

==================== New Run ====================

Start time: 27-Feb-2016 20:55:45

Description: [[version 3]], expected output for CURVES

Initial constant values:
------------------------

layersizes: 784  400  200  100   50   25    6   25   50  100  200  400  784
rms: 0
weightcost: 1e-005
autodamp: 1
initlambda: 150
lambda_adj_interval: 5
drop: 0.95
boost: 1.0526
initgamma: 12.2474
gamma_adj_interval: 20
gamma_drop: 0.97468
gamma_boost: 1.026
mattype: gn
errtype: L2
stochastic_mode: 1
numsamples: 1
minibatch_startsize: 1000
minibatch_maxsize: 20000
minibatch_maxsize_targetiter: 500
maxchunksize: 5000
psize: 842340
useTriBlock: 1
useEIGs: 1
ratio_sample: 0.125
ratio_BV: 1
refreshInvApprox_interval: 20
maxfade_stats: 0.95
maxfade_avg: 0.99
avg_start: 200
useMomentum: 1
compMode: jacket

=================================================

size_minibatch = 1000
Precon grad coeff: 4.1495
norm(ch) = 1.1418
iter: 1, Minibatch log likelihood (pre-update): -941.3253, error rate (pre-update): 279.3288

size_minibatch = 1006
Precon grad coeff: 3.0952, velocity coeff: 0.23961
norm(ch) = 0.92886
iter: 2, Minibatch log likelihood (pre-update): -739.1143, error rate (pre-update): 228.6915

size_minibatch = 1012
Precon grad coeff: 1.576, velocity coeff: 0.51214
norm(ch) = 0.76706
iter: 3, Minibatch log likelihood (pre-update): -601.0881, error rate (pre-update): 187.037

size_minibatch = 1018
Precon grad coeff: 0.67659, velocity coeff: 0.681
norm(ch) = 0.64335
iter: 4, Minibatch log likelihood (pre-update): -506.4886, error rate (pre-update): 154.0983

size_minibatch = 1024
Precon grad coeff: 0.5382, velocity coeff: 0.70945
norm(ch) = 0.55144
rho = 1.8659
New lambda: 116.0671
iter: 5, Minibatch log likelihood (pre-update): -439.7216, error rate (pre-update): 128.8368
iter: 5, Minibatch log likelihood (post-update): -390.6363, error rate (post-update): 109.1679

size_minibatch = 1030
Precon grad coeff: 0.5914, velocity coeff: 0.90319
norm(ch) = 0.60293
iter: 6, Minibatch log likelihood (pre-update): -390.5975, error rate (pre-update): 109.2333

size_minibatch = 1036
Precon grad coeff: 0.53696, velocity coeff: 0.71383
norm(ch) = 0.52459
iter: 7, Minibatch log likelihood (pre-update): -344.2047, error rate (pre-update): 90.1908

size_minibatch = 1042
Precon grad coeff: 0.42661, velocity coeff: 0.74728
norm(ch) = 0.46547
iter: 8, Minibatch log likelihood (pre-update): -309.3071, error rate (pre-update): 75.9058

size_minibatch = 1049
Precon grad coeff: 0.37669, velocity coeff: 0.76107
norm(ch) = 0.4169
iter: 9, Minibatch log likelihood (pre-update): -282.1922, error rate (pre-update): 64.4102

size_minibatch = 1055
Precon grad coeff: 0.32783, velocity coeff: 0.77832
norm(ch) = 0.37668
rho = 1.9023
New lambda: 89.8105
iter: 10, Minibatch log likelihood (pre-update): -260.4036, error rate (pre-update): 55.6192
iter: 10, Minibatch log likelihood (post-update): -242.6847, error rate (post-update): 48.5401

size_minibatch = 1061
Precon grad coeff: 0.40394, velocity coeff: 0.97358
norm(ch) = 0.4278
iter: 11, Minibatch log likelihood (pre-update): -242.6906, error rate (pre-update): 48.4574

size_minibatch = 1068
Precon grad coeff: 0.41907, velocity coeff: 0.75248
norm(ch) = 0.38048
iter: 12, Minibatch log likelihood (pre-update): -224.5513, error rate (pre-update): 41.4857

size_minibatch = 1074
Precon grad coeff: 0.38391, velocity coeff: 0.76424
norm(ch) = 0.34022
iter: 13, Minibatch log likelihood (pre-update): -210.715, error rate (pre-update): 36.4434

size_minibatch = 1081
Precon grad coeff: 0.39355, velocity coeff: 0.76172
norm(ch) = 0.30575
iter: 14, Minibatch log likelihood (pre-update): -199.2974, error rate (pre-update): 32.1947

size_minibatch = 1087
Precon grad coeff: 0.36712, velocity coeff: 0.7741
norm(ch) = 0.2767
rho = 1.9025
New lambda: 69.4937
iter: 15, Minibatch log likelihood (pre-update): -190.1858, error rate (pre-update): 29.1515
iter: 15, Minibatch log likelihood (post-update): -182.824, error rate (post-update): 26.8491

size_minibatch = 1094
Precon grad coeff: 0.55431, velocity coeff: 0.93828
norm(ch) = 0.31534
iter: 16, Minibatch log likelihood (pre-update): -183.1384, error rate (pre-update): 26.8562

size_minibatch = 1100
Precon grad coeff: 0.67112, velocity coeff: 0.7047
norm(ch) = 0.28358
iter: 17, Minibatch log likelihood (pre-update): -175.5907, error rate (pre-update): 24.7852

size_minibatch = 1107
Precon grad coeff: 0.6904, velocity coeff: 0.69881
norm(ch) = 0.25558
iter: 18, Minibatch log likelihood (pre-update): -169.3987, error rate (pre-update): 23.2183

size_minibatch = 1114
Precon grad coeff: 0.80547, velocity coeff: 0.66916
norm(ch) = 0.23233
iter: 19, Minibatch log likelihood (pre-update): -164.57, error rate (pre-update): 21.9523

size_minibatch = 1120
Precon grad coeff: 8.619, velocity coeff: -0.19297
New gamma: 12.2474
norm(ch) = 0.24351
rho = 1.8899
New lambda: 53.7729
iter: 20, Minibatch log likelihood (pre-update): -160.6264, error rate (pre-update): 21.2014
iter: 20, Minibatch log likelihood (post-update): -156.1602, error rate (post-update): 20.3273

size_minibatch = 1127
Precon grad coeff: 4.2294, velocity coeff: 0.61222
norm(ch) = 0.27359
iter: 21, Minibatch log likelihood (pre-update): -156.2659, error rate (pre-update): 20.2856

size_minibatch = 1134
Precon grad coeff: 3.8612, velocity coeff: 0.51576
norm(ch) = 0.24238
iter: 22, Minibatch log likelihood (pre-update): -151.7322, error rate (pre-update): 19.4804

size_minibatch = 1141
Precon grad coeff: 3.268, velocity coeff: 0.57813
norm(ch) = 0.21801
iter: 23, Minibatch log likelihood (pre-update): -148.3791, error rate (pre-update): 18.7922

size_minibatch = 1148
Precon grad coeff: 1.6464, velocity coeff: 0.73787
norm(ch) = 0.1967
iter: 24, Minibatch log likelihood (pre-update): -145.5265, error rate (pre-update): 18.4433

size_minibatch = 1154
Precon grad coeff: 2.6425, velocity coeff: 0.63794
norm(ch) = 0.17817
rho = 1.9108
New lambda: 41.6084
iter: 25, Minibatch log likelihood (pre-update): -143.5076, error rate (pre-update): 18.2026
iter: 25, Minibatch log likelihood (post-update): -141.6944, error rate (post-update): 17.9824

size_minibatch = 1161
Precon grad coeff: 3.04, velocity coeff: 0.84244
norm(ch) = 0.20685
iter: 26, Minibatch log likelihood (pre-update): -141.5785, error rate (pre-update): 18.0704

size_minibatch = 1168
Precon grad coeff: 3.7185, velocity coeff: 0.59506
norm(ch) = 0.18655
iter: 27, Minibatch log likelihood (pre-update): -139.9853, error rate (pre-update): 17.6545

size_minibatch = 1175
Precon grad coeff: 3.971, velocity coeff: 0.57608
norm(ch) = 0.17029
iter: 28, Minibatch log likelihood (pre-update): -138.2119, error rate (pre-update): 17.6646

size_minibatch = 1183
Precon grad coeff: 5.8348, velocity coeff: 0.40815
norm(ch) = 0.15497
iter: 29, Minibatch log likelihood (pre-update): -137.0883, error rate (pre-update): 17.4285

size_minibatch = 1190
Precon grad coeff: 6.2385, velocity coeff: 0.37508
norm(ch) = 0.14516
rho = 1.9305
New lambda: 32.1958
iter: 30, Minibatch log likelihood (pre-update): -135.9131, error rate (pre-update): 17.4388
iter: 30, Minibatch log likelihood (post-update): -134.995, error rate (post-update): 17.3634

size_minibatch = 1197
Precon grad coeff: 8.5099, velocity coeff: 0.40521
norm(ch) = 0.17108
iter: 31, Minibatch log likelihood (pre-update): -134.9537, error rate (pre-update): 17.2061

size_minibatch = 1204
Precon grad coeff: 9.4083, velocity coeff: 0.2454
norm(ch) = 0.15891
iter: 32, Minibatch log likelihood (pre-update): -133.9078, error rate (pre-update): 17.3368

size_minibatch = 1211
Precon grad coeff: 9.7936, velocity coeff: 0.20483
norm(ch) = 0.14523
iter: 33, Minibatch log likelihood (pre-update): -133.3966, error rate (pre-update): 17.278

size_minibatch = 1219
Precon grad coeff: 10.5485, velocity coeff: 0.14599
norm(ch) = 0.13576
iter: 34, Minibatch log likelihood (pre-update): -132.4619, error rate (pre-update): 17.1371

size_minibatch = 1226
Precon grad coeff: 10.1474, velocity coeff: 0.16658
norm(ch) = 0.12858
rho = 1.9239
New lambda: 24.9125
iter: 35, Minibatch log likelihood (pre-update): -131.8137, error rate (pre-update): 16.9907
iter: 35, Minibatch log likelihood (post-update): -131.255, error rate (post-update): 16.9532

size_minibatch = 1233
Precon grad coeff: 13.8476, velocity coeff: 0.12695
norm(ch) = 0.15038
iter: 36, Minibatch log likelihood (pre-update): -131.5747, error rate (pre-update): 17.0058

size_minibatch = 1241
Precon grad coeff: 13.0089, velocity coeff: 0.14549
norm(ch) = 0.14046
iter: 37, Minibatch log likelihood (pre-update): -130.8856, error rate (pre-update): 17.2377

size_minibatch = 1248
Precon grad coeff: 12.9995, velocity coeff: 0.13704
norm(ch) = 0.13284
iter: 38, Minibatch log likelihood (pre-update): -130.228, error rate (pre-update): 17.0305

size_minibatch = 1256
Precon grad coeff: 13.0263, velocity coeff: 0.12856
norm(ch) = 0.12491
iter: 39, Minibatch log likelihood (pre-update): -130.3311, error rate (pre-update): 17.137

size_minibatch = 1263
Precon grad coeff: 26.374, velocity coeff: -0.2086
New gamma: 12.2474
norm(ch) = 0.13414
rho = 1.8619
New lambda: 19.2768
iter: 40, Minibatch log likelihood (pre-update): -129.7914, error rate (pre-update): 16.9392
iter: 40, Minibatch log likelihood (post-update): -129.3042, error rate (post-update): 16.9134

size_minibatch = 1271
Precon grad coeff: 22.2236, velocity coeff: 0.29473
norm(ch) = 0.15669
iter: 41, Minibatch log likelihood (pre-update): -128.9413, error rate (pre-update): 17.0203

size_minibatch = 1279
Precon grad coeff: 20.0476, velocity coeff: 0.27733
norm(ch) = 0.14262
iter: 42, Minibatch log likelihood (pre-update): -127.9935, error rate (pre-update): 17.088

size_minibatch = 1286
Precon grad coeff: 19.7188, velocity coeff: 0.28504
norm(ch) = 0.13045
iter: 43, Minibatch log likelihood (pre-update): -128.105, error rate (pre-update): 16.9538

size_minibatch = 1294
Precon grad coeff: 20.9226, velocity coeff: 0.24485
norm(ch) = 0.12298
iter: 44, Minibatch log likelihood (pre-update): -128.0812, error rate (pre-update): 16.8397

size_minibatch = 1302
Precon grad coeff: 21.8371, velocity coeff: 0.18959
norm(ch) = 0.11048
rho = 1.865
New lambda: 14.916
iter: 45, Minibatch log likelihood (pre-update): -127.6674, error rate (pre-update): 16.9669
iter: 45, Minibatch log likelihood (post-update): -127.412, error rate (post-update): 16.9552

size_minibatch = 1310
Precon grad coeff: 24.8585, velocity coeff: 0.31963
norm(ch) = 0.13044
iter: 46, Minibatch log likelihood (pre-update): -127.8836, error rate (pre-update): 17.1805

size_minibatch = 1318
Precon grad coeff: 24.3834, velocity coeff: 0.27578
norm(ch) = 0.11926
iter: 47, Minibatch log likelihood (pre-update): -127.2615, error rate (pre-update): 16.9417

size_minibatch = 1325
Precon grad coeff: 24.1179, velocity coeff: 0.29384
norm(ch) = 0.11601
iter: 48, Minibatch log likelihood (pre-update): -127.2452, error rate (pre-update): 17.0524

size_minibatch = 1333
Precon grad coeff: 23.5674, velocity coeff: 0.26083
norm(ch) = 0.10807
iter: 49, Minibatch log likelihood (pre-update): -126.9056, error rate (pre-update): 17.04

size_minibatch = 1342
Precon grad coeff: 23.4753, velocity coeff: 0.22616
norm(ch) = 0.10117
rho = 1.759
New lambda: 11.5417
iter: 50, Minibatch log likelihood (pre-update): -126.7805, error rate (pre-update): 17.0218
iter: 50, Minibatch log likelihood (post-update): -126.6027, error rate (post-update): 17.0087
---
Full log-likelihood: -126.528, error rate: 16.9225
TEST log-likelihood: -126.5286, error rate: 16.9701
Error difference (test - train): 0.047622
---
Full log-likelihood (averaged params): -126.528, error rate (averaged params): 16.9225
TEST log-likelihood (averaged params): -126.5286, error rate (averaged params): 16.9701
Error difference (test - train) (averaged params): 0.047622

size_minibatch = 1350
Precon grad coeff: 27.1802, velocity coeff: 0.33947
norm(ch) = 0.12302
iter: 51, Minibatch log likelihood (pre-update): -126.0485, error rate (pre-update): 16.917

size_minibatch = 1358
Precon grad coeff: 24.6436, velocity coeff: 0.30496
norm(ch) = 0.11421
iter: 52, Minibatch log likelihood (pre-update): -126.298, error rate (pre-update): 16.9365

size_minibatch = 1366
Precon grad coeff: 26.8378, velocity coeff: 0.25625
norm(ch) = 0.10819
iter: 53, Minibatch log likelihood (pre-update): -126.1776, error rate (pre-update): 16.8899

size_minibatch = 1374
Precon grad coeff: 25.2602, velocity coeff: 0.25559
norm(ch) = 0.099924
iter: 54, Minibatch log likelihood (pre-update): -126.4995, error rate (pre-update): 17.0371

size_minibatch = 1382
Precon grad coeff: 24.946, velocity coeff: 0.27973
norm(ch) = 0.095974
rho = 1.6485
New lambda: 8.9308
iter: 55, Minibatch log likelihood (pre-update): -126.0797, error rate (pre-update): 16.8651
iter: 55, Minibatch log likelihood (post-update): -125.9441, error rate (post-update): 16.8531

size_minibatch = 1391
Precon grad coeff: 31.272, velocity coeff: 0.27099
norm(ch) = 0.10498
iter: 56, Minibatch log likelihood (pre-update): -126.2104, error rate (pre-update): 17.0115

size_minibatch = 1399
Precon grad coeff: 30.4395, velocity coeff: 0.28014
norm(ch) = 0.10547
iter: 57, Minibatch log likelihood (pre-update): -125.9837, error rate (pre-update): 16.9463

size_minibatch = 1408
Precon grad coeff: 30.7041, velocity coeff: 0.27291
norm(ch) = 0.10252
iter: 58, Minibatch log likelihood (pre-update): -125.5757, error rate (pre-update): 16.8747

size_minibatch = 1416
Precon grad coeff: 29.8606, velocity coeff: 0.24067
norm(ch) = 0.095832
iter: 59, Minibatch log likelihood (pre-update): -126.0262, error rate (pre-update): 16.8075

size_minibatch = 1425
Precon grad coeff: 30.8887, velocity coeff: 0.29923
New gamma: 12.2474
norm(ch) = 0.097884
rho = 1.5071
New lambda: 6.9105
iter: 60, Minibatch log likelihood (pre-update): -125.8438, error rate (pre-update): 16.9194
iter: 60, Minibatch log likelihood (post-update): -125.7155, error rate (post-update): 16.9055

size_minibatch = 1433
Precon grad coeff: 33.467, velocity coeff: 0.29978
norm(ch) = 0.10518
iter: 61, Minibatch log likelihood (pre-update): -125.8602, error rate (pre-update): 17.0084

size_minibatch = 1442
Precon grad coeff: 32.6119, velocity coeff: 0.31115
norm(ch) = 0.092791
iter: 62, Minibatch log likelihood (pre-update): -125.4582, error rate (pre-update): 16.7374

size_minibatch = 1450
Precon grad coeff: 32.6022, velocity coeff: 0.432
norm(ch) = 0.10198
iter: 63, Minibatch log likelihood (pre-update): -125.1679, error rate (pre-update): 16.8312

size_minibatch = 1459
Precon grad coeff: 32.2651, velocity coeff: 0.34828
norm(ch) = 0.096804
iter: 64, Minibatch log likelihood (pre-update): -125.5094, error rate (pre-update): 16.9465

size_minibatch = 1468
Precon grad coeff: 32.949, velocity coeff: 0.34487
norm(ch) = 0.089236
rho = 1.4287
New lambda: 5.3472
iter: 65, Minibatch log likelihood (pre-update): -125.3791, error rate (pre-update): 16.8197
iter: 65, Minibatch log likelihood (post-update): -125.2872, error rate (post-update): 16.8102

size_minibatch = 1477
Precon grad coeff: 38.828, velocity coeff: 0.40925
norm(ch) = 0.10118
iter: 66, Minibatch log likelihood (pre-update): -125.4363, error rate (pre-update): 16.9754

size_minibatch = 1486
Precon grad coeff: 31.4588, velocity coeff: 0.27959
norm(ch) = 0.10408
iter: 67, Minibatch log likelihood (pre-update): -125.0792, error rate (pre-update): 16.8946

size_minibatch = 1495
Precon grad coeff: 28.7148, velocity coeff: 0.27781
norm(ch) = 0.10933
iter: 68, Minibatch log likelihood (pre-update): -125.5869, error rate (pre-update): 16.9458

size_minibatch = 1504
Precon grad coeff: 28.8491, velocity coeff: 0.21252
norm(ch) = 0.075565
iter: 69, Minibatch log likelihood (pre-update): -125.134, error rate (pre-update): 16.8739

size_minibatch = 1513
Precon grad coeff: 33.328, velocity coeff: 0.24997
norm(ch) = 0.088375
rho = 1.3034
New lambda: 4.1376
iter: 70, Minibatch log likelihood (pre-update): -125.1355, error rate (pre-update): 16.8549
iter: 70, Minibatch log likelihood (post-update): -125.0461, error rate (post-update): 16.8418

size_minibatch = 1522
Precon grad coeff: 36.7685, velocity coeff: 0.21193
norm(ch) = 0.092178
iter: 71, Minibatch log likelihood (pre-update): -124.9775, error rate (pre-update): 16.8186

size_minibatch = 1531
Precon grad coeff: 33.9885, velocity coeff: 0.27883
norm(ch) = 0.085097
iter: 72, Minibatch log likelihood (pre-update): -125.1369, error rate (pre-update): 16.9017

size_minibatch = 1540
Precon grad coeff: 32.3628, velocity coeff: 0.30853
norm(ch) = 0.092807
iter: 73, Minibatch log likelihood (pre-update): -125.1912, error rate (pre-update): 16.9036

size_minibatch = 1549
Precon grad coeff: 33.2401, velocity coeff: 0.2531
norm(ch) = 0.089881
iter: 74, Minibatch log likelihood (pre-update): -125.6359, error rate (pre-update): 16.9995

size_minibatch = 1559
Precon grad coeff: 33.402, velocity coeff: 0.22558
norm(ch) = 0.095315
rho = 1.2305
New lambda: 3.2016
iter: 75, Minibatch log likelihood (pre-update): -125.0739, error rate (pre-update): 16.9842
iter: 75, Minibatch log likelihood (post-update): -124.9739, error rate (post-update): 16.9683

size_minibatch = 1568
Precon grad coeff: 34.1189, velocity coeff: 0.18464
norm(ch) = 0.089722
iter: 76, Minibatch log likelihood (pre-update): -125.2566, error rate (pre-update): 16.8707

size_minibatch = 1578
Precon grad coeff: 28.5453, velocity coeff: 0.17274
norm(ch) = 0.081084
iter: 77, Minibatch log likelihood (pre-update): -125.2056, error rate (pre-update): 17.0038

size_minibatch = 1587
Precon grad coeff: 32.1217, velocity coeff: 0.24703
norm(ch) = 0.080013
iter: 78, Minibatch log likelihood (pre-update): -125.2333, error rate (pre-update): 16.8852

size_minibatch = 1597
Precon grad coeff: 29.6456, velocity coeff: 0.20945
norm(ch) = 0.082928
iter: 79, Minibatch log likelihood (pre-update): -124.8715, error rate (pre-update): 16.9066

size_minibatch = 1606
Precon grad coeff: 31.1134, velocity coeff: 0.32838
New gamma: 12.2474
norm(ch) = 0.092744
rho = 1.1632
New lambda: 2.4773
iter: 80, Minibatch log likelihood (pre-update): -125.4964, error rate (pre-update): 16.9585
iter: 80, Minibatch log likelihood (post-update): -125.3948, error rate (post-update): 16.9406

size_minibatch = 1616
Precon grad coeff: 34.8479, velocity coeff: 0.2327
norm(ch) = 0.081711
iter: 81, Minibatch log likelihood (pre-update): -125.3744, error rate (pre-update): 16.8741

size_minibatch = 1626
Precon grad coeff: 31.2067, velocity coeff: 0.17175
norm(ch) = 0.078595
iter: 82, Minibatch log likelihood (pre-update): -125.2138, error rate (pre-update): 16.9174

size_minibatch = 1636
Precon grad coeff: 34.4224, velocity coeff: 0.36059
norm(ch) = 0.081062
iter: 83, Minibatch log likelihood (pre-update): -125.1141, error rate (pre-update): 16.9733

size_minibatch = 1645
Precon grad coeff: 35.7507, velocity coeff: 0.29471
norm(ch) = 0.084205
iter: 84, Minibatch log likelihood (pre-update): -124.9002, error rate (pre-update): 16.8559

size_minibatch = 1655
Precon grad coeff: 35.1308, velocity coeff: 0.24298
norm(ch) = 0.089262
rho = 1.1405
New lambda: 1.9169
iter: 85, Minibatch log likelihood (pre-update): -124.9878, error rate (pre-update): 16.9201
iter: 85, Minibatch log likelihood (post-update): -124.9046, error rate (post-update): 16.9068

size_minibatch = 1665
Precon grad coeff: 35.0051, velocity coeff: 0.15448
norm(ch) = 0.092581
iter: 86, Minibatch log likelihood (pre-update): -125.4134, error rate (pre-update): 16.9488

size_minibatch = 1675
Precon grad coeff: 34.048, velocity coeff: 0.22844
norm(ch) = 0.085006
iter: 87, Minibatch log likelihood (pre-update): -125.0634, error rate (pre-update): 16.9246

size_minibatch = 1685
Precon grad coeff: 30.9026, velocity coeff: 0.2032
norm(ch) = 0.082988
iter: 88, Minibatch log likelihood (pre-update): -125.057, error rate (pre-update): 16.9756

size_minibatch = 1696
Precon grad coeff: 32.7744, velocity coeff: 0.31616
norm(ch) = 0.07696
iter: 89, Minibatch log likelihood (pre-update): -124.828, error rate (pre-update): 16.9664

size_minibatch = 1706
Precon grad coeff: 38.8867, velocity coeff: 0.27824
norm(ch) = 0.093413
rho = 1.1165
New lambda: 1.4833
iter: 90, Minibatch log likelihood (pre-update): -124.8848, error rate (pre-update): 16.82
iter: 90, Minibatch log likelihood (post-update): -124.8055, error rate (post-update): 16.8081

size_minibatch = 1716
Precon grad coeff: 31.1375, velocity coeff: 0.10235
norm(ch) = 0.076645
iter: 91, Minibatch log likelihood (pre-update): -124.9669, error rate (pre-update): 16.89

size_minibatch = 1726
Precon grad coeff: 40.51, velocity coeff: 0.25809
norm(ch) = 0.078599
iter: 92, Minibatch log likelihood (pre-update): -125.1021, error rate (pre-update): 16.8496

size_minibatch = 1737
Precon grad coeff: 34.2674, velocity coeff: 0.23052
norm(ch) = 0.081433
iter: 93, Minibatch log likelihood (pre-update): -125.0046, error rate (pre-update): 16.8427

size_minibatch = 1747
Precon grad coeff: 39.0793, velocity coeff: 0.26586
norm(ch) = 0.10373
iter: 94, Minibatch log likelihood (pre-update): -124.9799, error rate (pre-update): 17.0138

size_minibatch = 1758
Precon grad coeff: 29.2419, velocity coeff: 0.099994
norm(ch) = 0.090366
rho = 1.0716
New lambda: 1.1477
iter: 95, Minibatch log likelihood (pre-update): -124.9193, error rate (pre-update): 16.9325
iter: 95, Minibatch log likelihood (post-update): -124.8298, error rate (post-update): 16.915

size_minibatch = 1768
Precon grad coeff: 30.4811, velocity coeff: 0.25218
norm(ch) = 0.077133
iter: 96, Minibatch log likelihood (pre-update): -124.9476, error rate (pre-update): 16.8389

size_minibatch = 1779
Precon grad coeff: 32.3531, velocity coeff: 0.2796
norm(ch) = 0.074623
iter: 97, Minibatch log likelihood (pre-update): -125.0288, error rate (pre-update): 16.8936

size_minibatch = 1790
Precon grad coeff: 33.9311, velocity coeff: 0.26948
norm(ch) = 0.081535
iter: 98, Minibatch log likelihood (pre-update): -125.0496, error rate (pre-update): 16.9873

size_minibatch = 1800
Precon grad coeff: 32.6585, velocity coeff: 0.19057
norm(ch) = 0.075304
iter: 99, Minibatch log likelihood (pre-update): -124.6494, error rate (pre-update): 16.9437

size_minibatch = 1811
Precon grad coeff: 36.3548, velocity coeff: 0.27266
New gamma: 12.2474
norm(ch) = 0.072631
rho = 1.0673
New lambda: 0.88808
iter: 100, Minibatch log likelihood (pre-update): -124.5904, error rate (pre-update): 16.8185
iter: 100, Minibatch log likelihood (post-update): -124.5428, error rate (post-update): 16.811
---
Full log-likelihood: -124.9636, error rate: 16.9059
TEST log-likelihood: -124.9672, error rate: 16.9543
Error difference (test - train): 0.048356
---
Full log-likelihood (averaged params): -124.9636, error rate (averaged params): 16.9059
TEST log-likelihood (averaged params): -124.9672, error rate (averaged params): 16.9543
Error difference (test - train) (averaged params): 0.048356

size_minibatch = 1822
Precon grad coeff: 39.4319, velocity coeff: 0.32832
norm(ch) = 0.095669
iter: 101, Minibatch log likelihood (pre-update): -124.7177, error rate (pre-update): 16.8801

size_minibatch = 1833
Precon grad coeff: 31.5166, velocity coeff: 0.095662
norm(ch) = 0.092559
iter: 102, Minibatch log likelihood (pre-update): -125.031, error rate (pre-update): 17.015

size_minibatch = 1844
Precon grad coeff: 35.4112, velocity coeff: 0.30678
norm(ch) = 0.097411
iter: 103, Minibatch log likelihood (pre-update): -125.0477, error rate (pre-update): 17.0073

size_minibatch = 1855
Precon grad coeff: 28.7964, velocity coeff: 0.10987
norm(ch) = 0.077599
iter: 104, Minibatch log likelihood (pre-update): -124.9241, error rate (pre-update): 16.7614

size_minibatch = 1867
Precon grad coeff: 32.7398, velocity coeff: 0.25439
norm(ch) = 0.071138
rho = 1.047
New lambda: 0.68718
iter: 105, Minibatch log likelihood (pre-update): -125.0022, error rate (pre-update): 16.8629
iter: 105, Minibatch log likelihood (post-update): -124.9524, error rate (post-update): 16.8539

size_minibatch = 1878
Precon grad coeff: 32.7327, velocity coeff: 0.25306
norm(ch) = 0.085863
iter: 106, Minibatch log likelihood (pre-update): -124.64, error rate (pre-update): 16.8265

size_minibatch = 1889
Precon grad coeff: 28.4805, velocity coeff: 0.14748
norm(ch) = 0.081772
iter: 107, Minibatch log likelihood (pre-update): -125.123, error rate (pre-update): 16.8709

size_minibatch = 1900
Precon grad coeff: 37.763, velocity coeff: 0.24777
norm(ch) = 0.096215
iter: 108, Minibatch log likelihood (pre-update): -125.1793, error rate (pre-update): 16.9427

size_minibatch = 1912
Precon grad coeff: 35.6767, velocity coeff: 0.11498
norm(ch) = 0.089157
iter: 109, Minibatch log likelihood (pre-update): -124.7442, error rate (pre-update): 16.9617

size_minibatch = 1923
Precon grad coeff: 29.5268, velocity coeff: 0.15189
norm(ch) = 0.07497
rho = 1.0364
New lambda: 0.53173
iter: 110, Minibatch log likelihood (pre-update): -124.9204, error rate (pre-update): 16.8554
iter: 110, Minibatch log likelihood (post-update): -124.8621, error rate (post-update): 16.8439

size_minibatch = 1935
Precon grad coeff: 31.6763, velocity coeff: 0.22274
norm(ch) = 0.075149
iter: 111, Minibatch log likelihood (pre-update): -124.8071, error rate (pre-update): 16.9578

size_minibatch = 1947
Precon grad coeff: 33.4654, velocity coeff: 0.26409
norm(ch) = 0.081324
iter: 112, Minibatch log likelihood (pre-update): -124.9796, error rate (pre-update): 16.9238

size_minibatch = 1958
Precon grad coeff: 31.4817, velocity coeff: 0.24555
norm(ch) = 0.070385
iter: 113, Minibatch log likelihood (pre-update): -124.7408, error rate (pre-update): 16.9408

size_minibatch = 1970
Precon grad coeff: 36.199, velocity coeff: 0.2343
norm(ch) = 0.083143
iter: 114, Minibatch log likelihood (pre-update): -125.1763, error rate (pre-update): 16.92

size_minibatch = 1982
Precon grad coeff: 31.1696, velocity coeff: 0.12336
norm(ch) = 0.07638
rho = 1.0268
New lambda: 0.41144
iter: 115, Minibatch log likelihood (pre-update): -124.893, error rate (pre-update): 16.9855
iter: 115, Minibatch log likelihood (post-update): -124.8356, error rate (post-update): 16.975

size_minibatch = 1994
Precon grad coeff: 32.4498, velocity coeff: 0.24976
norm(ch) = 0.06978
iter: 116, Minibatch log likelihood (pre-update): -124.9263, error rate (pre-update): 16.9167

size_minibatch = 2006
Precon grad coeff: 31.9262, velocity coeff: 0.20613
norm(ch) = 0.074035
iter: 117, Minibatch log likelihood (pre-update): -125.2916, error rate (pre-update): 16.9555

size_minibatch = 2018
Precon grad coeff: 30.1463, velocity coeff: 0.2749
norm(ch) = 0.072641
iter: 118, Minibatch log likelihood (pre-update): -125.0977, error rate (pre-update): 16.8561

size_minibatch = 2030
Precon grad coeff: 32.908, velocity coeff: 0.16634
norm(ch) = 0.094283
iter: 119, Minibatch log likelihood (pre-update): -125.2303, error rate (pre-update): 16.7762

size_minibatch = 2042
Precon grad coeff: 2.6038, velocity coeff: 0.14977
New gamma: 1
norm(ch) = 0.13151
rho = 1.0602
New lambda: 0.31836
iter: 120, Minibatch log likelihood (pre-update): -125.0271, error rate (pre-update): 16.9049
iter: 120, Minibatch log likelihood (post-update): -124.9727, error rate (post-update): 16.8956

size_minibatch = 2055
Precon grad coeff: 3.2177, velocity coeff: 0.25323
norm(ch) = 0.15759
iter: 121, Minibatch log likelihood (pre-update): -124.9543, error rate (pre-update): 16.9499

size_minibatch = 2067
Precon grad coeff: 3.2276, velocity coeff: 0.22574
norm(ch) = 0.2041
iter: 122, Minibatch log likelihood (pre-update): -125.0193, error rate (pre-update): 16.8781

size_minibatch = 2080
Precon grad coeff: 2.3739, velocity coeff: 0.12508
norm(ch) = 0.19656
iter: 123, Minibatch log likelihood (pre-update): -125.1449, error rate (pre-update): 16.986

size_minibatch = 2092
Precon grad coeff: 2.7167, velocity coeff: 0.28481
norm(ch) = 0.18274
iter: 124, Minibatch log likelihood (pre-update): -124.8034, error rate (pre-update): 16.8526

size_minibatch = 2105
Precon grad coeff: 2.8103, velocity coeff: 0.36066
norm(ch) = 0.23345
rho = 0.88776
New lambda: 0.24634
iter: 125, Minibatch log likelihood (pre-update): -124.6388, error rate (pre-update): 16.8836
iter: 125, Minibatch log likelihood (post-update): -124.5725, error rate (post-update): 16.8723

size_minibatch = 2117
Precon grad coeff: 2.6537, velocity coeff: 0.096356
norm(ch) = 0.27643
iter: 126, Minibatch log likelihood (pre-update): -125.4178, error rate (pre-update): 16.9055

size_minibatch = 2130
Precon grad coeff: 2.2633, velocity coeff: 0.20836
norm(ch) = 0.30812
iter: 127, Minibatch log likelihood (pre-update): -124.8319, error rate (pre-update): 16.8821

size_minibatch = 2143
Precon grad coeff: 2.7543, velocity coeff: 0.059012
norm(ch) = 0.24473
iter: 128, Minibatch log likelihood (pre-update): -125.4876, error rate (pre-update): 17.0034

size_minibatch = 2156
Precon grad coeff: 3.6453, velocity coeff: 0.23579
norm(ch) = 0.4594
iter: 129, Minibatch log likelihood (pre-update): -125.1807, error rate (pre-update): 16.9743

size_minibatch = 2169
Precon grad coeff: 2.592, velocity coeff: 0.10416
norm(ch) = 0.31626
rho = 1.1061
New lambda: 0.19062
iter: 130, Minibatch log likelihood (pre-update): -124.6897, error rate (pre-update): 16.8998
iter: 130, Minibatch log likelihood (post-update): -124.6145, error rate (post-update): 16.886

size_minibatch = 2182
Precon grad coeff: 2.0403, velocity coeff: 0.42189
norm(ch) = 0.4253
iter: 131, Minibatch log likelihood (pre-update): -124.7929, error rate (pre-update): 16.8151

size_minibatch = 2195
Precon grad coeff: 1.0333, velocity coeff: 1.5078
norm(ch) = 0.90127
iter: 132, Minibatch log likelihood (pre-update): -124.9328, error rate (pre-update): 16.9108

size_minibatch = 2208
Precon grad coeff: 1.8623, velocity coeff: -0.10366
norm(ch) = 0.47486
iter: 133, Minibatch log likelihood (pre-update): -124.915, error rate (pre-update): 16.8473

size_minibatch = 2222
Precon grad coeff: 0.42971, velocity coeff: -0.093312
norm(ch) = 0.36988
iter: 134, Minibatch log likelihood (pre-update): -124.9803, error rate (pre-update): 16.9123

size_minibatch = 2235
Precon grad coeff: 3.7437, velocity coeff: 1.8762
norm(ch) = 1.2687
rho = -Inf
New lambda: 0.24634
iter: 135, Minibatch log likelihood (pre-update): -124.9924, error rate (pre-update): 16.8312
iter: 135, Minibatch log likelihood (post-update): -125.3175, error rate (post-update): 16.8995

size_minibatch = 2248
Precon grad coeff: 0.64566, velocity coeff: -0.35128
norm(ch) = 0.80227
iter: 136, Minibatch log likelihood (pre-update): -124.8961, error rate (pre-update): 17.0381

size_minibatch = 2262
Precon grad coeff: 1.871, velocity coeff: 0.34452
norm(ch) = 0.54534
iter: 137, Minibatch log likelihood (pre-update): -125.0077, error rate (pre-update): 16.9125

size_minibatch = 2276
Precon grad coeff: 1.8046, velocity coeff: 0.91925
norm(ch) = 1.4166
iter: 138, Minibatch log likelihood (pre-update): -124.6342, error rate (pre-update): 16.824

size_minibatch = 2289
Precon grad coeff: 1.3298, velocity coeff: -0.23026
norm(ch) = 1.0331
iter: 139, Minibatch log likelihood (pre-update): -124.572, error rate (pre-update): 16.9313

size_minibatch = 2303
Precon grad coeff: 0.53649, velocity coeff: 0.54692
New gamma: 0.59874
norm(ch) = 1.4389
rho = 0.16684
New lambda: 0.31836
iter: 140, Minibatch log likelihood (pre-update): -124.8607, error rate (pre-update): 16.9435
iter: 140, Minibatch log likelihood (post-update): -124.6197, error rate (post-update): 16.8973

size_minibatch = 2317
Precon grad coeff: 0.45935, velocity coeff: -0.31705
norm(ch) = 0.96662
iter: 141, Minibatch log likelihood (pre-update): -124.7369, error rate (pre-update): 16.8708

size_minibatch = 2331
Precon grad coeff: 0.15573, velocity coeff: 0.25173
norm(ch) = 0.72241
iter: 142, Minibatch log likelihood (pre-update): -124.2437, error rate (pre-update): 16.6984

size_minibatch = 2345
Precon grad coeff: 0.1857, velocity coeff: 0.45422
norm(ch) = 0.89938
iter: 143, Minibatch log likelihood (pre-update): -124.3624, error rate (pre-update): 16.8651

size_minibatch = 2359
Precon grad coeff: 0.17923, velocity coeff: 0.75332
norm(ch) = 0.84827
iter: 144, Minibatch log likelihood (pre-update): -124.2292, error rate (pre-update): 16.7399

size_minibatch = 2373
Precon grad coeff: 0.62901, velocity coeff: 1.2816
norm(ch) = 1.8201
rho = 1.492
New lambda: 0.24634
iter: 145, Minibatch log likelihood (pre-update): -122.857, error rate (pre-update): 16.5389
iter: 145, Minibatch log likelihood (post-update): -121.1351, error rate (post-update): 16.1629

size_minibatch = 2388
Precon grad coeff: 0.13017, velocity coeff: 0.95235
norm(ch) = 1.9343
iter: 146, Minibatch log likelihood (pre-update): -121.3514, error rate (pre-update): 16.208

size_minibatch = 2402
Precon grad coeff: 0.0033361, velocity coeff: 0.69949
norm(ch) = 1.358
iter: 147, Minibatch log likelihood (pre-update): -119.4225, error rate (pre-update): 15.7862

size_minibatch = 2416
Precon grad coeff: 0.078074, velocity coeff: 0.44031
norm(ch) = 0.69008
iter: 148, Minibatch log likelihood (pre-update): -118.72, error rate (pre-update): 15.6187

size_minibatch = 2431
Precon grad coeff: 0.40221, velocity coeff: 1.8991
norm(ch) = 1.8419
iter: 149, Minibatch log likelihood (pre-update): -118.5505, error rate (pre-update): 15.6174

size_minibatch = 2446
Precon grad coeff: 0.063132, velocity coeff: 0.6876
norm(ch) = 1.3293
rho = 1.6054
New lambda: 0.19062
iter: 150, Minibatch log likelihood (pre-update): -116.5078, error rate (pre-update): 15.3261
iter: 150, Minibatch log likelihood (post-update): -115.6938, error rate (post-update): 15.2013
---
Full log-likelihood: -115.8567, error rate: 15.1785
TEST log-likelihood: -115.8116, error rate: 15.2258
Error difference (test - train): 0.047228
---
Full log-likelihood (averaged params): -115.8567, error rate (averaged params): 15.1785
TEST log-likelihood (averaged params): -115.8116, error rate (averaged params): 15.2258
Error difference (test - train) (averaged params): 0.047228

size_minibatch = 2460
Precon grad coeff: 0.10913, velocity coeff: 0.54559
norm(ch) = 0.83993
iter: 151, Minibatch log likelihood (pre-update): -116.1154, error rate (pre-update): 15.1989

size_minibatch = 2475
Precon grad coeff: 0.020802, velocity coeff: 0.24784
norm(ch) = 0.22972
iter: 152, Minibatch log likelihood (pre-update): -115.4581, error rate (pre-update): 15.0855

size_minibatch = 2490
Precon grad coeff: 0.083337, velocity coeff: 4.2143
norm(ch) = 1.0264
iter: 153, Minibatch log likelihood (pre-update): -115.311, error rate (pre-update): 15.0297

size_minibatch = 2505
Precon grad coeff: 0.18924, velocity coeff: 0.97179
norm(ch) = 1.1343
iter: 154, Minibatch log likelihood (pre-update): -114.6124, error rate (pre-update): 15.0816

size_minibatch = 2520
Precon grad coeff: 0.011426, velocity coeff: 0.64043
norm(ch) = 0.73383
rho = 1.2378
New lambda: 0.1475
iter: 155, Minibatch log likelihood (pre-update): -114.3663, error rate (pre-update): 14.9737
iter: 155, Minibatch log likelihood (post-update): -114.1426, error rate (post-update): 14.9754

size_minibatch = 2535
Precon grad coeff: 0.023868, velocity coeff: 0.97567
norm(ch) = 0.72578
iter: 156, Minibatch log likelihood (pre-update): -114.0099, error rate (pre-update): 14.9634

size_minibatch = 2551
Precon grad coeff: 0.022934, velocity coeff: 0.61212
norm(ch) = 0.45282
iter: 157, Minibatch log likelihood (pre-update): -113.8902, error rate (pre-update): 14.9164

size_minibatch = 2566
Precon grad coeff: 0.073104, velocity coeff: 2.091
norm(ch) = 0.96763
iter: 158, Minibatch log likelihood (pre-update): -113.5864, error rate (pre-update): 14.9147

size_minibatch = 2581
Precon grad coeff: 0.0092601, velocity coeff: 0.61572
norm(ch) = 0.59833
iter: 159, Minibatch log likelihood (pre-update): -113.5809, error rate (pre-update): 15.0019

size_minibatch = 2597
Precon grad coeff: 0.12819, velocity coeff: 0.48329
New gamma: 0.35849
norm(ch) = 0.45775
rho = 1.1203
New lambda: 0.11413
iter: 160, Minibatch log likelihood (pre-update): -113.4124, error rate (pre-update): 14.8465
iter: 160, Minibatch log likelihood (post-update): -113.1882, error rate (post-update): 14.7971

size_minibatch = 2613
Precon grad coeff: 0.13065, velocity coeff: 1.2268
norm(ch) = 0.70186
iter: 161, Minibatch log likelihood (pre-update): -112.8168, error rate (pre-update): 14.8801

size_minibatch = 2628
Precon grad coeff: 0.20954, velocity coeff: 2.3558
norm(ch) = 1.8565
iter: 162, Minibatch log likelihood (pre-update): -112.5836, error rate (pre-update): 14.856

size_minibatch = 2644
Precon grad coeff: 0.08653, velocity coeff: 0.43602
norm(ch) = 0.92777
iter: 163, Minibatch log likelihood (pre-update): -111.9082, error rate (pre-update): 14.5633

size_minibatch = 2660
Precon grad coeff: 0.06342, velocity coeff: 0.74144
norm(ch) = 0.76271
iter: 164, Minibatch log likelihood (pre-update): -111.4159, error rate (pre-update): 14.525

size_minibatch = 2676
Precon grad coeff: 0.11379, velocity coeff: 1.4078
norm(ch) = 1.2221
rho = 1.3696
New lambda: 0.088311
iter: 165, Minibatch log likelihood (pre-update): -111.1317, error rate (pre-update): 14.4356
iter: 165, Minibatch log likelihood (post-update): -110.5621, error rate (post-update): 14.3187

size_minibatch = 2692
Precon grad coeff: 0.204, velocity coeff: 1.0556
norm(ch) = 1.6176
iter: 166, Minibatch log likelihood (pre-update): -110.5865, error rate (pre-update): 14.3987

size_minibatch = 2708
Precon grad coeff: 0.048592, velocity coeff: 1.13
norm(ch) = 1.9173
iter: 167, Minibatch log likelihood (pre-update): -109.9195, error rate (pre-update): 14.2819

size_minibatch = 2725
Precon grad coeff: 0.16073, velocity coeff: 0.7733
norm(ch) = 1.7765
iter: 168, Minibatch log likelihood (pre-update): -108.7761, error rate (pre-update): 14.0023

size_minibatch = 2741
Precon grad coeff: 0.085967, velocity coeff: 0.68993
norm(ch) = 1.363
iter: 169, Minibatch log likelihood (pre-update): -108.103, error rate (pre-update): 13.5968

size_minibatch = 2758
Precon grad coeff: 0.045855, velocity coeff: 0.93078
norm(ch) = 1.3414
rho = 1.159
New lambda: 0.068333
iter: 170, Minibatch log likelihood (pre-update): -107.3612, error rate (pre-update): 13.4676
iter: 170, Minibatch log likelihood (post-update): -106.7984, error rate (post-update): 13.2858

size_minibatch = 2774
Precon grad coeff: 0.028063, velocity coeff: 0.53342
norm(ch) = 0.76266
iter: 171, Minibatch log likelihood (pre-update): -107.3566, error rate (pre-update): 13.4168

size_minibatch = 2791
Precon grad coeff: 0.053852, velocity coeff: 0.67951
norm(ch) = 0.59287
iter: 172, Minibatch log likelihood (pre-update): -106.7461, error rate (pre-update): 13.3469

size_minibatch = 2808
Precon grad coeff: 0.039854, velocity coeff: 1.648
norm(ch) = 1.0243
iter: 173, Minibatch log likelihood (pre-update): -106.4132, error rate (pre-update): 13.3355

size_minibatch = 2825
Precon grad coeff: 0.03944, velocity coeff: 0.85552
norm(ch) = 0.92754
iter: 174, Minibatch log likelihood (pre-update): -106.0344, error rate (pre-update): 13.296

size_minibatch = 2842
Precon grad coeff: 0.042691, velocity coeff: 0.88207
norm(ch) = 0.87772
rho = 1.1232
New lambda: 0.052875
iter: 175, Minibatch log likelihood (pre-update): -106.3806, error rate (pre-update): 13.2641
iter: 175, Minibatch log likelihood (post-update): -106.0855, error rate (post-update): 13.1925

size_minibatch = 2859
Precon grad coeff: 0.018769, velocity coeff: 0.59562
norm(ch) = 0.54401
iter: 176, Minibatch log likelihood (pre-update): -105.4951, error rate (pre-update): 13.0389

size_minibatch = 2876
Precon grad coeff: 0.031317, velocity coeff: 0.87422
norm(ch) = 0.51066
iter: 177, Minibatch log likelihood (pre-update): -105.423, error rate (pre-update): 13.023

size_minibatch = 2893
Precon grad coeff: 0.023831, velocity coeff: 1.1316
norm(ch) = 0.60739
iter: 178, Minibatch log likelihood (pre-update): -105.4411, error rate (pre-update): 12.9561

size_minibatch = 2911
Precon grad coeff: 0.023245, velocity coeff: 0.81665
norm(ch) = 0.51808
iter: 179, Minibatch log likelihood (pre-update): -105.3869, error rate (pre-update): 13.0096

size_minibatch = 2928
Precon grad coeff: 0.16982, velocity coeff: 1.0289
New gamma: 0.21464
norm(ch) = 0.92278
rho = 1.0837
New lambda: 0.040914
iter: 180, Minibatch log likelihood (pre-update): -104.8073, error rate (pre-update): 12.925
iter: 180, Minibatch log likelihood (post-update): -104.5129, error rate (post-update): 12.8404

size_minibatch = 2946
Precon grad coeff: 0.093429, velocity coeff: 0.9041
norm(ch) = 1.035
iter: 181, Minibatch log likelihood (pre-update): -105.1075, error rate (pre-update): 12.7818

size_minibatch = 2964
Precon grad coeff: 0.16463, velocity coeff: 1.6241
norm(ch) = 1.9634
iter: 182, Minibatch log likelihood (pre-update): -104.666, error rate (pre-update): 12.7496

size_minibatch = 2982
Precon grad coeff: 0.060955, velocity coeff: 0.46404
norm(ch) = 1.0256
iter: 183, Minibatch log likelihood (pre-update): -104.0598, error rate (pre-update): 12.5887

size_minibatch = 3000
Precon grad coeff: 0.093863, velocity coeff: 1.1355
norm(ch) = 1.3376
iter: 184, Minibatch log likelihood (pre-update): -103.6742, error rate (pre-update): 12.433

size_minibatch = 3018
Precon grad coeff: 0.068297, velocity coeff: 0.62864
norm(ch) = 0.9622
rho = 1.0999
New lambda: 0.031658
iter: 185, Minibatch log likelihood (pre-update): -103.8066, error rate (pre-update): 12.4845
iter: 185, Minibatch log likelihood (post-update): -103.6098, error rate (post-update): 12.4229

size_minibatch = 3036
Precon grad coeff: 0.091402, velocity coeff: 1.5541
norm(ch) = 1.6627
iter: 186, Minibatch log likelihood (pre-update): -103.1045, error rate (pre-update): 12.4908

size_minibatch = 3054
Precon grad coeff: 0.053616, velocity coeff: 0.73161
norm(ch) = 1.3024
iter: 187, Minibatch log likelihood (pre-update): -102.7149, error rate (pre-update): 12.2078

size_minibatch = 3072
Precon grad coeff: 0.072758, velocity coeff: 0.91619
norm(ch) = 1.3064
iter: 188, Minibatch log likelihood (pre-update): -102.5107, error rate (pre-update): 12.1464

size_minibatch = 3091
Precon grad coeff: 0.035878, velocity coeff: 0.51694
norm(ch) = 0.72362
iter: 189, Minibatch log likelihood (pre-update): -102.0633, error rate (pre-update): 12.0089

size_minibatch = 3110
Precon grad coeff: 0.078423, velocity coeff: 1.821
norm(ch) = 1.4206
rho = 1.154
New lambda: 0.024497
iter: 190, Minibatch log likelihood (pre-update): -101.801, error rate (pre-update): 12.0586
iter: 190, Minibatch log likelihood (post-update): -101.5572, error rate (post-update): 11.9766

size_minibatch = 3128
Precon grad coeff: 0.039899, velocity coeff: 0.7803
norm(ch) = 1.1563
iter: 191, Minibatch log likelihood (pre-update): -102.3658, error rate (pre-update): 11.9501

size_minibatch = 3147
Precon grad coeff: 0.058934, velocity coeff: 0.92075
norm(ch) = 1.1432
iter: 192, Minibatch log likelihood (pre-update): -101.665, error rate (pre-update): 11.8482

size_minibatch = 3166
Precon grad coeff: 0.030574, velocity coeff: 0.73387
norm(ch) = 0.87562
iter: 193, Minibatch log likelihood (pre-update): -101.5539, error rate (pre-update): 11.9152

size_minibatch = 3185
Precon grad coeff: 0.056924, velocity coeff: 1.0355
norm(ch) = 0.97136
iter: 194, Minibatch log likelihood (pre-update): -101.4185, error rate (pre-update): 11.8967

size_minibatch = 3204
Precon grad coeff: 0.03604, velocity coeff: 0.88158
norm(ch) = 0.8977
rho = 1.0995
New lambda: 0.018955
iter: 195, Minibatch log likelihood (pre-update): -101.3295, error rate (pre-update): 11.7677
iter: 195, Minibatch log likelihood (post-update): -101.2015, error rate (post-update): 11.7143

size_minibatch = 3224
Precon grad coeff: 0.033492, velocity coeff: 0.79739
norm(ch) = 0.75982
iter: 196, Minibatch log likelihood (pre-update): -101.2864, error rate (pre-update): 11.7585

size_minibatch = 3243
Precon grad coeff: 0.048464, velocity coeff: 1.483
norm(ch) = 1.181
iter: 197, Minibatch log likelihood (pre-update): -100.9671, error rate (pre-update): 11.7426

size_minibatch = 3263
Precon grad coeff: 0.027549, velocity coeff: 0.57617
norm(ch) = 0.71003
iter: 198, Minibatch log likelihood (pre-update): -100.5169, error rate (pre-update): 11.6305

size_minibatch = 3282
Precon grad coeff: 0.036809, velocity coeff: 1.1023
norm(ch) = 0.81598
iter: 199, Minibatch log likelihood (pre-update): -101.0804, error rate (pre-update): 11.653

size_minibatch = 3302
Precon grad coeff: 0.16718, velocity coeff: 0.93209
New gamma: 0.12851
norm(ch) = 1.119
rho = 1.0847
New lambda: 0.014667
iter: 200, Minibatch log likelihood (pre-update): -100.8506, error rate (pre-update): 11.5358
iter: 200, Minibatch log likelihood (post-update): -100.7183, error rate (post-update): 11.5008
---
Full log-likelihood: -100.7548, error rate: 11.5813
TEST log-likelihood: -100.4957, error rate: 11.5846
Error difference (test - train): 0.0032844
---
Full log-likelihood (averaged params): -100.7548, error rate (averaged params): 11.5813
TEST log-likelihood (averaged params): -100.4957, error rate (averaged params): 11.5846
Error difference (test - train) (averaged params): 0.0032844

size_minibatch = 3322
Precon grad coeff: 0.098745, velocity coeff: 1.3367
norm(ch) = 1.6777
iter: 201, Minibatch log likelihood (pre-update): -100.6106, error rate (pre-update): 11.5574

size_minibatch = 3342
Precon grad coeff: 0.098334, velocity coeff: 0.65202
norm(ch) = 1.2281
iter: 202, Minibatch log likelihood (pre-update): -100.8363, error rate (pre-update): 11.5595

size_minibatch = 3362
Precon grad coeff: 0.082348, velocity coeff: 0.65746
norm(ch) = 0.95442
iter: 203, Minibatch log likelihood (pre-update): -100.3556, error rate (pre-update): 11.5464

size_minibatch = 3382
Precon grad coeff: 0.132, velocity coeff: 1.3889
norm(ch) = 1.5087
iter: 204, Minibatch log likelihood (pre-update): -100.7447, error rate (pre-update): 11.4018

size_minibatch = 3403
Precon grad coeff: 0.079711, velocity coeff: 0.73592
norm(ch) = 1.2204
rho = 1.156
New lambda: 0.011349
iter: 205, Minibatch log likelihood (pre-update): -100.7088, error rate (pre-update): 11.4268
iter: 205, Minibatch log likelihood (post-update): -100.6058, error rate (post-update): 11.3929

size_minibatch = 3423
Precon grad coeff: 0.066115, velocity coeff: 0.63589
norm(ch) = 0.8602
iter: 206, Minibatch log likelihood (pre-update): -100.2608, error rate (pre-update): 11.4581

size_minibatch = 3444
Precon grad coeff: 0.088079, velocity coeff: 1.1722
norm(ch) = 1.1137
iter: 207, Minibatch log likelihood (pre-update): -99.8874, error rate (pre-update): 11.325

size_minibatch = 3465
Precon grad coeff: 0.080595, velocity coeff: 0.88572
norm(ch) = 1.0813
iter: 208, Minibatch log likelihood (pre-update): -100.2618, error rate (pre-update): 11.3681

size_minibatch = 3485
Precon grad coeff: 0.067626, velocity coeff: 0.67716
norm(ch) = 0.83247
iter: 209, Minibatch log likelihood (pre-update): -100.2807, error rate (pre-update): 11.3764

size_minibatch = 3506
Precon grad coeff: 0.055914, velocity coeff: 0.90219
norm(ch) = 0.81595
rho = 1.0442
New lambda: 0.0087817
iter: 210, Minibatch log likelihood (pre-update): -99.8853, error rate (pre-update): 11.34
iter: 210, Minibatch log likelihood (post-update): -99.8235, error rate (post-update): 11.3105

size_minibatch = 3527
Precon grad coeff: 0.084053, velocity coeff: 1.1781
norm(ch) = 1.0511
iter: 211, Minibatch log likelihood (pre-update): -99.5811, error rate (pre-update): 11.2554

size_minibatch = 3549
Precon grad coeff: 0.079806, velocity coeff: 0.73708
norm(ch) = 0.86488
iter: 212, Minibatch log likelihood (pre-update): -99.6312, error rate (pre-update): 11.2411

size_minibatch = 3570
Precon grad coeff: 0.044484, velocity coeff: 0.72464
norm(ch) = 0.67303
iter: 213, Minibatch log likelihood (pre-update): -99.9207, error rate (pre-update): 11.2599

size_minibatch = 3592
Precon grad coeff: 0.087061, velocity coeff: 1.3632
norm(ch) = 1.0121
iter: 214, Minibatch log likelihood (pre-update): -100.3091, error rate (pre-update): 11.2561

size_minibatch = 3613
Precon grad coeff: 0.046902, velocity coeff: 0.45364
norm(ch) = 0.5254
rho = 0.98757
New lambda: 0.0067951
iter: 215, Minibatch log likelihood (pre-update): -99.7602, error rate (pre-update): 11.3147
iter: 215, Minibatch log likelihood (post-update): -99.7287, error rate (post-update): 11.3076

size_minibatch = 3635
Precon grad coeff: 0.056508, velocity coeff: 1.2601
norm(ch) = 0.72187
iter: 216, Minibatch log likelihood (pre-update): -99.8103, error rate (pre-update): 11.2502

size_minibatch = 3657
Precon grad coeff: 0.075409, velocity coeff: 1.1891
norm(ch) = 0.95665
iter: 217, Minibatch log likelihood (pre-update): -99.7849, error rate (pre-update): 11.2604

size_minibatch = 3679
Precon grad coeff: 0.04384, velocity coeff: 0.673
norm(ch) = 0.70292
iter: 218, Minibatch log likelihood (pre-update): -99.5344, error rate (pre-update): 11.2552

size_minibatch = 3701
Precon grad coeff: 0.052889, velocity coeff: 1.162
norm(ch) = 0.87539
iter: 219, Minibatch log likelihood (pre-update): -99.9348, error rate (pre-update): 11.2101

size_minibatch = 3723
Precon grad coeff: 0.15053, velocity coeff: 1.3965
New gamma: 0.076945
norm(ch) = 1.801
rho = 1.2683
New lambda: 0.0052579
iter: 220, Minibatch log likelihood (pre-update): -99.2286, error rate (pre-update): 11.1929
iter: 220, Minibatch log likelihood (post-update): -99.0965, error rate (post-update): 11.1628

size_minibatch = 3746
Precon grad coeff: 0.072421, velocity coeff: 0.6911
norm(ch) = 1.4942
iter: 221, Minibatch log likelihood (pre-update): -99.2379, error rate (pre-update): 11.061

size_minibatch = 3768
Precon grad coeff: 0.085046, velocity coeff: 1.1971
norm(ch) = 2.1751
iter: 222, Minibatch log likelihood (pre-update): -99.1603, error rate (pre-update): 11.1255

size_minibatch = 3791
Precon grad coeff: 0.044506, velocity coeff: 0.76178
norm(ch) = 1.94
iter: 223, Minibatch log likelihood (pre-update): -98.9068, error rate (pre-update): 11.0874

size_minibatch = 3814
Precon grad coeff: 0.051932, velocity coeff: 1.1298
norm(ch) = 2.5904
iter: 224, Minibatch log likelihood (pre-update): -99.2496, error rate (pre-update): 11.0705

size_minibatch = 3837
Precon grad coeff: 0.015489, velocity coeff: 0.55108
norm(ch) = 1.5559
rho = 1.3792
New lambda: 0.0040685
iter: 225, Minibatch log likelihood (pre-update): -98.6447, error rate (pre-update): 11.033
iter: 225, Minibatch log likelihood (post-update): -98.3347, error rate (post-update): 10.9703

size_minibatch = 3860
Precon grad coeff: 0.066093, velocity coeff: 1.0976
norm(ch) = 2.5214
iter: 226, Minibatch log likelihood (pre-update): -98.1748, error rate (pre-update): 10.8756

size_minibatch = 3883
Precon grad coeff: 0.025209, velocity coeff: 0.5894
norm(ch) = 1.744
iter: 227, Minibatch log likelihood (pre-update): -97.9327, error rate (pre-update): 10.7786

size_minibatch = 3907
Precon grad coeff: 0.0065486, velocity coeff: 0.7681
norm(ch) = 1.4054
iter: 228, Minibatch log likelihood (pre-update): -97.7305, error rate (pre-update): 10.7346

size_minibatch = 3930
Precon grad coeff: 0.011301, velocity coeff: 0.97055
norm(ch) = 1.4995
iter: 229, Minibatch log likelihood (pre-update): -97.1591, error rate (pre-update): 10.6772

size_minibatch = 3954
Precon grad coeff: 0.0078411, velocity coeff: 0.3095
norm(ch) = 0.5655
rho = 1.1541
New lambda: 0.0031481
iter: 230, Minibatch log likelihood (pre-update): -96.6289, error rate (pre-update): 10.527
iter: 230, Minibatch log likelihood (post-update): -96.4994, error rate (post-update): 10.4918

size_minibatch = 3978
Precon grad coeff: 0.0091703, velocity coeff: 3.0977
norm(ch) = 1.8677
iter: 231, Minibatch log likelihood (pre-update): -96.9078, error rate (pre-update): 10.6797

size_minibatch = 4002
Precon grad coeff: 0.0083876, velocity coeff: 0.51434
norm(ch) = 1.0497
iter: 232, Minibatch log likelihood (pre-update): -96.2897, error rate (pre-update): 10.4702

size_minibatch = 4026
Precon grad coeff: 0.0035223, velocity coeff: 1.0153
norm(ch) = 1.0995
iter: 233, Minibatch log likelihood (pre-update): -96.0432, error rate (pre-update): 10.4552

size_minibatch = 4050
Precon grad coeff: 0.0093523, velocity coeff: 1.3041
norm(ch) = 1.4954
iter: 234, Minibatch log likelihood (pre-update): -96.0606, error rate (pre-update): 10.4657

size_minibatch = 4074
Precon grad coeff: 0.0041887, velocity coeff: 0.63273
norm(ch) = 0.97193
rho = 0.98533
New lambda: 0.0024359
iter: 235, Minibatch log likelihood (pre-update): -95.7653, error rate (pre-update): 10.3986
iter: 235, Minibatch log likelihood (post-update): -95.6345, error rate (post-update): 10.3881

size_minibatch = 4099
Precon grad coeff: 0.0052455, velocity coeff: 1.5703
norm(ch) = 1.5527
iter: 236, Minibatch log likelihood (pre-update): -95.549, error rate (pre-update): 10.4135

size_minibatch = 4123
Precon grad coeff: 0.0050716, velocity coeff: 1.1582
norm(ch) = 1.837
iter: 237, Minibatch log likelihood (pre-update): -95.3758, error rate (pre-update): 10.3556

size_minibatch = 4148
Precon grad coeff: 0.0039611, velocity coeff: 0.46592
norm(ch) = 0.88441
iter: 238, Minibatch log likelihood (pre-update): -95.3543, error rate (pre-update): 10.3279

size_minibatch = 4173
Precon grad coeff: 0.0045739, velocity coeff: 0.9934
norm(ch) = 0.91437
iter: 239, Minibatch log likelihood (pre-update): -95.0174, error rate (pre-update): 10.2955

size_minibatch = 4198
Precon grad coeff: 0.071641, velocity coeff: 1.5828
New gamma: 0.04607
norm(ch) = 3.1262
rho = 1.0275
New lambda: 0.0018849
iter: 240, Minibatch log likelihood (pre-update): -95.0932, error rate (pre-update): 10.2268
iter: 240, Minibatch log likelihood (post-update): -94.5008, error rate (post-update): 10.0715

size_minibatch = 4224
Precon grad coeff: 0.060014, velocity coeff: 0.84124
norm(ch) = 3.4218
iter: 241, Minibatch log likelihood (pre-update): -94.3619, error rate (pre-update): 10.044

size_minibatch = 4249
Precon grad coeff: 0.059411, velocity coeff: 1.0696
norm(ch) = 4.6098
iter: 242, Minibatch log likelihood (pre-update): -93.874, error rate (pre-update): 9.9742

size_minibatch = 4275
Precon grad coeff: 0.029918, velocity coeff: 0.6521
norm(ch) = 3.5233
iter: 243, Minibatch log likelihood (pre-update): -93.0664, error rate (pre-update): 9.7971

size_minibatch = 4300
Precon grad coeff: 0.04169, velocity coeff: 1.2174
norm(ch) = 5.0496
iter: 244, Minibatch log likelihood (pre-update): -92.5457, error rate (pre-update): 9.6681

size_minibatch = 4326
Precon grad coeff: 0.016311, velocity coeff: 0.47578
norm(ch) = 2.7335
rho = 1.0574
New lambda: 0.0014585
iter: 245, Minibatch log likelihood (pre-update): -91.7028, error rate (pre-update): 9.4716
iter: 245, Minibatch log likelihood (post-update): -91.1601, error rate (post-update): 9.3519

size_minibatch = 4352
Precon grad coeff: 0.020144, velocity coeff: 0.91132
norm(ch) = 2.8369
iter: 246, Minibatch log likelihood (pre-update): -90.8551, error rate (pre-update): 9.3539

size_minibatch = 4379
Precon grad coeff: 0.023078, velocity coeff: 1.2174
norm(ch) = 3.9071
iter: 247, Minibatch log likelihood (pre-update): -90.3824, error rate (pre-update): 9.1808

size_minibatch = 4405
Precon grad coeff: 0.022707, velocity coeff: 0.92507
norm(ch) = 4.0168
iter: 248, Minibatch log likelihood (pre-update): -89.9239, error rate (pre-update): 9.0606

size_minibatch = 4432
Precon grad coeff: 0.014592, velocity coeff: 0.61614
norm(ch) = 2.7753
iter: 249, Minibatch log likelihood (pre-update): -89.6219, error rate (pre-update): 8.8877

size_minibatch = 4458
Precon grad coeff: 0.014122, velocity coeff: 0.85761
norm(ch) = 2.6104
rho = 1.0471
New lambda: 0.0011285
iter: 250, Minibatch log likelihood (pre-update): -88.6248, error rate (pre-update): 8.7652
iter: 250, Minibatch log likelihood (post-update): -88.2011, error rate (post-update): 8.6575
---
Full log-likelihood: -88.5223, error rate: 8.65
TEST log-likelihood: -88.4763, error rate: 8.6887
Error difference (test - train): 0.038678
---
Full log-likelihood (averaged params): -98.2352, error rate (averaged params): 10.8839
TEST log-likelihood (averaged params): -98.0498, error rate (averaged params): 10.8974
Error difference (test - train) (averaged params): 0.01349

size_minibatch = 4485
Precon grad coeff: 0.021471, velocity coeff: 1.1008
norm(ch) = 3.2135
iter: 251, Minibatch log likelihood (pre-update): -88.5515, error rate (pre-update): 8.6079

size_minibatch = 4512
Precon grad coeff: 0.016388, velocity coeff: 0.93785
norm(ch) = 3.287
iter: 252, Minibatch log likelihood (pre-update): -88.1226, error rate (pre-update): 8.5057

size_minibatch = 4539
Precon grad coeff: 0.015621, velocity coeff: 0.76272
norm(ch) = 2.7693
iter: 253, Minibatch log likelihood (pre-update): -87.6649, error rate (pre-update): 8.4447

size_minibatch = 4567
Precon grad coeff: 0.01566, velocity coeff: 0.75546
norm(ch) = 2.3826
iter: 254, Minibatch log likelihood (pre-update): -87.2868, error rate (pre-update): 8.3195

size_minibatch = 4594
Precon grad coeff: 0.014718, velocity coeff: 0.99342
norm(ch) = 2.564
rho = 0.99963
New lambda: 0.00087325
iter: 255, Minibatch log likelihood (pre-update): -86.8012, error rate (pre-update): 8.1999
iter: 255, Minibatch log likelihood (post-update): -86.4619, error rate (post-update): 8.09

size_minibatch = 4622
Precon grad coeff: 0.017134, velocity coeff: 1.0244
norm(ch) = 2.9104
iter: 256, Minibatch log likelihood (pre-update): -86.6956, error rate (pre-update): 8.1497

size_minibatch = 4650
Precon grad coeff: 0.011349, velocity coeff: 0.68613
norm(ch) = 2.1346
iter: 257, Minibatch log likelihood (pre-update): -86.3748, error rate (pre-update): 8.1127

size_minibatch = 4678
Precon grad coeff: 0.014487, velocity coeff: 0.94401
norm(ch) = 2.2663
iter: 258, Minibatch log likelihood (pre-update): -86.2251, error rate (pre-update): 8.0478

size_minibatch = 4706
Precon grad coeff: 0.013391, velocity coeff: 0.94356
norm(ch) = 2.2864
iter: 259, Minibatch log likelihood (pre-update): -86, error rate (pre-update): 7.9426

size_minibatch = 4734
Precon grad coeff: 0.047371, velocity coeff: 0.80234
New gamma: 0.027584
norm(ch) = 3.1598
rho = 1.0054
New lambda: 0.0006757
iter: 260, Minibatch log likelihood (pre-update): -85.4349, error rate (pre-update): 7.8492
iter: 260, Minibatch log likelihood (post-update): -85.1091, error rate (post-update): 7.7536

size_minibatch = 4763
Precon grad coeff: 0.035043, velocity coeff: 0.9383
norm(ch) = 3.6911
iter: 261, Minibatch log likelihood (pre-update): -85.3689, error rate (pre-update): 7.8243

size_minibatch = 4791
Precon grad coeff: 0.036062, velocity coeff: 0.81214
norm(ch) = 3.6873
iter: 262, Minibatch log likelihood (pre-update): -85.3695, error rate (pre-update): 7.7187

size_minibatch = 4820
Precon grad coeff: 0.038764, velocity coeff: 0.79596
norm(ch) = 3.7009
iter: 263, Minibatch log likelihood (pre-update): -84.9212, error rate (pre-update): 7.6129

size_minibatch = 4849
Precon grad coeff: 0.036052, velocity coeff: 0.91092
norm(ch) = 4.3192
iter: 264, Minibatch log likelihood (pre-update): -84.9336, error rate (pre-update): 7.5781

size_minibatch = 4878
Precon grad coeff: 0.020371, velocity coeff: 0.66541
norm(ch) = 3.349
rho = 1.1041
New lambda: 0.00052285
iter: 265, Minibatch log likelihood (pre-update): -84.2063, error rate (pre-update): 7.3957
iter: 265, Minibatch log likelihood (post-update): -83.8821, error rate (post-update): 7.3057

size_minibatch = 4908
Precon grad coeff: 0.010842, velocity coeff: 0.65783
norm(ch) = 2.5376
iter: 266, Minibatch log likelihood (pre-update): -83.7375, error rate (pre-update): 7.3168

size_minibatch = 4937
Precon grad coeff: 0.015213, velocity coeff: 1.7097
norm(ch) = 4.7162
iter: 267, Minibatch log likelihood (pre-update): -83.7423, error rate (pre-update): 7.2835

size_minibatch = 4967
Precon grad coeff: 0.011428, velocity coeff: 0.67995
norm(ch) = 3.6364
iter: 268, Minibatch log likelihood (pre-update): -83.117, error rate (pre-update): 7.1457

size_minibatch = 4997
Precon grad coeff: 0.0061174, velocity coeff: 0.9421
norm(ch) = 3.6252
iter: 269, Minibatch log likelihood (pre-update): -82.5562, error rate (pre-update): 7.1167

size_minibatch = 5027
Precon grad coeff: 0.0076664, velocity coeff: 0.93232
norm(ch) = 3.7028
rho = 1.1246
New lambda: 0.00040457
iter: 270, Minibatch log likelihood (pre-update): -82.4919, error rate (pre-update): 7.0118
iter: 270, Minibatch log likelihood (post-update): -82.0309, error rate (post-update): 6.9612

size_minibatch = 5057
Precon grad coeff: 0.0056455, velocity coeff: 0.98632
norm(ch) = 3.8991
iter: 271, Minibatch log likelihood (pre-update): -81.7757, error rate (pre-update): 6.8849

size_minibatch = 5088
Precon grad coeff: 0.0036993, velocity coeff: 0.53679
norm(ch) = 2.277
iter: 272, Minibatch log likelihood (pre-update): -81.2157, error rate (pre-update): 6.7913

size_minibatch = 5118
Precon grad coeff: 0.0045122, velocity coeff: 1.1497
norm(ch) = 2.8598
iter: 273, Minibatch log likelihood (pre-update): -80.9581, error rate (pre-update): 6.7661

size_minibatch = 5149
Precon grad coeff: 0.0084018, velocity coeff: 1.4404
norm(ch) = 4.5751
iter: 274, Minibatch log likelihood (pre-update): -80.7635, error rate (pre-update): 6.7244

size_minibatch = 5180
Precon grad coeff: 0.005963, velocity coeff: 0.7028
norm(ch) = 3.4784
rho = 1.0856
New lambda: 0.00031305
iter: 275, Minibatch log likelihood (pre-update): -80.2717, error rate (pre-update): 6.5519
iter: 275, Minibatch log likelihood (post-update): -79.8036, error rate (post-update): 6.4362

size_minibatch = 5211
Precon grad coeff: 0.0039412, velocity coeff: 0.7608
norm(ch) = 2.8284
iter: 276, Minibatch log likelihood (pre-update): -79.4201, error rate (pre-update): 6.4027

size_minibatch = 5243
Precon grad coeff: 0.0039289, velocity coeff: 1.0755
norm(ch) = 3.262
iter: 277, Minibatch log likelihood (pre-update): -79.4401, error rate (pre-update): 6.3831

size_minibatch = 5274
Precon grad coeff: 0.0029972, velocity coeff: 0.80729
norm(ch) = 2.7813
iter: 278, Minibatch log likelihood (pre-update): -78.6203, error rate (pre-update): 6.2351

size_minibatch = 5306
Precon grad coeff: 0.0047157, velocity coeff: 1.0192
norm(ch) = 3.083
iter: 279, Minibatch log likelihood (pre-update): -78.3773, error rate (pre-update): 6.2189

size_minibatch = 5338
Precon grad coeff: 0.045735, velocity coeff: 1.0468
New gamma: 0.016515
norm(ch) = 7.5175
rho = 1.0723
New lambda: 0.00024223
iter: 280, Minibatch log likelihood (pre-update): -77.83, error rate (pre-update): 6.0566
iter: 280, Minibatch log likelihood (post-update): -76.7994, error rate (post-update): 5.7549

size_minibatch = 5370
Precon grad coeff: 0.031724, velocity coeff: 0.86489
norm(ch) = 8.6609
iter: 281, Minibatch log likelihood (pre-update): -76.9012, error rate (pre-update): 5.7846

size_minibatch = 5403
Precon grad coeff: 0.021677, velocity coeff: 0.65764
norm(ch) = 7.3434
iter: 282, Minibatch log likelihood (pre-update): -75.8844, error rate (pre-update): 5.5752

size_minibatch = 5435
Precon grad coeff: 0.012065, velocity coeff: 0.75078
norm(ch) = 6.408
iter: 283, Minibatch log likelihood (pre-update): -75.2908, error rate (pre-update): 5.3521

size_minibatch = 5468
Precon grad coeff: 0.015271, velocity coeff: 0.89132
norm(ch) = 6.8888
iter: 284, Minibatch log likelihood (pre-update): -74.2823, error rate (pre-update): 5.1838

size_minibatch = 5501
Precon grad coeff: 0.010543, velocity coeff: 0.75868
norm(ch) = 6.0697
rho = 1.0769
New lambda: 0.00018743
iter: 285, Minibatch log likelihood (pre-update): -73.2988, error rate (pre-update): 5.0127
iter: 285, Minibatch log likelihood (post-update): -72.5319, error rate (post-update): 4.8354

size_minibatch = 5534
Precon grad coeff: 0.010709, velocity coeff: 0.81718
norm(ch) = 5.7564
iter: 286, Minibatch log likelihood (pre-update): -72.5255, error rate (pre-update): 4.7905

size_minibatch = 5567
Precon grad coeff: 0.0089626, velocity coeff: 0.88332
norm(ch) = 5.7606
iter: 287, Minibatch log likelihood (pre-update): -72.1942, error rate (pre-update): 4.6721

size_minibatch = 5601
Precon grad coeff: 0.0061679, velocity coeff: 0.6936
norm(ch) = 4.4669
iter: 288, Minibatch log likelihood (pre-update): -71.3064, error rate (pre-update): 4.5205

size_minibatch = 5635
Precon grad coeff: 0.0054622, velocity coeff: 0.87495
norm(ch) = 4.3156
iter: 289, Minibatch log likelihood (pre-update): -70.7612, error rate (pre-update): 4.3626

size_minibatch = 5668
Precon grad coeff: 0.0089888, velocity coeff: 1.1796
norm(ch) = 5.7689
rho = 1.0502
New lambda: 0.00014503
iter: 290, Minibatch log likelihood (pre-update): -70.4816, error rate (pre-update): 4.2909
iter: 290, Minibatch log likelihood (post-update): -69.897, error rate (post-update): 4.1526

size_minibatch = 5703
Precon grad coeff: 0.006157, velocity coeff: 0.67988
norm(ch) = 4.3109
iter: 291, Minibatch log likelihood (pre-update): -69.8988, error rate (pre-update): 4.1635

size_minibatch = 5737
Precon grad coeff: 0.0038197, velocity coeff: 0.7676
norm(ch) = 3.5508
iter: 292, Minibatch log likelihood (pre-update): -69.2585, error rate (pre-update): 4.0465

size_minibatch = 5771
Precon grad coeff: 0.0050833, velocity coeff: 1.1657
norm(ch) = 4.4436
iter: 293, Minibatch log likelihood (pre-update): -69.0966, error rate (pre-update): 3.9867

size_minibatch = 5806
Precon grad coeff: 0.0072907, velocity coeff: 1.0441
norm(ch) = 5.0705
iter: 294, Minibatch log likelihood (pre-update): -68.8778, error rate (pre-update): 3.8875

size_minibatch = 5841
Precon grad coeff: 0.0055657, velocity coeff: 0.81372
norm(ch) = 4.4361
rho = 1.0236
New lambda: 0.00011222
iter: 295, Minibatch log likelihood (pre-update): -68.3687, error rate (pre-update): 3.8027
iter: 295, Minibatch log likelihood (post-update): -67.9926, error rate (post-update): 3.7013

size_minibatch = 5876
Precon grad coeff: 0.0052388, velocity coeff: 0.92312
norm(ch) = 4.3748
iter: 296, Minibatch log likelihood (pre-update): -68.156, error rate (pre-update): 3.6884

size_minibatch = 5912
Precon grad coeff: 0.0031332, velocity coeff: 0.74368
norm(ch) = 3.4246
iter: 297, Minibatch log likelihood (pre-update): -68.0597, error rate (pre-update): 3.6189

size_minibatch = 5947
Precon grad coeff: 0.0045232, velocity coeff: 1.2759
norm(ch) = 4.6103
iter: 298, Minibatch log likelihood (pre-update): -67.4888, error rate (pre-update): 3.5831

size_minibatch = 5983
Precon grad coeff: 0.0070083, velocity coeff: 0.93132
norm(ch) = 4.6793
iter: 299, Minibatch log likelihood (pre-update): -67.1542, error rate (pre-update): 3.4958

size_minibatch = 6019
Precon grad coeff: 0.037481, velocity coeff: 1.0265
New gamma: 0.0098884
norm(ch) = 8.5046
rho = 1.0162
New lambda: 8.6836e-005
iter: 300, Minibatch log likelihood (pre-update): -66.7571, error rate (pre-update): 3.4079
iter: 300, Minibatch log likelihood (post-update): -66.0812, error rate (post-update): 3.2204
---
Full log-likelihood: -66.118, error rate: 3.2197
TEST log-likelihood: -66.1273, error rate: 3.279
Error difference (test - train): 0.059247
---
Full log-likelihood (averaged params): -93.137, error rate (averaged params): 9.7555
TEST log-likelihood (averaged params): -93.0432, error rate (averaged params): 9.7828
Error difference (test - train) (averaged params): 0.027352

size_minibatch = 6055
Precon grad coeff: 0.028502, velocity coeff: 0.82084
norm(ch) = 9.0119
iter: 301, Minibatch log likelihood (pre-update): -66.3155, error rate (pre-update): 3.2269

size_minibatch = 6092
Precon grad coeff: 0.026961, velocity coeff: 0.82998
norm(ch) = 9.1683
iter: 302, Minibatch log likelihood (pre-update): -65.4638, error rate (pre-update): 3.058

size_minibatch = 6129
Precon grad coeff: 0.022847, velocity coeff: 0.86021
norm(ch) = 9.3597
iter: 303, Minibatch log likelihood (pre-update): -65.0387, error rate (pre-update): 2.9252

size_minibatch = 6166
Precon grad coeff: 0.026299, velocity coeff: 0.86045
norm(ch) = 9.7488
iter: 304, Minibatch log likelihood (pre-update): -64.424, error rate (pre-update): 2.7953

size_minibatch = 6203
Precon grad coeff: 0.020316, velocity coeff: 0.78244
norm(ch) = 8.8848
rho = 1.0238
New lambda: 6.7192e-005
iter: 305, Minibatch log likelihood (pre-update): -64.0498, error rate (pre-update): 2.6736
iter: 305, Minibatch log likelihood (post-update): -63.5636, error rate (post-update): 2.5371

size_minibatch = 6240
Precon grad coeff: 0.021287, velocity coeff: 0.88362
norm(ch) = 9.1289
iter: 306, Minibatch log likelihood (pre-update): -63.3229, error rate (pre-update): 2.5669

size_minibatch = 6278
Precon grad coeff: 0.015339, velocity coeff: 0.68607
norm(ch) = 7.1442
iter: 307, Minibatch log likelihood (pre-update): -63.0898, error rate (pre-update): 2.4462

size_minibatch = 6315
Precon grad coeff: 0.011332, velocity coeff: 0.71608
norm(ch) = 5.7533
iter: 308, Minibatch log likelihood (pre-update): -62.9151, error rate (pre-update): 2.3522

size_minibatch = 6353
Precon grad coeff: 0.010581, velocity coeff: 0.9907
norm(ch) = 6.3155
iter: 309, Minibatch log likelihood (pre-update): -62.5898, error rate (pre-update): 2.2973

size_minibatch = 6392
Precon grad coeff: 0.011358, velocity coeff: 0.98311
norm(ch) = 6.7327
rho = 1.0505
New lambda: 5.1992e-005
iter: 310, Minibatch log likelihood (pre-update): -62.3567, error rate (pre-update): 2.2199
iter: 310, Minibatch log likelihood (post-update): -62.0671, error rate (post-update): 2.1498

size_minibatch = 6430
Precon grad coeff: 0.012886, velocity coeff: 0.87897
norm(ch) = 6.6565
iter: 311, Minibatch log likelihood (pre-update): -61.9194, error rate (pre-update): 2.1479

size_minibatch = 6469
Precon grad coeff: 0.011163, velocity coeff: 0.77648
norm(ch) = 5.7267
iter: 312, Minibatch log likelihood (pre-update): -61.7232, error rate (pre-update): 2.0684

size_minibatch = 6508
Precon grad coeff: 0.0084371, velocity coeff: 0.92996
norm(ch) = 5.7955
iter: 313, Minibatch log likelihood (pre-update): -61.4287, error rate (pre-update): 2.0418

size_minibatch = 6547
Precon grad coeff: 0.0088697, velocity coeff: 0.77242
norm(ch) = 4.9236
iter: 314, Minibatch log likelihood (pre-update): -61.5047, error rate (pre-update): 1.9777

size_minibatch = 6586
Precon grad coeff: 0.0081352, velocity coeff: 0.96658
norm(ch) = 5.2063
rho = 0.98355
New lambda: 4.023e-005
iter: 315, Minibatch log likelihood (pre-update): -60.9867, error rate (pre-update): 1.9386
iter: 315, Minibatch log likelihood (post-update): -60.7882, error rate (post-update): 1.8714

size_minibatch = 6626
Precon grad coeff: 0.0076515, velocity coeff: 0.82351
norm(ch) = 4.6754
iter: 316, Minibatch log likelihood (pre-update): -61.0663, error rate (pre-update): 1.8909

size_minibatch = 6666
Precon grad coeff: 0.0095944, velocity coeff: 1.0502
norm(ch) = 5.44
iter: 317, Minibatch log likelihood (pre-update): -60.9082, error rate (pre-update): 1.8438

size_minibatch = 6706
Precon grad coeff: 0.0078688, velocity coeff: 0.7657
norm(ch) = 4.5408
iter: 318, Minibatch log likelihood (pre-update): -60.6417, error rate (pre-update): 1.7906

size_minibatch = 6747
Precon grad coeff: 0.0064197, velocity coeff: 0.79967
norm(ch) = 4.0053
iter: 319, Minibatch log likelihood (pre-update): -60.4875, error rate (pre-update): 1.7704

size_minibatch = 6787
Precon grad coeff: 0.033766, velocity coeff: 0.92424
New gamma: 0.0059205
norm(ch) = 6.8938
rho = 1.0179
New lambda: 3.113e-005
iter: 320, Minibatch log likelihood (pre-update): -60.4862, error rate (pre-update): 1.7302
iter: 320, Minibatch log likelihood (post-update): -60.2462, error rate (post-update): 1.6544

size_minibatch = 6828
Precon grad coeff: 0.036386, velocity coeff: 0.97486
norm(ch) = 9.2154
iter: 321, Minibatch log likelihood (pre-update): -60.1894, error rate (pre-update): 1.6596

size_minibatch = 6869
Precon grad coeff: 0.028152, velocity coeff: 0.81373
norm(ch) = 8.9819
iter: 322, Minibatch log likelihood (pre-update): -60.0354, error rate (pre-update): 1.6011

size_minibatch = 6911
Precon grad coeff: 0.02701, velocity coeff: 0.82759
norm(ch) = 9.0858
iter: 323, Minibatch log likelihood (pre-update): -59.8363, error rate (pre-update): 1.5522

size_minibatch = 6952
Precon grad coeff: 0.013197, velocity coeff: 0.66908
norm(ch) = 6.8115
iter: 324, Minibatch log likelihood (pre-update): -59.5635, error rate (pre-update): 1.5128

size_minibatch = 6994
Precon grad coeff: 0.019331, velocity coeff: 0.99204
norm(ch) = 7.9002
rho = 1.028
New lambda: 2.4087e-005
iter: 325, Minibatch log likelihood (pre-update): -59.3269, error rate (pre-update): 1.4531
iter: 325, Minibatch log likelihood (post-update): -59.1283, error rate (post-update): 1.4053

size_minibatch = 7036
Precon grad coeff: 0.023532, velocity coeff: 0.95441
norm(ch) = 8.8938
iter: 326, Minibatch log likelihood (pre-update): -59.3729, error rate (pre-update): 1.4108

size_minibatch = 7078
Precon grad coeff: 0.016539, velocity coeff: 0.69009
norm(ch) = 6.9904
iter: 327, Minibatch log likelihood (pre-update): -59.2667, error rate (pre-update): 1.362

size_minibatch = 7121
Precon grad coeff: 0.012806, velocity coeff: 0.79773
norm(ch) = 6.2172
iter: 328, Minibatch log likelihood (pre-update): -59.1277, error rate (pre-update): 1.3192

size_minibatch = 7164
Precon grad coeff: 0.010121, velocity coeff: 0.84042
norm(ch) = 5.7282
iter: 329, Minibatch log likelihood (pre-update): -58.7673, error rate (pre-update): 1.2882

size_minibatch = 7207
Precon grad coeff: 0.014524, velocity coeff: 1.0898
norm(ch) = 7.034
rho = 0.98981
New lambda: 1.8638e-005
iter: 330, Minibatch log likelihood (pre-update): -58.8963, error rate (pre-update): 1.2826
iter: 330, Minibatch log likelihood (post-update): -58.7535, error rate (post-update): 1.2352

size_minibatch = 7251
Precon grad coeff: 0.016252, velocity coeff: 0.90714
norm(ch) = 7.1414
iter: 331, Minibatch log likelihood (pre-update): -58.5751, error rate (pre-update): 1.2377

size_minibatch = 7294
Precon grad coeff: 0.01584, velocity coeff: 0.79335
norm(ch) = 6.4673
iter: 332, Minibatch log likelihood (pre-update): -58.4474, error rate (pre-update): 1.2055

size_minibatch = 7338
Precon grad coeff: 0.0094138, velocity coeff: 0.68155
norm(ch) = 4.8588
iter: 333, Minibatch log likelihood (pre-update): -58.3166, error rate (pre-update): 1.1773

size_minibatch = 7382
Precon grad coeff: 0.011805, velocity coeff: 1.0167
norm(ch) = 5.5203
iter: 334, Minibatch log likelihood (pre-update): -58.3524, error rate (pre-update): 1.1558

size_minibatch = 7427
Precon grad coeff: 0.0084963, velocity coeff: 0.72748
norm(ch) = 4.397
rho = 1.0228
New lambda: 1.4422e-005
iter: 335, Minibatch log likelihood (pre-update): -58.2903, error rate (pre-update): 1.1296
iter: 335, Minibatch log likelihood (post-update): -58.2074, error rate (post-update): 1.1192

size_minibatch = 7472
Precon grad coeff: 0.010586, velocity coeff: 1.0229
norm(ch) = 5.0264
iter: 336, Minibatch log likelihood (pre-update): -58.1124, error rate (pre-update): 1.1245

size_minibatch = 7516
Precon grad coeff: 0.01116, velocity coeff: 0.86901
norm(ch) = 4.9036
iter: 337, Minibatch log likelihood (pre-update): -58.0882, error rate (pre-update): 1.098

size_minibatch = 7562
Precon grad coeff: 0.012263, velocity coeff: 0.9785
norm(ch) = 5.323
iter: 338, Minibatch log likelihood (pre-update): -58.1386, error rate (pre-update): 1.0781

size_minibatch = 7607
Precon grad coeff: 0.0082603, velocity coeff: 0.64565
norm(ch) = 3.798
iter: 339, Minibatch log likelihood (pre-update): -58.0871, error rate (pre-update): 1.06

size_minibatch = 7653
Precon grad coeff: 0.032048, velocity coeff: 0.89203
New gamma: 0.0035448
norm(ch) = 6.4349
rho = 0.98841
New lambda: 1.116e-005
iter: 340, Minibatch log likelihood (pre-update): -57.765, error rate (pre-update): 1.0495
iter: 340, Minibatch log likelihood (post-update): -57.6603, error rate (post-update): 1.0096

size_minibatch = 7699
Precon grad coeff: 0.032378, velocity coeff: 0.88841
norm(ch) = 7.8103
iter: 341, Minibatch log likelihood (pre-update): -58.004, error rate (pre-update): 1.0256

size_minibatch = 7746
Precon grad coeff: 0.029773, velocity coeff: 0.84047
norm(ch) = 8.113
iter: 342, Minibatch log likelihood (pre-update): -57.6878, error rate (pre-update): 0.99995

size_minibatch = 7792
Precon grad coeff: 0.029697, velocity coeff: 0.96478
norm(ch) = 9.4088
iter: 343, Minibatch log likelihood (pre-update): -57.6089, error rate (pre-update): 0.97902

size_minibatch = 7839
Precon grad coeff: 0.028686, velocity coeff: 0.86232
norm(ch) = 9.4788
iter: 344, Minibatch log likelihood (pre-update): -57.7922, error rate (pre-update): 0.96284

size_minibatch = 7886
Precon grad coeff: 0.027011, velocity coeff: 0.81178
norm(ch) = 8.9462
rho = 1.0101
New lambda: 8.635e-006
iter: 345, Minibatch log likelihood (pre-update): -57.4404, error rate (pre-update): 0.93145
iter: 345, Minibatch log likelihood (post-update): -57.3425, error rate (post-update): 0.90354

size_minibatch = 7934
Precon grad coeff: 0.026349, velocity coeff: 0.86902
norm(ch) = 9.095
iter: 346, Minibatch log likelihood (pre-update): -57.4467, error rate (pre-update): 0.91543

size_minibatch = 7982
Precon grad coeff: 0.025096, velocity coeff: 0.78278
norm(ch) = 8.2958
iter: 347, Minibatch log likelihood (pre-update): -57.4124, error rate (pre-update): 0.88826

size_minibatch = 8030
Precon grad coeff: 0.022286, velocity coeff: 0.82592
norm(ch) = 7.8854
iter: 348, Minibatch log likelihood (pre-update): -57.2342, error rate (pre-update): 0.87207

size_minibatch = 8078
Precon grad coeff: 0.02102, velocity coeff: 0.77053
norm(ch) = 7.0868
iter: 349, Minibatch log likelihood (pre-update): -57.3438, error rate (pre-update): 0.85677

size_minibatch = 8127
Precon grad coeff: 0.017446, velocity coeff: 0.75823
norm(ch) = 6.1509
rho = 1.0175
New lambda: 6.6816e-006
iter: 350, Minibatch log likelihood (pre-update): -56.9762, error rate (pre-update): 0.83883
iter: 350, Minibatch log likelihood (post-update): -56.9095, error rate (post-update): 0.82015
---
Full log-likelihood: -57.1569, error rate: 0.82829
TEST log-likelihood: -57.3094, error rate: 0.92977
Error difference (test - train): 0.10148
---
Full log-likelihood (averaged params): -87.1161, error rate (averaged params): 8.3726
TEST log-likelihood (averaged params): -87.0204, error rate (averaged params): 8.397
Error difference (test - train) (averaged params): 0.024361

size_minibatch = 8176
Precon grad coeff: 0.019682, velocity coeff: 0.83122
norm(ch) = 6.1037
iter: 351, Minibatch log likelihood (pre-update): -57.0754, error rate (pre-update): 0.82644

size_minibatch = 8225
Precon grad coeff: 0.014457, velocity coeff: 0.74305
norm(ch) = 5.1009
iter: 352, Minibatch log likelihood (pre-update): -57.2858, error rate (pre-update): 0.81385

size_minibatch = 8274
Precon grad coeff: 0.019774, velocity coeff: 0.8997
norm(ch) = 5.6303
iter: 353, Minibatch log likelihood (pre-update): -57.0703, error rate (pre-update): 0.80613

size_minibatch = 8324
Precon grad coeff: 0.018174, velocity coeff: 0.82412
norm(ch) = 5.445
iter: 354, Minibatch log likelihood (pre-update): -57.0376, error rate (pre-update): 0.79006

size_minibatch = 8374
Precon grad coeff: 0.018469, velocity coeff: 0.81631
norm(ch) = 5.2638
rho = 1.0006
New lambda: 5.1701e-006
iter: 355, Minibatch log likelihood (pre-update): -57.0098, error rate (pre-update): 0.78193
iter: 355, Minibatch log likelihood (post-update): -56.96, error rate (post-update): 0.76396

size_minibatch = 8425
Precon grad coeff: 0.015759, velocity coeff: 0.70495
norm(ch) = 4.4101
iter: 356, Minibatch log likelihood (pre-update): -56.8551, error rate (pre-update): 0.76938

size_minibatch = 8475
Precon grad coeff: 0.011562, velocity coeff: 0.79783
norm(ch) = 4.0117
iter: 357, Minibatch log likelihood (pre-update): -57.1216, error rate (pre-update): 0.76447

size_minibatch = 8527
Precon grad coeff: 0.017255, velocity coeff: 0.97873
norm(ch) = 4.6885
iter: 358, Minibatch log likelihood (pre-update): -57.0199, error rate (pre-update): 0.75344

size_minibatch = 8578
Precon grad coeff: 0.013105, velocity coeff: 0.78225
norm(ch) = 4.1087
iter: 359, Minibatch log likelihood (pre-update): -56.737, error rate (pre-update): 0.74487

size_minibatch = 8630
Precon grad coeff: 0.036058, velocity coeff: 0.89008
New gamma: 0.0031623
norm(ch) = 5.4387
rho = 0.99171
New lambda: 4.0005e-006
iter: 360, Minibatch log likelihood (pre-update): -56.7506, error rate (pre-update): 0.7429
iter: 360, Minibatch log likelihood (post-update): -56.703, error rate (post-update): 0.7271

size_minibatch = 8681
Precon grad coeff: 0.040413, velocity coeff: 0.94767
norm(ch) = 6.6521
iter: 361, Minibatch log likelihood (pre-update): -57.0043, error rate (pre-update): 0.73418

size_minibatch = 8734
Precon grad coeff: 0.026327, velocity coeff: 0.72261
norm(ch) = 5.6025
iter: 362, Minibatch log likelihood (pre-update): -56.8268, error rate (pre-update): 0.72091

size_minibatch = 8786
Precon grad coeff: 0.034639, velocity coeff: 1.1075
norm(ch) = 7.2234
iter: 363, Minibatch log likelihood (pre-update): -56.6887, error rate (pre-update): 0.71561

size_minibatch = 8839
Precon grad coeff: 0.03585, velocity coeff: 0.91379
norm(ch) = 7.6095
iter: 364, Minibatch log likelihood (pre-update): -56.6742, error rate (pre-update): 0.70621

size_minibatch = 8892
Precon grad coeff: 0.028257, velocity coeff: 0.81732
norm(ch) = 6.966
rho = 1.0118
New lambda: 3.0955e-006
iter: 365, Minibatch log likelihood (pre-update): -56.6926, error rate (pre-update): 0.69555
iter: 365, Minibatch log likelihood (post-update): -56.6424, error rate (post-update): 0.68016

size_minibatch = 8946
Precon grad coeff: 0.029081, velocity coeff: 0.90429
norm(ch) = 7.2223
iter: 366, Minibatch log likelihood (pre-update): -56.6166, error rate (pre-update): 0.68747

size_minibatch = 9000
Precon grad coeff: 0.028394, velocity coeff: 0.84854
norm(ch) = 6.9865
iter: 367, Minibatch log likelihood (pre-update): -56.6956, error rate (pre-update): 0.67336

size_minibatch = 9054
Precon grad coeff: 0.021359, velocity coeff: 0.74094
norm(ch) = 5.7628
iter: 368, Minibatch log likelihood (pre-update): -56.5956, error rate (pre-update): 0.66112

size_minibatch = 9109
Precon grad coeff: 0.027209, velocity coeff: 0.99519
norm(ch) = 6.6998
iter: 369, Minibatch log likelihood (pre-update): -56.5023, error rate (pre-update): 0.66007

size_minibatch = 9163
Precon grad coeff: 0.025847, velocity coeff: 0.75766
norm(ch) = 5.8798
rho = 1.009
New lambda: 2.3953e-006
iter: 370, Minibatch log likelihood (pre-update): -56.5565, error rate (pre-update): 0.64656
iter: 370, Minibatch log likelihood (post-update): -56.5133, error rate (post-update): 0.63515

size_minibatch = 9219
Precon grad coeff: 0.026378, velocity coeff: 0.85436
norm(ch) = 5.8506
iter: 371, Minibatch log likelihood (pre-update): -56.3893, error rate (pre-update): 0.64356

size_minibatch = 9274
Precon grad coeff: 0.023204, velocity coeff: 0.76763
norm(ch) = 5.2516
iter: 372, Minibatch log likelihood (pre-update): -56.5245, error rate (pre-update): 0.63275

size_minibatch = 9330
Precon grad coeff: 0.019984, velocity coeff: 0.77348
norm(ch) = 4.6892
iter: 373, Minibatch log likelihood (pre-update): -56.4991, error rate (pre-update): 0.62782

size_minibatch = 9386
Precon grad coeff: 0.022579, velocity coeff: 0.93423
norm(ch) = 5.0434
iter: 374, Minibatch log likelihood (pre-update): -56.515, error rate (pre-update): 0.61838

size_minibatch = 9443
Precon grad coeff: 0.020529, velocity coeff: 0.84758
norm(ch) = 4.84
rho = 0.99044
New lambda: 1.8534e-006
iter: 375, Minibatch log likelihood (pre-update): -56.4397, error rate (pre-update): 0.61362
iter: 375, Minibatch log likelihood (post-update): -56.4091, error rate (post-update): 0.60101

size_minibatch = 9500
Precon grad coeff: 0.018868, velocity coeff: 0.84323
norm(ch) = 4.6062
iter: 376, Minibatch log likelihood (pre-update): -56.368, error rate (pre-update): 0.60308

size_minibatch = 9557
Precon grad coeff: 0.019423, velocity coeff: 0.87716
norm(ch) = 4.5892
iter: 377, Minibatch log likelihood (pre-update): -56.3874, error rate (pre-update): 0.60079

size_minibatch = 9614
Precon grad coeff: 0.018541, velocity coeff: 0.87591
norm(ch) = 4.5325
iter: 378, Minibatch log likelihood (pre-update): -56.3261, error rate (pre-update): 0.59403

size_minibatch = 9672
Precon grad coeff: 0.022089, velocity coeff: 0.87558
norm(ch) = 4.6474
iter: 379, Minibatch log likelihood (pre-update): -56.2702, error rate (pre-update): 0.58909

size_minibatch = 9730
Precon grad coeff: 0.035771, velocity coeff: 0.69966
New gamma: 0.0031623
norm(ch) = 4.4357
rho = 1.0018
New lambda: 1.4341e-006
iter: 380, Minibatch log likelihood (pre-update): -56.1434, error rate (pre-update): 0.58404
iter: 380, Minibatch log likelihood (post-update): -56.1123, error rate (post-update): 0.57625

size_minibatch = 9789
Precon grad coeff: 0.034363, velocity coeff: 0.83134
norm(ch) = 4.5521
iter: 381, Minibatch log likelihood (pre-update): -56.1965, error rate (pre-update): 0.5794

size_minibatch = 9848
Precon grad coeff: 0.038482, velocity coeff: 0.90809
norm(ch) = 5.0352
iter: 382, Minibatch log likelihood (pre-update): -56.4449, error rate (pre-update): 0.5716

size_minibatch = 9907
Precon grad coeff: 0.036106, velocity coeff: 0.92122
norm(ch) = 5.3711
iter: 383, Minibatch log likelihood (pre-update): -56.3086, error rate (pre-update): 0.56597

size_minibatch = 9967
Precon grad coeff: 0.040858, velocity coeff: 0.90863
norm(ch) = 5.7042
iter: 384, Minibatch log likelihood (pre-update): -56.1503, error rate (pre-update): 0.55943

size_minibatch = 10027
Precon grad coeff: 0.034762, velocity coeff: 0.87053
norm(ch) = 5.5705
rho = 1.0038
New lambda: 1.1097e-006
iter: 385, Minibatch log likelihood (pre-update): -56.1821, error rate (pre-update): 0.55555
iter: 385, Minibatch log likelihood (post-update): -56.1524, error rate (post-update): 0.54735

size_minibatch = 10087
Precon grad coeff: 0.035235, velocity coeff: 0.864
norm(ch) = 5.5649
iter: 386, Minibatch log likelihood (pre-update): -56.331, error rate (pre-update): 0.55129

size_minibatch = 10148
Precon grad coeff: 0.039821, velocity coeff: 0.88495
norm(ch) = 5.7491
iter: 387, Minibatch log likelihood (pre-update): -56.2686, error rate (pre-update): 0.54558

size_minibatch = 10209
Precon grad coeff: 0.032045, velocity coeff: 0.72962
norm(ch) = 4.9919
iter: 388, Minibatch log likelihood (pre-update): -56.1367, error rate (pre-update): 0.54174

size_minibatch = 10271
Precon grad coeff: 0.033046, velocity coeff: 0.84419
norm(ch) = 4.9004
iter: 389, Minibatch log likelihood (pre-update): -56.0921, error rate (pre-update): 0.53366

size_minibatch = 10333
Precon grad coeff: 0.029059, velocity coeff: 0.81951
norm(ch) = 4.6201
rho = 1.0008
New lambda: 8.5867e-007
iter: 390, Minibatch log likelihood (pre-update): -56.0673, error rate (pre-update): 0.52698
iter: 390, Minibatch log likelihood (post-update): -56.0422, error rate (post-update): 0.52086

size_minibatch = 10395
Precon grad coeff: 0.030327, velocity coeff: 0.79065
norm(ch) = 4.3062
iter: 391, Minibatch log likelihood (pre-update): -56.12, error rate (pre-update): 0.52259

size_minibatch = 10457
Precon grad coeff: 0.024517, velocity coeff: 0.86975
norm(ch) = 4.2147
iter: 392, Minibatch log likelihood (pre-update): -56.1362, error rate (pre-update): 0.52126

size_minibatch = 10520
Precon grad coeff: 0.030818, velocity coeff: 0.90685
norm(ch) = 4.4657
iter: 393, Minibatch log likelihood (pre-update): -56.1129, error rate (pre-update): 0.51759

size_minibatch = 10584
Precon grad coeff: 0.030941, velocity coeff: 0.86707
norm(ch) = 4.4609
iter: 394, Minibatch log likelihood (pre-update): -55.9638, error rate (pre-update): 0.51262

size_minibatch = 10647
Precon grad coeff: 0.025366, velocity coeff: 0.76858
norm(ch) = 3.9311
rho = 0.99645
New lambda: 6.6442e-007
iter: 395, Minibatch log likelihood (pre-update): -56.0523, error rate (pre-update): 0.50981
iter: 395, Minibatch log likelihood (post-update): -56.0325, error rate (post-update): 0.50363

size_minibatch = 10712
Precon grad coeff: 0.02702, velocity coeff: 0.88904
norm(ch) = 4.0254
iter: 396, Minibatch log likelihood (pre-update): -56.1522, error rate (pre-update): 0.50484

size_minibatch = 10776
Precon grad coeff: 0.027309, velocity coeff: 0.88727
norm(ch) = 4.1241
iter: 397, Minibatch log likelihood (pre-update): -56.0063, error rate (pre-update): 0.50057

size_minibatch = 10841
Precon grad coeff: 0.022154, velocity coeff: 0.78595
norm(ch) = 3.6139
iter: 398, Minibatch log likelihood (pre-update): -55.8859, error rate (pre-update): 0.49561

size_minibatch = 10906
Precon grad coeff: 0.023263, velocity coeff: 0.92816
norm(ch) = 3.7267
iter: 399, Minibatch log likelihood (pre-update): -55.9387, error rate (pre-update): 0.49323

size_minibatch = 10972
Precon grad coeff: 0.041158, velocity coeff: 0.78412
New gamma: 0.0031623
norm(ch) = 3.752
rho = 0.9951
New lambda: 5.1412e-007
iter: 400, Minibatch log likelihood (pre-update): -56.0216, error rate (pre-update): 0.49037
iter: 400, Minibatch log likelihood (post-update): -56.003, error rate (post-update): 0.48457
---
Full log-likelihood: -55.9638, error rate: 0.48715
TEST log-likelihood: -56.159, error rate: 0.60307
Error difference (test - train): 0.11592
---
Full log-likelihood (averaged params): -81.1823, error rate (averaged params): 7.0194
TEST log-likelihood (averaged params): -81.0164, error rate (averaged params): 7.0229
Error difference (test - train) (averaged params): 0.0034383

size_minibatch = 11038
Precon grad coeff: 0.042048, velocity coeff: 0.99174
norm(ch) = 4.3796
iter: 401, Minibatch log likelihood (pre-update): -55.9284, error rate (pre-update): 0.48521

size_minibatch = 11104
Precon grad coeff: 0.037908, velocity coeff: 0.73892
norm(ch) = 3.8227
iter: 402, Minibatch log likelihood (pre-update): -55.9945, error rate (pre-update): 0.48589

size_minibatch = 11171
Precon grad coeff: 0.035539, velocity coeff: 0.9327
norm(ch) = 4.0564
iter: 403, Minibatch log likelihood (pre-update): -55.9852, error rate (pre-update): 0.48077

size_minibatch = 11239
Precon grad coeff: 0.038833, velocity coeff: 0.95127
norm(ch) = 4.3963
iter: 404, Minibatch log likelihood (pre-update): -55.9408, error rate (pre-update): 0.47694

size_minibatch = 11306
Precon grad coeff: 0.044613, velocity coeff: 0.97047
norm(ch) = 4.8559
rho = 0.99187
New lambda: 3.9781e-007
iter: 405, Minibatch log likelihood (pre-update): -55.9209, error rate (pre-update): 0.47601
iter: 405, Minibatch log likelihood (post-update): -55.901, error rate (post-update): 0.46974

size_minibatch = 11374
Precon grad coeff: 0.036203, velocity coeff: 0.77723
norm(ch) = 4.2416
iter: 406, Minibatch log likelihood (pre-update): -56.0071, error rate (pre-update): 0.47064

size_minibatch = 11443
Precon grad coeff: 0.041231, velocity coeff: 0.93434
norm(ch) = 4.5299
iter: 407, Minibatch log likelihood (pre-update): -55.9521, error rate (pre-update): 0.46738

size_minibatch = 11512
Precon grad coeff: 0.034395, velocity coeff: 0.78725
norm(ch) = 4.0264
iter: 408, Minibatch log likelihood (pre-update): -55.8487, error rate (pre-update): 0.46286

size_minibatch = 11581
Precon grad coeff: 0.034393, velocity coeff: 0.90707
norm(ch) = 4.1006
iter: 409, Minibatch log likelihood (pre-update): -55.8538, error rate (pre-update): 0.45899

size_minibatch = 11651
Precon grad coeff: 0.039015, velocity coeff: 0.93268
norm(ch) = 4.3591
rho = 0.99063
New lambda: 3.0782e-007
iter: 410, Minibatch log likelihood (pre-update): -55.9187, error rate (pre-update): 0.45529
iter: 410, Minibatch log likelihood (post-update): -55.9008, error rate (post-update): 0.45009

size_minibatch = 11721
Precon grad coeff: 0.034895, velocity coeff: 0.81975
norm(ch) = 4.0367
iter: 411, Minibatch log likelihood (pre-update): -55.9029, error rate (pre-update): 0.45302

size_minibatch = 11792
Precon grad coeff: 0.03799, velocity coeff: 0.8626
norm(ch) = 4.0207
iter: 412, Minibatch log likelihood (pre-update): -55.8737, error rate (pre-update): 0.45007

size_minibatch = 11863
Precon grad coeff: 0.031636, velocity coeff: 0.79899
norm(ch) = 3.6004
iter: 413, Minibatch log likelihood (pre-update): -55.7833, error rate (pre-update): 0.44653

size_minibatch = 11934
Precon grad coeff: 0.034727, velocity coeff: 0.94112
norm(ch) = 3.8447
iter: 414, Minibatch log likelihood (pre-update): -55.6993, error rate (pre-update): 0.44323

size_minibatch = 12006
Precon grad coeff: 0.031955, velocity coeff: 0.82786
norm(ch) = 3.5684
rho = 0.99259
New lambda: 2.3819e-007
iter: 415, Minibatch log likelihood (pre-update): -55.8282, error rate (pre-update): 0.4407
iter: 415, Minibatch log likelihood (post-update): -55.8139, error rate (post-update): 0.43545

size_minibatch = 12078
Precon grad coeff: 0.033427, velocity coeff: 0.89555
norm(ch) = 3.6459
iter: 416, Minibatch log likelihood (pre-update): -55.7701, error rate (pre-update): 0.43873

size_minibatch = 12151
Precon grad coeff: 0.028097, velocity coeff: 0.74722
norm(ch) = 3.0765
iter: 417, Minibatch log likelihood (pre-update): -55.6987, error rate (pre-update): 0.43503

size_minibatch = 12224
Precon grad coeff: 0.025993, velocity coeff: 0.92489
norm(ch) = 3.159
iter: 418, Minibatch log likelihood (pre-update): -55.7371, error rate (pre-update): 0.43299

size_minibatch = 12298
Precon grad coeff: 0.036455, velocity coeff: 1.0864
norm(ch) = 3.8955
iter: 419, Minibatch log likelihood (pre-update): -55.768, error rate (pre-update): 0.42961

size_minibatch = 12372
Precon grad coeff: 0.044916, velocity coeff: 0.75801
New gamma: 0.0031623
norm(ch) = 3.479
rho = 0.98969
New lambda: 1.843e-007
iter: 420, Minibatch log likelihood (pre-update): -55.8575, error rate (pre-update): 0.42854
iter: 420, Minibatch log likelihood (post-update): -55.8442, error rate (post-update): 0.42421

size_minibatch = 12446
Precon grad coeff: 0.036704, velocity coeff: 0.81981
norm(ch) = 3.2498
iter: 421, Minibatch log likelihood (pre-update): -55.6844, error rate (pre-update): 0.4267

size_minibatch = 12521
Precon grad coeff: 0.038483, velocity coeff: 0.9207
norm(ch) = 3.4277
iter: 422, Minibatch log likelihood (pre-update): -55.7703, error rate (pre-update): 0.42422

size_minibatch = 12597
Precon grad coeff: 0.042904, velocity coeff: 0.97068
norm(ch) = 3.7601
iter: 423, Minibatch log likelihood (pre-update): -55.6628, error rate (pre-update): 0.4201

size_minibatch = 12672
Precon grad coeff: 0.04041, velocity coeff: 0.89259
norm(ch) = 3.7204
iter: 424, Minibatch log likelihood (pre-update): -55.7702, error rate (pre-update): 0.41894

size_minibatch = 12749
Precon grad coeff: 0.042046, velocity coeff: 0.94271
norm(ch) = 3.8842
rho = 0.99133
New lambda: 1.4261e-007
iter: 425, Minibatch log likelihood (pre-update): -55.7372, error rate (pre-update): 0.41589
iter: 425, Minibatch log likelihood (post-update): -55.7243, error rate (post-update): 0.41149

size_minibatch = 12826
Precon grad coeff: 0.038279, velocity coeff: 0.94807
norm(ch) = 4.0252
iter: 426, Minibatch log likelihood (pre-update): -55.6988, error rate (pre-update): 0.41359

size_minibatch = 12903
Precon grad coeff: 0.0413, velocity coeff: 0.92137
norm(ch) = 4.0476
iter: 427, Minibatch log likelihood (pre-update): -55.6252, error rate (pre-update): 0.41159

size_minibatch = 12980
Precon grad coeff: 0.034768, velocity coeff: 0.8602
norm(ch) = 3.7766
iter: 428, Minibatch log likelihood (pre-update): -55.6475, error rate (pre-update): 0.40957

size_minibatch = 13059
Precon grad coeff: 0.036759, velocity coeff: 0.98461
norm(ch) = 4.0291
iter: 429, Minibatch log likelihood (pre-update): -55.7033, error rate (pre-update): 0.4054

size_minibatch = 13137
Precon grad coeff: 0.040593, velocity coeff: 0.94533
norm(ch) = 4.1702
rho = 0.99171
New lambda: 1.1035e-007
iter: 430, Minibatch log likelihood (pre-update): -55.6784, error rate (pre-update): 0.40474
iter: 430, Minibatch log likelihood (post-update): -55.6647, error rate (post-update): 0.40026

size_minibatch = 13216
Precon grad coeff: 0.036649, velocity coeff: 0.86851
norm(ch) = 3.9577
iter: 431, Minibatch log likelihood (pre-update): -55.6276, error rate (pre-update): 0.40143

size_minibatch = 13296
Precon grad coeff: 0.037082, velocity coeff: 0.90503
norm(ch) = 3.9121
iter: 432, Minibatch log likelihood (pre-update): -55.7537, error rate (pre-update): 0.39826

size_minibatch = 13376
Precon grad coeff: 0.036879, velocity coeff: 0.89951
norm(ch) = 3.8847
iter: 433, Minibatch log likelihood (pre-update): -55.7232, error rate (pre-update): 0.39547

size_minibatch = 13457
Precon grad coeff: 0.033534, velocity coeff: 0.82204
norm(ch) = 3.4913
iter: 434, Minibatch log likelihood (pre-update): -55.6649, error rate (pre-update): 0.3931

size_minibatch = 13538
Precon grad coeff: 0.032902, velocity coeff: 0.88392
norm(ch) = 3.401
rho = 0.98811
New lambda: 8.5386e-008
iter: 435, Minibatch log likelihood (pre-update): -55.6785, error rate (pre-update): 0.39251
iter: 435, Minibatch log likelihood (post-update): -55.6672, error rate (post-update): 0.38833

size_minibatch = 13619
Precon grad coeff: 0.032224, velocity coeff: 0.88652
norm(ch) = 3.3298
iter: 436, Minibatch log likelihood (pre-update): -55.5366, error rate (pre-update): 0.38797

size_minibatch = 13701
Precon grad coeff: 0.028758, velocity coeff: 0.80854
norm(ch) = 2.978
iter: 437, Minibatch log likelihood (pre-update): -55.6703, error rate (pre-update): 0.3848

size_minibatch = 13784
Precon grad coeff: 0.032567, velocity coeff: 1.0007
norm(ch) = 3.2946
iter: 438, Minibatch log likelihood (pre-update): -55.5328, error rate (pre-update): 0.38273

size_minibatch = 13867
Precon grad coeff: 0.036022, velocity coeff: 0.96293
norm(ch) = 3.4862
iter: 439, Minibatch log likelihood (pre-update): -55.6437, error rate (pre-update): 0.38092

size_minibatch = 13950
Precon grad coeff: 0.039004, velocity coeff: 0.78003
New gamma: 0.0031623
norm(ch) = 3.0516
rho = 0.99617
New lambda: 6.607e-008
iter: 440, Minibatch log likelihood (pre-update): -55.5438, error rate (pre-update): 0.38035
iter: 440, Minibatch log likelihood (post-update): -55.5342, error rate (post-update): 0.37726

size_minibatch = 14034
Precon grad coeff: 0.035722, velocity coeff: 0.95006
norm(ch) = 3.2058
iter: 441, Minibatch log likelihood (pre-update): -55.5258, error rate (pre-update): 0.37626

size_minibatch = 14119
Precon grad coeff: 0.040038, velocity coeff: 1.0053
norm(ch) = 3.525
iter: 442, Minibatch log likelihood (pre-update): -55.5537, error rate (pre-update): 0.37454

size_minibatch = 14204
Precon grad coeff: 0.039319, velocity coeff: 0.94714
norm(ch) = 3.6357
iter: 443, Minibatch log likelihood (pre-update): -55.5643, error rate (pre-update): 0.37214

size_minibatch = 14289
Precon grad coeff: 0.037403, velocity coeff: 0.91985
norm(ch) = 3.6236
iter: 444, Minibatch log likelihood (pre-update): -55.5981, error rate (pre-update): 0.37083

size_minibatch = 14375
Precon grad coeff: 0.041803, velocity coeff: 1.1289
norm(ch) = 4.3835
rho = 1.0208
New lambda: 5.1124e-008
iter: 445, Minibatch log likelihood (pre-update): -55.53, error rate (pre-update): 0.36842
iter: 445, Minibatch log likelihood (post-update): -55.5175, error rate (post-update): 0.36533

size_minibatch = 14462
Precon grad coeff: 0.043479, velocity coeff: 0.96192
norm(ch) = 4.4966
iter: 446, Minibatch log likelihood (pre-update): -55.5693, error rate (pre-update): 0.36678

size_minibatch = 14549
Precon grad coeff: 0.031887, velocity coeff: 0.8274
norm(ch) = 3.9412
iter: 447, Minibatch log likelihood (pre-update): -55.4877, error rate (pre-update): 0.36285

size_minibatch = 14636
Precon grad coeff: 0.031685, velocity coeff: 0.96533
norm(ch) = 4.0688
iter: 448, Minibatch log likelihood (pre-update): -55.4887, error rate (pre-update): 0.36049

size_minibatch = 14725
Precon grad coeff: 0.024196, velocity coeff: 0.86002
norm(ch) = 3.6764
iter: 449, Minibatch log likelihood (pre-update): -55.5123, error rate (pre-update): 0.35678

size_minibatch = 14813
Precon grad coeff: 0.031704, velocity coeff: 1.0621
norm(ch) = 4.1811
rho = 1.0198
New lambda: 3.9559e-008
iter: 450, Minibatch log likelihood (pre-update): -55.5432, error rate (pre-update): 0.35529
iter: 450, Minibatch log likelihood (post-update): -55.5307, error rate (post-update): 0.35183
---
Full log-likelihood: -55.4894, error rate: 0.35244
TEST log-likelihood: -55.6894, error rate: 0.47088
Error difference (test - train): 0.11844
---
Full log-likelihood (averaged params): -75.0711, error rate (averaged params): 5.4982
TEST log-likelihood (averaged params): -74.9151, error rate (averaged params): 5.4968
Error difference (test - train) (averaged params): -0.0013488

size_minibatch = 14902
Precon grad coeff: 0.032724, velocity coeff: 0.93165
norm(ch) = 4.1921
iter: 451, Minibatch log likelihood (pre-update): -55.4284, error rate (pre-update): 0.35163

size_minibatch = 14992
Precon grad coeff: 0.021479, velocity coeff: 0.79848
norm(ch) = 3.5793
iter: 452, Minibatch log likelihood (pre-update): -55.5369, error rate (pre-update): 0.35034

size_minibatch = 15083
Precon grad coeff: 0.024138, velocity coeff: 0.9158
norm(ch) = 3.5083
iter: 453, Minibatch log likelihood (pre-update): -55.5061, error rate (pre-update): 0.34666

size_minibatch = 15173
Precon grad coeff: 0.022879, velocity coeff: 0.90742
norm(ch) = 3.4122
iter: 454, Minibatch log likelihood (pre-update): -55.4594, error rate (pre-update): 0.34302

size_minibatch = 15265
Precon grad coeff: 0.024537, velocity coeff: 1.0593
norm(ch) = 3.85
rho = 1.0192
New lambda: 3.061e-008
iter: 455, Minibatch log likelihood (pre-update): -55.5129, error rate (pre-update): 0.34124
iter: 455, Minibatch log likelihood (post-update): -55.5018, error rate (post-update): 0.33833

size_minibatch = 15357
Precon grad coeff: 0.030734, velocity coeff: 0.97076
norm(ch) = 4.0487
iter: 456, Minibatch log likelihood (pre-update): -55.4668, error rate (pre-update): 0.33896

size_minibatch = 15449
Precon grad coeff: 0.02758, velocity coeff: 0.85911
norm(ch) = 3.7371
iter: 457, Minibatch log likelihood (pre-update): -55.4065, error rate (pre-update): 0.33589

size_minibatch = 15542
Precon grad coeff: 0.024302, velocity coeff: 0.87127
norm(ch) = 3.4939
iter: 458, Minibatch log likelihood (pre-update): -55.3439, error rate (pre-update): 0.3346

size_minibatch = 15636
Precon grad coeff: 0.017654, velocity coeff: 0.74743
norm(ch) = 2.7887
iter: 459, Minibatch log likelihood (pre-update): -55.419, error rate (pre-update): 0.33111

size_minibatch = 15730
Precon grad coeff: 0.038394, velocity coeff: 1.0936
New gamma: 0.0031623
norm(ch) = 3.483
rho = 1.0053
New lambda: 2.3685e-008
iter: 460, Minibatch log likelihood (pre-update): -55.4951, error rate (pre-update): 0.32931
iter: 460, Minibatch log likelihood (post-update): -55.4844, error rate (post-update): 0.32601

size_minibatch = 15825
Precon grad coeff: 0.038328, velocity coeff: 0.82149
norm(ch) = 3.266
iter: 461, Minibatch log likelihood (pre-update): -55.4747, error rate (pre-update): 0.32686

size_minibatch = 15920
Precon grad coeff: 0.03672, velocity coeff: 0.96351
norm(ch) = 3.5012
iter: 462, Minibatch log likelihood (pre-update): -55.4511, error rate (pre-update): 0.32484

size_minibatch = 16016
Precon grad coeff: 0.043316, velocity coeff: 0.9925
norm(ch) = 3.8812
iter: 463, Minibatch log likelihood (pre-update): -55.439, error rate (pre-update): 0.32197

size_minibatch = 16112
Precon grad coeff: 0.033521, velocity coeff: 0.80773
norm(ch) = 3.4092
iter: 464, Minibatch log likelihood (pre-update): -55.3952, error rate (pre-update): 0.31943

size_minibatch = 16209
Precon grad coeff: 0.034479, velocity coeff: 1.0356
norm(ch) = 3.7909
rho = 1.0048
New lambda: 1.8327e-008
iter: 465, Minibatch log likelihood (pre-update): -55.3578, error rate (pre-update): 0.31821
iter: 465, Minibatch log likelihood (post-update): -55.3489, error rate (post-update): 0.31506

size_minibatch = 16307
Precon grad coeff: 0.039253, velocity coeff: 1.0011
norm(ch) = 4.0918
iter: 466, Minibatch log likelihood (pre-update): -55.3394, error rate (pre-update): 0.31617

size_minibatch = 16405
Precon grad coeff: 0.037025, velocity coeff: 0.95962
norm(ch) = 4.1752
iter: 467, Minibatch log likelihood (pre-update): -55.4206, error rate (pre-update): 0.3139

size_minibatch = 16504
Precon grad coeff: 0.042414, velocity coeff: 0.99814
norm(ch) = 4.4581
iter: 468, Minibatch log likelihood (pre-update): -55.2881, error rate (pre-update): 0.31187

size_minibatch = 16603
Precon grad coeff: 0.035504, velocity coeff: 0.87326
norm(ch) = 4.1192
iter: 469, Minibatch log likelihood (pre-update): -55.2867, error rate (pre-update): 0.30889

size_minibatch = 16703
Precon grad coeff: 0.033429, velocity coeff: 0.91444
norm(ch) = 3.9902
rho = 1.002
New lambda: 1.4181e-008
iter: 470, Minibatch log likelihood (pre-update): -55.3623, error rate (pre-update): 0.30773
iter: 470, Minibatch log likelihood (post-update): -55.3538, error rate (post-update): 0.30495

size_minibatch = 16804
Precon grad coeff: 0.031368, velocity coeff: 0.9121
norm(ch) = 3.8376
iter: 471, Minibatch log likelihood (pre-update): -55.3368, error rate (pre-update): 0.30491

size_minibatch = 16905
Precon grad coeff: 0.03207, velocity coeff: 0.9557
norm(ch) = 3.8774
iter: 472, Minibatch log likelihood (pre-update): -55.3404, error rate (pre-update): 0.30306

size_minibatch = 17007
Precon grad coeff: 0.027869, velocity coeff: 0.90471
norm(ch) = 3.6793
iter: 473, Minibatch log likelihood (pre-update): -55.3525, error rate (pre-update): 0.30054

size_minibatch = 17109
Precon grad coeff: 0.032644, velocity coeff: 1.0521
norm(ch) = 4.08
iter: 474, Minibatch log likelihood (pre-update): -55.3138, error rate (pre-update): 0.2992

size_minibatch = 17212
Precon grad coeff: 0.029457, velocity coeff: 0.8387
norm(ch) = 3.6063
rho = 0.99138
New lambda: 1.0973e-008
iter: 475, Minibatch log likelihood (pre-update): -55.3441, error rate (pre-update): 0.29738
iter: 475, Minibatch log likelihood (post-update): -55.3371, error rate (post-update): 0.295

size_minibatch = 17316
Precon grad coeff: 0.02087, velocity coeff: 0.85097
norm(ch) = 3.2
iter: 476, Minibatch log likelihood (pre-update): -55.2631, error rate (pre-update): 0.29531

size_minibatch = 17420
Precon grad coeff: 0.02711, velocity coeff: 1.1366
norm(ch) = 3.7985
iter: 477, Minibatch log likelihood (pre-update): -55.2686, error rate (pre-update): 0.29394

size_minibatch = 17525
Precon grad coeff: 0.030033, velocity coeff: 0.96971
norm(ch) = 3.8576
iter: 478, Minibatch log likelihood (pre-update): -55.245, error rate (pre-update): 0.29242

size_minibatch = 17631
Precon grad coeff: 0.025491, velocity coeff: 0.93658
norm(ch) = 3.7471
iter: 479, Minibatch log likelihood (pre-update): -55.314, error rate (pre-update): 0.29021

size_minibatch = 17737
Precon grad coeff: 0.045393, velocity coeff: 0.93841
New gamma: 0.0031623
norm(ch) = 3.7964
rho = 0.99455
New lambda: 8.4908e-009
iter: 480, Minibatch log likelihood (pre-update): -55.2701, error rate (pre-update): 0.28863
iter: 480, Minibatch log likelihood (post-update): -55.2627, error rate (post-update): 0.28658

size_minibatch = 17843
Precon grad coeff: 0.04088, velocity coeff: 0.93379
norm(ch) = 3.8012
iter: 481, Minibatch log likelihood (pre-update): -55.2668, error rate (pre-update): 0.28675

size_minibatch = 17951
Precon grad coeff: 0.03925, velocity coeff: 0.94572
norm(ch) = 3.8175
iter: 482, Minibatch log likelihood (pre-update): -55.2597, error rate (pre-update): 0.28512

size_minibatch = 18059
Precon grad coeff: 0.040792, velocity coeff: 1.031
norm(ch) = 4.1586
iter: 483, Minibatch log likelihood (pre-update): -55.2306, error rate (pre-update): 0.28338

size_minibatch = 18168
Precon grad coeff: 0.045596, velocity coeff: 1.0094
norm(ch) = 4.4345
iter: 484, Minibatch log likelihood (pre-update): -55.1937, error rate (pre-update): 0.28172

size_minibatch = 18277
Precon grad coeff: 0.040558, velocity coeff: 0.90649
norm(ch) = 4.2067
rho = 0.99789
New lambda: 6.57e-009
iter: 485, Minibatch log likelihood (pre-update): -55.2429, error rate (pre-update): 0.27953
iter: 485, Minibatch log likelihood (post-update): -55.2361, error rate (post-update): 0.27766

size_minibatch = 18387
Precon grad coeff: 0.039586, velocity coeff: 0.96335
norm(ch) = 4.2359
iter: 486, Minibatch log likelihood (pre-update): -55.2376, error rate (pre-update): 0.27788

size_minibatch = 18498
Precon grad coeff: 0.033709, velocity coeff: 0.90533
norm(ch) = 3.9738
iter: 487, Minibatch log likelihood (pre-update): -55.2269, error rate (pre-update): 0.27619

size_minibatch = 18609
Precon grad coeff: 0.036685, velocity coeff: 1.0319
norm(ch) = 4.2626
iter: 488, Minibatch log likelihood (pre-update): -55.2065, error rate (pre-update): 0.2748

size_minibatch = 18721
Precon grad coeff: 0.036445, velocity coeff: 0.9319
norm(ch) = 4.1128
iter: 489, Minibatch log likelihood (pre-update): -55.2129, error rate (pre-update): 0.2729

size_minibatch = 18834
Precon grad coeff: 0.037832, velocity coeff: 0.99905
norm(ch) = 4.253
rho = 0.99282
New lambda: 5.0838e-009
iter: 490, Minibatch log likelihood (pre-update): -55.2138, error rate (pre-update): 0.27077
iter: 490, Minibatch log likelihood (post-update): -55.2074, error rate (post-update): 0.269

size_minibatch = 18948
Precon grad coeff: 0.033849, velocity coeff: 0.91424
norm(ch) = 4.0129
iter: 491, Minibatch log likelihood (pre-update): -55.1769, error rate (pre-update): 0.26954

size_minibatch = 19062
Precon grad coeff: 0.035237, velocity coeff: 0.95593
norm(ch) = 3.9689
iter: 492, Minibatch log likelihood (pre-update): -55.1622, error rate (pre-update): 0.26791

size_minibatch = 19176
Precon grad coeff: 0.033706, velocity coeff: 0.98902
norm(ch) = 4.0528
iter: 493, Minibatch log likelihood (pre-update): -55.177, error rate (pre-update): 0.26603

size_minibatch = 19292
Precon grad coeff: 0.032238, velocity coeff: 0.88052
norm(ch) = 3.6773
iter: 494, Minibatch log likelihood (pre-update): -55.1679, error rate (pre-update): 0.26442

size_minibatch = 19408
Precon grad coeff: 0.030607, velocity coeff: 0.98205
norm(ch) = 3.7244
rho = 0.99271
New lambda: 3.9337e-009
iter: 495, Minibatch log likelihood (pre-update): -55.1593, error rate (pre-update): 0.2633
iter: 495, Minibatch log likelihood (post-update): -55.154, error rate (post-update): 0.26189

size_minibatch = 19525
Precon grad coeff: 0.031474, velocity coeff: 0.97269
norm(ch) = 3.7335
iter: 496, Minibatch log likelihood (pre-update): -55.1629, error rate (pre-update): 0.26189

size_minibatch = 19643
Precon grad coeff: 0.031709, velocity coeff: 0.98562
norm(ch) = 3.7891
iter: 497, Minibatch log likelihood (pre-update): -55.1606, error rate (pre-update): 0.26065

size_minibatch = 19761
Precon grad coeff: 0.033303, velocity coeff: 0.99812
norm(ch) = 3.9016
iter: 498, Minibatch log likelihood (pre-update): -55.1597, error rate (pre-update): 0.25916

size_minibatch = 19880
Precon grad coeff: 0.028837, velocity coeff: 0.88437
norm(ch) = 3.5452
iter: 499, Minibatch log likelihood (pre-update): -55.1542, error rate (pre-update): 0.25747

size_minibatch = 20000
Precon grad coeff: 0.039465, velocity coeff: 0.94991
New gamma: 0.0031623
norm(ch) = 3.518
rho = 0.99123
New lambda: 3.0438e-009
iter: 500, Minibatch log likelihood (pre-update): -55.1446, error rate (pre-update): 0.25645
iter: 500, Minibatch log likelihood (post-update): -55.1398, error rate (post-update): 0.25514
---
Full log-likelihood: -55.1398, error rate: 0.25514
TEST log-likelihood: -55.2836, error rate: 0.35627
Error difference (test - train): 0.10113
---
Full log-likelihood (averaged params): -68.6785, error rate (averaged params): 3.7972
TEST log-likelihood (averaged params): -68.5763, error rate (averaged params): 3.809
Error difference (test - train) (averaged params): 0.011786

size_minibatch = 20000
Precon grad coeff: 0.034322, velocity coeff: 0.96066
norm(ch) = 3.5007
iter: 501, Minibatch log likelihood (pre-update): -55.1398, error rate (pre-update): 0.25514

size_minibatch = 20000
Precon grad coeff: 0.040844, velocity coeff: 1.0612
norm(ch) = 3.8572
iter: 502, Minibatch log likelihood (pre-update): -55.1351, error rate (pre-update): 0.25368

size_minibatch = 20000
Precon grad coeff: 0.038414, velocity coeff: 0.98142
norm(ch) = 3.917
iter: 503, Minibatch log likelihood (pre-update): -55.13, error rate (pre-update): 0.25235

size_minibatch = 20000
Precon grad coeff: 0.043294, velocity coeff: 1.0455
norm(ch) = 4.2369
iter: 504, Minibatch log likelihood (pre-update): -55.125, error rate (pre-update): 0.25131

size_minibatch = 20000
Precon grad coeff: 0.041393, velocity coeff: 0.95082
norm(ch) = 4.1516
rho = 0.9944
New lambda: 2.3553e-009
iter: 505, Minibatch log likelihood (pre-update): -55.1197, error rate (pre-update): 0.24966
iter: 505, Minibatch log likelihood (post-update): -55.1146, error rate (post-update): 0.24811

size_minibatch = 20000
Precon grad coeff: 0.03497, velocity coeff: 0.91549
norm(ch) = 3.9
iter: 506, Minibatch log likelihood (pre-update): -55.1146, error rate (pre-update): 0.24811

size_minibatch = 20000
Precon grad coeff: 0.034746, velocity coeff: 0.98163
norm(ch) = 3.9204
iter: 507, Minibatch log likelihood (pre-update): -55.1099, error rate (pre-update): 0.24707

size_minibatch = 20000
Precon grad coeff: 0.033374, velocity coeff: 0.98802
norm(ch) = 3.9552
iter: 508, Minibatch log likelihood (pre-update): -55.1052, error rate (pre-update): 0.24595

size_minibatch = 20000
Precon grad coeff: 0.035033, velocity coeff: 0.97527
norm(ch) = 3.9455
iter: 509, Minibatch log likelihood (pre-update): -55.1005, error rate (pre-update): 0.24454

size_minibatch = 20000
Precon grad coeff: 0.037473, velocity coeff: 1.0098
norm(ch) = 4.0764
rho = 0.99379
New lambda: 1.8225e-009
iter: 510, Minibatch log likelihood (pre-update): -55.0958, error rate (pre-update): 0.24359
iter: 510, Minibatch log likelihood (post-update): -55.091, error rate (post-update): 0.24206

size_minibatch = 20000
Precon grad coeff: 0.034992, velocity coeff: 0.93093
norm(ch) = 3.8749
iter: 511, Minibatch log likelihood (pre-update): -55.091, error rate (pre-update): 0.24206

size_minibatch = 20000
Precon grad coeff: 0.033641, velocity coeff: 0.93794
norm(ch) = 3.7066
iter: 512, Minibatch log likelihood (pre-update): -55.0865, error rate (pre-update): 0.2406

size_minibatch = 20000
Precon grad coeff: 0.030643, velocity coeff: 0.93421
norm(ch) = 3.5352
iter: 513, Minibatch log likelihood (pre-update): -55.0822, error rate (pre-update): 0.23981

size_minibatch = 20000
Precon grad coeff: 0.030646, velocity coeff: 0.99402
norm(ch) = 3.5893
iter: 514, Minibatch log likelihood (pre-update): -55.0782, error rate (pre-update): 0.23855

size_minibatch = 20000
Precon grad coeff: 0.029284, velocity coeff: 0.91613
norm(ch) = 3.3548
rho = 0.99499
New lambda: 1.4102e-009
iter: 515, Minibatch log likelihood (pre-update): -55.0741, error rate (pre-update): 0.23745
iter: 515, Minibatch log likelihood (post-update): -55.0702, error rate (post-update): 0.23664

size_minibatch = 20000
Precon grad coeff: 0.034068, velocity coeff: 1.0585
norm(ch) = 3.6362
iter: 516, Minibatch log likelihood (pre-update): -55.0702, error rate (pre-update): 0.23664

size_minibatch = 20000
Precon grad coeff: 0.029127, velocity coeff: 0.90403
norm(ch) = 3.3551
iter: 517, Minibatch log likelihood (pre-update): -55.0662, error rate (pre-update): 0.23536

size_minibatch = 20000
Precon grad coeff: 0.028865, velocity coeff: 0.95806
norm(ch) = 3.2858
iter: 518, Minibatch log likelihood (pre-update): -55.0624, error rate (pre-update): 0.23451

size_minibatch = 20000
Precon grad coeff: 0.025741, velocity coeff: 0.91268
norm(ch) = 3.0609
iter: 519, Minibatch log likelihood (pre-update): -55.0588, error rate (pre-update): 0.23355

size_minibatch = 20000
Precon grad coeff: 0.038377, velocity coeff: 1.0015
New gamma: 0.0031623
norm(ch) = 3.1707
rho = 0.9937
New lambda: 1.0912e-009
iter: 520, Minibatch log likelihood (pre-update): -55.0555, error rate (pre-update): 0.23238
iter: 520, Minibatch log likelihood (post-update): -55.052, error rate (post-update): 0.23172

size_minibatch = 20000
Precon grad coeff: 0.042256, velocity coeff: 1.1329
norm(ch) = 3.712
iter: 521, Minibatch log likelihood (pre-update): -55.052, error rate (pre-update): 0.23172

size_minibatch = 20000
Precon grad coeff: 0.042699, velocity coeff: 0.95046
norm(ch) = 3.6367
iter: 522, Minibatch log likelihood (pre-update): -55.0479, error rate (pre-update): 0.23065

size_minibatch = 20000
Precon grad coeff: 0.039431, velocity coeff: 0.95349
norm(ch) = 3.5651
iter: 523, Minibatch log likelihood (pre-update): -55.0441, error rate (pre-update): 0.22935

size_minibatch = 20000
Precon grad coeff: 0.040165, velocity coeff: 1.0332
norm(ch) = 3.7795
iter: 524, Minibatch log likelihood (pre-update): -55.0403, error rate (pre-update): 0.22867

size_minibatch = 20000
Precon grad coeff: 0.037033, velocity coeff: 0.94986
norm(ch) = 3.6718
rho = 0.99414
New lambda: 8.4433e-010
iter: 525, Minibatch log likelihood (pre-update): -55.0364, error rate (pre-update): 0.22763
iter: 525, Minibatch log likelihood (post-update): -55.0327, error rate (post-update): 0.22679

size_minibatch = 20000
Precon grad coeff: 0.031466, velocity coeff: 0.88314
norm(ch) = 3.3129
iter: 526, Minibatch log likelihood (pre-update): -55.0327, error rate (pre-update): 0.22679

size_minibatch = 20000
Precon grad coeff: 0.034603, velocity coeff: 1.1199
norm(ch) = 3.7849
iter: 527, Minibatch log likelihood (pre-update): -55.0294, error rate (pre-update): 0.22599

size_minibatch = 20000
Precon grad coeff: 0.035525, velocity coeff: 0.93507
norm(ch) = 3.6007
iter: 528, Minibatch log likelihood (pre-update): -55.0256, error rate (pre-update): 0.22489

size_minibatch = 20000
Precon grad coeff: 0.036185, velocity coeff: 1.0438
norm(ch) = 3.8212
iter: 529, Minibatch log likelihood (pre-update): -55.022, error rate (pre-update): 0.22382

size_minibatch = 20000
Precon grad coeff: 0.039222, velocity coeff: 0.95824
norm(ch) = 3.731
rho = 0.99505
New lambda: 6.5333e-010
iter: 530, Minibatch log likelihood (pre-update): -55.0182, error rate (pre-update): 0.2231
iter: 530, Minibatch log likelihood (post-update): -55.0145, error rate (post-update): 0.22206

size_minibatch = 20000
Precon grad coeff: 0.033238, velocity coeff: 0.88851
norm(ch) = 3.3705
iter: 531, Minibatch log likelihood (pre-update): -55.0145, error rate (pre-update): 0.22206

size_minibatch = 20000
Precon grad coeff: 0.031379, velocity coeff: 0.9667
norm(ch) = 3.3122
iter: 532, Minibatch log likelihood (pre-update): -55.0112, error rate (pre-update): 0.22109

size_minibatch = 20000
Precon grad coeff: 0.029589, velocity coeff: 0.93186
norm(ch) = 3.1373
iter: 533, Minibatch log likelihood (pre-update): -55.008, error rate (pre-update): 0.22015

size_minibatch = 20000
Precon grad coeff: 0.029066, velocity coeff: 0.96691
norm(ch) = 3.0864
iter: 534, Minibatch log likelihood (pre-update): -55.0049, error rate (pre-update): 0.21959

size_minibatch = 20000
Precon grad coeff: 0.030078, velocity coeff: 0.98393
norm(ch) = 3.0923
rho = 0.992
New lambda: 5.0553e-010
iter: 535, Minibatch log likelihood (pre-update): -55.0019, error rate (pre-update): 0.21875
iter: 535, Minibatch log likelihood (post-update): -54.9989, error rate (post-update): 0.21795

size_minibatch = 20000
Precon grad coeff: 0.029793, velocity coeff: 0.99368
norm(ch) = 3.1253
iter: 536, Minibatch log likelihood (pre-update): -54.9989, error rate (pre-update): 0.21795

size_minibatch = 20000
Precon grad coeff: 0.032838, velocity coeff: 0.9853
norm(ch) = 3.1388
iter: 537, Minibatch log likelihood (pre-update): -54.9959, error rate (pre-update): 0.2173

size_minibatch = 20000
Precon grad coeff: 0.032776, velocity coeff: 0.99772
norm(ch) = 3.1969
iter: 538, Minibatch log likelihood (pre-update): -54.9929, error rate (pre-update): 0.21649

size_minibatch = 20000
Precon grad coeff: 0.026422, velocity coeff: 0.89017
norm(ch) = 2.8948
iter: 539, Minibatch log likelihood (pre-update): -54.9899, error rate (pre-update): 0.21563

size_minibatch = 20000
Precon grad coeff: 0.040971, velocity coeff: 0.99179
New gamma: 0.0031623
norm(ch) = 2.9698
rho = 0.99083
New lambda: 3.9117e-010
iter: 540, Minibatch log likelihood (pre-update): -54.9872, error rate (pre-update): 0.21495
iter: 540, Minibatch log likelihood (post-update): -54.9843, error rate (post-update): 0.21417

size_minibatch = 20000
Precon grad coeff: 0.036449, velocity coeff: 0.9744
norm(ch) = 2.975
iter: 541, Minibatch log likelihood (pre-update): -54.9843, error rate (pre-update): 0.21417

size_minibatch = 20000
Precon grad coeff: 0.036836, velocity coeff: 1.0154
norm(ch) = 3.1011
iter: 542, Minibatch log likelihood (pre-update): -54.9815, error rate (pre-update): 0.21358

size_minibatch = 20000
Precon grad coeff: 0.035806, velocity coeff: 0.94834
norm(ch) = 3.0116
iter: 543, Minibatch log likelihood (pre-update): -54.9785, error rate (pre-update): 0.21287

size_minibatch = 20000
Precon grad coeff: 0.039548, velocity coeff: 1.0867
norm(ch) = 3.3588
iter: 544, Minibatch log likelihood (pre-update): -54.9758, error rate (pre-update): 0.21206

size_minibatch = 20000
Precon grad coeff: 0.03709, velocity coeff: 1.0083
norm(ch) = 3.4544
rho = 0.99056
New lambda: 3.0268e-010
iter: 545, Minibatch log likelihood (pre-update): -54.9727, error rate (pre-update): 0.21143
iter: 545, Minibatch log likelihood (post-update): -54.9696, error rate (post-update): 0.21065

size_minibatch = 20000
Precon grad coeff: 0.036222, velocity coeff: 0.94216
norm(ch) = 3.3154
iter: 546, Minibatch log likelihood (pre-update): -54.9696, error rate (pre-update): 0.21065

size_minibatch = 20000
Precon grad coeff: 0.032491, velocity coeff: 0.99474
norm(ch) = 3.3517
iter: 547, Minibatch log likelihood (pre-update): -54.9667, error rate (pre-update): 0.21014

size_minibatch = 20000
Precon grad coeff: 0.037541, velocity coeff: 1.02
norm(ch) = 3.4744
iter: 548, Minibatch log likelihood (pre-update): -54.9637, error rate (pre-update): 0.2093

size_minibatch = 20000
Precon grad coeff: 0.036988, velocity coeff: 0.99266
norm(ch) = 3.5008
iter: 549, Minibatch log likelihood (pre-update): -54.9606, error rate (pre-update): 0.20839

size_minibatch = 20000
Precon grad coeff: 0.033299, velocity coeff: 0.88399
norm(ch) = 3.1401
rho = 0.99491
New lambda: 2.3421e-010
iter: 550, Minibatch log likelihood (pre-update): -54.9576, error rate (pre-update): 0.20778
iter: 550, Minibatch log likelihood (post-update): -54.9548, error rate (post-update): 0.20724
---
Full log-likelihood: -54.9548, error rate: 0.20724
TEST log-likelihood: -55.081, error rate: 0.30321
Error difference (test - train): 0.095969
---
Full log-likelihood (averaged params): -63.4432, error rate (averaged params): 2.4311
TEST log-likelihood (averaged params): -63.3918, error rate (averaged params): 2.4604
Error difference (test - train) (averaged params): 0.029373

size_minibatch = 20000
Precon grad coeff: 0.031535, velocity coeff: 0.99131
norm(ch) = 3.1523
iter: 551, Minibatch log likelihood (pre-update): -54.9548, error rate (pre-update): 0.20724

size_minibatch = 20000
Precon grad coeff: 0.031746, velocity coeff: 0.97274
norm(ch) = 3.1096
iter: 552, Minibatch log likelihood (pre-update): -54.9521, error rate (pre-update): 0.20623

size_minibatch = 20000
Precon grad coeff: 0.031737, velocity coeff: 0.94864
norm(ch) = 2.993
iter: 553, Minibatch log likelihood (pre-update): -54.9494, error rate (pre-update): 0.20561

size_minibatch = 20000
Precon grad coeff: 0.029125, velocity coeff: 0.94879
norm(ch) = 2.8803
iter: 554, Minibatch log likelihood (pre-update): -54.9468, error rate (pre-update): 0.20523

size_minibatch = 20000
Precon grad coeff: 0.033533, velocity coeff: 1.0299
norm(ch) = 3.0161
rho = 0.99305
New lambda: 1.8123e-010
iter: 555, Minibatch log likelihood (pre-update): -54.9443, error rate (pre-update): 0.20437
iter: 555, Minibatch log likelihood (post-update): -54.9417, error rate (post-update): 0.20366

size_minibatch = 20000
Precon grad coeff: 0.028829, velocity coeff: 0.88362
norm(ch) = 2.7073
iter: 556, Minibatch log likelihood (pre-update): -54.9417, error rate (pre-update): 0.20366

size_minibatch = 20000
Precon grad coeff: 0.031603, velocity coeff: 1.0541
norm(ch) = 2.9044
iter: 557, Minibatch log likelihood (pre-update): -54.9394, error rate (pre-update): 0.20346

size_minibatch = 20000
Precon grad coeff: 0.029904, velocity coeff: 0.92262
norm(ch) = 2.7246
iter: 558, Minibatch log likelihood (pre-update): -54.9369, error rate (pre-update): 0.20274

size_minibatch = 20000
Precon grad coeff: 0.032497, velocity coeff: 1.0591
norm(ch) = 2.939
iter: 559, Minibatch log likelihood (pre-update): -54.9346, error rate (pre-update): 0.20206

size_minibatch = 20000
Precon grad coeff: 0.043018, velocity coeff: 0.94355
New gamma: 0.0031623
norm(ch) = 2.8548
rho = 0.99166
New lambda: 1.4023e-010
iter: 560, Minibatch log likelihood (pre-update): -54.9321, error rate (pre-update): 0.20168
iter: 560, Minibatch log likelihood (post-update): -54.9297, error rate (post-update): 0.20087

size_minibatch = 20000
Precon grad coeff: 0.037766, velocity coeff: 0.9836
norm(ch) = 2.8792
iter: 561, Minibatch log likelihood (pre-update): -54.9297, error rate (pre-update): 0.20087

size_minibatch = 20000
Precon grad coeff: 0.037856, velocity coeff: 0.96536
norm(ch) = 2.8448
iter: 562, Minibatch log likelihood (pre-update): -54.9272, error rate (pre-update): 0.20031

size_minibatch = 20000
Precon grad coeff: 0.037204, velocity coeff: 1.0188
norm(ch) = 2.9623
iter: 563, Minibatch log likelihood (pre-update): -54.9248, error rate (pre-update): 0.19985

size_minibatch = 20000
Precon grad coeff: 0.035569, velocity coeff: 0.96007
norm(ch) = 2.908
iter: 564, Minibatch log likelihood (pre-update): -54.9224, error rate (pre-update): 0.19927

size_minibatch = 20000
Precon grad coeff: 0.03485, velocity coeff: 1.0573
norm(ch) = 3.1289
rho = 0.99344
New lambda: 1.0851e-010
iter: 565, Minibatch log likelihood (pre-update): -54.92, error rate (pre-update): 0.19861
iter: 565, Minibatch log likelihood (post-update): -54.9175, error rate (post-update): 0.19802

size_minibatch = 20000
Precon grad coeff: 0.035752, velocity coeff: 0.97375
norm(ch) = 3.1012
iter: 566, Minibatch log likelihood (pre-update): -54.9175, error rate (pre-update): 0.19802

size_minibatch = 20000
Precon grad coeff: 0.032891, velocity coeff: 0.95962
norm(ch) = 3.0221
iter: 567, Minibatch log likelihood (pre-update): -54.915, error rate (pre-update): 0.19753

size_minibatch = 20000
Precon grad coeff: 0.031738, velocity coeff: 0.96656
norm(ch) = 2.9609
iter: 568, Minibatch log likelihood (pre-update): -54.9126, error rate (pre-update): 0.19683

size_minibatch = 20000
Precon grad coeff: 0.031925, velocity coeff: 0.99454
norm(ch) = 2.9843
iter: 569, Minibatch log likelihood (pre-update): -54.9102, error rate (pre-update): 0.19634

size_minibatch = 20000
Precon grad coeff: 0.034624, velocity coeff: 0.97738
norm(ch) = 2.9581
rho = 0.99473
New lambda: 8.396e-011
iter: 570, Minibatch log likelihood (pre-update): -54.9078, error rate (pre-update): 0.19593
iter: 570, Minibatch log likelihood (post-update): -54.9055, error rate (post-update): 0.19536

size_minibatch = 20000
Precon grad coeff: 0.034605, velocity coeff: 0.99759
norm(ch) = 2.9951
iter: 571, Minibatch log likelihood (pre-update): -54.9055, error rate (pre-update): 0.19536

size_minibatch = 20000
Precon grad coeff: 0.033931, velocity coeff: 0.96896
norm(ch) = 2.9401
iter: 572, Minibatch log likelihood (pre-update): -54.9031, error rate (pre-update): 0.19454

size_minibatch = 20000
Precon grad coeff: 0.034484, velocity coeff: 0.96059
norm(ch) = 2.8643
iter: 573, Minibatch log likelihood (pre-update): -54.9008, error rate (pre-update): 0.19413

size_minibatch = 20000
Precon grad coeff: 0.03365, velocity coeff: 0.98247
norm(ch) = 2.8558
iter: 574, Minibatch log likelihood (pre-update): -54.8985, error rate (pre-update): 0.19366

size_minibatch = 20000
Precon grad coeff: 0.03021, velocity coeff: 0.9001
norm(ch) = 2.6089
rho = 0.99305
New lambda: 6.4967e-011
iter: 575, Minibatch log likelihood (pre-update): -54.8963, error rate (pre-update): 0.193
iter: 575, Minibatch log likelihood (post-update): -54.8942, error rate (post-update): 0.19261

size_minibatch = 20000
Precon grad coeff: 0.02608, velocity coeff: 0.86556
norm(ch) = 2.2888
iter: 576, Minibatch log likelihood (pre-update): -54.8942, error rate (pre-update): 0.19261

size_minibatch = 20000
Precon grad coeff: 0.031135, velocity coeff: 1.1985
norm(ch) = 2.7881
iter: 577, Minibatch log likelihood (pre-update): -54.8924, error rate (pre-update): 0.19208

size_minibatch = 20000
Precon grad coeff: 0.02902, velocity coeff: 0.87114
norm(ch) = 2.4643
iter: 578, Minibatch log likelihood (pre-update): -54.8903, error rate (pre-update): 0.19164

size_minibatch = 20000
Precon grad coeff: 0.030525, velocity coeff: 1.0472
norm(ch) = 2.623
iter: 579, Minibatch log likelihood (pre-update): -54.8884, error rate (pre-update): 0.19138

size_minibatch = 20000
Precon grad coeff: 0.039543, velocity coeff: 0.97318
New gamma: 0.0031623
norm(ch) = 2.6161
rho = 0.99392
New lambda: 5.027e-011
iter: 580, Minibatch log likelihood (pre-update): -54.8864, error rate (pre-update): 0.19069
iter: 580, Minibatch log likelihood (post-update): -54.8843, error rate (post-update): 0.19023

size_minibatch = 20000
Precon grad coeff: 0.038847, velocity coeff: 0.98479
norm(ch) = 2.6395
iter: 581, Minibatch log likelihood (pre-update): -54.8843, error rate (pre-update): 0.19023

size_minibatch = 20000
Precon grad coeff: 0.037605, velocity coeff: 0.99976
norm(ch) = 2.6981
iter: 582, Minibatch log likelihood (pre-update): -54.8822, error rate (pre-update): 0.18985

size_minibatch = 20000
Precon grad coeff: 0.037371, velocity coeff: 0.96813
norm(ch) = 2.6649
iter: 583, Minibatch log likelihood (pre-update): -54.8802, error rate (pre-update): 0.1893

size_minibatch = 20000
Precon grad coeff: 0.0372, velocity coeff: 1.086
norm(ch) = 2.9486
iter: 584, Minibatch log likelihood (pre-update): -54.8782, error rate (pre-update): 0.18889

size_minibatch = 20000
Precon grad coeff: 0.040269, velocity coeff: 0.99468
norm(ch) = 2.9873
rho = 0.99524
New lambda: 3.8898e-011
iter: 585, Minibatch log likelihood (pre-update): -54.876, error rate (pre-update): 0.18855
iter: 585, Minibatch log likelihood (post-update): -54.8737, error rate (post-update): 0.18788

size_minibatch = 20000
Precon grad coeff: 0.037943, velocity coeff: 0.99472
norm(ch) = 3.0201
iter: 586, Minibatch log likelihood (pre-update): -54.8737, error rate (pre-update): 0.18788

size_minibatch = 20000
Precon grad coeff: 0.039958, velocity coeff: 1.0104
norm(ch) = 3.1005
iter: 587, Minibatch log likelihood (pre-update): -54.8715, error rate (pre-update): 0.18739

size_minibatch = 20000
Precon grad coeff: 0.035007, velocity coeff: 0.90381
norm(ch) = 2.8395
iter: 588, Minibatch log likelihood (pre-update): -54.8692, error rate (pre-update): 0.18685

size_minibatch = 20000
Precon grad coeff: 0.036719, velocity coeff: 1.0485
norm(ch) = 3.0177
iter: 589, Minibatch log likelihood (pre-update): -54.8672, error rate (pre-update): 0.18643

size_minibatch = 20000
Precon grad coeff: 0.035318, velocity coeff: 0.90566
norm(ch) = 2.7662
rho = 0.99438
New lambda: 3.0099e-011
iter: 590, Minibatch log likelihood (pre-update): -54.8649, error rate (pre-update): 0.18605
iter: 590, Minibatch log likelihood (post-update): -54.8629, error rate (post-update): 0.18549

size_minibatch = 20000
Precon grad coeff: 0.030807, velocity coeff: 0.95547
norm(ch) = 2.6757
iter: 591, Minibatch log likelihood (pre-update): -54.8629, error rate (pre-update): 0.18549

size_minibatch = 20000
Precon grad coeff: 0.034659, velocity coeff: 1.0015
norm(ch) = 2.7134
iter: 592, Minibatch log likelihood (pre-update): -54.861, error rate (pre-update): 0.18516

size_minibatch = 20000
Precon grad coeff: 0.030933, velocity coeff: 0.92371
norm(ch) = 2.5389
iter: 593, Minibatch log likelihood (pre-update): -54.859, error rate (pre-update): 0.18463

size_minibatch = 20000
Precon grad coeff: 0.032873, velocity coeff: 0.99857
norm(ch) = 2.5689
iter: 594, Minibatch log likelihood (pre-update): -54.8572, error rate (pre-update): 0.18403

size_minibatch = 20000
Precon grad coeff: 0.034606, velocity coeff: 0.98495
norm(ch) = 2.5696
rho = 0.99358
New lambda: 2.329e-011
iter: 595, Minibatch log likelihood (pre-update): -54.8553, error rate (pre-update): 0.18364
iter: 595, Minibatch log likelihood (post-update): -54.8535, error rate (post-update): 0.18326

size_minibatch = 20000
Precon grad coeff: 0.027988, velocity coeff: 0.88837
norm(ch) = 2.3131
iter: 596, Minibatch log likelihood (pre-update): -54.8535, error rate (pre-update): 0.18326

size_minibatch = 20000
Precon grad coeff: 0.030465, velocity coeff: 1.0253
norm(ch) = 2.4076
iter: 597, Minibatch log likelihood (pre-update): -54.8518, error rate (pre-update): 0.18282

size_minibatch = 20000
Precon grad coeff: 0.028923, velocity coeff: 0.94766
norm(ch) = 2.3162
iter: 598, Minibatch log likelihood (pre-update): -54.8501, error rate (pre-update): 0.18257

size_minibatch = 20000
Precon grad coeff: 0.030592, velocity coeff: 1.052
norm(ch) = 2.4721
iter: 599, Minibatch log likelihood (pre-update): -54.8485, error rate (pre-update): 0.18224

size_minibatch = 20000
Precon grad coeff: 0.040455, velocity coeff: 0.96246
New gamma: 0.0031623
norm(ch) = 2.4381
rho = 0.99249
New lambda: 1.8021e-011
iter: 600, Minibatch log likelihood (pre-update): -54.8467, error rate (pre-update): 0.18179
iter: 600, Minibatch log likelihood (post-update): -54.845, error rate (post-update): 0.18141
---
Full log-likelihood: -54.845, error rate: 0.18141
TEST log-likelihood: -54.9645, error rate: 0.27539
Error difference (test - train): 0.093974
---
Full log-likelihood (averaged params): -59.8644, error rate (averaged params): 1.5319
TEST log-likelihood (averaged params): -59.8527, error rate (averaged params): 1.5748
Error difference (test - train) (averaged params): 0.0429

size_minibatch = 20000
Precon grad coeff: 0.037854, velocity coeff: 1.0151
norm(ch) = 2.5307
iter: 601, Minibatch log likelihood (pre-update): -54.845, error rate (pre-update): 0.18141

size_minibatch = 20000
Precon grad coeff: 0.041055, velocity coeff: 1.0382
norm(ch) = 2.6775
iter: 602, Minibatch log likelihood (pre-update): -54.8432, error rate (pre-update): 0.18109

size_minibatch = 20000
Precon grad coeff: 0.039893, velocity coeff: 0.97573
norm(ch) = 2.6638
iter: 603, Minibatch log likelihood (pre-update): -54.8413, error rate (pre-update): 0.18059

size_minibatch = 20000
Precon grad coeff: 0.033938, velocity coeff: 0.9793
norm(ch) = 2.6498
iter: 604, Minibatch log likelihood (pre-update): -54.8394, error rate (pre-update): 0.18013

size_minibatch = 20000
Precon grad coeff: 0.038015, velocity coeff: 0.99612
norm(ch) = 2.6839
rho = 0.99481
New lambda: 1.3944e-011
iter: 605, Minibatch log likelihood (pre-update): -54.8376, error rate (pre-update): 0.1798
iter: 605, Minibatch log likelihood (post-update): -54.8358, error rate (post-update): 0.17945

size_minibatch = 20000
Precon grad coeff: 0.033996, velocity coeff: 0.98229
norm(ch) = 2.6723
iter: 606, Minibatch log likelihood (pre-update): -54.8358, error rate (pre-update): 0.17945

size_minibatch = 20000
Precon grad coeff: 0.033049, velocity coeff: 0.98485
norm(ch) = 2.6677
iter: 607, Minibatch log likelihood (pre-update): -54.8339, error rate (pre-update): 0.17894

size_minibatch = 20000
Precon grad coeff: 0.034188, velocity coeff: 0.95015
norm(ch) = 2.5678
iter: 608, Minibatch log likelihood (pre-update): -54.8321, error rate (pre-update): 0.17854

size_minibatch = 20000
Precon grad coeff: 0.035582, velocity coeff: 1.0368
norm(ch) = 2.6954
iter: 609, Minibatch log likelihood (pre-update): -54.8304, error rate (pre-update): 0.1782

size_minibatch = 20000
Precon grad coeff: 0.032707, velocity coeff: 0.91361
norm(ch) = 2.4951
rho = 0.9922
New lambda: 1.079e-011
iter: 610, Minibatch log likelihood (pre-update): -54.8285, error rate (pre-update): 0.17785
iter: 610, Minibatch log likelihood (post-update): -54.8268, error rate (post-update): 0.17747

size_minibatch = 20000
Precon grad coeff: 0.033916, velocity coeff: 1.031
norm(ch) = 2.6024
iter: 611, Minibatch log likelihood (pre-update): -54.8268, error rate (pre-update): 0.17747

size_minibatch = 20000
Precon grad coeff: 0.033061, velocity coeff: 0.91293
norm(ch) = 2.405
iter: 612, Minibatch log likelihood (pre-update): -54.8251, error rate (pre-update): 0.17712

size_minibatch = 20000
Precon grad coeff: 0.031701, velocity coeff: 0.96884
norm(ch) = 2.362
iter: 613, Minibatch log likelihood (pre-update): -54.8235, error rate (pre-update): 0.17658

size_minibatch = 20000
Precon grad coeff: 0.032596, velocity coeff: 0.99404
norm(ch) = 2.3792
iter: 614, Minibatch log likelihood (pre-update): -54.8219, error rate (pre-update): 0.17623

size_minibatch = 20000
Precon grad coeff: 0.029943, velocity coeff: 0.96487
norm(ch) = 2.3242
rho = 0.99209
New lambda: 8.349e-012
iter: 615, Minibatch log likelihood (pre-update): -54.8203, error rate (pre-update): 0.17596
iter: 615, Minibatch log likelihood (post-update): -54.8187, error rate (post-update): 0.17554

size_minibatch = 20000
Precon grad coeff: 0.032841, velocity coeff: 0.98737
norm(ch) = 2.3275
iter: 616, Minibatch log likelihood (pre-update): -54.8187, error rate (pre-update): 0.17554

size_minibatch = 20000
Precon grad coeff: 0.029095, velocity coeff: 0.95245
norm(ch) = 2.2481
iter: 617, Minibatch log likelihood (pre-update): -54.8172, error rate (pre-update): 0.17514

size_minibatch = 20000
Precon grad coeff: 0.03064, velocity coeff: 1.0096
norm(ch) = 2.2995
iter: 618, Minibatch log likelihood (pre-update): -54.8157, error rate (pre-update): 0.17495

size_minibatch = 20000
Precon grad coeff: 0.030099, velocity coeff: 0.96419
norm(ch) = 2.2499
iter: 619, Minibatch log likelihood (pre-update): -54.8142, error rate (pre-update): 0.17454

size_minibatch = 20000
Precon grad coeff: 0.040902, velocity coeff: 1.0005
New gamma: 0.0031623
norm(ch) = 2.3024
rho = 0.9948
New lambda: 6.4603e-012
iter: 620, Minibatch log likelihood (pre-update): -54.8127, error rate (pre-update): 0.17424
iter: 620, Minibatch log likelihood (post-update): -54.8111, error rate (post-update): 0.17403

size_minibatch = 20000
Precon grad coeff: 0.036464, velocity coeff: 0.94792
norm(ch) = 2.2288
iter: 621, Minibatch log likelihood (pre-update): -54.8111, error rate (pre-update): 0.17403

size_minibatch = 20000
Precon grad coeff: 0.039445, velocity coeff: 1.0617
norm(ch) = 2.4141
iter: 622, Minibatch log likelihood (pre-update): -54.8097, error rate (pre-update): 0.17356

size_minibatch = 20000
Precon grad coeff: 0.03526, velocity coeff: 0.9238
norm(ch) = 2.2709
iter: 623, Minibatch log likelihood (pre-update): -54.8081, error rate (pre-update): 0.17315

size_minibatch = 20000
Precon grad coeff: 0.035317, velocity coeff: 1.0484
norm(ch) = 2.4211
iter: 624, Minibatch log likelihood (pre-update): -54.8066, error rate (pre-update): 0.17297

size_minibatch = 20000
Precon grad coeff: 0.036712, velocity coeff: 1.0185
norm(ch) = 2.5046
rho = 0.99678
New lambda: 4.9989e-012
iter: 625, Minibatch log likelihood (pre-update): -54.805, error rate (pre-update): 0.17262
iter: 625, Minibatch log likelihood (post-update): -54.8034, error rate (post-update): 0.17218

size_minibatch = 20000
Precon grad coeff: 0.037094, velocity coeff: 1.0038
norm(ch) = 2.5519
iter: 626, Minibatch log likelihood (pre-update): -54.8034, error rate (pre-update): 0.17218

size_minibatch = 20000
Precon grad coeff: 0.033399, velocity coeff: 0.94772
norm(ch) = 2.4512
iter: 627, Minibatch log likelihood (pre-update): -54.8017, error rate (pre-update): 0.17198

size_minibatch = 20000
Precon grad coeff: 0.035482, velocity coeff: 0.98563
norm(ch) = 2.4481
iter: 628, Minibatch log likelihood (pre-update): -54.8002, error rate (pre-update): 0.17156

size_minibatch = 20000
Precon grad coeff: 0.030647, velocity coeff: 0.94644
norm(ch) = 2.3412
iter: 629, Minibatch log likelihood (pre-update): -54.7986, error rate (pre-update): 0.17116

size_minibatch = 20000
Precon grad coeff: 0.033391, velocity coeff: 1.0052
norm(ch) = 2.3839
rho = 0.99313
New lambda: 3.868e-012
iter: 630, Minibatch log likelihood (pre-update): -54.7971, error rate (pre-update): 0.1709
iter: 630, Minibatch log likelihood (post-update): -54.7956, error rate (post-update): 0.17049

size_minibatch = 20000
Precon grad coeff: 0.033548, velocity coeff: 0.98935
norm(ch) = 2.3875
iter: 631, Minibatch log likelihood (pre-update): -54.7956, error rate (pre-update): 0.17049

size_minibatch = 20000
Precon grad coeff: 0.03464, velocity coeff: 0.97169
norm(ch) = 2.3499
iter: 632, Minibatch log likelihood (pre-update): -54.7941, error rate (pre-update): 0.17015

size_minibatch = 20000
Precon grad coeff: 0.031901, velocity coeff: 0.9132
norm(ch) = 2.1729
iter: 633, Minibatch log likelihood (pre-update): -54.7926, error rate (pre-update): 0.16991

size_minibatch = 20000
Precon grad coeff: 0.028009, velocity coeff: 0.94511
norm(ch) = 2.0802
iter: 634, Minibatch log likelihood (pre-update): -54.7912, error rate (pre-update): 0.16954

size_minibatch = 20000
Precon grad coeff: 0.03176, velocity coeff: 1.0139
norm(ch) = 2.1366
rho = 0.993
New lambda: 2.993e-012
iter: 635, Minibatch log likelihood (pre-update): -54.7899, error rate (pre-update): 0.16923
iter: 635, Minibatch log likelihood (post-update): -54.7886, error rate (post-update): 0.169

size_minibatch = 20000
Precon grad coeff: 0.032612, velocity coeff: 1.0249
norm(ch) = 2.2218
iter: 636, Minibatch log likelihood (pre-update): -54.7886, error rate (pre-update): 0.169

size_minibatch = 20000
Precon grad coeff: 0.031307, velocity coeff: 0.92137
norm(ch) = 2.0759
iter: 637, Minibatch log likelihood (pre-update): -54.7872, error rate (pre-update): 0.16865

size_minibatch = 20000
Precon grad coeff: 0.027519, velocity coeff: 0.93011
norm(ch) = 1.9556
iter: 638, Minibatch log likelihood (pre-update): -54.7859, error rate (pre-update): 0.16839

size_minibatch = 20000
Precon grad coeff: 0.030162, velocity coeff: 1.0879
norm(ch) = 2.1562
iter: 639, Minibatch log likelihood (pre-update): -54.7847, error rate (pre-update): 0.16819

size_minibatch = 20000
Precon grad coeff: 0.038481, velocity coeff: 0.95094
New gamma: 0.0031623
norm(ch) = 2.0929
rho = 0.9936
New lambda: 2.3159e-012
iter: 640, Minibatch log likelihood (pre-update): -54.7833, error rate (pre-update): 0.16785
iter: 640, Minibatch log likelihood (post-update): -54.782, error rate (post-update): 0.16759

size_minibatch = 20000
Precon grad coeff: 0.037182, velocity coeff: 1.0038
norm(ch) = 2.1423
iter: 641, Minibatch log likelihood (pre-update): -54.782, error rate (pre-update): 0.16759

size_minibatch = 20000
Precon grad coeff: 0.040208, velocity coeff: 1.0865
norm(ch) = 2.3705
iter: 642, Minibatch log likelihood (pre-update): -54.7807, error rate (pre-update): 0.16733

size_minibatch = 20000
Precon grad coeff: 0.038555, velocity coeff: 0.96229
norm(ch) = 2.3193
iter: 643, Minibatch log likelihood (pre-update): -54.7793, error rate (pre-update): 0.16695

size_minibatch = 20000
Precon grad coeff: 0.032355, velocity coeff: 0.92328
norm(ch) = 2.1721
iter: 644, Minibatch log likelihood (pre-update): -54.7779, error rate (pre-update): 0.16665

size_minibatch = 20000
Precon grad coeff: 0.035139, velocity coeff: 1.0794
norm(ch) = 2.3773
rho = 0.99484
New lambda: 1.792e-012
iter: 645, Minibatch log likelihood (pre-update): -54.7766, error rate (pre-update): 0.16636
iter: 645, Minibatch log likelihood (post-update): -54.7751, error rate (post-update): 0.16606

size_minibatch = 20000
Precon grad coeff: 0.03747, velocity coeff: 0.99924
norm(ch) = 2.4099
iter: 646, Minibatch log likelihood (pre-update): -54.7751, error rate (pre-update): 0.16606

size_minibatch = 20000
Precon grad coeff: 0.033617, velocity coeff: 0.94429
norm(ch) = 2.3043
iter: 647, Minibatch log likelihood (pre-update): -54.7737, error rate (pre-update): 0.16582

size_minibatch = 20000
Precon grad coeff: 0.031782, velocity coeff: 0.95524
norm(ch) = 2.227
iter: 648, Minibatch log likelihood (pre-update): -54.7723, error rate (pre-update): 0.16545

size_minibatch = 20000
Precon grad coeff: 0.035153, velocity coeff: 1.0424
norm(ch) = 2.3497
iter: 649, Minibatch log likelihood (pre-update): -54.771, error rate (pre-update): 0.16523

size_minibatch = 20000
Precon grad coeff: 0.033974, velocity coeff: 0.93298
norm(ch) = 2.2203
rho = 0.99384
New lambda: 1.3866e-012
iter: 650, Minibatch log likelihood (pre-update): -54.7696, error rate (pre-update): 0.16498
iter: 650, Minibatch log likelihood (post-update): -54.7683, error rate (post-update): 0.16462
---
Full log-likelihood: -54.7683, error rate: 0.16462
TEST log-likelihood: -54.8895, error rate: 0.25896
Error difference (test - train): 0.09434
---
Full log-likelihood (averaged params): -57.7167, error rate (averaged params): 0.98943
TEST log-likelihood (averaged params): -57.7302, error rate (averaged params): 1.0416
Error difference (test - train) (averaged params): 0.052213

size_minibatch = 20000
Precon grad coeff: 0.034428, velocity coeff: 0.98351
norm(ch) = 2.2097
iter: 651, Minibatch log likelihood (pre-update): -54.7683, error rate (pre-update): 0.16462

size_minibatch = 20000
Precon grad coeff: 0.031569, velocity coeff: 0.90401
norm(ch) = 2.0217
iter: 652, Minibatch log likelihood (pre-update): -54.767, error rate (pre-update): 0.16433

size_minibatch = 20000
Precon grad coeff: 0.030178, velocity coeff: 0.99682
norm(ch) = 2.0407
iter: 653, Minibatch log likelihood (pre-update): -54.7658, error rate (pre-update): 0.16403

size_minibatch = 20000
Precon grad coeff: 0.032781, velocity coeff: 0.96575
norm(ch) = 1.9965
iter: 654, Minibatch log likelihood (pre-update): -54.7646, error rate (pre-update): 0.16379

size_minibatch = 20000
Precon grad coeff: 0.029857, velocity coeff: 0.96375
norm(ch) = 1.951
rho = 0.99262
New lambda: 1.073e-012
iter: 655, Minibatch log likelihood (pre-update): -54.7634, error rate (pre-update): 0.16358
iter: 655, Minibatch log likelihood (post-update): -54.7623, error rate (post-update): 0.16335

size_minibatch = 20000
Precon grad coeff: 0.028649, velocity coeff: 0.97233
norm(ch) = 1.9205
iter: 656, Minibatch log likelihood (pre-update): -54.7623, error rate (pre-update): 0.16335

size_minibatch = 20000
Precon grad coeff: 0.029664, velocity coeff: 1.0058
norm(ch) = 1.9557
iter: 657, Minibatch log likelihood (pre-update): -54.7612, error rate (pre-update): 0.16301

size_minibatch = 20000
Precon grad coeff: 0.028497, velocity coeff: 0.95074
norm(ch) = 1.8832
iter: 658, Minibatch log likelihood (pre-update): -54.76, error rate (pre-update): 0.16279

size_minibatch = 20000
Precon grad coeff: 0.028091, velocity coeff: 1.0031
norm(ch) = 1.9142
iter: 659, Minibatch log likelihood (pre-update): -54.759, error rate (pre-update): 0.16263

size_minibatch = 20000
Precon grad coeff: 0.036419, velocity coeff: 1.0071
New gamma: 0.0031623
norm(ch) = 1.9655
rho = 0.99151
New lambda: 8.3023e-013
iter: 660, Minibatch log likelihood (pre-update): -54.7579, error rate (pre-update): 0.16239
iter: 660, Minibatch log likelihood (post-update): -54.7567, error rate (post-update): 0.16209

size_minibatch = 20000
Precon grad coeff: 0.035203, velocity coeff: 0.97836
norm(ch) = 1.9587
iter: 661, Minibatch log likelihood (pre-update): -54.7567, error rate (pre-update): 0.16209

size_minibatch = 20000
Precon grad coeff: 0.035359, velocity coeff: 1.0158
norm(ch) = 2.0211
iter: 662, Minibatch log likelihood (pre-update): -54.7556, error rate (pre-update): 0.16193

size_minibatch = 20000
Precon grad coeff: 0.038711, velocity coeff: 1.0547
norm(ch) = 2.1694
iter: 663, Minibatch log likelihood (pre-update): -54.7544, error rate (pre-update): 0.16162

size_minibatch = 20000
Precon grad coeff: 0.029062, velocity coeff: 0.8314
norm(ch) = 1.8268
iter: 664, Minibatch log likelihood (pre-update): -54.7532, error rate (pre-update): 0.16128

size_minibatch = 20000
Precon grad coeff: 0.037801, velocity coeff: 1.2485
norm(ch) = 2.3158
rho = 0.9955
New lambda: 6.4242e-013
iter: 665, Minibatch log likelihood (pre-update): -54.7522, error rate (pre-update): 0.16123
iter: 665, Minibatch log likelihood (post-update): -54.7509, error rate (post-update): 0.16093

size_minibatch = 20000
Precon grad coeff: 0.033719, velocity coeff: 0.90423
norm(ch) = 2.1191
iter: 666, Minibatch log likelihood (pre-update): -54.7509, error rate (pre-update): 0.16093

size_minibatch = 20000
Precon grad coeff: 0.032578, velocity coeff: 0.98075
norm(ch) = 2.104
iter: 667, Minibatch log likelihood (pre-update): -54.7497, error rate (pre-update): 0.16054

size_minibatch = 20000
Precon grad coeff: 0.034552, velocity coeff: 1.0042
norm(ch) = 2.1379
iter: 668, Minibatch log likelihood (pre-update): -54.7485, error rate (pre-update): 0.16039

size_minibatch = 20000
Precon grad coeff: 0.032238, velocity coeff: 0.96811
norm(ch) = 2.0933
iter: 669, Minibatch log likelihood (pre-update): -54.7473, error rate (pre-update): 0.1602

size_minibatch = 20000
Precon grad coeff: 0.029822, velocity coeff: 0.93525
norm(ch) = 1.9792
rho = 0.9934
New lambda: 4.9709e-013
iter: 670, Minibatch log likelihood (pre-update): -54.7462, error rate (pre-update): 0.15995
iter: 670, Minibatch log likelihood (post-update): -54.7451, error rate (post-update): 0.15975

size_minibatch = 20000
Precon grad coeff: 0.029579, velocity coeff: 0.97031
norm(ch) = 1.9404
iter: 671, Minibatch log likelihood (pre-update): -54.7451, error rate (pre-update): 0.15975

size_minibatch = 20000
Precon grad coeff: 0.031899, velocity coeff: 1.0403
norm(ch) = 2.0419
iter: 672, Minibatch log likelihood (pre-update): -54.744, error rate (pre-update): 0.15956

size_minibatch = 20000
Precon grad coeff: 0.033182, velocity coeff: 0.96763
norm(ch) = 1.9999
iter: 673, Minibatch log likelihood (pre-update): -54.7429, error rate (pre-update): 0.15919

size_minibatch = 20000
Precon grad coeff: 0.029241, velocity coeff: 0.90349
norm(ch) = 1.8246
iter: 674, Minibatch log likelihood (pre-update): -54.7418, error rate (pre-update): 0.15903

size_minibatch = 20000
Precon grad coeff: 0.030005, velocity coeff: 1.0198
norm(ch) = 1.8829
rho = 0.99321
New lambda: 3.8464e-013
iter: 675, Minibatch log likelihood (pre-update): -54.7408, error rate (pre-update): 0.15884
iter: 675, Minibatch log likelihood (post-update): -54.7398, error rate (post-update): 0.15852

size_minibatch = 20000
Precon grad coeff: 0.026097, velocity coeff: 0.89065
norm(ch) = 1.6953
iter: 676, Minibatch log likelihood (pre-update): -54.7398, error rate (pre-update): 0.15852

size_minibatch = 20000
Precon grad coeff: 0.028381, velocity coeff: 1.0585
norm(ch) = 1.8171
iter: 677, Minibatch log likelihood (pre-update): -54.7389, error rate (pre-update): 0.15836

size_minibatch = 20000
Precon grad coeff: 0.028039, velocity coeff: 0.99252
norm(ch) = 1.8239
iter: 678, Minibatch log likelihood (pre-update): -54.7379, error rate (pre-update): 0.15815

size_minibatch = 20000
Precon grad coeff: 0.031522, velocity coeff: 1.056
norm(ch) = 1.9488
iter: 679, Minibatch log likelihood (pre-update): -54.7369, error rate (pre-update): 0.15799

size_minibatch = 20000
Precon grad coeff: 0.036058, velocity coeff: 0.90353
New gamma: 0.0031623
norm(ch) = 1.7932
rho = 0.99266
New lambda: 2.9763e-013
iter: 680, Minibatch log likelihood (pre-update): -54.7359, error rate (pre-update): 0.15784
iter: 680, Minibatch log likelihood (post-update): -54.7349, error rate (post-update): 0.15756

size_minibatch = 20000
Precon grad coeff: 0.033509, velocity coeff: 1.0427
norm(ch) = 1.9
iter: 681, Minibatch log likelihood (pre-update): -54.7349, error rate (pre-update): 0.15756

size_minibatch = 20000
Precon grad coeff: 0.036919, velocity coeff: 1.0213
norm(ch) = 1.9696
iter: 682, Minibatch log likelihood (pre-update): -54.7339, error rate (pre-update): 0.15726

size_minibatch = 20000
Precon grad coeff: 0.033182, velocity coeff: 0.96947
norm(ch) = 1.9354
iter: 683, Minibatch log likelihood (pre-update): -54.7328, error rate (pre-update): 0.15712

size_minibatch = 20000
Precon grad coeff: 0.033102, velocity coeff: 0.99291
norm(ch) = 1.9484
iter: 684, Minibatch log likelihood (pre-update): -54.7318, error rate (pre-update): 0.15694

size_minibatch = 20000
Precon grad coeff: 0.034374, velocity coeff: 1.0632
norm(ch) = 2.0966
rho = 1
New lambda: 2.303e-013
iter: 685, Minibatch log likelihood (pre-update): -54.7308, error rate (pre-update): 0.15668
iter: 685, Minibatch log likelihood (post-update): -54.7297, error rate (post-update): 0.15648

size_minibatch = 20000
Precon grad coeff: 0.035831, velocity coeff: 0.98448
norm(ch) = 2.0902
iter: 686, Minibatch log likelihood (pre-update): -54.7297, error rate (pre-update): 0.15648

size_minibatch = 20000
Precon grad coeff: 0.028707, velocity coeff: 0.90391
norm(ch) = 1.9089
iter: 687, Minibatch log likelihood (pre-update): -54.7286, error rate (pre-update): 0.1562

size_minibatch = 20000
Precon grad coeff: 0.032389, velocity coeff: 1.0611
norm(ch) = 2.047
iter: 688, Minibatch log likelihood (pre-update): -54.7276, error rate (pre-update): 0.15605

size_minibatch = 20000
Precon grad coeff: 0.033026, velocity coeff: 0.97879
norm(ch) = 2.0241
iter: 689, Minibatch log likelihood (pre-update): -54.7266, error rate (pre-update): 0.15589

size_minibatch = 20000
Precon grad coeff: 0.031438, velocity coeff: 0.94923
norm(ch) = 1.9413
rho = 0.99498
New lambda: 1.782e-013
iter: 690, Minibatch log likelihood (pre-update): -54.7255, error rate (pre-update): 0.15564
iter: 690, Minibatch log likelihood (post-update): -54.7245, error rate (post-update): 0.15533

size_minibatch = 20000
Precon grad coeff: 0.029871, velocity coeff: 0.98212
norm(ch) = 1.9258
iter: 691, Minibatch log likelihood (pre-update): -54.7245, error rate (pre-update): 0.15533

size_minibatch = 20000
Precon grad coeff: 0.031257, velocity coeff: 0.96199
norm(ch) = 1.8717
iter: 692, Minibatch log likelihood (pre-update): -54.7235, error rate (pre-update): 0.15518

size_minibatch = 20000
Precon grad coeff: 0.03058, velocity coeff: 0.98198
norm(ch) = 1.8569
iter: 693, Minibatch log likelihood (pre-update): -54.7226, error rate (pre-update): 0.15501

size_minibatch = 20000
Precon grad coeff: 0.025261, velocity coeff: 0.88003
norm(ch) = 1.6504
iter: 694, Minibatch log likelihood (pre-update): -54.7216, error rate (pre-update): 0.15479

size_minibatch = 20000
Precon grad coeff: 0.027797, velocity coeff: 1.0806
norm(ch) = 1.8005
rho = 0.99741
New lambda: 1.3789e-013
iter: 695, Minibatch log likelihood (pre-update): -54.7208, error rate (pre-update): 0.15456
iter: 695, Minibatch log likelihood (post-update): -54.7199, error rate (post-update): 0.15444

size_minibatch = 20000
Precon grad coeff: 0.028353, velocity coeff: 0.93199
norm(ch) = 1.6979
iter: 696, Minibatch log likelihood (pre-update): -54.7199, error rate (pre-update): 0.15444

size_minibatch = 20000
Precon grad coeff: 0.026643, velocity coeff: 0.99522
norm(ch) = 1.7071
iter: 697, Minibatch log likelihood (pre-update): -54.719, error rate (pre-update): 0.15426

size_minibatch = 20000
Precon grad coeff: 0.029328, velocity coeff: 1.0183
norm(ch) = 1.7582
iter: 698, Minibatch log likelihood (pre-update): -54.7182, error rate (pre-update): 0.1541

size_minibatch = 20000
Precon grad coeff: 0.025847, velocity coeff: 0.93527
norm(ch) = 1.6613
iter: 699, Minibatch log likelihood (pre-update): -54.7173, error rate (pre-update): 0.15391

size_minibatch = 20000
Precon grad coeff: 0.03493, velocity coeff: 1.0394
New gamma: 0.0031623
norm(ch) = 1.7561
rho = 0.99486
New lambda: 1.0669e-013
iter: 700, Minibatch log likelihood (pre-update): -54.7165, error rate (pre-update): 0.15376
iter: 700, Minibatch log likelihood (post-update): -54.7156, error rate (post-update): 0.15349
---
Full log-likelihood: -54.7156, error rate: 0.15349
TEST log-likelihood: -54.8485, error rate: 0.251
Error difference (test - train): 0.097505
---
Full log-likelihood (averaged params): -56.4896, error rate (averaged params): 0.66878
TEST log-likelihood (averaged params): -56.5152, error rate (averaged params): 0.72681
Error difference (test - train) (averaged params): 0.05803

size_minibatch = 20000
Precon grad coeff: 0.033105, velocity coeff: 0.97234
norm(ch) = 1.7343
iter: 701, Minibatch log likelihood (pre-update): -54.7156, error rate (pre-update): 0.15349

size_minibatch = 20000
Precon grad coeff: 0.036916, velocity coeff: 1.0322
norm(ch) = 1.8182
iter: 702, Minibatch log likelihood (pre-update): -54.7147, error rate (pre-update): 0.15332

size_minibatch = 20000
Precon grad coeff: 0.033602, velocity coeff: 0.98118
norm(ch) = 1.8104
iter: 703, Minibatch log likelihood (pre-update): -54.7138, error rate (pre-update): 0.15317

size_minibatch = 20000
Precon grad coeff: 0.03171, velocity coeff: 0.9951
norm(ch) = 1.825
iter: 704, Minibatch log likelihood (pre-update): -54.7129, error rate (pre-update): 0.153

size_minibatch = 20000
Precon grad coeff: 0.036522, velocity coeff: 1.0719
norm(ch) = 1.9807
rho = 0.99766
New lambda: 8.2558e-014
iter: 705, Minibatch log likelihood (pre-update): -54.7119, error rate (pre-update): 0.15276
iter: 705, Minibatch log likelihood (post-update): -54.711, error rate (post-update): 0.15257

size_minibatch = 20000
Precon grad coeff: 0.031736, velocity coeff: 0.92761
norm(ch) = 1.8596
iter: 706, Minibatch log likelihood (pre-update): -54.711, error rate (pre-update): 0.15257

size_minibatch = 20000
Precon grad coeff: 0.029392, velocity coeff: 0.99513
norm(ch) = 1.8712
iter: 707, Minibatch log likelihood (pre-update): -54.71, error rate (pre-update): 0.15245

size_minibatch = 20000
Precon grad coeff: 0.033084, velocity coeff: 1.0476
norm(ch) = 1.981
iter: 708, Minibatch log likelihood (pre-update): -54.7091, error rate (pre-update): 0.15228

size_minibatch = 20000
Precon grad coeff: 0.032963, velocity coeff: 0.98148
norm(ch) = 1.9644
iter: 709, Minibatch log likelihood (pre-update): -54.7081, error rate (pre-update): 0.15198

size_minibatch = 20000
Precon grad coeff: 0.032318, velocity coeff: 0.95893
norm(ch) = 1.9014
rho = 0.99397
New lambda: 6.3882e-014
iter: 710, Minibatch log likelihood (pre-update): -54.7072, error rate (pre-update): 0.15181
iter: 710, Minibatch log likelihood (post-update): -54.7063, error rate (post-update): 0.15168

size_minibatch = 20000
Precon grad coeff: 0.028705, velocity coeff: 0.94858
norm(ch) = 1.8211
iter: 711, Minibatch log likelihood (pre-update): -54.7063, error rate (pre-update): 0.15168

size_minibatch = 20000
Precon grad coeff: 0.030845, velocity coeff: 1.003
norm(ch) = 1.8443
iter: 712, Minibatch log likelihood (pre-update): -54.7054, error rate (pre-update): 0.15141

size_minibatch = 20000
Precon grad coeff: 0.02904, velocity coeff: 0.91299
norm(ch) = 1.7004
iter: 713, Minibatch log likelihood (pre-update): -54.7045, error rate (pre-update): 0.15125

size_minibatch = 20000
Precon grad coeff: 0.024064, velocity coeff: 0.90235
norm(ch) = 1.5476
iter: 714, Minibatch log likelihood (pre-update): -54.7036, error rate (pre-update): 0.15108

size_minibatch = 20000
Precon grad coeff: 0.027947, velocity coeff: 1.1131
norm(ch) = 1.7393
rho = 0.9894
New lambda: 4.9431e-014
iter: 715, Minibatch log likelihood (pre-update): -54.7029, error rate (pre-update): 0.15091
iter: 715, Minibatch log likelihood (post-update): -54.7021, error rate (post-update): 0.15069

size_minibatch = 20000
Precon grad coeff: 0.030326, velocity coeff: 0.969
norm(ch) = 1.7024
iter: 716, Minibatch log likelihood (pre-update): -54.7021, error rate (pre-update): 0.15069

size_minibatch = 20000
Precon grad coeff: 0.028363, velocity coeff: 0.95849
norm(ch) = 1.6495
iter: 717, Minibatch log likelihood (pre-update): -54.7012, error rate (pre-update): 0.15059

size_minibatch = 20000
Precon grad coeff: 0.02692, velocity coeff: 0.97392
norm(ch) = 1.6225
iter: 718, Minibatch log likelihood (pre-update): -54.7004, error rate (pre-update): 0.1504

size_minibatch = 20000
Precon grad coeff: 0.030762, velocity coeff: 1.0506
norm(ch) = 1.7245
iter: 719, Minibatch log likelihood (pre-update): -54.6997, error rate (pre-update): 0.15026

size_minibatch = 20000
Precon grad coeff: 0.032292, velocity coeff: 0.93889
New gamma: 0.0031623
norm(ch) = 1.644
rho = 0.99231
New lambda: 3.8249e-014
iter: 720, Minibatch log likelihood (pre-update): -54.6988, error rate (pre-update): 0.15008
iter: 720, Minibatch log likelihood (post-update): -54.698, error rate (post-update): 0.14989

size_minibatch = 20000
Precon grad coeff: 0.033653, velocity coeff: 0.99588
norm(ch) = 1.6621
iter: 721, Minibatch log likelihood (pre-update): -54.698, error rate (pre-update): 0.14989

size_minibatch = 20000
Precon grad coeff: 0.032862, velocity coeff: 1.0141
norm(ch) = 1.7078
iter: 722, Minibatch log likelihood (pre-update): -54.6972, error rate (pre-update): 0.14972

size_minibatch = 20000
Precon grad coeff: 0.033642, velocity coeff: 1.0492
norm(ch) = 1.8156
iter: 723, Minibatch log likelihood (pre-update): -54.6964, error rate (pre-update): 0.14959

size_minibatch = 20000
Precon grad coeff: 0.033463, velocity coeff: 0.99192
norm(ch) = 1.8232
iter: 724, Minibatch log likelihood (pre-update): -54.6956, error rate (pre-update): 0.1494

size_minibatch = 20000
Precon grad coeff: 0.032018, velocity coeff: 1.0028
norm(ch) = 1.848
rho = 0.99706
New lambda: 2.9596e-014
iter: 725, Minibatch log likelihood (pre-update): -54.6947, error rate (pre-update): 0.14928
iter: 725, Minibatch log likelihood (post-update): -54.6938, error rate (post-update): 0.14904

size_minibatch = 20000
Precon grad coeff: 0.031206, velocity coeff: 0.97527
norm(ch) = 1.8229
iter: 726, Minibatch log likelihood (pre-update): -54.6938, error rate (pre-update): 0.14904

size_minibatch = 20000
Precon grad coeff: 0.02917, velocity coeff: 0.98736
norm(ch) = 1.8163
iter: 727, Minibatch log likelihood (pre-update): -54.693, error rate (pre-update): 0.14881

size_minibatch = 20000
Precon grad coeff: 0.033168, velocity coeff: 1.0249
norm(ch) = 1.8818
iter: 728, Minibatch log likelihood (pre-update): -54.6921, error rate (pre-update): 0.14864

size_minibatch = 20000
Precon grad coeff: 0.029544, velocity coeff: 0.96816
norm(ch) = 1.8382
iter: 729, Minibatch log likelihood (pre-update): -54.6912, error rate (pre-update): 0.14854

size_minibatch = 20000
Precon grad coeff: 0.030752, velocity coeff: 0.93347
norm(ch) = 1.7327
rho = 0.99727
New lambda: 2.2901e-014
iter: 730, Minibatch log likelihood (pre-update): -54.6904, error rate (pre-update): 0.1483
iter: 730, Minibatch log likelihood (post-update): -54.6896, error rate (post-update): 0.14817

size_minibatch = 20000
Precon grad coeff: 0.027708, velocity coeff: 0.96804
norm(ch) = 1.6923
iter: 731, Minibatch log likelihood (pre-update): -54.6896, error rate (pre-update): 0.14817

size_minibatch = 20000
Precon grad coeff: 0.030525, velocity coeff: 1.0275
norm(ch) = 1.7563
iter: 732, Minibatch log likelihood (pre-update): -54.6888, error rate (pre-update): 0.14805

size_minibatch = 20000
Precon grad coeff: 0.025774, velocity coeff: 0.87793
norm(ch) = 1.5551
iter: 733, Minibatch log likelihood (pre-update): -54.688, error rate (pre-update): 0.14784

size_minibatch = 20000
Precon grad coeff: 0.027549, velocity coeff: 1.0249
norm(ch) = 1.6094
iter: 734, Minibatch log likelihood (pre-update): -54.6873, error rate (pre-update): 0.14762

size_minibatch = 20000
Precon grad coeff: 0.029027, velocity coeff: 1.0368
norm(ch) = 1.6853
rho = 0.99573
New lambda: 1.772e-014
iter: 735, Minibatch log likelihood (pre-update): -54.6865, error rate (pre-update): 0.14754
iter: 735, Minibatch log likelihood (post-update): -54.6857, error rate (post-update): 0.14735

size_minibatch = 20000
Precon grad coeff: 0.029902, velocity coeff: 0.96446
norm(ch) = 1.6411
iter: 736, Minibatch log likelihood (pre-update): -54.6857, error rate (pre-update): 0.14735

size_minibatch = 20000
Precon grad coeff: 0.024219, velocity coeff: 0.89981
norm(ch) = 1.4902
iter: 737, Minibatch log likelihood (pre-update): -54.685, error rate (pre-update): 0.14716

size_minibatch = 20000
Precon grad coeff: 0.027664, velocity coeff: 1.0815
norm(ch) = 1.6276
iter: 738, Minibatch log likelihood (pre-update): -54.6843, error rate (pre-update): 0.14702

size_minibatch = 20000
Precon grad coeff: 0.025931, velocity coeff: 0.92672
norm(ch) = 1.523
iter: 739, Minibatch log likelihood (pre-update): -54.6836, error rate (pre-update): 0.1469

size_minibatch = 20000
Precon grad coeff: 0.030903, velocity coeff: 1.0056
New gamma: 0.0031623
norm(ch) = 1.5528
rho = 1.0024
New lambda: 1.3712e-014
iter: 740, Minibatch log likelihood (pre-update): -54.6829, error rate (pre-update): 0.14671
iter: 740, Minibatch log likelihood (post-update): -54.6822, error rate (post-update): 0.14661

size_minibatch = 20000
Precon grad coeff: 0.033472, velocity coeff: 1.0472
norm(ch) = 1.6487
iter: 741, Minibatch log likelihood (pre-update): -54.6822, error rate (pre-update): 0.14661

size_minibatch = 20000
Precon grad coeff: 0.034582, velocity coeff: 1.0144
norm(ch) = 1.695
iter: 742, Minibatch log likelihood (pre-update): -54.6814, error rate (pre-update): 0.14648

size_minibatch = 20000
Precon grad coeff: 0.033934, velocity coeff: 1.0342
norm(ch) = 1.7748
iter: 743, Minibatch log likelihood (pre-update): -54.6806, error rate (pre-update): 0.14628

size_minibatch = 20000
Precon grad coeff: 0.032904, velocity coeff: 0.96319
norm(ch) = 1.7294
iter: 744, Minibatch log likelihood (pre-update): -54.6798, error rate (pre-update): 0.1461

size_minibatch = 20000
Precon grad coeff: 0.034002, velocity coeff: 1.0575
norm(ch) = 1.8488
rho = 0.99296
New lambda: 1.061e-014
iter: 745, Minibatch log likelihood (pre-update): -54.679, error rate (pre-update): 0.14596
iter: 745, Minibatch log likelihood (post-update): -54.6782, error rate (post-update): 0.14577

size_minibatch = 20000
Precon grad coeff: 0.030909, velocity coeff: 0.92151
norm(ch) = 1.722
iter: 746, Minibatch log likelihood (pre-update): -54.6782, error rate (pre-update): 0.14577

size_minibatch = 20000
Precon grad coeff: 0.029522, velocity coeff: 1.0202
norm(ch) = 1.7729
iter: 747, Minibatch log likelihood (pre-update): -54.6774, error rate (pre-update): 0.1456

size_minibatch = 20000
Precon grad coeff: 0.028786, velocity coeff: 0.94796
norm(ch) = 1.6976
iter: 748, Minibatch log likelihood (pre-update): -54.6767, error rate (pre-update): 0.14547

size_minibatch = 20000
Precon grad coeff: 0.027347, velocity coeff: 0.97459
norm(ch) = 1.6685
iter: 749, Minibatch log likelihood (pre-update): -54.6759, error rate (pre-update): 0.14528

size_minibatch = 20000
Precon grad coeff: 0.029125, velocity coeff: 1.0092
norm(ch) = 1.6989
rho = 0.99756
New lambda: 8.2096e-015
iter: 750, Minibatch log likelihood (pre-update): -54.6751, error rate (pre-update): 0.14515
iter: 750, Minibatch log likelihood (post-update): -54.6744, error rate (post-update): 0.14502
---
Full log-likelihood: -54.6744, error rate: 0.14502
TEST log-likelihood: -54.8207, error rate: 0.24608
Error difference (test - train): 0.10107
---
Full log-likelihood (averaged params): -55.786, error rate (averaged params): 0.47856
TEST log-likelihood (averaged params): -55.8234, error rate (averaged params): 0.54154
Error difference (test - train) (averaged params): 0.062982

size_minibatch = 20000
Precon grad coeff: 0.030634, velocity coeff: 0.97562
norm(ch) = 1.6737
iter: 751, Minibatch log likelihood (pre-update): -54.6744, error rate (pre-update): 0.14502

size_minibatch = 20000
Precon grad coeff: 0.029131, velocity coeff: 0.96894
norm(ch) = 1.6372
iter: 752, Minibatch log likelihood (pre-update): -54.6737, error rate (pre-update): 0.14485

size_minibatch = 20000
Precon grad coeff: 0.027769, velocity coeff: 0.95261
norm(ch) = 1.5752
iter: 753, Minibatch log likelihood (pre-update): -54.6729, error rate (pre-update): 0.14467

size_minibatch = 20000
Precon grad coeff: 0.032172, velocity coeff: 1.0414
norm(ch) = 1.6567
iter: 754, Minibatch log likelihood (pre-update): -54.6722, error rate (pre-update): 0.14455

size_minibatch = 20000
Precon grad coeff: 0.030533, velocity coeff: 0.96155
norm(ch) = 1.6081
rho = 0.99252
New lambda: 6.3524e-015
iter: 755, Minibatch log likelihood (pre-update): -54.6715, error rate (pre-update): 0.14438
iter: 755, Minibatch log likelihood (post-update): -54.6708, error rate (post-update): 0.14418

size_minibatch = 20000
Precon grad coeff: 0.027156, velocity coeff: 0.9235
norm(ch) = 1.4997
iter: 756, Minibatch log likelihood (pre-update): -54.6708, error rate (pre-update): 0.14418

size_minibatch = 20000
Precon grad coeff: 0.028612, velocity coeff: 1.025
norm(ch) = 1.5535
iter: 757, Minibatch log likelihood (pre-update): -54.6701, error rate (pre-update): 0.14407

size_minibatch = 20000
Precon grad coeff: 0.022996, velocity coeff: 0.87392
norm(ch) = 1.3694
iter: 758, Minibatch log likelihood (pre-update): -54.6694, error rate (pre-update): 0.14397

size_minibatch = 20000
Precon grad coeff: 0.024558, velocity coeff: 1.0778
norm(ch) = 1.4904
iter: 759, Minibatch log likelihood (pre-update): -54.6688, error rate (pre-update): 0.14385

size_minibatch = 20000
Precon grad coeff: 0.031455, velocity coeff: 0.99489
New gamma: 0.0031623
norm(ch) = 1.5054
rho = 1.0018
New lambda: 4.9154e-015
iter: 760, Minibatch log likelihood (pre-update): -54.6682, error rate (pre-update): 0.14364
iter: 760, Minibatch log likelihood (post-update): -54.6675, error rate (post-update): 0.14356

size_minibatch = 20000
Precon grad coeff: 0.031676, velocity coeff: 1.0004
norm(ch) = 1.5274
iter: 761, Minibatch log likelihood (pre-update): -54.6675, error rate (pre-update): 0.14356

size_minibatch = 20000
Precon grad coeff: 0.031778, velocity coeff: 0.96966
norm(ch) = 1.4996
iter: 762, Minibatch log likelihood (pre-update): -54.6668, error rate (pre-update): 0.14345

size_minibatch = 20000
Precon grad coeff: 0.029833, velocity coeff: 1.0165
norm(ch) = 1.5437
iter: 763, Minibatch log likelihood (pre-update): -54.6662, error rate (pre-update): 0.14322

size_minibatch = 20000
Precon grad coeff: 0.027004, velocity coeff: 0.95285
norm(ch) = 1.4865
iter: 764, Minibatch log likelihood (pre-update): -54.6655, error rate (pre-update): 0.14312

size_minibatch = 20000
Precon grad coeff: 0.03243, velocity coeff: 1.146
norm(ch) = 1.7234
rho = 0.99261
New lambda: 3.8034e-015
iter: 765, Minibatch log likelihood (pre-update): -54.6648, error rate (pre-update): 0.14304
iter: 765, Minibatch log likelihood (post-update): -54.6641, error rate (post-update): 0.14287

size_minibatch = 20000
Precon grad coeff: 0.029333, velocity coeff: 0.94077
norm(ch) = 1.6393
iter: 766, Minibatch log likelihood (pre-update): -54.6641, error rate (pre-update): 0.14287

size_minibatch = 20000
Precon grad coeff: 0.031222, velocity coeff: 1.0441
norm(ch) = 1.7273
iter: 767, Minibatch log likelihood (pre-update): -54.6634, error rate (pre-update): 0.14266

size_minibatch = 20000
Precon grad coeff: 0.027039, velocity coeff: 0.90623
norm(ch) = 1.5799
iter: 768, Minibatch log likelihood (pre-update): -54.6626, error rate (pre-update): 0.14255

size_minibatch = 20000
Precon grad coeff: 0.027734, velocity coeff: 1.0412
norm(ch) = 1.6599
iter: 769, Minibatch log likelihood (pre-update): -54.6619, error rate (pre-update): 0.14249

size_minibatch = 20000
Precon grad coeff: 0.025252, velocity coeff: 0.92407
norm(ch) = 1.5453
rho = 0.99289
New lambda: 2.943e-015
iter: 770, Minibatch log likelihood (pre-update): -54.6612, error rate (pre-update): 0.14228
iter: 770, Minibatch log likelihood (post-update): -54.6605, error rate (post-update): 0.14212

size_minibatch = 20000
Precon grad coeff: 0.030367, velocity coeff: 1.0775
norm(ch) = 1.6812
iter: 771, Minibatch log likelihood (pre-update): -54.6605, error rate (pre-update): 0.14212

size_minibatch = 20000
Precon grad coeff: 0.027847, velocity coeff: 0.91049
norm(ch) = 1.5438
iter: 772, Minibatch log likelihood (pre-update): -54.6598, error rate (pre-update): 0.14197

size_minibatch = 20000
Precon grad coeff: 0.027594, velocity coeff: 0.97426
norm(ch) = 1.5181
iter: 773, Minibatch log likelihood (pre-update): -54.6592, error rate (pre-update): 0.14185

size_minibatch = 20000
Precon grad coeff: 0.026903, velocity coeff: 0.97632
norm(ch) = 1.4958
iter: 774, Minibatch log likelihood (pre-update): -54.6585, error rate (pre-update): 0.14171

size_minibatch = 20000
Precon grad coeff: 0.022486, velocity coeff: 0.88329
norm(ch) = 1.3324
rho = 1.0013
New lambda: 2.2773e-015
iter: 775, Minibatch log likelihood (pre-update): -54.6579, error rate (pre-update): 0.14154
iter: 775, Minibatch log likelihood (post-update): -54.6573, error rate (post-update): 0.14146

size_minibatch = 20000
Precon grad coeff: 0.026512, velocity coeff: 1.0959
norm(ch) = 1.4736
iter: 776, Minibatch log likelihood (pre-update): -54.6573, error rate (pre-update): 0.14146

size_minibatch = 20000
Precon grad coeff: 0.029651, velocity coeff: 1.0535
norm(ch) = 1.5675
iter: 777, Minibatch log likelihood (pre-update): -54.6567, error rate (pre-update): 0.14136

size_minibatch = 20000
Precon grad coeff: 0.028024, velocity coeff: 0.93826
norm(ch) = 1.4856
iter: 778, Minibatch log likelihood (pre-update): -54.656, error rate (pre-update): 0.14121

size_minibatch = 20000
Precon grad coeff: 0.024554, velocity coeff: 0.89974
norm(ch) = 1.3498
iter: 779, Minibatch log likelihood (pre-update): -54.6554, error rate (pre-update): 0.1411

size_minibatch = 20000
Precon grad coeff: 0.028252, velocity coeff: 1.0488
New gamma: 0.0031623
norm(ch) = 1.4347
rho = 0.99557
New lambda: 1.7621e-015
iter: 780, Minibatch log likelihood (pre-update): -54.6548, error rate (pre-update): 0.14096
iter: 780, Minibatch log likelihood (post-update): -54.6542, error rate (post-update): 0.14083

size_minibatch = 20000
Precon grad coeff: 0.031669, velocity coeff: 1.0307
norm(ch) = 1.4973
iter: 781, Minibatch log likelihood (pre-update): -54.6542, error rate (pre-update): 0.14083

size_minibatch = 20000
Precon grad coeff: 0.029541, velocity coeff: 0.95231
norm(ch) = 1.4432
iter: 782, Minibatch log likelihood (pre-update): -54.6536, error rate (pre-update): 0.14066

size_minibatch = 20000
Precon grad coeff: 0.031128, velocity coeff: 1.1142
norm(ch) = 1.6263
iter: 783, Minibatch log likelihood (pre-update): -54.6529, error rate (pre-update): 0.14058

size_minibatch = 20000
Precon grad coeff: 0.031896, velocity coeff: 0.94689
norm(ch) = 1.5573
iter: 784, Minibatch log likelihood (pre-update): -54.6523, error rate (pre-update): 0.14047

size_minibatch = 20000
Precon grad coeff: 0.025803, velocity coeff: 0.94881
norm(ch) = 1.4915
rho = 0.99999
New lambda: 1.3635e-015
iter: 785, Minibatch log likelihood (pre-update): -54.6516, error rate (pre-update): 0.14029
iter: 785, Minibatch log likelihood (post-update): -54.651, error rate (post-update): 0.14019

size_minibatch = 20000
Precon grad coeff: 0.028582, velocity coeff: 1.0888
norm(ch) = 1.6391
iter: 786, Minibatch log likelihood (pre-update): -54.651, error rate (pre-update): 0.14019

size_minibatch = 20000
Precon grad coeff: 0.030122, velocity coeff: 1.0167
norm(ch) = 1.6827
iter: 787, Minibatch log likelihood (pre-update): -54.6503, error rate (pre-update): 0.14006

size_minibatch = 20000
Precon grad coeff: 0.030099, velocity coeff: 0.95071
norm(ch) = 1.6146
iter: 788, Minibatch log likelihood (pre-update): -54.6496, error rate (pre-update): 0.13993

size_minibatch = 20000
Precon grad coeff: 0.025341, velocity coeff: 0.90663
norm(ch) = 1.4766
iter: 789, Minibatch log likelihood (pre-update): -54.6489, error rate (pre-update): 0.13978

size_minibatch = 20000
Precon grad coeff: 0.028184, velocity coeff: 1.0724
norm(ch) = 1.5969
rho = 0.99642
New lambda: 1.055e-015
iter: 790, Minibatch log likelihood (pre-update): -54.6483, error rate (pre-update): 0.13965
iter: 790, Minibatch log likelihood (post-update): -54.6477, error rate (post-update): 0.13954

size_minibatch = 20000
Precon grad coeff: 0.027523, velocity coeff: 0.90521
norm(ch) = 1.4578
iter: 791, Minibatch log likelihood (pre-update): -54.6477, error rate (pre-update): 0.13954

size_minibatch = 20000
Precon grad coeff: 0.023589, velocity coeff: 0.92404
norm(ch) = 1.3586
iter: 792, Minibatch log likelihood (pre-update): -54.647, error rate (pre-update): 0.13939

size_minibatch = 20000
Precon grad coeff: 0.02945, velocity coeff: 1.1694
norm(ch) = 1.6038
iter: 793, Minibatch log likelihood (pre-update): -54.6465, error rate (pre-update): 0.13928

size_minibatch = 20000
Precon grad coeff: 0.026994, velocity coeff: 0.87736
norm(ch) = 1.4188
iter: 794, Minibatch log likelihood (pre-update): -54.6458, error rate (pre-update): 0.13912

size_minibatch = 20000
Precon grad coeff: 0.029335, velocity coeff: 1.066
norm(ch) = 1.5273
rho = 0.99641
New lambda: 8.1637e-016
iter: 795, Minibatch log likelihood (pre-update): -54.6453, error rate (pre-update): 0.13903
iter: 795, Minibatch log likelihood (post-update): -54.6446, error rate (post-update): 0.13893

size_minibatch = 20000
Precon grad coeff: 0.022541, velocity coeff: 0.79382
norm(ch) = 1.2229
iter: 796, Minibatch log likelihood (pre-update): -54.6446, error rate (pre-update): 0.13893

size_minibatch = 20000
Precon grad coeff: 0.024395, velocity coeff: 1.1922
norm(ch) = 1.4708
iter: 797, Minibatch log likelihood (pre-update): -54.6441, error rate (pre-update): 0.13878

size_minibatch = 20000
Precon grad coeff: 0.027393, velocity coeff: 0.96771
norm(ch) = 1.4363
iter: 798, Minibatch log likelihood (pre-update): -54.6435, error rate (pre-update): 0.13868

size_minibatch = 20000
Precon grad coeff: 0.02798, velocity coeff: 1.0053
norm(ch) = 1.4572
iter: 799, Minibatch log likelihood (pre-update): -54.643, error rate (pre-update): 0.13858

size_minibatch = 20000
Precon grad coeff: 0.029784, velocity coeff: 0.97156
New gamma: 0.0031623
norm(ch) = 1.434
rho = 0.99317
New lambda: 6.3169e-016
iter: 800, Minibatch log likelihood (pre-update): -54.6424, error rate (pre-update): 0.13847
iter: 800, Minibatch log likelihood (post-update): -54.6418, error rate (post-update): 0.13836
---
Full log-likelihood: -54.6418, error rate: 0.13836
TEST log-likelihood: -54.8005, error rate: 0.24276
Error difference (test - train): 0.1044
---
Full log-likelihood (averaged params): -55.3721, error rate (averaged params): 0.36318
TEST log-likelihood (averaged params): -55.4246, error rate (averaged params): 0.43147
Error difference (test - train) (averaged params): 0.068289

size_minibatch = 20000
Precon grad coeff: 0.028783, velocity coeff: 0.93658
norm(ch) = 1.3584
iter: 801, Minibatch log likelihood (pre-update): -54.6418, error rate (pre-update): 0.13836

size_minibatch = 20000
Precon grad coeff: 0.030226, velocity coeff: 1.0914
norm(ch) = 1.4986
iter: 802, Minibatch log likelihood (pre-update): -54.6412, error rate (pre-update): 0.1382

size_minibatch = 20000
Precon grad coeff: 0.02751, velocity coeff: 0.94256
norm(ch) = 1.4267
iter: 803, Minibatch log likelihood (pre-update): -54.6406, error rate (pre-update): 0.13813

size_minibatch = 20000
Precon grad coeff: 0.031431, velocity coeff: 1.1085
norm(ch) = 1.5977
iter: 804, Minibatch log likelihood (pre-update): -54.64, error rate (pre-update): 0.13802

size_minibatch = 20000
Precon grad coeff: 0.029352, velocity coeff: 0.94967
norm(ch) = 1.5326
rho = 1.003
New lambda: 4.8879e-016
iter: 805, Minibatch log likelihood (pre-update): -54.6394, error rate (pre-update): 0.13783
iter: 805, Minibatch log likelihood (post-update): -54.6388, error rate (post-update): 0.13771

size_minibatch = 20000
Precon grad coeff: 0.030572, velocity coeff: 1.0406
norm(ch) = 1.6091
iter: 806, Minibatch log likelihood (pre-update): -54.6388, error rate (pre-update): 0.13771

size_minibatch = 20000
Precon grad coeff: 0.027205, velocity coeff: 0.92111
norm(ch) = 1.495
iter: 807, Minibatch log likelihood (pre-update): -54.6381, error rate (pre-update): 0.13764

size_minibatch = 20000
Precon grad coeff: 0.024116, velocity coeff: 0.97883
norm(ch) = 1.4741
iter: 808, Minibatch log likelihood (pre-update): -54.6375, error rate (pre-update): 0.13755

size_minibatch = 20000
Precon grad coeff: 0.03036, velocity coeff: 1.0894
norm(ch) = 1.6201
iter: 809, Minibatch log likelihood (pre-update): -54.637, error rate (pre-update): 0.13736

size_minibatch = 20000
Precon grad coeff: 0.03114, velocity coeff: 0.96937
norm(ch) = 1.5851
rho = 0.99858
New lambda: 3.7822e-016
iter: 810, Minibatch log likelihood (pre-update): -54.6363, error rate (pre-update): 0.13722
iter: 810, Minibatch log likelihood (post-update): -54.6357, error rate (post-update): 0.13714

size_minibatch = 20000
Precon grad coeff: 0.025673, velocity coeff: 0.87153
norm(ch) = 1.3935
iter: 811, Minibatch log likelihood (pre-update): -54.6357, error rate (pre-update): 0.13714

size_minibatch = 20000
Precon grad coeff: 0.02544, velocity coeff: 0.98407
norm(ch) = 1.3823
iter: 812, Minibatch log likelihood (pre-update): -54.6351, error rate (pre-update): 0.13703

size_minibatch = 20000
Precon grad coeff: 0.025554, velocity coeff: 1.0044
norm(ch) = 1.3994
iter: 813, Minibatch log likelihood (pre-update): -54.6346, error rate (pre-update): 0.13691

size_minibatch = 20000
Precon grad coeff: 0.025539, velocity coeff: 0.97208
norm(ch) = 1.371
iter: 814, Minibatch log likelihood (pre-update): -54.634, error rate (pre-update): 0.13678

size_minibatch = 20000
Precon grad coeff: 0.026902, velocity coeff: 1.0067
norm(ch) = 1.3928
rho = 0.99031
New lambda: 2.9266e-016
iter: 815, Minibatch log likelihood (pre-update): -54.6335, error rate (pre-update): 0.13672
iter: 815, Minibatch log likelihood (post-update): -54.633, error rate (post-update): 0.13659

size_minibatch = 20000
Precon grad coeff: 0.027523, velocity coeff: 1.0213
norm(ch) = 1.434
iter: 816, Minibatch log likelihood (pre-update): -54.633, error rate (pre-update): 0.13659

size_minibatch = 20000
Precon grad coeff: 0.028067, velocity coeff: 0.99286
norm(ch) = 1.437
iter: 817, Minibatch log likelihood (pre-update): -54.6324, error rate (pre-update): 0.13646

size_minibatch = 20000
Precon grad coeff: 0.023462, velocity coeff: 0.89838
norm(ch) = 1.3015
iter: 818, Minibatch log likelihood (pre-update): -54.6318, error rate (pre-update): 0.13636

size_minibatch = 20000
Precon grad coeff: 0.022901, velocity coeff: 0.98204
norm(ch) = 1.2888
iter: 819, Minibatch log likelihood (pre-update): -54.6313, error rate (pre-update): 0.13627

size_minibatch = 20000
Precon grad coeff: 0.02967, velocity coeff: 1.0797
New gamma: 0.0031623
norm(ch) = 1.4085
rho = 0.99868
New lambda: 2.2645e-016
iter: 820, Minibatch log likelihood (pre-update): -54.6308, error rate (pre-update): 0.1362
iter: 820, Minibatch log likelihood (post-update): -54.6303, error rate (post-update): 0.13602

size_minibatch = 20000
Precon grad coeff: 0.034482, velocity coeff: 1.0273
norm(ch) = 1.4671
iter: 821, Minibatch log likelihood (pre-update): -54.6303, error rate (pre-update): 0.13602

size_minibatch = 20000
Precon grad coeff: 0.028709, velocity coeff: 0.91037
norm(ch) = 1.349
iter: 822, Minibatch log likelihood (pre-update): -54.6297, error rate (pre-update): 0.13587

size_minibatch = 20000
Precon grad coeff: 0.028778, velocity coeff: 1.0264
norm(ch) = 1.4003
iter: 823, Minibatch log likelihood (pre-update): -54.6292, error rate (pre-update): 0.13585

size_minibatch = 20000
Precon grad coeff: 0.029856, velocity coeff: 1.0485
norm(ch) = 1.4826
iter: 824, Minibatch log likelihood (pre-update): -54.6286, error rate (pre-update): 0.13578

size_minibatch = 20000
Precon grad coeff: 0.029129, velocity coeff: 1.013
norm(ch) = 1.5161
rho = 0.99621
New lambda: 1.7522e-016
iter: 825, Minibatch log likelihood (pre-update): -54.628, error rate (pre-update): 0.13566
iter: 825, Minibatch log likelihood (post-update): -54.6275, error rate (post-update): 0.13545

size_minibatch = 20000
Precon grad coeff: 0.031757, velocity coeff: 1.0489
norm(ch) = 1.6048
iter: 826, Minibatch log likelihood (pre-update): -54.6275, error rate (pre-update): 0.13545

size_minibatch = 20000
Precon grad coeff: 0.028467, velocity coeff: 0.93059
norm(ch) = 1.506
iter: 827, Minibatch log likelihood (pre-update): -54.6268, error rate (pre-update): 0.13535

size_minibatch = 20000
Precon grad coeff: 0.026551, velocity coeff: 0.98268
norm(ch) = 1.4918
iter: 828, Minibatch log likelihood (pre-update): -54.6263, error rate (pre-update): 0.13532

size_minibatch = 20000
Precon grad coeff: 0.027989, velocity coeff: 1.0041
norm(ch) = 1.51
iter: 829, Minibatch log likelihood (pre-update): -54.6257, error rate (pre-update): 0.13514

size_minibatch = 20000
Precon grad coeff: 0.027969, velocity coeff: 0.99634
norm(ch) = 1.5162
rho = 1.0017
New lambda: 1.3558e-016
iter: 830, Minibatch log likelihood (pre-update): -54.6251, error rate (pre-update): 0.13501
iter: 830, Minibatch log likelihood (post-update): -54.6245, error rate (post-update): 0.13494

size_minibatch = 20000
Precon grad coeff: 0.027897, velocity coeff: 0.9477
norm(ch) = 1.4491
iter: 831, Minibatch log likelihood (pre-update): -54.6245, error rate (pre-update): 0.13494

size_minibatch = 20000
Precon grad coeff: 0.026698, velocity coeff: 0.94154
norm(ch) = 1.3755
iter: 832, Minibatch log likelihood (pre-update): -54.624, error rate (pre-update): 0.1348

size_minibatch = 20000
Precon grad coeff: 0.0275, velocity coeff: 1.0143
norm(ch) = 1.4076
iter: 833, Minibatch log likelihood (pre-update): -54.6235, error rate (pre-update): 0.13471

size_minibatch = 20000
Precon grad coeff: 0.023983, velocity coeff: 0.88059
norm(ch) = 1.2489
iter: 834, Minibatch log likelihood (pre-update): -54.6229, error rate (pre-update): 0.13459

size_minibatch = 20000
Precon grad coeff: 0.027282, velocity coeff: 1.0759
norm(ch) = 1.3559
rho = 0.99317
New lambda: 1.0491e-016
iter: 835, Minibatch log likelihood (pre-update): -54.6225, error rate (pre-update): 0.13452
iter: 835, Minibatch log likelihood (post-update): -54.6219, error rate (post-update): 0.13443

size_minibatch = 20000
Precon grad coeff: 0.027659, velocity coeff: 0.98606
norm(ch) = 1.3497
iter: 836, Minibatch log likelihood (pre-update): -54.6219, error rate (pre-update): 0.13443

size_minibatch = 20000
Precon grad coeff: 0.026227, velocity coeff: 0.97823
norm(ch) = 1.3316
iter: 837, Minibatch log likelihood (pre-update): -54.6214, error rate (pre-update): 0.13432

size_minibatch = 20000
Precon grad coeff: 0.025799, velocity coeff: 0.96661
norm(ch) = 1.2981
iter: 838, Minibatch log likelihood (pre-update): -54.6209, error rate (pre-update): 0.13424

size_minibatch = 20000
Precon grad coeff: 0.023721, velocity coeff: 0.9806
norm(ch) = 1.2837
iter: 839, Minibatch log likelihood (pre-update): -54.6204, error rate (pre-update): 0.13408

size_minibatch = 20000
Precon grad coeff: 0.030305, velocity coeff: 1.0873
New gamma: 0.0031623
norm(ch) = 1.4125
rho = 1.0009
New lambda: 8.118e-017
iter: 840, Minibatch log likelihood (pre-update): -54.62, error rate (pre-update): 0.13399
iter: 840, Minibatch log likelihood (post-update): -54.6194, error rate (post-update): 0.13394

size_minibatch = 20000
Precon grad coeff: 0.030549, velocity coeff: 0.95776
norm(ch) = 1.3683
iter: 841, Minibatch log likelihood (pre-update): -54.6194, error rate (pre-update): 0.13394

size_minibatch = 20000
Precon grad coeff: 0.029812, velocity coeff: 1.0319
norm(ch) = 1.4259
iter: 842, Minibatch log likelihood (pre-update): -54.6189, error rate (pre-update): 0.13384

size_minibatch = 20000
Precon grad coeff: 0.02785, velocity coeff: 0.96409
norm(ch) = 1.3879
iter: 843, Minibatch log likelihood (pre-update): -54.6184, error rate (pre-update): 0.1337

size_minibatch = 20000
Precon grad coeff: 0.028682, velocity coeff: 1.0303
norm(ch) = 1.4423
iter: 844, Minibatch log likelihood (pre-update): -54.6178, error rate (pre-update): 0.1336

size_minibatch = 20000
Precon grad coeff: 0.028936, velocity coeff: 1.0392
norm(ch) = 1.5134
rho = 0.99437
New lambda: 6.2815e-017
iter: 845, Minibatch log likelihood (pre-update): -54.6173, error rate (pre-update): 0.13356
iter: 845, Minibatch log likelihood (post-update): -54.6167, error rate (post-update): 0.13343

size_minibatch = 20000
Precon grad coeff: 0.029039, velocity coeff: 0.97925
norm(ch) = 1.4959
iter: 846, Minibatch log likelihood (pre-update): -54.6167, error rate (pre-update): 0.13343

size_minibatch = 20000
Precon grad coeff: 0.028149, velocity coeff: 0.94765
norm(ch) = 1.4285
iter: 847, Minibatch log likelihood (pre-update): -54.6162, error rate (pre-update): 0.13332

size_minibatch = 20000
Precon grad coeff: 0.025235, velocity coeff: 0.97179
norm(ch) = 1.3993
iter: 848, Minibatch log likelihood (pre-update): -54.6156, error rate (pre-update): 0.13323

size_minibatch = 20000
Precon grad coeff: 0.028183, velocity coeff: 1.0426
norm(ch) = 1.4706
iter: 849, Minibatch log likelihood (pre-update): -54.6151, error rate (pre-update): 0.1331

size_minibatch = 20000
Precon grad coeff: 0.02805, velocity coeff: 0.94667
norm(ch) = 1.4035
rho = 0.99616
New lambda: 4.8605e-017
iter: 850, Minibatch log likelihood (pre-update): -54.6146, error rate (pre-update): 0.133
iter: 850, Minibatch log likelihood (post-update): -54.6141, error rate (post-update): 0.13288
---
Full log-likelihood: -54.6141, error rate: 0.13288
TEST log-likelihood: -54.7845, error rate: 0.24032
Error difference (test - train): 0.10744
---
Full log-likelihood (averaged params): -55.1191, error rate (averaged params): 0.29146
TEST log-likelihood (averaged params): -55.1889, error rate (averaged params): 0.36551
Error difference (test - train) (averaged params): 0.074044

size_minibatch = 20000
Precon grad coeff: 0.025858, velocity coeff: 0.94677
norm(ch) = 1.3403
iter: 851, Minibatch log likelihood (pre-update): -54.6141, error rate (pre-update): 0.13288

size_minibatch = 20000
Precon grad coeff: 0.027034, velocity coeff: 1.0013
norm(ch) = 1.3529
iter: 852, Minibatch log likelihood (pre-update): -54.6136, error rate (pre-update): 0.1328

size_minibatch = 20000
Precon grad coeff: 0.024086, velocity coeff: 0.92671
norm(ch) = 1.2639
iter: 853, Minibatch log likelihood (pre-update): -54.6131, error rate (pre-update): 0.13274

size_minibatch = 20000
Precon grad coeff: 0.027083, velocity coeff: 1.0578
norm(ch) = 1.3483
iter: 854, Minibatch log likelihood (pre-update): -54.6126, error rate (pre-update): 0.13262

size_minibatch = 20000
Precon grad coeff: 0.028386, velocity coeff: 1.0051
norm(ch) = 1.367
rho = 0.9894
New lambda: 3.761e-017
iter: 855, Minibatch log likelihood (pre-update): -54.6121, error rate (pre-update): 0.13254
iter: 855, Minibatch log likelihood (post-update): -54.6116, error rate (post-update): 0.1324

size_minibatch = 20000
Precon grad coeff: 0.02534, velocity coeff: 0.95973
norm(ch) = 1.3223
iter: 856, Minibatch log likelihood (pre-update): -54.6116, error rate (pre-update): 0.1324

size_minibatch = 20000
Precon grad coeff: 0.023913, velocity coeff: 0.93818
norm(ch) = 1.2501
iter: 857, Minibatch log likelihood (pre-update): -54.6111, error rate (pre-update): 0.13229

size_minibatch = 20000
Precon grad coeff: 0.025821, velocity coeff: 1.0886
norm(ch) = 1.3722
iter: 858, Minibatch log likelihood (pre-update): -54.6107, error rate (pre-update): 0.13228

size_minibatch = 20000
Precon grad coeff: 0.024169, velocity coeff: 0.93632
norm(ch) = 1.2947
iter: 859, Minibatch log likelihood (pre-update): -54.6102, error rate (pre-update): 0.13217

size_minibatch = 20000
Precon grad coeff: 0.03512, velocity coeff: 1.1611
New gamma: 0.0031623
norm(ch) = 1.5215
rho = 0.99959
New lambda: 2.9102e-017
iter: 860, Minibatch log likelihood (pre-update): -54.6097, error rate (pre-update): 0.13206
iter: 860, Minibatch log likelihood (post-update): -54.6092, error rate (post-update): 0.13197

size_minibatch = 20000
Precon grad coeff: 0.028419, velocity coeff: 0.83534
norm(ch) = 1.2828
iter: 861, Minibatch log likelihood (pre-update): -54.6092, error rate (pre-update): 0.13197

size_minibatch = 20000
Precon grad coeff: 0.02675, velocity coeff: 1.0515
norm(ch) = 1.3606
iter: 862, Minibatch log likelihood (pre-update): -54.6087, error rate (pre-update): 0.13187

size_minibatch = 20000
Precon grad coeff: 0.03001, velocity coeff: 1.0427
norm(ch) = 1.4323
iter: 863, Minibatch log likelihood (pre-update): -54.6082, error rate (pre-update): 0.13181

size_minibatch = 20000
Precon grad coeff: 0.031427, velocity coeff: 1.0194
norm(ch) = 1.4738
iter: 864, Minibatch log likelihood (pre-update): -54.6077, error rate (pre-update): 0.13169

size_minibatch = 20000
Precon grad coeff: 0.026607, velocity coeff: 0.91301
norm(ch) = 1.356
rho = 0.99655
New lambda: 2.2518e-017
iter: 865, Minibatch log likelihood (pre-update): -54.6072, error rate (pre-update): 0.13155
iter: 865, Minibatch log likelihood (post-update): -54.6067, error rate (post-update): 0.13149

size_minibatch = 20000
Precon grad coeff: 0.028745, velocity coeff: 1.0743
norm(ch) = 1.4698
iter: 866, Minibatch log likelihood (pre-update): -54.6067, error rate (pre-update): 0.13149

size_minibatch = 20000
Precon grad coeff: 0.028719, velocity coeff: 0.94621
norm(ch) = 1.4015
iter: 867, Minibatch log likelihood (pre-update): -54.6061, error rate (pre-update): 0.13137

size_minibatch = 20000
Precon grad coeff: 0.02533, velocity coeff: 0.96187
norm(ch) = 1.3586
iter: 868, Minibatch log likelihood (pre-update): -54.6056, error rate (pre-update): 0.13131

size_minibatch = 20000
Precon grad coeff: 0.027453, velocity coeff: 1.0343
norm(ch) = 1.4171
iter: 869, Minibatch log likelihood (pre-update): -54.6052, error rate (pre-update): 0.13121

size_minibatch = 20000
Precon grad coeff: 0.029875, velocity coeff: 1.0026
norm(ch) = 1.4328
rho = 1.001
New lambda: 1.7424e-017
iter: 870, Minibatch log likelihood (pre-update): -54.6047, error rate (pre-update): 0.1311
iter: 870, Minibatch log likelihood (post-update): -54.6041, error rate (post-update): 0.13103

size_minibatch = 20000
Precon grad coeff: 0.027162, velocity coeff: 0.91798
norm(ch) = 1.3253
iter: 871, Minibatch log likelihood (pre-update): -54.6041, error rate (pre-update): 0.13103

size_minibatch = 20000
Precon grad coeff: 0.02498, velocity coeff: 0.97789
norm(ch) = 1.3059
iter: 872, Minibatch log likelihood (pre-update): -54.6037, error rate (pre-update): 0.13094

size_minibatch = 20000
Precon grad coeff: 0.024353, velocity coeff: 0.95913
norm(ch) = 1.2626
iter: 873, Minibatch log likelihood (pre-update): -54.6032, error rate (pre-update): 0.13083

size_minibatch = 20000
Precon grad coeff: 0.027482, velocity coeff: 1.0758
norm(ch) = 1.369
iter: 874, Minibatch log likelihood (pre-update): -54.6028, error rate (pre-update): 0.13072

size_minibatch = 20000
Precon grad coeff: 0.026629, velocity coeff: 0.91109
norm(ch) = 1.2587
rho = 0.99259
New lambda: 1.3483e-017
iter: 875, Minibatch log likelihood (pre-update): -54.6023, error rate (pre-update): 0.13065
iter: 875, Minibatch log likelihood (post-update): -54.6018, error rate (post-update): 0.13055

size_minibatch = 20000
Precon grad coeff: 0.027329, velocity coeff: 1.0551
norm(ch) = 1.339
iter: 876, Minibatch log likelihood (pre-update): -54.6018, error rate (pre-update): 0.13055

size_minibatch = 20000
Precon grad coeff: 0.022614, velocity coeff: 0.88029
norm(ch) = 1.1875
iter: 877, Minibatch log likelihood (pre-update): -54.6014, error rate (pre-update): 0.13046

size_minibatch = 20000
Precon grad coeff: 0.02453, velocity coeff: 1.0702
norm(ch) = 1.2812
iter: 878, Minibatch log likelihood (pre-update): -54.601, error rate (pre-update): 0.13041

size_minibatch = 20000
Precon grad coeff: 0.026273, velocity coeff: 0.99685
norm(ch) = 1.2875
iter: 879, Minibatch log likelihood (pre-update): -54.6005, error rate (pre-update): 0.13032

size_minibatch = 20000
Precon grad coeff: 0.028834, velocity coeff: 0.99417
New gamma: 0.0031623
norm(ch) = 1.2939
rho = 0.98956
New lambda: 1.0433e-017
iter: 880, Minibatch log likelihood (pre-update): -54.6001, error rate (pre-update): 0.13025
iter: 880, Minibatch log likelihood (post-update): -54.5996, error rate (post-update): 0.13015

size_minibatch = 20000
Precon grad coeff: 0.029225, velocity coeff: 0.98418
norm(ch) = 1.2865
iter: 881, Minibatch log likelihood (pre-update): -54.5996, error rate (pre-update): 0.13015

size_minibatch = 20000
Precon grad coeff: 0.025133, velocity coeff: 0.92595
norm(ch) = 1.202
iter: 882, Minibatch log likelihood (pre-update): -54.5991, error rate (pre-update): 0.13006

size_minibatch = 20000
Precon grad coeff: 0.0296, velocity coeff: 1.1719
norm(ch) = 1.4217
iter: 883, Minibatch log likelihood (pre-update): -54.5987, error rate (pre-update): 0.13

size_minibatch = 20000
Precon grad coeff: 0.027894, velocity coeff: 0.91462
norm(ch) = 1.3119
iter: 884, Minibatch log likelihood (pre-update): -54.5982, error rate (pre-update): 0.12986

size_minibatch = 20000
Precon grad coeff: 0.029793, velocity coeff: 1.1022
norm(ch) = 1.4589
rho = 0.99433
New lambda: 8.0725e-018
iter: 885, Minibatch log likelihood (pre-update): -54.5978, error rate (pre-update): 0.12979
iter: 885, Minibatch log likelihood (post-update): -54.5973, error rate (post-update): 0.1297

size_minibatch = 20000
Precon grad coeff: 0.024588, velocity coeff: 0.87513
norm(ch) = 1.2863
iter: 886, Minibatch log likelihood (pre-update): -54.5973, error rate (pre-update): 0.1297

size_minibatch = 20000
Precon grad coeff: 0.026369, velocity coeff: 1.0888
norm(ch) = 1.411
iter: 887, Minibatch log likelihood (pre-update): -54.5968, error rate (pre-update): 0.12959

size_minibatch = 20000
Precon grad coeff: 0.025807, velocity coeff: 0.93541
norm(ch) = 1.3302
iter: 888, Minibatch log likelihood (pre-update): -54.5963, error rate (pre-update): 0.12955

size_minibatch = 20000
Precon grad coeff: 0.029957, velocity coeff: 1.1153
norm(ch) = 1.4954
iter: 889, Minibatch log likelihood (pre-update): -54.5959, error rate (pre-update): 0.12945

size_minibatch = 20000
Precon grad coeff: 0.026166, velocity coeff: 0.82829
norm(ch) = 1.2482
rho = 0.99305
New lambda: 6.2464e-018
iter: 890, Minibatch log likelihood (pre-update): -54.5953, error rate (pre-update): 0.12931
iter: 890, Minibatch log likelihood (post-update): -54.5949, error rate (post-update): 0.12925

size_minibatch = 20000
Precon grad coeff: 0.022103, velocity coeff: 1.014
norm(ch) = 1.274
iter: 891, Minibatch log likelihood (pre-update): -54.5949, error rate (pre-update): 0.12925

size_minibatch = 20000
Precon grad coeff: 0.028123, velocity coeff: 1.0394
norm(ch) = 1.3362
iter: 892, Minibatch log likelihood (pre-update): -54.5945, error rate (pre-update): 0.12916

size_minibatch = 20000
Precon grad coeff: 0.025619, velocity coeff: 0.95591
norm(ch) = 1.2868
iter: 893, Minibatch log likelihood (pre-update): -54.594, error rate (pre-update): 0.1291

size_minibatch = 20000
Precon grad coeff: 0.026378, velocity coeff: 0.98951
norm(ch) = 1.2835
iter: 894, Minibatch log likelihood (pre-update): -54.5936, error rate (pre-update): 0.12898

size_minibatch = 20000
Precon grad coeff: 0.023515, velocity coeff: 0.91348
norm(ch) = 1.1807
rho = 0.99505
New lambda: 4.8333e-018
iter: 895, Minibatch log likelihood (pre-update): -54.5932, error rate (pre-update): 0.12888
iter: 895, Minibatch log likelihood (post-update): -54.5927, error rate (post-update): 0.12887

size_minibatch = 20000
Precon grad coeff: 0.023235, velocity coeff: 1.0095
norm(ch) = 1.2018
iter: 896, Minibatch log likelihood (pre-update): -54.5928, error rate (pre-update): 0.12887

size_minibatch = 20000
Precon grad coeff: 0.024783, velocity coeff: 1.0241
norm(ch) = 1.2408
iter: 897, Minibatch log likelihood (pre-update): -54.5923, error rate (pre-update): 0.12878

size_minibatch = 20000
Precon grad coeff: 0.025532, velocity coeff: 0.99509
norm(ch) = 1.2448
iter: 898, Minibatch log likelihood (pre-update): -54.5919, error rate (pre-update): 0.12865

size_minibatch = 20000
Precon grad coeff: 0.025295, velocity coeff: 1.0011
norm(ch) = 1.2559
iter: 899, Minibatch log likelihood (pre-update): -54.5915, error rate (pre-update): 0.1286

size_minibatch = 20000
Precon grad coeff: 0.02717, velocity coeff: 0.94044
New gamma: 0.0031623
norm(ch) = 1.1931
rho = 1.0008
New lambda: 3.7399e-018
iter: 900, Minibatch log likelihood (pre-update): -54.5911, error rate (pre-update): 0.1285
iter: 900, Minibatch log likelihood (post-update): -54.5907, error rate (post-update): 0.12844
---
Full log-likelihood: -54.5907, error rate: 0.12844
TEST log-likelihood: -54.7732, error rate: 0.23902
Error difference (test - train): 0.11058
---
Full log-likelihood (averaged params): -54.9612, error rate (averaged params): 0.24653
TEST log-likelihood (averaged params): -55.0478, error rate (averaged params): 0.32602
Error difference (test - train) (averaged params): 0.079489

size_minibatch = 20000
Precon grad coeff: 0.026268, velocity coeff: 1.0289
norm(ch) = 1.2398
iter: 901, Minibatch log likelihood (pre-update): -54.5907, error rate (pre-update): 0.12844

size_minibatch = 20000
Precon grad coeff: 0.02879, velocity coeff: 1.0586
norm(ch) = 1.3241
iter: 902, Minibatch log likelihood (pre-update): -54.5902, error rate (pre-update): 0.12838

size_minibatch = 20000
Precon grad coeff: 0.030168, velocity coeff: 1.0493
norm(ch) = 1.4017
iter: 903, Minibatch log likelihood (pre-update): -54.5898, error rate (pre-update): 0.12827

size_minibatch = 20000
Precon grad coeff: 0.029154, velocity coeff: 0.97226
norm(ch) = 1.3745
iter: 904, Minibatch log likelihood (pre-update): -54.5893, error rate (pre-update): 0.12815

size_minibatch = 20000
Precon grad coeff: 0.024838, velocity coeff: 0.93823
norm(ch) = 1.3001
rho = 1.001
New lambda: 2.8939e-018
iter: 905, Minibatch log likelihood (pre-update): -54.5889, error rate (pre-update): 0.12812
iter: 905, Minibatch log likelihood (post-update): -54.5884, error rate (post-update): 0.12806

size_minibatch = 20000
Precon grad coeff: 0.02655, velocity coeff: 1.0519
norm(ch) = 1.3775
iter: 906, Minibatch log likelihood (pre-update): -54.5884, error rate (pre-update): 0.12806

size_minibatch = 20000
Precon grad coeff: 0.026878, velocity coeff: 1.0137
norm(ch) = 1.4066
iter: 907, Minibatch log likelihood (pre-update): -54.588, error rate (pre-update): 0.12792

size_minibatch = 20000
Precon grad coeff: 0.028437, velocity coeff: 0.99797
norm(ch) = 1.4147
iter: 908, Minibatch log likelihood (pre-update): -54.5875, error rate (pre-update): 0.12785

size_minibatch = 20000
Precon grad coeff: 0.025572, velocity coeff: 0.92821
norm(ch) = 1.322
iter: 909, Minibatch log likelihood (pre-update): -54.587, error rate (pre-update): 0.12778

size_minibatch = 20000
Precon grad coeff: 0.027669, velocity coeff: 0.98076
norm(ch) = 1.3074
rho = 1.0078
New lambda: 2.2392e-018
iter: 910, Minibatch log likelihood (pre-update): -54.5866, error rate (pre-update): 0.12766
iter: 910, Minibatch log likelihood (post-update): -54.5862, error rate (post-update): 0.12755

size_minibatch = 20000
Precon grad coeff: 0.022917, velocity coeff: 0.93858
norm(ch) = 1.2352
iter: 911, Minibatch log likelihood (pre-update): -54.5862, error rate (pre-update): 0.12755

size_minibatch = 20000
Precon grad coeff: 0.024275, velocity coeff: 0.98088
norm(ch) = 1.2206
iter: 912, Minibatch log likelihood (pre-update): -54.5858, error rate (pre-update): 0.1275

size_minibatch = 20000
Precon grad coeff: 0.026861, velocity coeff: 1.0197
norm(ch) = 1.2543
iter: 913, Minibatch log likelihood (pre-update): -54.5854, error rate (pre-update): 0.12749

size_minibatch = 20000
Precon grad coeff: 0.025564, velocity coeff: 0.97757
norm(ch) = 1.2356
iter: 914, Minibatch log likelihood (pre-update): -54.5849, error rate (pre-update): 0.12736

size_minibatch = 20000
Precon grad coeff: 0.027406, velocity coeff: 0.99599
norm(ch) = 1.2406
rho = 1.0019
New lambda: 1.7327e-018
iter: 915, Minibatch log likelihood (pre-update): -54.5845, error rate (pre-update): 0.12727
iter: 915, Minibatch log likelihood (post-update): -54.5841, error rate (post-update): 0.12721

size_minibatch = 20000
Precon grad coeff: 0.022046, velocity coeff: 0.90581
norm(ch) = 1.1317
iter: 916, Minibatch log likelihood (pre-update): -54.5841, error rate (pre-update): 0.12721

size_minibatch = 20000
Precon grad coeff: 0.023774, velocity coeff: 1.0346
norm(ch) = 1.1795
iter: 917, Minibatch log likelihood (pre-update): -54.5838, error rate (pre-update): 0.1271

size_minibatch = 20000
Precon grad coeff: 0.022848, velocity coeff: 0.98564
norm(ch) = 1.1716
iter: 918, Minibatch log likelihood (pre-update): -54.5834, error rate (pre-update): 0.12707

size_minibatch = 20000
Precon grad coeff: 0.028399, velocity coeff: 1.1582
norm(ch) = 1.3675
iter: 919, Minibatch log likelihood (pre-update): -54.583, error rate (pre-update): 0.12702

size_minibatch = 20000
Precon grad coeff: 0.029658, velocity coeff: 0.91519
New gamma: 0.0031623
norm(ch) = 1.2647
rho = 1.0011
New lambda: 1.3407e-018
iter: 920, Minibatch log likelihood (pre-update): -54.5826, error rate (pre-update): 0.12686
iter: 920, Minibatch log likelihood (post-update): -54.5821, error rate (post-update): 0.12682

size_minibatch = 20000
Precon grad coeff: 0.027355, velocity coeff: 0.99216
norm(ch) = 1.2651
iter: 921, Minibatch log likelihood (pre-update): -54.5821, error rate (pre-update): 0.12682

size_minibatch = 20000
Precon grad coeff: 0.026622, velocity coeff: 1.0326
norm(ch) = 1.3167
iter: 922, Minibatch log likelihood (pre-update): -54.5817, error rate (pre-update): 0.12677

size_minibatch = 20000
Precon grad coeff: 0.026887, velocity coeff: 0.97607
norm(ch) = 1.2945
iter: 923, Minibatch log likelihood (pre-update): -54.5813, error rate (pre-update): 0.12668

size_minibatch = 20000
Precon grad coeff: 0.027403, velocity coeff: 1.0613
norm(ch) = 1.3847
iter: 924, Minibatch log likelihood (pre-update): -54.5809, error rate (pre-update): 0.12657

size_minibatch = 20000
Precon grad coeff: 0.030947, velocity coeff: 1.0164
norm(ch) = 1.4188
rho = 0.99865
New lambda: 1.0374e-018
iter: 925, Minibatch log likelihood (pre-update): -54.5804, error rate (pre-update): 0.1265
iter: 925, Minibatch log likelihood (post-update): -54.58, error rate (post-update): 0.12643

size_minibatch = 20000
Precon grad coeff: 0.027147, velocity coeff: 0.93453
norm(ch) = 1.3365
iter: 926, Minibatch log likelihood (pre-update): -54.58, error rate (pre-update): 0.12643

size_minibatch = 20000
Precon grad coeff: 0.024108, velocity coeff: 0.91395
norm(ch) = 1.2292
iter: 927, Minibatch log likelihood (pre-update): -54.5796, error rate (pre-update): 0.12634

size_minibatch = 20000
Precon grad coeff: 0.024523, velocity coeff: 1.0622
norm(ch) = 1.3149
iter: 928, Minibatch log likelihood (pre-update): -54.5792, error rate (pre-update): 0.12629

size_minibatch = 20000
Precon grad coeff: 0.030425, velocity coeff: 1.0114
norm(ch) = 1.3398
iter: 929, Minibatch log likelihood (pre-update): -54.5788, error rate (pre-update): 0.12618

size_minibatch = 20000
Precon grad coeff: 0.027385, velocity coeff: 0.96407
norm(ch) = 1.3022
rho = 0.99813
New lambda: 8.0273e-019
iter: 930, Minibatch log likelihood (pre-update): -54.5783, error rate (pre-update): 0.12608
iter: 930, Minibatch log likelihood (post-update): -54.5779, error rate (post-update): 0.12603

size_minibatch = 20000
Precon grad coeff: 0.025468, velocity coeff: 0.88904
norm(ch) = 1.166
iter: 931, Minibatch log likelihood (pre-update): -54.5779, error rate (pre-update): 0.12603

size_minibatch = 20000
Precon grad coeff: 0.022702, velocity coeff: 1.0118
norm(ch) = 1.1879
iter: 932, Minibatch log likelihood (pre-update): -54.5776, error rate (pre-update): 0.12594

size_minibatch = 20000
Precon grad coeff: 0.025447, velocity coeff: 1.0224
norm(ch) = 1.2226
iter: 933, Minibatch log likelihood (pre-update): -54.5772, error rate (pre-update): 0.12587

size_minibatch = 20000
Precon grad coeff: 0.027661, velocity coeff: 1.0433
norm(ch) = 1.2858
iter: 934, Minibatch log likelihood (pre-update): -54.5768, error rate (pre-update): 0.1258

size_minibatch = 20000
Precon grad coeff: 0.02658, velocity coeff: 0.96352
norm(ch) = 1.2481
rho = 0.99305
New lambda: 6.2114e-019
iter: 935, Minibatch log likelihood (pre-update): -54.5764, error rate (pre-update): 0.12572
iter: 935, Minibatch log likelihood (post-update): -54.576, error rate (post-update): 0.12564

size_minibatch = 20000
Precon grad coeff: 0.024944, velocity coeff: 0.9525
norm(ch) = 1.1978
iter: 936, Minibatch log likelihood (pre-update): -54.576, error rate (pre-update): 0.12564

size_minibatch = 20000
Precon grad coeff: 0.021768, velocity coeff: 0.92968
norm(ch) = 1.1211
iter: 937, Minibatch log likelihood (pre-update): -54.5756, error rate (pre-update): 0.12559

size_minibatch = 20000
Precon grad coeff: 0.023784, velocity coeff: 1.1166
norm(ch) = 1.2605
iter: 938, Minibatch log likelihood (pre-update): -54.5753, error rate (pre-update): 0.12553

size_minibatch = 20000
Precon grad coeff: 0.027785, velocity coeff: 0.9931
norm(ch) = 1.2612
iter: 939, Minibatch log likelihood (pre-update): -54.5749, error rate (pre-update): 0.12543

size_minibatch = 20000
Precon grad coeff: 0.027197, velocity coeff: 0.95832
New gamma: 0.0031623
norm(ch) = 1.2195
rho = 0.99369
New lambda: 4.8063e-019
iter: 940, Minibatch log likelihood (pre-update): -54.5745, error rate (pre-update): 0.12539
iter: 940, Minibatch log likelihood (post-update): -54.5741, error rate (post-update): 0.12531

size_minibatch = 20000
Precon grad coeff: 0.028316, velocity coeff: 1.0238
norm(ch) = 1.2593
iter: 941, Minibatch log likelihood (pre-update): -54.5741, error rate (pre-update): 0.12531

size_minibatch = 20000
Precon grad coeff: 0.026625, velocity coeff: 0.91925
norm(ch) = 1.1672
iter: 942, Minibatch log likelihood (pre-update): -54.5737, error rate (pre-update): 0.12524

size_minibatch = 20000
Precon grad coeff: 0.023662, velocity coeff: 0.99191
norm(ch) = 1.1667
iter: 943, Minibatch log likelihood (pre-update): -54.5733, error rate (pre-update): 0.12516

size_minibatch = 20000
Precon grad coeff: 0.027217, velocity coeff: 1.1008
norm(ch) = 1.2938
iter: 944, Minibatch log likelihood (pre-update): -54.573, error rate (pre-update): 0.12505

size_minibatch = 20000
Precon grad coeff: 0.030027, velocity coeff: 1.0443
norm(ch) = 1.3629
rho = 0.9984
New lambda: 3.719e-019
iter: 945, Minibatch log likelihood (pre-update): -54.5726, error rate (pre-update): 0.12502
iter: 945, Minibatch log likelihood (post-update): -54.5722, error rate (post-update): 0.12494

size_minibatch = 20000
Precon grad coeff: 0.026958, velocity coeff: 0.93396
norm(ch) = 1.2819
iter: 946, Minibatch log likelihood (pre-update): -54.5722, error rate (pre-update): 0.12494

size_minibatch = 20000
Precon grad coeff: 0.026271, velocity coeff: 0.95863
norm(ch) = 1.2382
iter: 947, Minibatch log likelihood (pre-update): -54.5718, error rate (pre-update): 0.12484

size_minibatch = 20000
Precon grad coeff: 0.023414, velocity coeff: 0.99296
norm(ch) = 1.2373
iter: 948, Minibatch log likelihood (pre-update): -54.5714, error rate (pre-update): 0.12482

size_minibatch = 20000
Precon grad coeff: 0.023304, velocity coeff: 0.94924
norm(ch) = 1.183
iter: 949, Minibatch log likelihood (pre-update): -54.571, error rate (pre-update): 0.12473

size_minibatch = 20000
Precon grad coeff: 0.028647, velocity coeff: 1.1507
norm(ch) = 1.3712
rho = 1
New lambda: 2.8777e-019
iter: 950, Minibatch log likelihood (pre-update): -54.5706, error rate (pre-update): 0.12461
iter: 950, Minibatch log likelihood (post-update): -54.5702, error rate (post-update): 0.12455
---
Full log-likelihood: -54.5702, error rate: 0.12455
TEST log-likelihood: -54.7654, error rate: 0.23854
Error difference (test - train): 0.114
---
Full log-likelihood (averaged params): -54.8562, error rate (averaged params): 0.21691
TEST log-likelihood (averaged params): -54.9591, error rate (averaged params): 0.30168
Error difference (test - train) (averaged params): 0.084764

size_minibatch = 20000
Precon grad coeff: 0.028502, velocity coeff: 0.90547
norm(ch) = 1.2516
iter: 951, Minibatch log likelihood (pre-update): -54.5702, error rate (pre-update): 0.12455

size_minibatch = 20000
Precon grad coeff: 0.022872, velocity coeff: 0.92202
norm(ch) = 1.1616
iter: 952, Minibatch log likelihood (pre-update): -54.5698, error rate (pre-update): 0.12449

size_minibatch = 20000
Precon grad coeff: 0.025728, velocity coeff: 1.0293
norm(ch) = 1.2043
iter: 953, Minibatch log likelihood (pre-update): -54.5695, error rate (pre-update): 0.12443

size_minibatch = 20000
Precon grad coeff: 0.021094, velocity coeff: 0.89945
norm(ch) = 1.0905
iter: 954, Minibatch log likelihood (pre-update): -54.5691, error rate (pre-update): 0.12433

size_minibatch = 20000
Precon grad coeff: 0.025376, velocity coeff: 1.1204
norm(ch) = 1.2304
rho = 0.99778
New lambda: 2.2267e-019
iter: 955, Minibatch log likelihood (pre-update): -54.5688, error rate (pre-update): 0.1243
iter: 955, Minibatch log likelihood (post-update): -54.5684, error rate (post-update): 0.12423

size_minibatch = 20000
Precon grad coeff: 0.025091, velocity coeff: 0.95618
norm(ch) = 1.1848
iter: 956, Minibatch log likelihood (pre-update): -54.5684, error rate (pre-update): 0.12423

size_minibatch = 20000
Precon grad coeff: 0.027055, velocity coeff: 1.0434
norm(ch) = 1.2452
iter: 957, Minibatch log likelihood (pre-update): -54.568, error rate (pre-update): 0.12413

size_minibatch = 20000
Precon grad coeff: 0.024202, velocity coeff: 0.89034
norm(ch) = 1.1168
iter: 958, Minibatch log likelihood (pre-update): -54.5677, error rate (pre-update): 0.12407

size_minibatch = 20000
Precon grad coeff: 0.021872, velocity coeff: 1.0031
norm(ch) = 1.1279
iter: 959, Minibatch log likelihood (pre-update): -54.5673, error rate (pre-update): 0.124

size_minibatch = 20000
Precon grad coeff: 0.025121, velocity coeff: 0.97449
New gamma: 0.0031623
norm(ch) = 1.1087
rho = 0.99518
New lambda: 1.723e-019
iter: 960, Minibatch log likelihood (pre-update): -54.567, error rate (pre-update): 0.12396
iter: 960, Minibatch log likelihood (post-update): -54.5667, error rate (post-update): 0.12389

size_minibatch = 20000
Precon grad coeff: 0.029248, velocity coeff: 1.1101
norm(ch) = 1.2427
iter: 961, Minibatch log likelihood (pre-update): -54.5667, error rate (pre-update): 0.12389

size_minibatch = 20000
Precon grad coeff: 0.030119, velocity coeff: 0.96098
norm(ch) = 1.2049
iter: 962, Minibatch log likelihood (pre-update): -54.5663, error rate (pre-update): 0.1238

size_minibatch = 20000
Precon grad coeff: 0.025316, velocity coeff: 0.94181
norm(ch) = 1.1435
iter: 963, Minibatch log likelihood (pre-update): -54.5659, error rate (pre-update): 0.12373

size_minibatch = 20000
Precon grad coeff: 0.025894, velocity coeff: 1.0248
norm(ch) = 1.1816
iter: 964, Minibatch log likelihood (pre-update): -54.5656, error rate (pre-update): 0.12368

size_minibatch = 20000
Precon grad coeff: 0.025149, velocity coeff: 1.0036
norm(ch) = 1.1949
rho = 1.0013
New lambda: 1.3332e-019
iter: 965, Minibatch log likelihood (pre-update): -54.5652, error rate (pre-update): 0.12365
iter: 965, Minibatch log likelihood (post-update): -54.5648, error rate (post-update): 0.12355

size_minibatch = 20000
Precon grad coeff: 0.028093, velocity coeff: 1.0817
norm(ch) = 1.3032
iter: 966, Minibatch log likelihood (pre-update): -54.5648, error rate (pre-update): 0.12355

size_minibatch = 20000
Precon grad coeff: 0.028999, velocity coeff: 0.98414
norm(ch) = 1.2917
iter: 967, Minibatch log likelihood (pre-update): -54.5645, error rate (pre-update): 0.12347

size_minibatch = 20000
Precon grad coeff: 0.024953, velocity coeff: 0.909
norm(ch) = 1.1839
iter: 968, Minibatch log likelihood (pre-update): -54.5641, error rate (pre-update): 0.12339

size_minibatch = 20000
Precon grad coeff: 0.022266, velocity coeff: 0.98029
norm(ch) = 1.1676
iter: 969, Minibatch log likelihood (pre-update): -54.5637, error rate (pre-update): 0.1233

size_minibatch = 20000
Precon grad coeff: 0.02791, velocity coeff: 1.1194
norm(ch) = 1.3169
rho = 1.0015
New lambda: 1.0316e-019
iter: 970, Minibatch log likelihood (pre-update): -54.5634, error rate (pre-update): 0.12326
iter: 970, Minibatch log likelihood (post-update): -54.563, error rate (post-update): 0.12321

size_minibatch = 20000
Precon grad coeff: 0.026586, velocity coeff: 0.88872
norm(ch) = 1.1791
iter: 971, Minibatch log likelihood (pre-update): -54.563, error rate (pre-update): 0.12321

size_minibatch = 20000
Precon grad coeff: 0.026369, velocity coeff: 1.0224
norm(ch) = 1.2146
iter: 972, Minibatch log likelihood (pre-update): -54.5626, error rate (pre-update): 0.12313

size_minibatch = 20000
Precon grad coeff: 0.021417, velocity coeff: 0.8409
norm(ch) = 1.028
iter: 973, Minibatch log likelihood (pre-update): -54.5622, error rate (pre-update): 0.12306

size_minibatch = 20000
Precon grad coeff: 0.023774, velocity coeff: 1.1122
norm(ch) = 1.1514
iter: 974, Minibatch log likelihood (pre-update): -54.5619, error rate (pre-update): 0.12297

size_minibatch = 20000
Precon grad coeff: 0.029241, velocity coeff: 1.0794
norm(ch) = 1.2525
rho = 0.9873
New lambda: 7.9824e-020
iter: 975, Minibatch log likelihood (pre-update): -54.5616, error rate (pre-update): 0.12293
iter: 975, Minibatch log likelihood (post-update): -54.5612, error rate (post-update): 0.12287

size_minibatch = 20000
Precon grad coeff: 0.025653, velocity coeff: 0.88649
norm(ch) = 1.1188
iter: 976, Minibatch log likelihood (pre-update): -54.5612, error rate (pre-update): 0.12287

size_minibatch = 20000
Precon grad coeff: 0.02143, velocity coeff: 0.922
norm(ch) = 1.0385
iter: 977, Minibatch log likelihood (pre-update): -54.5609, error rate (pre-update): 0.1228

size_minibatch = 20000
Precon grad coeff: 0.024078, velocity coeff: 1.1133
norm(ch) = 1.1648
iter: 978, Minibatch log likelihood (pre-update): -54.5606, error rate (pre-update): 0.12276

size_minibatch = 20000
Precon grad coeff: 0.024059, velocity coeff: 0.97527
norm(ch) = 1.1433
iter: 979, Minibatch log likelihood (pre-update): -54.5602, error rate (pre-update): 0.12266

size_minibatch = 20000
Precon grad coeff: 0.029622, velocity coeff: 1.0378
New gamma: 0.0031623
norm(ch) = 1.1976
rho = 1.0063
New lambda: 6.1766e-020
iter: 980, Minibatch log likelihood (pre-update): -54.5599, error rate (pre-update): 0.12261
iter: 980, Minibatch log likelihood (post-update): -54.5595, error rate (post-update): 0.12257

size_minibatch = 20000
Precon grad coeff: 0.026805, velocity coeff: 0.92902
norm(ch) = 1.1224
iter: 981, Minibatch log likelihood (pre-update): -54.5595, error rate (pre-update): 0.12257

size_minibatch = 20000
Precon grad coeff: 0.026852, velocity coeff: 1.0499
norm(ch) = 1.1876
iter: 982, Minibatch log likelihood (pre-update): -54.5592, error rate (pre-update): 0.12247

size_minibatch = 20000
Precon grad coeff: 0.026814, velocity coeff: 0.99583
norm(ch) = 1.1916
iter: 983, Minibatch log likelihood (pre-update): -54.5589, error rate (pre-update): 0.12245

size_minibatch = 20000
Precon grad coeff: 0.02563, velocity coeff: 0.98771
norm(ch) = 1.1857
iter: 984, Minibatch log likelihood (pre-update): -54.5585, error rate (pre-update): 0.12239

size_minibatch = 20000
Precon grad coeff: 0.029395, velocity coeff: 1.1058
norm(ch) = 1.3208
rho = 1.0065
New lambda: 4.7794e-020
iter: 985, Minibatch log likelihood (pre-update): -54.5582, error rate (pre-update): 0.12227
iter: 985, Minibatch log likelihood (post-update): -54.5578, error rate (post-update): 0.12221

size_minibatch = 20000
Precon grad coeff: 0.028028, velocity coeff: 0.93328
norm(ch) = 1.2423
iter: 986, Minibatch log likelihood (pre-update): -54.5578, error rate (pre-update): 0.12221

size_minibatch = 20000
Precon grad coeff: 0.025009, velocity coeff: 0.96526
norm(ch) = 1.2072
iter: 987, Minibatch log likelihood (pre-update): -54.5574, error rate (pre-update): 0.12217

size_minibatch = 20000
Precon grad coeff: 0.024085, velocity coeff: 0.9779
norm(ch) = 1.188
iter: 988, Minibatch log likelihood (pre-update): -54.5571, error rate (pre-update): 0.1221

size_minibatch = 20000
Precon grad coeff: 0.026817, velocity coeff: 1.0455
norm(ch) = 1.2503
iter: 989, Minibatch log likelihood (pre-update): -54.5567, error rate (pre-update): 0.12201

size_minibatch = 20000
Precon grad coeff: 0.027282, velocity coeff: 0.96598
norm(ch) = 1.2164
rho = 0.99424
New lambda: 3.6982e-020
iter: 990, Minibatch log likelihood (pre-update): -54.5564, error rate (pre-update): 0.12197
iter: 990, Minibatch log likelihood (post-update): -54.556, error rate (post-update): 0.12191

size_minibatch = 20000
Precon grad coeff: 0.027063, velocity coeff: 0.97524
norm(ch) = 1.1948
iter: 991, Minibatch log likelihood (pre-update): -54.556, error rate (pre-update): 0.12191

size_minibatch = 20000
Precon grad coeff: 0.022878, velocity coeff: 0.85649
norm(ch) = 1.0298
iter: 992, Minibatch log likelihood (pre-update): -54.5557, error rate (pre-update): 0.1218

size_minibatch = 20000
Precon grad coeff: 0.024155, velocity coeff: 1.1095
norm(ch) = 1.1507
iter: 993, Minibatch log likelihood (pre-update): -54.5554, error rate (pre-update): 0.12178

size_minibatch = 20000
Precon grad coeff: 0.027723, velocity coeff: 1.0045
norm(ch) = 1.1642
iter: 994, Minibatch log likelihood (pre-update): -54.555, error rate (pre-update): 0.12173

size_minibatch = 20000
Precon grad coeff: 0.026463, velocity coeff: 0.97661
norm(ch) = 1.1453
rho = 1.0003
New lambda: 2.8616e-020
iter: 995, Minibatch log likelihood (pre-update): -54.5547, error rate (pre-update): 0.12166
iter: 995, Minibatch log likelihood (post-update): -54.5544, error rate (post-update): 0.1216

size_minibatch = 20000
Precon grad coeff: 0.023939, velocity coeff: 0.92557
norm(ch) = 1.0678
iter: 996, Minibatch log likelihood (pre-update): -54.5544, error rate (pre-update): 0.1216

size_minibatch = 20000
Precon grad coeff: 0.024728, velocity coeff: 1.041
norm(ch) = 1.119
iter: 997, Minibatch log likelihood (pre-update): -54.5541, error rate (pre-update): 0.12154

size_minibatch = 20000
Precon grad coeff: 0.022388, velocity coeff: 0.97878
norm(ch) = 1.1024
iter: 998, Minibatch log likelihood (pre-update): -54.5538, error rate (pre-update): 0.1215

size_minibatch = 20000
Precon grad coeff: 0.026159, velocity coeff: 1.0295
norm(ch) = 1.1436
iter: 999, Minibatch log likelihood (pre-update): -54.5534, error rate (pre-update): 0.12142

size_minibatch = 20000
Precon grad coeff: 0.027152, velocity coeff: 0.99718
New gamma: 0.0031623
norm(ch) = 1.1493
rho = 0.99672
New lambda: 2.2142e-020
iter: 1000, Minibatch log likelihood (pre-update): -54.5531, error rate (pre-update): 0.12135
iter: 1000, Minibatch log likelihood (post-update): -54.5528, error rate (post-update): 0.12129
---
Full log-likelihood: -54.5528, error rate: 0.12129
TEST log-likelihood: -54.758, error rate: 0.23819
Error difference (test - train): 0.1169
---
Full log-likelihood (averaged params): -54.7804, error rate (averaged params): 0.19568
TEST log-likelihood (averaged params): -54.8992, error rate (averaged params): 0.2855
Error difference (test - train) (averaged params): 0.089826

size_minibatch = 20000
Precon grad coeff: 0.028064, velocity coeff: 1.0185
norm(ch) = 1.1802
iter: 1001, Minibatch log likelihood (pre-update): -54.5528, error rate (pre-update): 0.12129

size_minibatch = 20000
Precon grad coeff: 0.027949, velocity coeff: 1.0068
norm(ch) = 1.1982
iter: 1002, Minibatch log likelihood (pre-update): -54.5525, error rate (pre-update): 0.12126

size_minibatch = 20000
Precon grad coeff: 0.023917, velocity coeff: 0.91448
norm(ch) = 1.1026
iter: 1003, Minibatch log likelihood (pre-update): -54.5521, error rate (pre-update): 0.12119

size_minibatch = 20000
Precon grad coeff: 0.02562, velocity coeff: 1.1157
norm(ch) = 1.2383
iter: 1004, Minibatch log likelihood (pre-update): -54.5518, error rate (pre-update): 0.1211

size_minibatch = 20000
Precon grad coeff: 0.030594, velocity coeff: 1.0312
norm(ch) = 1.286
rho = 1.0058
New lambda: 1.7133e-020
iter: 1005, Minibatch log likelihood (pre-update): -54.5515, error rate (pre-update): 0.12107
iter: 1005, Minibatch log likelihood (post-update): -54.5511, error rate (post-update): 0.121

size_minibatch = 20000
Precon grad coeff: 0.026813, velocity coeff: 0.94736
norm(ch) = 1.227
iter: 1006, Minibatch log likelihood (pre-update): -54.5511, error rate (pre-update): 0.121

size_minibatch = 20000
Precon grad coeff: 0.026103, velocity coeff: 0.97176
norm(ch) = 1.1999
iter: 1007, Minibatch log likelihood (pre-update): -54.5508, error rate (pre-update): 0.12092

size_minibatch = 20000
Precon grad coeff: 0.023556, velocity coeff: 0.9158
norm(ch) = 1.106
iter: 1008, Minibatch log likelihood (pre-update): -54.5504, error rate (pre-update): 0.12089

size_minibatch = 20000
Precon grad coeff: 0.024774, velocity coeff: 1.034
norm(ch) = 1.1509
iter: 1009, Minibatch log likelihood (pre-update): -54.5501, error rate (pre-update): 0.12081

size_minibatch = 20000
Precon grad coeff: 0.026675, velocity coeff: 1.0037
norm(ch) = 1.1634
rho = 0.98607
New lambda: 1.3257e-020
iter: 1010, Minibatch log likelihood (pre-update): -54.5498, error rate (pre-update): 0.12075
iter: 1010, Minibatch log likelihood (post-update): -54.5495, error rate (post-update): 0.12071

size_minibatch = 20000
Precon grad coeff: 0.025246, velocity coeff: 0.96643
norm(ch) = 1.1317
iter: 1011, Minibatch log likelihood (pre-update): -54.5495, error rate (pre-update): 0.12071

size_minibatch = 20000
Precon grad coeff: 0.02697, velocity coeff: 0.9993
norm(ch) = 1.1388
iter: 1012, Minibatch log likelihood (pre-update): -54.5492, error rate (pre-update): 0.12065

size_minibatch = 20000
Precon grad coeff: 0.025059, velocity coeff: 0.95656
norm(ch) = 1.0966
iter: 1013, Minibatch log likelihood (pre-update): -54.5489, error rate (pre-update): 0.12057

size_minibatch = 20000
Precon grad coeff: 0.023102, velocity coeff: 0.96988
norm(ch) = 1.0706
iter: 1014, Minibatch log likelihood (pre-update): -54.5485, error rate (pre-update): 0.12052

size_minibatch = 20000
Precon grad coeff: 0.023854, velocity coeff: 0.99708
norm(ch) = 1.0746
rho = 0.98657
New lambda: 1.0258e-020
iter: 1015, Minibatch log likelihood (pre-update): -54.5483, error rate (pre-update): 0.12049
iter: 1015, Minibatch log likelihood (post-update): -54.548, error rate (post-update): 0.12042

size_minibatch = 20000
Precon grad coeff: 0.025757, velocity coeff: 1.0964
norm(ch) = 1.1859
iter: 1016, Minibatch log likelihood (pre-update): -54.548, error rate (pre-update): 0.12042

size_minibatch = 20000
Precon grad coeff: 0.027764, velocity coeff: 0.98627
norm(ch) = 1.1778
iter: 1017, Minibatch log likelihood (pre-update): -54.5476, error rate (pre-update): 0.12035

size_minibatch = 20000
Precon grad coeff: 0.023586, velocity coeff: 0.91796
norm(ch) = 1.0875
iter: 1018, Minibatch log likelihood (pre-update): -54.5473, error rate (pre-update): 0.12031

size_minibatch = 20000
Precon grad coeff: 0.024506, velocity coeff: 1.0228
norm(ch) = 1.1199
iter: 1019, Minibatch log likelihood (pre-update): -54.547, error rate (pre-update): 0.12026

size_minibatch = 20000
Precon grad coeff: 0.024905, velocity coeff: 0.94872
New gamma: 0.0031623
norm(ch) = 1.0708
rho = 1.0124
New lambda: 7.9377e-021
iter: 1020, Minibatch log likelihood (pre-update): -54.5467, error rate (pre-update): 0.12021
iter: 1020, Minibatch log likelihood (post-update): -54.5464, error rate (post-update): 0.12014

size_minibatch = 20000
Precon grad coeff: 0.027394, velocity coeff: 1.0489
norm(ch) = 1.1323
iter: 1021, Minibatch log likelihood (pre-update): -54.5464, error rate (pre-update): 0.12014

size_minibatch = 20000
Precon grad coeff: 0.028796, velocity coeff: 1.0334
norm(ch) = 1.1787
iter: 1022, Minibatch log likelihood (pre-update): -54.5461, error rate (pre-update): 0.12009

size_minibatch = 20000
Precon grad coeff: 0.028372, velocity coeff: 0.98246
norm(ch) = 1.1667
iter: 1023, Minibatch log likelihood (pre-update): -54.5458, error rate (pre-update): 0.12003

size_minibatch = 20000
Precon grad coeff: 0.025927, velocity coeff: 0.9647
norm(ch) = 1.1333
iter: 1024, Minibatch log likelihood (pre-update): -54.5455, error rate (pre-update): 0.11999

size_minibatch = 20000
Precon grad coeff: 0.025196, velocity coeff: 1.019
norm(ch) = 1.1625
rho = 1.0012
New lambda: 6.1421e-021
iter: 1025, Minibatch log likelihood (pre-update): -54.5452, error rate (pre-update): 0.11994
iter: 1025, Minibatch log likelihood (post-update): -54.5448, error rate (post-update): 0.11984

size_minibatch = 20000
Precon grad coeff: 0.027796, velocity coeff: 0.99906
norm(ch) = 1.1701
iter: 1026, Minibatch log likelihood (pre-update): -54.5448, error rate (pre-update): 0.11984

size_minibatch = 20000
Precon grad coeff: 0.023274, velocity coeff: 0.99143
norm(ch) = 1.167
iter: 1027, Minibatch log likelihood (pre-update): -54.5445, error rate (pre-update): 0.11982

size_minibatch = 20000
Precon grad coeff: 0.031592, velocity coeff: 1.1111
norm(ch) = 1.3058
iter: 1028, Minibatch log likelihood (pre-update): -54.5442, error rate (pre-update): 0.11977

size_minibatch = 20000
Precon grad coeff: 0.027513, velocity coeff: 0.87599
norm(ch) = 1.1518
iter: 1029, Minibatch log likelihood (pre-update): -54.5439, error rate (pre-update): 0.11971

size_minibatch = 20000
Precon grad coeff: 0.02179, velocity coeff: 0.9216
norm(ch) = 1.0675
rho = 1.0122
New lambda: 4.7526e-021
iter: 1030, Minibatch log likelihood (pre-update): -54.5436, error rate (pre-update): 0.11963
iter: 1030, Minibatch log likelihood (post-update): -54.5433, error rate (post-update): 0.11955

size_minibatch = 20000
Precon grad coeff: 0.026518, velocity coeff: 1.0764
norm(ch) = 1.157
iter: 1031, Minibatch log likelihood (pre-update): -54.5433, error rate (pre-update): 0.11955

size_minibatch = 20000
Precon grad coeff: 0.024351, velocity coeff: 0.94219
norm(ch) = 1.0966
iter: 1032, Minibatch log likelihood (pre-update): -54.543, error rate (pre-update): 0.11954

size_minibatch = 20000
Precon grad coeff: 0.027535, velocity coeff: 1.0235
norm(ch) = 1.1305
iter: 1033, Minibatch log likelihood (pre-update): -54.5427, error rate (pre-update): 0.11949

size_minibatch = 20000
Precon grad coeff: 0.025061, velocity coeff: 0.9473
norm(ch) = 1.0782
iter: 1034, Minibatch log likelihood (pre-update): -54.5424, error rate (pre-update): 0.1194

size_minibatch = 20000
Precon grad coeff: 0.023693, velocity coeff: 0.94963
norm(ch) = 1.03
rho = 0.99998
New lambda: 3.6775e-021
iter: 1035, Minibatch log likelihood (pre-update): -54.5421, error rate (pre-update): 0.11937
iter: 1035, Minibatch log likelihood (post-update): -54.5418, error rate (post-update): 0.11932

size_minibatch = 20000
Precon grad coeff: 0.024307, velocity coeff: 1.0399
norm(ch) = 1.0786
iter: 1036, Minibatch log likelihood (pre-update): -54.5418, error rate (pre-update): 0.11932

size_minibatch = 20000
Precon grad coeff: 0.02377, velocity coeff: 0.96447
norm(ch) = 1.047
iter: 1037, Minibatch log likelihood (pre-update): -54.5415, error rate (pre-update): 0.11927

size_minibatch = 20000
Precon grad coeff: 0.02441, velocity coeff: 1.0513
norm(ch) = 1.1079
iter: 1038, Minibatch log likelihood (pre-update): -54.5412, error rate (pre-update): 0.11922

size_minibatch = 20000
Precon grad coeff: 0.027079, velocity coeff: 1.0344
norm(ch) = 1.1536
iter: 1039, Minibatch log likelihood (pre-update): -54.5409, error rate (pre-update): 0.11919

size_minibatch = 20000
Precon grad coeff: 0.028524, velocity coeff: 0.95733
New gamma: 0.0031623
norm(ch) = 1.1138
rho = 0.99652
New lambda: 2.8456e-021
iter: 1040, Minibatch log likelihood (pre-update): -54.5406, error rate (pre-update): 0.11912
iter: 1040, Minibatch log likelihood (post-update): -54.5403, error rate (post-update): 0.11904

size_minibatch = 20000
Precon grad coeff: 0.023184, velocity coeff: 0.88188
norm(ch) = 0.98925
iter: 1041, Minibatch log likelihood (pre-update): -54.5403, error rate (pre-update): 0.11904

size_minibatch = 20000
Precon grad coeff: 0.02605, velocity coeff: 1.1486
norm(ch) = 1.1442
iter: 1042, Minibatch log likelihood (pre-update): -54.5401, error rate (pre-update): 0.11903

size_minibatch = 20000
Precon grad coeff: 0.031489, velocity coeff: 1.0598
norm(ch) = 1.2222
iter: 1043, Minibatch log likelihood (pre-update): -54.5398, error rate (pre-update): 0.119

size_minibatch = 20000
Precon grad coeff: 0.025729, velocity coeff: 0.8945
norm(ch) = 1.1005
iter: 1044, Minibatch log likelihood (pre-update): -54.5395, error rate (pre-update): 0.1189

size_minibatch = 20000
Precon grad coeff: 0.026002, velocity coeff: 1.0529
norm(ch) = 1.1668
rho = 1.006
New lambda: 2.2018e-021
iter: 1045, Minibatch log likelihood (pre-update): -54.5392, error rate (pre-update): 0.11883
iter: 1045, Minibatch log likelihood (post-update): -54.5389, error rate (post-update): 0.11878

size_minibatch = 20000
Precon grad coeff: 0.025363, velocity coeff: 0.94188
norm(ch) = 1.1058
iter: 1046, Minibatch log likelihood (pre-update): -54.5389, error rate (pre-update): 0.11878

size_minibatch = 20000
Precon grad coeff: 0.023674, velocity coeff: 1.0084
norm(ch) = 1.1224
iter: 1047, Minibatch log likelihood (pre-update): -54.5386, error rate (pre-update): 0.11878

size_minibatch = 20000
Precon grad coeff: 0.02732, velocity coeff: 1.0294
norm(ch) = 1.1626
iter: 1048, Minibatch log likelihood (pre-update): -54.5383, error rate (pre-update): 0.11873

size_minibatch = 20000
Precon grad coeff: 0.025803, velocity coeff: 0.96273
norm(ch) = 1.1269
iter: 1049, Minibatch log likelihood (pre-update): -54.538, error rate (pre-update): 0.11863

size_minibatch = 20000
Precon grad coeff: 0.028128, velocity coeff: 1.0209
norm(ch) = 1.1581
rho = 1.003
New lambda: 1.7037e-021
iter: 1050, Minibatch log likelihood (pre-update): -54.5377, error rate (pre-update): 0.11855
iter: 1050, Minibatch log likelihood (post-update): -54.5374, error rate (post-update): 0.11853
---
Full log-likelihood: -54.5374, error rate: 0.11853
TEST log-likelihood: -54.751, error rate: 0.23799
Error difference (test - train): 0.11946
---
Full log-likelihood (averaged params): -54.7239, error rate (averaged params): 0.18005
TEST log-likelihood (averaged params): -54.8577, error rate (averaged params): 0.27449
Error difference (test - train) (averaged params): 0.094447

size_minibatch = 20000
Precon grad coeff: 0.020841, velocity coeff: 0.84315
norm(ch) = 0.98201
iter: 1051, Minibatch log likelihood (pre-update): -54.5374, error rate (pre-update): 0.11853

size_minibatch = 20000
Precon grad coeff: 0.025453, velocity coeff: 1.1538
norm(ch) = 1.1407
iter: 1052, Minibatch log likelihood (pre-update): -54.5371, error rate (pre-update): 0.11851

size_minibatch = 20000
Precon grad coeff: 0.027006, velocity coeff: 0.94787
norm(ch) = 1.0887
iter: 1053, Minibatch log likelihood (pre-update): -54.5368, error rate (pre-update): 0.11844

size_minibatch = 20000
Precon grad coeff: 0.02609, velocity coeff: 1.0104
norm(ch) = 1.1071
iter: 1054, Minibatch log likelihood (pre-update): -54.5365, error rate (pre-update): 0.1184

size_minibatch = 20000
Precon grad coeff: 0.023472, velocity coeff: 0.88652
norm(ch) = 0.98831
rho = 0.99871
New lambda: 1.3183e-021
iter: 1055, Minibatch log likelihood (pre-update): -54.5362, error rate (pre-update): 0.11835
iter: 1055, Minibatch log likelihood (post-update): -54.536, error rate (post-update): 0.1183

size_minibatch = 20000
Precon grad coeff: 0.021373, velocity coeff: 1.02
norm(ch) = 1.0141
iter: 1056, Minibatch log likelihood (pre-update): -54.536, error rate (pre-update): 0.1183

size_minibatch = 20000
Precon grad coeff: 0.027257, velocity coeff: 1.1044
norm(ch) = 1.1279
iter: 1057, Minibatch log likelihood (pre-update): -54.5357, error rate (pre-update): 0.11826

size_minibatch = 20000
Precon grad coeff: 0.025254, velocity coeff: 0.92662
norm(ch) = 1.0516
iter: 1058, Minibatch log likelihood (pre-update): -54.5354, error rate (pre-update): 0.11818

size_minibatch = 20000
Precon grad coeff: 0.02347, velocity coeff: 0.98893
norm(ch) = 1.0462
iter: 1059, Minibatch log likelihood (pre-update): -54.5352, error rate (pre-update): 0.11815

size_minibatch = 20000
Precon grad coeff: 0.025361, velocity coeff: 0.94909
New gamma: 0.0031623
norm(ch) = 1.0012
rho = 0.98932
New lambda: 1.0201e-021
iter: 1060, Minibatch log likelihood (pre-update): -54.5349, error rate (pre-update): 0.11811
iter: 1060, Minibatch log likelihood (post-update): -54.5346, error rate (post-update): 0.11802

size_minibatch = 20000
Precon grad coeff: 0.026949, velocity coeff: 1.0467
norm(ch) = 1.0571
iter: 1061, Minibatch log likelihood (pre-update): -54.5346, error rate (pre-update): 0.11802

size_minibatch = 20000
Precon grad coeff: 0.025027, velocity coeff: 0.9477
norm(ch) = 1.009
iter: 1062, Minibatch log likelihood (pre-update): -54.5343, error rate (pre-update): 0.11799

size_minibatch = 20000
Precon grad coeff: 0.028795, velocity coeff: 1.1449
norm(ch) = 1.164
iter: 1063, Minibatch log likelihood (pre-update): -54.5341, error rate (pre-update): 0.11798

size_minibatch = 20000
Precon grad coeff: 0.027805, velocity coeff: 0.92796
norm(ch) = 1.0882
iter: 1064, Minibatch log likelihood (pre-update): -54.5338, error rate (pre-update): 0.11793

size_minibatch = 20000
Precon grad coeff: 0.024036, velocity coeff: 0.98492
norm(ch) = 1.079
rho = 1.0101
New lambda: 7.8933e-022
iter: 1065, Minibatch log likelihood (pre-update): -54.5335, error rate (pre-update): 0.11786
iter: 1065, Minibatch log likelihood (post-update): -54.5332, error rate (post-update): 0.11783

size_minibatch = 20000
Precon grad coeff: 0.028104, velocity coeff: 1.0989
norm(ch) = 1.1937
iter: 1066, Minibatch log likelihood (pre-update): -54.5332, error rate (pre-update): 0.11783

size_minibatch = 20000
Precon grad coeff: 0.024084, velocity coeff: 0.89214
norm(ch) = 1.0716
iter: 1067, Minibatch log likelihood (pre-update): -54.5329, error rate (pre-update): 0.11776

size_minibatch = 20000
Precon grad coeff: 0.025017, velocity coeff: 1.0589
norm(ch) = 1.1419
iter: 1068, Minibatch log likelihood (pre-update): -54.5326, error rate (pre-update): 0.11769

size_minibatch = 20000
Precon grad coeff: 0.026579, velocity coeff: 0.99385
norm(ch) = 1.1422
iter: 1069, Minibatch log likelihood (pre-update): -54.5323, error rate (pre-update): 0.11769

size_minibatch = 20000
Precon grad coeff: 0.024668, velocity coeff: 0.91991
norm(ch) = 1.0575
rho = 1.0066
New lambda: 6.1077e-022
iter: 1070, Minibatch log likelihood (pre-update): -54.532, error rate (pre-update): 0.1176
iter: 1070, Minibatch log likelihood (post-update): -54.5318, error rate (post-update): 0.11753

size_minibatch = 20000
Precon grad coeff: 0.027019, velocity coeff: 1.0718
norm(ch) = 1.1407
iter: 1071, Minibatch log likelihood (pre-update): -54.5318, error rate (pre-update): 0.11753

size_minibatch = 20000
Precon grad coeff: 0.022286, velocity coeff: 0.82493
norm(ch) = 0.94662
iter: 1072, Minibatch log likelihood (pre-update): -54.5315, error rate (pre-update): 0.11755

size_minibatch = 20000
Precon grad coeff: 0.024019, velocity coeff: 1.0962
norm(ch) = 1.0445
iter: 1073, Minibatch log likelihood (pre-update): -54.5312, error rate (pre-update): 0.11748

size_minibatch = 20000
Precon grad coeff: 0.025456, velocity coeff: 0.98896
norm(ch) = 1.0395
iter: 1074, Minibatch log likelihood (pre-update): -54.531, error rate (pre-update): 0.1174

size_minibatch = 20000
Precon grad coeff: 0.025871, velocity coeff: 1.0113
norm(ch) = 1.0586
rho = 1.0036
New lambda: 4.726e-022
iter: 1075, Minibatch log likelihood (pre-update): -54.5307, error rate (pre-update): 0.11736
iter: 1075, Minibatch log likelihood (post-update): -54.5304, error rate (post-update): 0.11732

size_minibatch = 20000
Precon grad coeff: 0.026929, velocity coeff: 0.98887
norm(ch) = 1.0536
iter: 1076, Minibatch log likelihood (pre-update): -54.5304, error rate (pre-update): 0.11732

size_minibatch = 20000
Precon grad coeff: 0.02112, velocity coeff: 0.90179
norm(ch) = 0.95585
iter: 1077, Minibatch log likelihood (pre-update): -54.5302, error rate (pre-update): 0.1173

size_minibatch = 20000
Precon grad coeff: 0.023865, velocity coeff: 1.0798
norm(ch) = 1.0385
iter: 1078, Minibatch log likelihood (pre-update): -54.5299, error rate (pre-update): 0.11725

size_minibatch = 20000
Precon grad coeff: 0.024959, velocity coeff: 1.0238
norm(ch) = 1.0698
iter: 1079, Minibatch log likelihood (pre-update): -54.5297, error rate (pre-update): 0.1172

size_minibatch = 20000
Precon grad coeff: 0.027543, velocity coeff: 0.97942
New gamma: 0.0031623
norm(ch) = 1.0566
rho = 1.0068
New lambda: 3.6569e-022
iter: 1080, Minibatch log likelihood (pre-update): -54.5294, error rate (pre-update): 0.11712
iter: 1080, Minibatch log likelihood (post-update): -54.5291, error rate (post-update): 0.11712

size_minibatch = 20000
Precon grad coeff: 0.027688, velocity coeff: 1.019
norm(ch) = 1.0851
iter: 1081, Minibatch log likelihood (pre-update): -54.5291, error rate (pre-update): 0.11712

size_minibatch = 20000
Precon grad coeff: 0.026687, velocity coeff: 0.99363
norm(ch) = 1.0852
iter: 1082, Minibatch log likelihood (pre-update): -54.5289, error rate (pre-update): 0.11709

size_minibatch = 20000
Precon grad coeff: 0.025346, velocity coeff: 0.95341
norm(ch) = 1.0416
iter: 1083, Minibatch log likelihood (pre-update): -54.5286, error rate (pre-update): 0.117

size_minibatch = 20000
Precon grad coeff: 0.024339, velocity coeff: 1.035
norm(ch) = 1.0848
iter: 1084, Minibatch log likelihood (pre-update): -54.5283, error rate (pre-update): 0.11697

size_minibatch = 20000
Precon grad coeff: 0.030387, velocity coeff: 1.1121
norm(ch) = 1.2149
rho = 1.0071
New lambda: 2.8296e-022
iter: 1085, Minibatch log likelihood (pre-update): -54.528, error rate (pre-update): 0.11691
iter: 1085, Minibatch log likelihood (post-update): -54.5277, error rate (post-update): 0.11686

size_minibatch = 20000
Precon grad coeff: 0.026894, velocity coeff: 0.89059
norm(ch) = 1.0895
iter: 1086, Minibatch log likelihood (pre-update): -54.5277, error rate (pre-update): 0.11686

size_minibatch = 20000
Precon grad coeff: 0.02561, velocity coeff: 1.0219
norm(ch) = 1.1205
iter: 1087, Minibatch log likelihood (pre-update): -54.5275, error rate (pre-update): 0.11683

size_minibatch = 20000
Precon grad coeff: 0.025481, velocity coeff: 0.96324
norm(ch) = 1.0859
iter: 1088, Minibatch log likelihood (pre-update): -54.5272, error rate (pre-update): 0.11678

size_minibatch = 20000
Precon grad coeff: 0.025546, velocity coeff: 0.97247
norm(ch) = 1.0627
iter: 1089, Minibatch log likelihood (pre-update): -54.5269, error rate (pre-update): 0.11672

size_minibatch = 20000
Precon grad coeff: 0.023808, velocity coeff: 0.98297
norm(ch) = 1.0508
rho = 1.0034
New lambda: 2.1895e-022
iter: 1090, Minibatch log likelihood (pre-update): -54.5267, error rate (pre-update): 0.11669
iter: 1090, Minibatch log likelihood (post-update): -54.5264, error rate (post-update): 0.11666

size_minibatch = 20000
Precon grad coeff: 0.026016, velocity coeff: 0.99994
norm(ch) = 1.0572
iter: 1091, Minibatch log likelihood (pre-update): -54.5264, error rate (pre-update): 0.11666

size_minibatch = 20000
Precon grad coeff: 0.025729, velocity coeff: 0.99802
norm(ch) = 1.0623
iter: 1092, Minibatch log likelihood (pre-update): -54.5261, error rate (pre-update): 0.11658

size_minibatch = 20000
Precon grad coeff: 0.024925, velocity coeff: 0.98019
norm(ch) = 1.0474
iter: 1093, Minibatch log likelihood (pre-update): -54.5259, error rate (pre-update): 0.11654

size_minibatch = 20000
Precon grad coeff: 0.026478, velocity coeff: 0.99929
norm(ch) = 1.0535
iter: 1094, Minibatch log likelihood (pre-update): -54.5256, error rate (pre-update): 0.11648

size_minibatch = 20000
Precon grad coeff: 0.023578, velocity coeff: 0.92156
norm(ch) = 0.97734
rho = 0.99217
New lambda: 1.6942e-022
iter: 1095, Minibatch log likelihood (pre-update): -54.5254, error rate (pre-update): 0.11644
iter: 1095, Minibatch log likelihood (post-update): -54.5251, error rate (post-update): 0.11644

size_minibatch = 20000
Precon grad coeff: 0.023895, velocity coeff: 1.0516
norm(ch) = 1.0341
iter: 1096, Minibatch log likelihood (pre-update): -54.5251, error rate (pre-update): 0.11644

size_minibatch = 20000
Precon grad coeff: 0.025023, velocity coeff: 1.0081
norm(ch) = 1.0491
iter: 1097, Minibatch log likelihood (pre-update): -54.5249, error rate (pre-update): 0.11636

size_minibatch = 20000
Precon grad coeff: 0.023165, velocity coeff: 0.97441
norm(ch) = 1.0275
iter: 1098, Minibatch log likelihood (pre-update): -54.5246, error rate (pre-update): 0.11632

size_minibatch = 20000
Precon grad coeff: 0.026434, velocity coeff: 1.0535
norm(ch) = 1.09
iter: 1099, Minibatch log likelihood (pre-update): -54.5244, error rate (pre-update): 0.11629

size_minibatch = 20000
Precon grad coeff: 0.028281, velocity coeff: 0.97399
New gamma: 0.0031623
norm(ch) = 1.0692
rho = 1.0015
New lambda: 1.3109e-022
iter: 1100, Minibatch log likelihood (pre-update): -54.5241, error rate (pre-update): 0.11625
iter: 1100, Minibatch log likelihood (post-update): -54.5238, error rate (post-update): 0.1162
---
Full log-likelihood: -54.5238, error rate: 0.1162
TEST log-likelihood: -54.746, error rate: 0.23792
Error difference (test - train): 0.12172
---
Full log-likelihood (averaged params): -54.681, error rate (averaged params): 0.16827
TEST log-likelihood (averaged params): -54.8285, error rate (averaged params): 0.26687
Error difference (test - train) (averaged params): 0.098598

size_minibatch = 20000
Precon grad coeff: 0.027858, velocity coeff: 0.93093
norm(ch) = 1.0034
iter: 1101, Minibatch log likelihood (pre-update): -54.5238, error rate (pre-update): 0.1162

size_minibatch = 20000
Precon grad coeff: 0.025271, velocity coeff: 1.0236
norm(ch) = 1.034
iter: 1102, Minibatch log likelihood (pre-update): -54.5236, error rate (pre-update): 0.11615

size_minibatch = 20000
Precon grad coeff: 0.026439, velocity coeff: 0.96107
norm(ch) = 1.0009
iter: 1103, Minibatch log likelihood (pre-update): -54.5233, error rate (pre-update): 0.11612

size_minibatch = 20000
Precon grad coeff: 0.026413, velocity coeff: 1.0896
norm(ch) = 1.0978
iter: 1104, Minibatch log likelihood (pre-update): -54.5231, error rate (pre-update): 0.11604

size_minibatch = 20000
Precon grad coeff: 0.029746, velocity coeff: 1.0235
norm(ch) = 1.1316
rho = 1.0127
New lambda: 1.0144e-022
iter: 1105, Minibatch log likelihood (pre-update): -54.5228, error rate (pre-update): 0.116
iter: 1105, Minibatch log likelihood (post-update): -54.5225, error rate (post-update): 0.11597

size_minibatch = 20000
Precon grad coeff: 0.028803, velocity coeff: 0.97969
norm(ch) = 1.1162
iter: 1106, Minibatch log likelihood (pre-update): -54.5225, error rate (pre-update): 0.11597

size_minibatch = 20000
Precon grad coeff: 0.025917, velocity coeff: 0.99076
norm(ch) = 1.1128
iter: 1107, Minibatch log likelihood (pre-update): -54.5222, error rate (pre-update): 0.11592

size_minibatch = 20000
Precon grad coeff: 0.026524, velocity coeff: 0.98909
norm(ch) = 1.1078
iter: 1108, Minibatch log likelihood (pre-update): -54.522, error rate (pre-update): 0.11588

size_minibatch = 20000
Precon grad coeff: 0.024875, velocity coeff: 0.94336
norm(ch) = 1.052
iter: 1109, Minibatch log likelihood (pre-update): -54.5217, error rate (pre-update): 0.11582

size_minibatch = 20000
Precon grad coeff: 0.024885, velocity coeff: 1.0614
norm(ch) = 1.1226
rho = 0.99496
New lambda: 7.8491e-023
iter: 1110, Minibatch log likelihood (pre-update): -54.5214, error rate (pre-update): 0.11579
iter: 1110, Minibatch log likelihood (post-update): -54.5212, error rate (post-update): 0.11572

size_minibatch = 20000
Precon grad coeff: 0.02639, velocity coeff: 0.95784
norm(ch) = 1.0818
iter: 1111, Minibatch log likelihood (pre-update): -54.5212, error rate (pre-update): 0.11572

size_minibatch = 20000
Precon grad coeff: 0.024877, velocity coeff: 0.92917
norm(ch) = 1.0115
iter: 1112, Minibatch log likelihood (pre-update): -54.5209, error rate (pre-update): 0.11569

size_minibatch = 20000
Precon grad coeff: 0.025744, velocity coeff: 1.0761
norm(ch) = 1.0946
iter: 1113, Minibatch log likelihood (pre-update): -54.5207, error rate (pre-update): 0.11567

size_minibatch = 20000
Precon grad coeff: 0.02789, velocity coeff: 0.96015
norm(ch) = 1.0578
iter: 1114, Minibatch log likelihood (pre-update): -54.5204, error rate (pre-update): 0.1156

size_minibatch = 20000
Precon grad coeff: 0.025721, velocity coeff: 0.96262
norm(ch) = 1.0243
rho = 1.0025
New lambda: 6.0735e-023
iter: 1115, Minibatch log likelihood (pre-update): -54.5201, error rate (pre-update): 0.11555
iter: 1115, Minibatch log likelihood (post-update): -54.5199, error rate (post-update): 0.11551

size_minibatch = 20000
Precon grad coeff: 0.023644, velocity coeff: 0.93491
norm(ch) = 0.96326
iter: 1116, Minibatch log likelihood (pre-update): -54.5199, error rate (pre-update): 0.11551

size_minibatch = 20000
Precon grad coeff: 0.024539, velocity coeff: 1.0566
norm(ch) = 1.0244
iter: 1117, Minibatch log likelihood (pre-update): -54.5197, error rate (pre-update): 0.11548

size_minibatch = 20000
Precon grad coeff: 0.023113, velocity coeff: 0.94339
norm(ch) = 0.97228
iter: 1118, Minibatch log likelihood (pre-update): -54.5194, error rate (pre-update): 0.11542

size_minibatch = 20000
Precon grad coeff: 0.02502, velocity coeff: 1.0829
norm(ch) = 1.0593
iter: 1119, Minibatch log likelihood (pre-update): -54.5192, error rate (pre-update): 0.11539

size_minibatch = 20000
Precon grad coeff: 0.029886, velocity coeff: 1.0155
New gamma: 0.0031623
norm(ch) = 1.0842
rho = 1.0005
New lambda: 4.6996e-023
iter: 1120, Minibatch log likelihood (pre-update): -54.5189, error rate (pre-update): 0.11535
iter: 1120, Minibatch log likelihood (post-update): -54.5187, error rate (post-update): 0.1153

size_minibatch = 20000
Precon grad coeff: 0.028994, velocity coeff: 0.98514
norm(ch) = 1.0761
iter: 1121, Minibatch log likelihood (pre-update): -54.5187, error rate (pre-update): 0.1153

size_minibatch = 20000
Precon grad coeff: 0.026434, velocity coeff: 1.0184
norm(ch) = 1.1027
iter: 1122, Minibatch log likelihood (pre-update): -54.5184, error rate (pre-update): 0.11523

size_minibatch = 20000
Precon grad coeff: 0.02867, velocity coeff: 0.99074
norm(ch) = 1.0997
iter: 1123, Minibatch log likelihood (pre-update): -54.5181, error rate (pre-update): 0.1152

size_minibatch = 20000
Precon grad coeff: 0.024773, velocity coeff: 0.97357
norm(ch) = 1.0771
iter: 1124, Minibatch log likelihood (pre-update): -54.5179, error rate (pre-update): 0.11518

size_minibatch = 20000
Precon grad coeff: 0.024037, velocity coeff: 0.95355
norm(ch) = 1.0331
rho = 1.0089
New lambda: 3.6364e-023
iter: 1125, Minibatch log likelihood (pre-update): -54.5176, error rate (pre-update): 0.11511
iter: 1125, Minibatch log likelihood (post-update): -54.5174, error rate (post-update): 0.11509

size_minibatch = 20000
Precon grad coeff: 0.02635, velocity coeff: 1.1023
norm(ch) = 1.1454
iter: 1126, Minibatch log likelihood (pre-update): -54.5174, error rate (pre-update): 0.11509

size_minibatch = 20000
Precon grad coeff: 0.025391, velocity coeff: 0.93354
norm(ch) = 1.076
iter: 1127, Minibatch log likelihood (pre-update): -54.5171, error rate (pre-update): 0.11504

size_minibatch = 20000
Precon grad coeff: 0.027067, velocity coeff: 1.0125
norm(ch) = 1.0961
iter: 1128, Minibatch log likelihood (pre-update): -54.5168, error rate (pre-update): 0.11497

size_minibatch = 20000
Precon grad coeff: 0.026236, velocity coeff: 0.98011
norm(ch) = 1.081
iter: 1129, Minibatch log likelihood (pre-update): -54.5166, error rate (pre-update): 0.11492

size_minibatch = 20000
Precon grad coeff: 0.028444, velocity coeff: 0.98917
norm(ch) = 1.0757
rho = 1.0004
New lambda: 2.8138e-023
iter: 1130, Minibatch log likelihood (pre-update): -54.5163, error rate (pre-update): 0.11489
iter: 1130, Minibatch log likelihood (post-update): -54.5161, error rate (post-update): 0.11484

size_minibatch = 20000
Precon grad coeff: 0.02443, velocity coeff: 0.92444
norm(ch) = 1.0006
iter: 1131, Minibatch log likelihood (pre-update): -54.5161, error rate (pre-update): 0.11484

size_minibatch = 20000
Precon grad coeff: 0.023305, velocity coeff: 0.97562
norm(ch) = 0.98198
iter: 1132, Minibatch log likelihood (pre-update): -54.5158, error rate (pre-update): 0.1148

size_minibatch = 20000
Precon grad coeff: 0.024194, velocity coeff: 1.0257
norm(ch) = 1.013
iter: 1133, Minibatch log likelihood (pre-update): -54.5156, error rate (pre-update): 0.11477

size_minibatch = 20000
Precon grad coeff: 0.023619, velocity coeff: 0.98012
norm(ch) = 0.99832
iter: 1134, Minibatch log likelihood (pre-update): -54.5154, error rate (pre-update): 0.1147

size_minibatch = 20000
Precon grad coeff: 0.026191, velocity coeff: 1.0601
norm(ch) = 1.0651
rho = 0.99697
New lambda: 2.1773e-023
iter: 1135, Minibatch log likelihood (pre-update): -54.5151, error rate (pre-update): 0.11469
iter: 1135, Minibatch log likelihood (post-update): -54.5149, error rate (post-update): 0.11465

size_minibatch = 20000
Precon grad coeff: 0.026401, velocity coeff: 0.99754
norm(ch) = 1.0687
iter: 1136, Minibatch log likelihood (pre-update): -54.5149, error rate (pre-update): 0.11465

size_minibatch = 20000
Precon grad coeff: 0.025646, velocity coeff: 0.97961
norm(ch) = 1.0533
iter: 1137, Minibatch log likelihood (pre-update): -54.5146, error rate (pre-update): 0.11457

size_minibatch = 20000
Precon grad coeff: 0.024996, velocity coeff: 0.98531
norm(ch) = 1.0433
iter: 1138, Minibatch log likelihood (pre-update): -54.5144, error rate (pre-update): 0.11456

size_minibatch = 20000
Precon grad coeff: 0.024371, velocity coeff: 1.0016
norm(ch) = 1.0512
iter: 1139, Minibatch log likelihood (pre-update): -54.5141, error rate (pre-update): 0.11451

size_minibatch = 20000
Precon grad coeff: 0.025481, velocity coeff: 0.91753
New gamma: 0.0031623
norm(ch) = 0.97131
rho = 1.0161
New lambda: 1.6847e-023
iter: 1140, Minibatch log likelihood (pre-update): -54.5139, error rate (pre-update): 0.11445
iter: 1140, Minibatch log likelihood (post-update): -54.5137, error rate (post-update): 0.11441

size_minibatch = 20000
Precon grad coeff: 0.024209, velocity coeff: 1.0029
norm(ch) = 0.98067
iter: 1141, Minibatch log likelihood (pre-update): -54.5137, error rate (pre-update): 0.11441

size_minibatch = 20000
Precon grad coeff: 0.028327, velocity coeff: 1.0731
norm(ch) = 1.0596
iter: 1142, Minibatch log likelihood (pre-update): -54.5134, error rate (pre-update): 0.11438

size_minibatch = 20000
Precon grad coeff: 0.028044, velocity coeff: 1.0057
norm(ch) = 1.0724
iter: 1143, Minibatch log likelihood (pre-update): -54.5132, error rate (pre-update): 0.11433

size_minibatch = 20000
Precon grad coeff: 0.026873, velocity coeff: 0.97836
norm(ch) = 1.0557
iter: 1144, Minibatch log likelihood (pre-update): -54.5129, error rate (pre-update): 0.11429

size_minibatch = 20000
Precon grad coeff: 0.028828, velocity coeff: 1.0743
norm(ch) = 1.1422
rho = 0.99923
New lambda: 1.3036e-023
iter: 1145, Minibatch log likelihood (pre-update): -54.5127, error rate (pre-update): 0.11423
iter: 1145, Minibatch log likelihood (post-update): -54.5124, error rate (post-update): 0.11421

size_minibatch = 20000
Precon grad coeff: 0.027734, velocity coeff: 0.9529
norm(ch) = 1.0951
iter: 1146, Minibatch log likelihood (pre-update): -54.5124, error rate (pre-update): 0.11421

size_minibatch = 20000
Precon grad coeff: 0.0228, velocity coeff: 0.94466
norm(ch) = 1.0403
iter: 1147, Minibatch log likelihood (pre-update): -54.5122, error rate (pre-update): 0.11418

size_minibatch = 20000
Precon grad coeff: 0.02631, velocity coeff: 1.0603
norm(ch) = 1.1091
iter: 1148, Minibatch log likelihood (pre-update): -54.5119, error rate (pre-update): 0.11411

size_minibatch = 20000
Precon grad coeff: 0.025134, velocity coeff: 0.95172
norm(ch) = 1.0615
iter: 1149, Minibatch log likelihood (pre-update): -54.5117, error rate (pre-update): 0.11406

size_minibatch = 20000
Precon grad coeff: 0.025251, velocity coeff: 1.003
norm(ch) = 1.071
rho = 1.0111
New lambda: 1.0087e-023
iter: 1150, Minibatch log likelihood (pre-update): -54.5114, error rate (pre-update): 0.11402
iter: 1150, Minibatch log likelihood (post-update): -54.5112, error rate (post-update): 0.11398
---
Full log-likelihood: -54.5112, error rate: 0.11398
TEST log-likelihood: -54.7427, error rate: 0.23818
Error difference (test - train): 0.12421
---
Full log-likelihood (averaged params): -54.6459, error rate (averaged params): 0.15879
TEST log-likelihood (averaged params): -54.8068, error rate (averaged params): 0.26132
Error difference (test - train) (averaged params): 0.10253

size_minibatch = 20000
Precon grad coeff: 0.025299, velocity coeff: 0.97046
norm(ch) = 1.0453
iter: 1151, Minibatch log likelihood (pre-update): -54.5112, error rate (pre-update): 0.11398

size_minibatch = 20000
Precon grad coeff: 0.027932, velocity coeff: 1.0518
norm(ch) = 1.1059
iter: 1152, Minibatch log likelihood (pre-update): -54.5109, error rate (pre-update): 0.11392

size_minibatch = 20000
Precon grad coeff: 0.025601, velocity coeff: 0.89834
norm(ch) = 0.99925
iter: 1153, Minibatch log likelihood (pre-update): -54.5107, error rate (pre-update): 0.11391

size_minibatch = 20000
Precon grad coeff: 0.02368, velocity coeff: 0.99394
norm(ch) = 0.999
iter: 1154, Minibatch log likelihood (pre-update): -54.5104, error rate (pre-update): 0.11384

size_minibatch = 20000
Precon grad coeff: 0.025406, velocity coeff: 0.99001
norm(ch) = 0.99465
rho = 0.99599
New lambda: 7.8052e-024
iter: 1155, Minibatch log likelihood (pre-update): -54.5102, error rate (pre-update): 0.11378
iter: 1155, Minibatch log likelihood (post-update): -54.51, error rate (post-update): 0.11378

size_minibatch = 20000
Precon grad coeff: 0.02277, velocity coeff: 0.9512
norm(ch) = 0.95168
iter: 1156, Minibatch log likelihood (pre-update): -54.51, error rate (pre-update): 0.11378

size_minibatch = 20000
Precon grad coeff: 0.023076, velocity coeff: 1.0295
norm(ch) = 0.98546
iter: 1157, Minibatch log likelihood (pre-update): -54.5098, error rate (pre-update): 0.11373

size_minibatch = 20000
Precon grad coeff: 0.027886, velocity coeff: 1.1013
norm(ch) = 1.092
iter: 1158, Minibatch log likelihood (pre-update): -54.5095, error rate (pre-update): 0.11368

size_minibatch = 20000
Precon grad coeff: 0.026515, velocity coeff: 0.94233
norm(ch) = 1.0349
iter: 1159, Minibatch log likelihood (pre-update): -54.5093, error rate (pre-update): 0.11363

size_minibatch = 20000
Precon grad coeff: 0.025308, velocity coeff: 0.96958
New gamma: 0.0031623
norm(ch) = 1.0102
rho = 0.99678
New lambda: 6.0395e-024
iter: 1160, Minibatch log likelihood (pre-update): -54.5091, error rate (pre-update): 0.11358
iter: 1160, Minibatch log likelihood (post-update): -54.5088, error rate (post-update): 0.11355

size_minibatch = 20000
Precon grad coeff: 0.028906, velocity coeff: 1.0905
norm(ch) = 1.1092
iter: 1161, Minibatch log likelihood (pre-update): -54.5088, error rate (pre-update): 0.11355

size_minibatch = 20000
Precon grad coeff: 0.024909, velocity coeff: 0.9183
norm(ch) = 1.0246
iter: 1162, Minibatch log likelihood (pre-update): -54.5086, error rate (pre-update): 0.11351

size_minibatch = 20000
Precon grad coeff: 0.024047, velocity coeff: 1.0098
norm(ch) = 1.0403
iter: 1163, Minibatch log likelihood (pre-update): -54.5083, error rate (pre-update): 0.11348

size_minibatch = 20000
Precon grad coeff: 0.024712, velocity coeff: 1.0271
norm(ch) = 1.0747
iter: 1164, Minibatch log likelihood (pre-update): -54.5081, error rate (pre-update): 0.1134

size_minibatch = 20000
Precon grad coeff: 0.028721, velocity coeff: 1.0579
norm(ch) = 1.1435
rho = 1.0029
New lambda: 4.6733e-024
iter: 1165, Minibatch log likelihood (pre-update): -54.5079, error rate (pre-update): 0.11336
iter: 1165, Minibatch log likelihood (post-update): -54.5076, error rate (post-update): 0.11335

size_minibatch = 20000
Precon grad coeff: 0.024867, velocity coeff: 0.91303
norm(ch) = 1.0503
iter: 1166, Minibatch log likelihood (pre-update): -54.5076, error rate (pre-update): 0.11335

size_minibatch = 20000
Precon grad coeff: 0.026121, velocity coeff: 1.0174
norm(ch) = 1.0751
iter: 1167, Minibatch log likelihood (pre-update): -54.5074, error rate (pre-update): 0.11328

size_minibatch = 20000
Precon grad coeff: 0.026553, velocity coeff: 0.99006
norm(ch) = 1.0704
iter: 1168, Minibatch log likelihood (pre-update): -54.5071, error rate (pre-update): 0.11324

size_minibatch = 20000
Precon grad coeff: 0.025318, velocity coeff: 0.94836
norm(ch) = 1.0211
iter: 1169, Minibatch log likelihood (pre-update): -54.5069, error rate (pre-update): 0.11319

size_minibatch = 20000
Precon grad coeff: 0.021932, velocity coeff: 0.90711
norm(ch) = 0.93134
rho = 0.98285
New lambda: 3.6161e-024
iter: 1170, Minibatch log likelihood (pre-update): -54.5067, error rate (pre-update): 0.11314
iter: 1170, Minibatch log likelihood (post-update): -54.5065, error rate (post-update): 0.11311

size_minibatch = 20000
Precon grad coeff: 0.024942, velocity coeff: 1.0933
norm(ch) = 1.0241
iter: 1171, Minibatch log likelihood (pre-update): -54.5065, error rate (pre-update): 0.11311

size_minibatch = 20000
Precon grad coeff: 0.024287, velocity coeff: 0.96651
norm(ch) = 0.99578
iter: 1172, Minibatch log likelihood (pre-update): -54.5062, error rate (pre-update): 0.11309

size_minibatch = 20000
Precon grad coeff: 0.026557, velocity coeff: 1.0492
norm(ch) = 1.0507
iter: 1173, Minibatch log likelihood (pre-update): -54.506, error rate (pre-update): 0.11303

size_minibatch = 20000
Precon grad coeff: 0.026681, velocity coeff: 0.99002
norm(ch) = 1.0465
iter: 1174, Minibatch log likelihood (pre-update): -54.5058, error rate (pre-update): 0.11298

size_minibatch = 20000
Precon grad coeff: 0.023855, velocity coeff: 0.94833
norm(ch) = 0.99752
rho = 1.0097
New lambda: 2.798e-024
iter: 1175, Minibatch log likelihood (pre-update): -54.5055, error rate (pre-update): 0.11294
iter: 1175, Minibatch log likelihood (post-update): -54.5053, error rate (post-update): 0.11289

size_minibatch = 20000
Precon grad coeff: 0.026297, velocity coeff: 1.0507
norm(ch) = 1.0547
iter: 1176, Minibatch log likelihood (pre-update): -54.5053, error rate (pre-update): 0.11289

size_minibatch = 20000
Precon grad coeff: 0.02153, velocity coeff: 0.88643
norm(ch) = 0.93991
iter: 1177, Minibatch log likelihood (pre-update): -54.5051, error rate (pre-update): 0.11286

size_minibatch = 20000
Precon grad coeff: 0.023571, velocity coeff: 1.0675
norm(ch) = 1.0089
iter: 1178, Minibatch log likelihood (pre-update): -54.5049, error rate (pre-update): 0.11283

size_minibatch = 20000
Precon grad coeff: 0.022182, velocity coeff: 0.9902
norm(ch) = 1.0039
iter: 1179, Minibatch log likelihood (pre-update): -54.5047, error rate (pre-update): 0.11279

size_minibatch = 20000
Precon grad coeff: 0.029096, velocity coeff: 1.05
New gamma: 0.0031623
norm(ch) = 1.0621
rho = 0.98868
New lambda: 2.1651e-024
iter: 1180, Minibatch log likelihood (pre-update): -54.5044, error rate (pre-update): 0.11273
iter: 1180, Minibatch log likelihood (post-update): -54.5042, error rate (post-update): 0.1127

size_minibatch = 20000
Precon grad coeff: 0.028272, velocity coeff: 0.97119
norm(ch) = 1.0382
iter: 1181, Minibatch log likelihood (pre-update): -54.5042, error rate (pre-update): 0.1127

size_minibatch = 20000
Precon grad coeff: 0.025549, velocity coeff: 0.96895
norm(ch) = 1.0125
iter: 1182, Minibatch log likelihood (pre-update): -54.504, error rate (pre-update): 0.11266

size_minibatch = 20000
Precon grad coeff: 0.029517, velocity coeff: 1.107
norm(ch) = 1.1272
iter: 1183, Minibatch log likelihood (pre-update): -54.5037, error rate (pre-update): 0.1126

size_minibatch = 20000
Precon grad coeff: 0.028882, velocity coeff: 0.96461
norm(ch) = 1.0942
iter: 1184, Minibatch log likelihood (pre-update): -54.5035, error rate (pre-update): 0.11254

size_minibatch = 20000
Precon grad coeff: 0.0246, velocity coeff: 0.93729
norm(ch) = 1.031
rho = 1.0078
New lambda: 1.6753e-024
iter: 1185, Minibatch log likelihood (pre-update): -54.5033, error rate (pre-update): 0.11251
iter: 1185, Minibatch log likelihood (post-update): -54.503, error rate (post-update): 0.11249

size_minibatch = 20000
Precon grad coeff: 0.026892, velocity coeff: 1.0888
norm(ch) = 1.1293
iter: 1186, Minibatch log likelihood (pre-update): -54.503, error rate (pre-update): 0.11249

size_minibatch = 20000
Precon grad coeff: 0.026158, velocity coeff: 0.92842
norm(ch) = 1.054
iter: 1187, Minibatch log likelihood (pre-update): -54.5028, error rate (pre-update): 0.11243

size_minibatch = 20000
Precon grad coeff: 0.024932, velocity coeff: 1.03
norm(ch) = 1.0914
iter: 1188, Minibatch log likelihood (pre-update): -54.5026, error rate (pre-update): 0.11239

size_minibatch = 20000
Precon grad coeff: 0.028979, velocity coeff: 0.99001
norm(ch) = 1.0869
iter: 1189, Minibatch log likelihood (pre-update): -54.5023, error rate (pre-update): 0.11235

size_minibatch = 20000
Precon grad coeff: 0.027502, velocity coeff: 1.0103
norm(ch) = 1.1042
rho = 1.0003
New lambda: 1.2963e-024
iter: 1190, Minibatch log likelihood (pre-update): -54.5021, error rate (pre-update): 0.1123
iter: 1190, Minibatch log likelihood (post-update): -54.5018, error rate (post-update): 0.11226

size_minibatch = 20000
Precon grad coeff: 0.025545, velocity coeff: 0.896
norm(ch) = 0.995
iter: 1191, Minibatch log likelihood (pre-update): -54.5018, error rate (pre-update): 0.11226

size_minibatch = 20000
Precon grad coeff: 0.025571, velocity coeff: 1.0352
norm(ch) = 1.0358
iter: 1192, Minibatch log likelihood (pre-update): -54.5016, error rate (pre-update): 0.11223

size_minibatch = 20000
Precon grad coeff: 0.026584, velocity coeff: 0.98601
norm(ch) = 1.027
iter: 1193, Minibatch log likelihood (pre-update): -54.5014, error rate (pre-update): 0.11218

size_minibatch = 20000
Precon grad coeff: 0.024411, velocity coeff: 0.95471
norm(ch) = 0.9858
iter: 1194, Minibatch log likelihood (pre-update): -54.5012, error rate (pre-update): 0.11212

size_minibatch = 20000
Precon grad coeff: 0.024599, velocity coeff: 1.0115
norm(ch) = 1.0027
rho = 0.99471
New lambda: 1.0031e-024
iter: 1195, Minibatch log likelihood (pre-update): -54.501, error rate (pre-update): 0.1121
iter: 1195, Minibatch log likelihood (post-update): -54.5007, error rate (post-update): 0.11206

size_minibatch = 20000
Precon grad coeff: 0.025082, velocity coeff: 0.99418
norm(ch) = 1.0025
iter: 1196, Minibatch log likelihood (pre-update): -54.5007, error rate (pre-update): 0.11206

size_minibatch = 20000
Precon grad coeff: 0.025564, velocity coeff: 1.0524
norm(ch) = 1.0605
iter: 1197, Minibatch log likelihood (pre-update): -54.5005, error rate (pre-update): 0.11202

size_minibatch = 20000
Precon grad coeff: 0.027211, velocity coeff: 1.0074
norm(ch) = 1.0747
iter: 1198, Minibatch log likelihood (pre-update): -54.5003, error rate (pre-update): 0.11196

size_minibatch = 20000
Precon grad coeff: 0.026595, velocity coeff: 0.97409
norm(ch) = 1.0528
iter: 1199, Minibatch log likelihood (pre-update): -54.5001, error rate (pre-update): 0.11191

size_minibatch = 20000
Precon grad coeff: 0.026876, velocity coeff: 0.95797
New gamma: 0.0031623
norm(ch) = 1.0146
rho = 1.0028
New lambda: 7.7615e-025
iter: 1200, Minibatch log likelihood (pre-update): -54.4998, error rate (pre-update): 0.1119
iter: 1200, Minibatch log likelihood (post-update): -54.4996, error rate (post-update): 0.11185
---
Full log-likelihood: -54.4996, error rate: 0.11185
TEST log-likelihood: -54.7421, error rate: 0.23914
Error difference (test - train): 0.12729
---
Full log-likelihood (averaged params): -54.6176, error rate (averaged params): 0.15145
TEST log-likelihood (averaged params): -54.7924, error rate (averaged params): 0.25805
Error difference (test - train) (averaged params): 0.1066

size_minibatch = 20000
Precon grad coeff: 0.026019, velocity coeff: 1.015
norm(ch) = 1.0369
iter: 1201, Minibatch log likelihood (pre-update): -54.4996, error rate (pre-update): 0.11185

size_minibatch = 20000
Precon grad coeff: 0.026964, velocity coeff: 0.98987
norm(ch) = 1.0322
iter: 1202, Minibatch log likelihood (pre-update): -54.4994, error rate (pre-update): 0.11181

size_minibatch = 20000
Precon grad coeff: 0.02488, velocity coeff: 0.97858
norm(ch) = 1.0157
iter: 1203, Minibatch log likelihood (pre-update): -54.4992, error rate (pre-update): 0.11176

size_minibatch = 20000
Precon grad coeff: 0.025483, velocity coeff: 1.0284
norm(ch) = 1.0501
iter: 1204, Minibatch log likelihood (pre-update): -54.499, error rate (pre-update): 0.11173

size_minibatch = 20000
Precon grad coeff: 0.027415, velocity coeff: 1.0609
norm(ch) = 1.12
rho = 0.999
New lambda: 6.0057e-025
iter: 1205, Minibatch log likelihood (pre-update): -54.4987, error rate (pre-update): 0.11168
iter: 1205, Minibatch log likelihood (post-update): -54.4985, error rate (post-update): 0.11163

size_minibatch = 20000
Precon grad coeff: 0.028253, velocity coeff: 0.98244
norm(ch) = 1.1074
iter: 1206, Minibatch log likelihood (pre-update): -54.4985, error rate (pre-update): 0.11163

size_minibatch = 20000
Precon grad coeff: 0.027261, velocity coeff: 0.99114
norm(ch) = 1.1031
iter: 1207, Minibatch log likelihood (pre-update): -54.4983, error rate (pre-update): 0.11158

size_minibatch = 20000
Precon grad coeff: 0.027055, velocity coeff: 0.96377
norm(ch) = 1.0692
iter: 1208, Minibatch log likelihood (pre-update): -54.498, error rate (pre-update): 0.11157

size_minibatch = 20000
Precon grad coeff: 0.024243, velocity coeff: 0.96247
norm(ch) = 1.0345
iter: 1209, Minibatch log likelihood (pre-update): -54.4978, error rate (pre-update): 0.11153

size_minibatch = 20000
Precon grad coeff: 0.02615, velocity coeff: 0.9832
norm(ch) = 1.0226
rho = 0.99244
New lambda: 4.6471e-025
iter: 1210, Minibatch log likelihood (pre-update): -54.4976, error rate (pre-update): 0.11145
iter: 1210, Minibatch log likelihood (post-update): -54.4974, error rate (post-update): 0.11143

size_minibatch = 20000
Precon grad coeff: 0.02332, velocity coeff: 0.96459
norm(ch) = 0.99131
iter: 1211, Minibatch log likelihood (pre-update): -54.4974, error rate (pre-update): 0.11143

size_minibatch = 20000
Precon grad coeff: 0.023805, velocity coeff: 0.98769
norm(ch) = 0.98391
iter: 1212, Minibatch log likelihood (pre-update): -54.4972, error rate (pre-update): 0.11139

size_minibatch = 20000
Precon grad coeff: 0.026541, velocity coeff: 1.0514
norm(ch) = 1.0407
iter: 1213, Minibatch log likelihood (pre-update): -54.497, error rate (pre-update): 0.11135

size_minibatch = 20000
Precon grad coeff: 0.026029, velocity coeff: 0.97617
norm(ch) = 1.0213
iter: 1214, Minibatch log likelihood (pre-update): -54.4967, error rate (pre-update): 0.11129

size_minibatch = 20000
Precon grad coeff: 0.026535, velocity coeff: 1.0085
norm(ch) = 1.0359
rho = 0.99394
New lambda: 3.5958e-025
iter: 1215, Minibatch log likelihood (pre-update): -54.4965, error rate (pre-update): 0.11127
iter: 1215, Minibatch log likelihood (post-update): -54.4963, error rate (post-update): 0.11123

size_minibatch = 20000
Precon grad coeff: 0.026086, velocity coeff: 0.96027
norm(ch) = 1
iter: 1216, Minibatch log likelihood (pre-update): -54.4963, error rate (pre-update): 0.11123

size_minibatch = 20000
Precon grad coeff: 0.024189, velocity coeff: 0.99514
norm(ch) = 1.0006
iter: 1217, Minibatch log likelihood (pre-update): -54.4961, error rate (pre-update): 0.11118

size_minibatch = 20000
Precon grad coeff: 0.024362, velocity coeff: 0.99223
norm(ch) = 0.99842
iter: 1218, Minibatch log likelihood (pre-update): -54.4959, error rate (pre-update): 0.11115

size_minibatch = 20000
Precon grad coeff: 0.022339, velocity coeff: 0.94384
norm(ch) = 0.94714
iter: 1219, Minibatch log likelihood (pre-update): -54.4957, error rate (pre-update): 0.1111

size_minibatch = 20000
Precon grad coeff: 0.026716, velocity coeff: 1.0717
New gamma: 0.0031623
norm(ch) = 1.022
rho = 1.0058
New lambda: 2.7824e-025
iter: 1220, Minibatch log likelihood (pre-update): -54.4955, error rate (pre-update): 0.11108
iter: 1220, Minibatch log likelihood (post-update): -54.4953, error rate (post-update): 0.11104

size_minibatch = 20000
Precon grad coeff: 0.027757, velocity coeff: 0.99932
norm(ch) = 1.0278
iter: 1221, Minibatch log likelihood (pre-update): -54.4953, error rate (pre-update): 0.11104

size_minibatch = 20000
Precon grad coeff: 0.029724, velocity coeff: 1.0506
norm(ch) = 1.0869
iter: 1222, Minibatch log likelihood (pre-update): -54.495, error rate (pre-update): 0.11098

size_minibatch = 20000
Precon grad coeff: 0.028678, velocity coeff: 0.96291
norm(ch) = 1.0534
iter: 1223, Minibatch log likelihood (pre-update): -54.4948, error rate (pre-update): 0.11095

size_minibatch = 20000
Precon grad coeff: 0.026992, velocity coeff: 1.0141
norm(ch) = 1.0747
iter: 1224, Minibatch log likelihood (pre-update): -54.4946, error rate (pre-update): 0.1109

size_minibatch = 20000
Precon grad coeff: 0.027596, velocity coeff: 1.0115
norm(ch) = 1.0936
rho = 1.0103
New lambda: 2.153e-025
iter: 1225, Minibatch log likelihood (pre-update): -54.4944, error rate (pre-update): 0.11086
iter: 1225, Minibatch log likelihood (post-update): -54.4941, error rate (post-update): 0.11082

size_minibatch = 20000
Precon grad coeff: 0.025948, velocity coeff: 0.96683
norm(ch) = 1.063
iter: 1226, Minibatch log likelihood (pre-update): -54.4941, error rate (pre-update): 0.11082

size_minibatch = 20000
Precon grad coeff: 0.023234, velocity coeff: 0.93372
norm(ch) = 0.99772
iter: 1227, Minibatch log likelihood (pre-update): -54.4939, error rate (pre-update): 0.11078

size_minibatch = 20000
Precon grad coeff: 0.026875, velocity coeff: 1.121
norm(ch) = 1.1248
iter: 1228, Minibatch log likelihood (pre-update): -54.4937, error rate (pre-update): 0.11072

size_minibatch = 20000
Precon grad coeff: 0.026132, velocity coeff: 0.90559
norm(ch) = 1.0243
iter: 1229, Minibatch log likelihood (pre-update): -54.4935, error rate (pre-update): 0.11071

size_minibatch = 20000
Precon grad coeff: 0.025291, velocity coeff: 1.0001
norm(ch) = 1.0299
rho = 1.0089
New lambda: 1.6659e-025
iter: 1230, Minibatch log likelihood (pre-update): -54.4932, error rate (pre-update): 0.11065
iter: 1230, Minibatch log likelihood (post-update): -54.493, error rate (post-update): 0.1106

size_minibatch = 20000
Precon grad coeff: 0.027297, velocity coeff: 1.0191
norm(ch) = 1.0557
iter: 1231, Minibatch log likelihood (pre-update): -54.493, error rate (pre-update): 0.1106

size_minibatch = 20000
Precon grad coeff: 0.026442, velocity coeff: 0.94551
norm(ch) = 1.004
iter: 1232, Minibatch log likelihood (pre-update): -54.4928, error rate (pre-update): 0.11059

size_minibatch = 20000
Precon grad coeff: 0.024332, velocity coeff: 0.98928
norm(ch) = 0.99856
iter: 1233, Minibatch log likelihood (pre-update): -54.4926, error rate (pre-update): 0.11051

size_minibatch = 20000
Precon grad coeff: 0.027742, velocity coeff: 1.0318
norm(ch) = 1.0364
iter: 1234, Minibatch log likelihood (pre-update): -54.4924, error rate (pre-update): 0.11049

size_minibatch = 20000
Precon grad coeff: 0.024274, velocity coeff: 0.95121
norm(ch) = 0.99134
rho = 1.0008
New lambda: 1.2891e-025
iter: 1235, Minibatch log likelihood (pre-update): -54.4922, error rate (pre-update): 0.11047
iter: 1235, Minibatch log likelihood (post-update): -54.492, error rate (post-update): 0.11041

size_minibatch = 20000
Precon grad coeff: 0.025255, velocity coeff: 1.0165
norm(ch) = 1.0127
iter: 1236, Minibatch log likelihood (pre-update): -54.492, error rate (pre-update): 0.11041

size_minibatch = 20000
Precon grad coeff: 0.023168, velocity coeff: 0.95507
norm(ch) = 0.97234
iter: 1237, Minibatch log likelihood (pre-update): -54.4918, error rate (pre-update): 0.11037

size_minibatch = 20000
Precon grad coeff: 0.023279, velocity coeff: 1.0327
norm(ch) = 1.0093
iter: 1238, Minibatch log likelihood (pre-update): -54.4916, error rate (pre-update): 0.11035

size_minibatch = 20000
Precon grad coeff: 0.024396, velocity coeff: 0.99883
norm(ch) = 1.0134
iter: 1239, Minibatch log likelihood (pre-update): -54.4913, error rate (pre-update): 0.11029

size_minibatch = 20000
Precon grad coeff: 0.028276, velocity coeff: 1.0151
New gamma: 0.0031623
norm(ch) = 1.0355
rho = 1.0127
New lambda: 9.9745e-026
iter: 1240, Minibatch log likelihood (pre-update): -54.4911, error rate (pre-update): 0.11025
iter: 1240, Minibatch log likelihood (post-update): -54.4909, error rate (post-update): 0.11023

size_minibatch = 20000
Precon grad coeff: 0.028433, velocity coeff: 0.99372
norm(ch) = 1.0362
iter: 1241, Minibatch log likelihood (pre-update): -54.4909, error rate (pre-update): 0.11023

size_minibatch = 20000
Precon grad coeff: 0.029246, velocity coeff: 1.0197
norm(ch) = 1.0635
iter: 1242, Minibatch log likelihood (pre-update): -54.4907, error rate (pre-update): 0.11018

size_minibatch = 20000
Precon grad coeff: 0.025487, velocity coeff: 0.90821
norm(ch) = 0.97193
iter: 1243, Minibatch log likelihood (pre-update): -54.4905, error rate (pre-update): 0.11013

size_minibatch = 20000
Precon grad coeff: 0.027154, velocity coeff: 1.1125
norm(ch) = 1.0877
iter: 1244, Minibatch log likelihood (pre-update): -54.4903, error rate (pre-update): 0.11009

size_minibatch = 20000
Precon grad coeff: 0.02453, velocity coeff: 0.94338
norm(ch) = 1.0312
rho = 1.0064
New lambda: 7.7181e-026
iter: 1245, Minibatch log likelihood (pre-update): -54.49, error rate (pre-update): 0.11007
iter: 1245, Minibatch log likelihood (post-update): -54.4898, error rate (post-update): 0.11002

size_minibatch = 20000
Precon grad coeff: 0.028198, velocity coeff: 1.106
norm(ch) = 1.1476
iter: 1246, Minibatch log likelihood (pre-update): -54.4898, error rate (pre-update): 0.11002

size_minibatch = 20000
Precon grad coeff: 0.02432, velocity coeff: 0.89633
norm(ch) = 1.0335
iter: 1247, Minibatch log likelihood (pre-update): -54.4896, error rate (pre-update): 0.10996

size_minibatch = 20000
Precon grad coeff: 0.029518, velocity coeff: 1.1232
norm(ch) = 1.1676
iter: 1248, Minibatch log likelihood (pre-update): -54.4894, error rate (pre-update): 0.10991

size_minibatch = 20000
Precon grad coeff: 0.024799, velocity coeff: 0.84996
norm(ch) = 0.99787
iter: 1249, Minibatch log likelihood (pre-update): -54.4891, error rate (pre-update): 0.10989

size_minibatch = 20000
Precon grad coeff: 0.023579, velocity coeff: 1.0359
norm(ch) = 1.039
rho = 1.0043
New lambda: 5.9721e-026
iter: 1250, Minibatch log likelihood (pre-update): -54.4889, error rate (pre-update): 0.10985
iter: 1250, Minibatch log likelihood (post-update): -54.4887, error rate (post-update): 0.10981
---
Full log-likelihood: -54.4887, error rate: 0.10981
TEST log-likelihood: -54.7422, error rate: 0.23984
Error difference (test - train): 0.13003
---
Full log-likelihood (averaged params): -54.5951, error rate (averaged params): 0.14575
TEST log-likelihood (averaged params): -54.7838, error rate (averaged params): 0.25633
Error difference (test - train) (averaged params): 0.11058

size_minibatch = 20000
Precon grad coeff: 0.026845, velocity coeff: 0.99572
norm(ch) = 1.0405
iter: 1251, Minibatch log likelihood (pre-update): -54.4887, error rate (pre-update): 0.10981

size_minibatch = 20000
Precon grad coeff: 0.02593, velocity coeff: 0.96556
norm(ch) = 1.0097
iter: 1252, Minibatch log likelihood (pre-update): -54.4885, error rate (pre-update): 0.10975

size_minibatch = 20000
Precon grad coeff: 0.025986, velocity coeff: 0.99316
norm(ch) = 1.0084
iter: 1253, Minibatch log likelihood (pre-update): -54.4883, error rate (pre-update): 0.10971

size_minibatch = 20000
Precon grad coeff: 0.028062, velocity coeff: 1.0344
norm(ch) = 1.0493
iter: 1254, Minibatch log likelihood (pre-update): -54.4881, error rate (pre-update): 0.10969

size_minibatch = 20000
Precon grad coeff: 0.027075, velocity coeff: 0.96916
norm(ch) = 1.0226
rho = 0.99201
New lambda: 4.6211e-026
iter: 1255, Minibatch log likelihood (pre-update): -54.4879, error rate (pre-update): 0.10966
iter: 1255, Minibatch log likelihood (post-update): -54.4877, error rate (post-update): 0.10959

size_minibatch = 20000
Precon grad coeff: 0.022888, velocity coeff: 0.92867
norm(ch) = 0.95447
iter: 1256, Minibatch log likelihood (pre-update): -54.4877, error rate (pre-update): 0.10959

size_minibatch = 20000
Precon grad coeff: 0.025408, velocity coeff: 1.0753
norm(ch) = 1.032
iter: 1257, Minibatch log likelihood (pre-update): -54.4875, error rate (pre-update): 0.10953

size_minibatch = 20000
Precon grad coeff: 0.024042, velocity coeff: 0.96413
norm(ch) = 0.99973
iter: 1258, Minibatch log likelihood (pre-update): -54.4873, error rate (pre-update): 0.10953

size_minibatch = 20000
Precon grad coeff: 0.024985, velocity coeff: 1.0251
norm(ch) = 1.0306
iter: 1259, Minibatch log likelihood (pre-update): -54.487, error rate (pre-update): 0.10949

size_minibatch = 20000
Precon grad coeff: 0.027278, velocity coeff: 1.0022
New gamma: 0.0031623
norm(ch) = 1.0389
rho = 0.99363
New lambda: 3.5757e-026
iter: 1260, Minibatch log likelihood (pre-update): -54.4868, error rate (pre-update): 0.10946
iter: 1260, Minibatch log likelihood (post-update): -54.4866, error rate (post-update): 0.10941

size_minibatch = 20000
Precon grad coeff: 0.027294, velocity coeff: 0.98969
norm(ch) = 1.0349
iter: 1261, Minibatch log likelihood (pre-update): -54.4866, error rate (pre-update): 0.10941

size_minibatch = 20000
Precon grad coeff: 0.025252, velocity coeff: 0.96892
norm(ch) = 1.0082
iter: 1262, Minibatch log likelihood (pre-update): -54.4864, error rate (pre-update): 0.10934

size_minibatch = 20000
Precon grad coeff: 0.026159, velocity coeff: 1.0381
norm(ch) = 1.0524
iter: 1263, Minibatch log likelihood (pre-update): -54.4862, error rate (pre-update): 0.10931

size_minibatch = 20000
Precon grad coeff: 0.027314, velocity coeff: 1.0159
norm(ch) = 1.075
iter: 1264, Minibatch log likelihood (pre-update): -54.486, error rate (pre-update): 0.10931

size_minibatch = 20000
Precon grad coeff: 0.027812, velocity coeff: 0.99941
norm(ch) = 1.0802
rho = 1.001
New lambda: 2.7668e-026
iter: 1265, Minibatch log likelihood (pre-update): -54.4858, error rate (pre-update): 0.10923
iter: 1265, Minibatch log likelihood (post-update): -54.4855, error rate (post-update): 0.10919

size_minibatch = 20000
Precon grad coeff: 0.027676, velocity coeff: 1.0408
norm(ch) = 1.1302
iter: 1266, Minibatch log likelihood (pre-update): -54.4855, error rate (pre-update): 0.10919

size_minibatch = 20000
Precon grad coeff: 0.029194, velocity coeff: 0.933
norm(ch) = 1.0607
iter: 1267, Minibatch log likelihood (pre-update): -54.4853, error rate (pre-update): 0.10916

size_minibatch = 20000
Precon grad coeff: 0.022598, velocity coeff: 0.93174
norm(ch) = 0.99315
iter: 1268, Minibatch log likelihood (pre-update): -54.4851, error rate (pre-update): 0.1091

size_minibatch = 20000
Precon grad coeff: 0.026606, velocity coeff: 1.057
norm(ch) = 1.0552
iter: 1269, Minibatch log likelihood (pre-update): -54.4849, error rate (pre-update): 0.10907

size_minibatch = 20000
Precon grad coeff: 0.025108, velocity coeff: 0.96244
norm(ch) = 1.0207
rho = 1.0009
New lambda: 2.1409e-026
iter: 1270, Minibatch log likelihood (pre-update): -54.4847, error rate (pre-update): 0.10903
iter: 1270, Minibatch log likelihood (post-update): -54.4845, error rate (post-update): 0.10899

size_minibatch = 20000
Precon grad coeff: 0.024794, velocity coeff: 0.95091
norm(ch) = 0.97591
iter: 1271, Minibatch log likelihood (pre-update): -54.4845, error rate (pre-update): 0.10899

size_minibatch = 20000
Precon grad coeff: 0.025694, velocity coeff: 1.0689
norm(ch) = 1.0488
iter: 1272, Minibatch log likelihood (pre-update): -54.4843, error rate (pre-update): 0.10896

size_minibatch = 20000
Precon grad coeff: 0.026259, velocity coeff: 0.97555
norm(ch) = 1.0286
iter: 1273, Minibatch log likelihood (pre-update): -54.4841, error rate (pre-update): 0.1089

size_minibatch = 20000
Precon grad coeff: 0.024868, velocity coeff: 0.95578
norm(ch) = 0.98744
iter: 1274, Minibatch log likelihood (pre-update): -54.4839, error rate (pre-update): 0.10886

size_minibatch = 20000
Precon grad coeff: 0.024585, velocity coeff: 1.0221
norm(ch) = 1.0144
rho = 1.0025
New lambda: 1.6566e-026
iter: 1275, Minibatch log likelihood (pre-update): -54.4837, error rate (pre-update): 0.10885
iter: 1275, Minibatch log likelihood (post-update): -54.4835, error rate (post-update): 0.10879

size_minibatch = 20000
Precon grad coeff: 0.026493, velocity coeff: 1.0442
norm(ch) = 1.0655
iter: 1276, Minibatch log likelihood (pre-update): -54.4835, error rate (pre-update): 0.10879

size_minibatch = 20000
Precon grad coeff: 0.026567, velocity coeff: 0.95124
norm(ch) = 1.0186
iter: 1277, Minibatch log likelihood (pre-update): -54.4832, error rate (pre-update): 0.10875

size_minibatch = 20000
Precon grad coeff: 0.025561, velocity coeff: 1.0049
norm(ch) = 1.0287
iter: 1278, Minibatch log likelihood (pre-update): -54.483, error rate (pre-update): 0.10872

size_minibatch = 20000
Precon grad coeff: 0.02232, velocity coeff: 0.89475
norm(ch) = 0.92513
iter: 1279, Minibatch log likelihood (pre-update): -54.4828, error rate (pre-update): 0.10865

size_minibatch = 20000
Precon grad coeff: 0.026918, velocity coeff: 1.1163
New gamma: 0.0031623
norm(ch) = 1.0391
rho = 1.0133
New lambda: 1.2818e-026
iter: 1280, Minibatch log likelihood (pre-update): -54.4826, error rate (pre-update): 0.10864
iter: 1280, Minibatch log likelihood (post-update): -54.4824, error rate (post-update): 0.1086

size_minibatch = 20000
Precon grad coeff: 0.028061, velocity coeff: 0.95283
norm(ch) = 0.99624
iter: 1281, Minibatch log likelihood (pre-update): -54.4824, error rate (pre-update): 0.1086

size_minibatch = 20000
Precon grad coeff: 0.026414, velocity coeff: 1.0203
norm(ch) = 1.0226
iter: 1282, Minibatch log likelihood (pre-update): -54.4822, error rate (pre-update): 0.10856

size_minibatch = 20000
Precon grad coeff: 0.029007, velocity coeff: 1.0456
norm(ch) = 1.0758
iter: 1283, Minibatch log likelihood (pre-update): -54.482, error rate (pre-update): 0.10852

size_minibatch = 20000
Precon grad coeff: 0.029156, velocity coeff: 1.0105
norm(ch) = 1.0933
iter: 1284, Minibatch log likelihood (pre-update): -54.4818, error rate (pre-update): 0.10848

size_minibatch = 20000
Precon grad coeff: 0.025898, velocity coeff: 0.94884
norm(ch) = 1.0431
rho = 1.0175
New lambda: 9.9186e-027
iter: 1285, Minibatch log likelihood (pre-update): -54.4816, error rate (pre-update): 0.10845
iter: 1285, Minibatch log likelihood (post-update): -54.4814, error rate (post-update): 0.10839

size_minibatch = 20000
Precon grad coeff: 0.026204, velocity coeff: 1.0119
norm(ch) = 1.0609
iter: 1286, Minibatch log likelihood (pre-update): -54.4814, error rate (pre-update): 0.10839

size_minibatch = 20000
Precon grad coeff: 0.026193, velocity coeff: 1.0102
norm(ch) = 1.0776
iter: 1287, Minibatch log likelihood (pre-update): -54.4812, error rate (pre-update): 0.10836

size_minibatch = 20000
Precon grad coeff: 0.026392, velocity coeff: 0.95453
norm(ch) = 1.0338
iter: 1288, Minibatch log likelihood (pre-update): -54.4809, error rate (pre-update): 0.10832

size_minibatch = 20000
Precon grad coeff: 0.022964, velocity coeff: 0.9404
norm(ch) = 0.97676
iter: 1289, Minibatch log likelihood (pre-update): -54.4807, error rate (pre-update): 0.10828

size_minibatch = 20000
Precon grad coeff: 0.028079, velocity coeff: 1.1028
norm(ch) = 1.0833
rho = 0.99919
New lambda: 7.6749e-027
iter: 1290, Minibatch log likelihood (pre-update): -54.4805, error rate (pre-update): 0.10824
iter: 1290, Minibatch log likelihood (post-update): -54.4803, error rate (post-update): 0.10819

size_minibatch = 20000
Precon grad coeff: 0.023335, velocity coeff: 0.8736
norm(ch) = 0.9509
iter: 1291, Minibatch log likelihood (pre-update): -54.4803, error rate (pre-update): 0.10819

size_minibatch = 20000
Precon grad coeff: 0.027926, velocity coeff: 1.0931
norm(ch) = 1.0455
iter: 1292, Minibatch log likelihood (pre-update): -54.4801, error rate (pre-update): 0.10816

size_minibatch = 20000
Precon grad coeff: 0.026986, velocity coeff: 0.96483
norm(ch) = 1.0139
iter: 1293, Minibatch log likelihood (pre-update): -54.4799, error rate (pre-update): 0.10813

size_minibatch = 20000
Precon grad coeff: 0.027009, velocity coeff: 0.98656
norm(ch) = 1.0058
iter: 1294, Minibatch log likelihood (pre-update): -54.4797, error rate (pre-update): 0.10809

size_minibatch = 20000
Precon grad coeff: 0.026573, velocity coeff: 0.99614
norm(ch) = 1.0075
rho = 0.99766
New lambda: 5.9387e-027
iter: 1295, Minibatch log likelihood (pre-update): -54.4795, error rate (pre-update): 0.10806
iter: 1295, Minibatch log likelihood (post-update): -54.4793, error rate (post-update): 0.10802

size_minibatch = 20000
Precon grad coeff: 0.023303, velocity coeff: 0.93972
norm(ch) = 0.95137
iter: 1296, Minibatch log likelihood (pre-update): -54.4793, error rate (pre-update): 0.10802

size_minibatch = 20000
Precon grad coeff: 0.02632, velocity coeff: 1.0635
norm(ch) = 1.0176
iter: 1297, Minibatch log likelihood (pre-update): -54.4791, error rate (pre-update): 0.10798

size_minibatch = 20000
Precon grad coeff: 0.023438, velocity coeff: 0.94247
norm(ch) = 0.96328
iter: 1298, Minibatch log likelihood (pre-update): -54.4789, error rate (pre-update): 0.10795

size_minibatch = 20000
Precon grad coeff: 0.02334, velocity coeff: 1.0157
norm(ch) = 0.98341
iter: 1299, Minibatch log likelihood (pre-update): -54.4787, error rate (pre-update): 0.10789

size_minibatch = 20000
Precon grad coeff: 0.027036, velocity coeff: 0.99248
New gamma: 0.0031623
norm(ch) = 0.98246
rho = 1.0099
New lambda: 4.5952e-027
iter: 1300, Minibatch log likelihood (pre-update): -54.4786, error rate (pre-update): 0.10786
iter: 1300, Minibatch log likelihood (post-update): -54.4784, error rate (post-update): 0.10784
---
Full log-likelihood: -54.4784, error rate: 0.10784
TEST log-likelihood: -54.7411, error rate: 0.24026
Error difference (test - train): 0.13242
---
Full log-likelihood (averaged params): -54.5767, error rate (averaged params): 0.14103
TEST log-likelihood (averaged params): -54.7775, error rate (averaged params): 0.25491
Error difference (test - train) (averaged params): 0.11388

size_minibatch = 20000
Precon grad coeff: 0.024944, velocity coeff: 0.99576
norm(ch) = 0.98393
iter: 1301, Minibatch log likelihood (pre-update): -54.4784, error rate (pre-update): 0.10784

size_minibatch = 20000
Precon grad coeff: 0.02804, velocity coeff: 1.0469
norm(ch) = 1.0362
iter: 1302, Minibatch log likelihood (pre-update): -54.4782, error rate (pre-update): 0.10781

size_minibatch = 20000
Precon grad coeff: 0.027274, velocity coeff: 0.99447
norm(ch) = 1.0363
iter: 1303, Minibatch log likelihood (pre-update): -54.478, error rate (pre-update): 0.10777

size_minibatch = 20000
Precon grad coeff: 0.029101, velocity coeff: 1.0494
norm(ch) = 1.0935
iter: 1304, Minibatch log likelihood (pre-update): -54.4778, error rate (pre-update): 0.10774

size_minibatch = 20000
Precon grad coeff: 0.026895, velocity coeff: 0.93957
norm(ch) = 1.0334
rho = 0.99384
New lambda: 3.5557e-027
iter: 1305, Minibatch log likelihood (pre-update): -54.4775, error rate (pre-update): 0.10768
iter: 1305, Minibatch log likelihood (post-update): -54.4773, error rate (post-update): 0.10766

size_minibatch = 20000
Precon grad coeff: 0.026009, velocity coeff: 1.0129
norm(ch) = 1.0524
iter: 1306, Minibatch log likelihood (pre-update): -54.4773, error rate (pre-update): 0.10766

size_minibatch = 20000
Precon grad coeff: 0.026384, velocity coeff: 0.9547
norm(ch) = 1.0101
iter: 1307, Minibatch log likelihood (pre-update): -54.4771, error rate (pre-update): 0.1076

size_minibatch = 20000
Precon grad coeff: 0.024099, velocity coeff: 1.0052
norm(ch) = 1.0203
iter: 1308, Minibatch log likelihood (pre-update): -54.4769, error rate (pre-update): 0.10755

size_minibatch = 20000
Precon grad coeff: 0.02613, velocity coeff: 0.97425
norm(ch) = 0.99938
iter: 1309, Minibatch log likelihood (pre-update): -54.4767, error rate (pre-update): 0.10755

size_minibatch = 20000
Precon grad coeff: 0.024168, velocity coeff: 0.95187
norm(ch) = 0.95624
rho = 1.0149
New lambda: 2.7513e-027
iter: 1310, Minibatch log likelihood (pre-update): -54.4765, error rate (pre-update): 0.10753
iter: 1310, Minibatch log likelihood (post-update): -54.4763, error rate (post-update): 0.10746

size_minibatch = 20000
Precon grad coeff: 0.023147, velocity coeff: 0.97358
norm(ch) = 0.93555
iter: 1311, Minibatch log likelihood (pre-update): -54.4763, error rate (pre-update): 0.10746

size_minibatch = 20000
Precon grad coeff: 0.025027, velocity coeff: 1.0385
norm(ch) = 0.97684
iter: 1312, Minibatch log likelihood (pre-update): -54.4762, error rate (pre-update): 0.10743

size_minibatch = 20000
Precon grad coeff: 0.025624, velocity coeff: 1.0195
norm(ch) = 1.0008
iter: 1313, Minibatch log likelihood (pre-update): -54.476, error rate (pre-update): 0.10741

size_minibatch = 20000
Precon grad coeff: 0.026384, velocity coeff: 0.95923
norm(ch) = 0.96544
iter: 1314, Minibatch log likelihood (pre-update): -54.4758, error rate (pre-update): 0.10739

size_minibatch = 20000
Precon grad coeff: 0.025174, velocity coeff: 1.0306
norm(ch) = 1.0004
rho = 1.0067
New lambda: 2.1289e-027
iter: 1315, Minibatch log likelihood (pre-update): -54.4756, error rate (pre-update): 0.10733
iter: 1315, Minibatch log likelihood (post-update): -54.4754, error rate (post-update): 0.10728

size_minibatch = 20000
Precon grad coeff: 0.025689, velocity coeff: 0.97963
norm(ch) = 0.9848
iter: 1316, Minibatch log likelihood (pre-update): -54.4754, error rate (pre-update): 0.10728

size_minibatch = 20000
Precon grad coeff: 0.023899, velocity coeff: 0.9733
norm(ch) = 0.96325
iter: 1317, Minibatch log likelihood (pre-update): -54.4752, error rate (pre-update): 0.10728

size_minibatch = 20000
Precon grad coeff: 0.023115, velocity coeff: 0.9915
norm(ch) = 0.95971
iter: 1318, Minibatch log likelihood (pre-update): -54.475, error rate (pre-update): 0.10726

size_minibatch = 20000
Precon grad coeff: 0.025732, velocity coeff: 1.0442
norm(ch) = 1.0073
iter: 1319, Minibatch log likelihood (pre-update): -54.4748, error rate (pre-update): 0.10721

size_minibatch = 20000
Precon grad coeff: 0.023833, velocity coeff: 0.88284
New gamma: 0.0031623
norm(ch) = 0.89474
rho = 0.99828
New lambda: 1.6473e-027
iter: 1320, Minibatch log likelihood (pre-update): -54.4746, error rate (pre-update): 0.10716
iter: 1320, Minibatch log likelihood (post-update): -54.4745, error rate (post-update): 0.10712

size_minibatch = 20000
Precon grad coeff: 0.025587, velocity coeff: 1.0858
norm(ch) = 0.97713
iter: 1321, Minibatch log likelihood (pre-update): -54.4745, error rate (pre-update): 0.10712

size_minibatch = 20000
Precon grad coeff: 0.025651, velocity coeff: 0.99311
norm(ch) = 0.9758
iter: 1322, Minibatch log likelihood (pre-update): -54.4743, error rate (pre-update): 0.1071

size_minibatch = 20000
Precon grad coeff: 0.027276, velocity coeff: 1.0266
norm(ch) = 1.0076
iter: 1323, Minibatch log likelihood (pre-update): -54.4741, error rate (pre-update): 0.10706

size_minibatch = 20000
Precon grad coeff: 0.027754, velocity coeff: 1.0396
norm(ch) = 1.0531
iter: 1324, Minibatch log likelihood (pre-update): -54.4739, error rate (pre-update): 0.10703

size_minibatch = 20000
Precon grad coeff: 0.027535, velocity coeff: 0.96093
norm(ch) = 1.0181
rho = 1.0103
New lambda: 1.2747e-027
iter: 1325, Minibatch log likelihood (pre-update): -54.4737, error rate (pre-update): 0.10699
iter: 1325, Minibatch log likelihood (post-update): -54.4735, error rate (post-update): 0.10695

size_minibatch = 20000
Precon grad coeff: 0.023979, velocity coeff: 0.96924
norm(ch) = 0.99144
iter: 1326, Minibatch log likelihood (pre-update): -54.4735, error rate (pre-update): 0.10695

size_minibatch = 20000
Precon grad coeff: 0.025024, velocity coeff: 0.98596
norm(ch) = 0.98274
iter: 1327, Minibatch log likelihood (pre-update): -54.4733, error rate (pre-update): 0.10692

size_minibatch = 20000
Precon grad coeff: 0.025305, velocity coeff: 1.0161
norm(ch) = 1.0038
iter: 1328, Minibatch log likelihood (pre-update): -54.4731, error rate (pre-update): 0.10689

size_minibatch = 20000
Precon grad coeff: 0.023911, velocity coeff: 0.93861
norm(ch) = 0.94675
iter: 1329, Minibatch log likelihood (pre-update): -54.4729, error rate (pre-update): 0.10686

size_minibatch = 20000
Precon grad coeff: 0.024484, velocity coeff: 0.98726
norm(ch) = 0.93952
rho = 1.0022
New lambda: 9.8631e-028
iter: 1330, Minibatch log likelihood (pre-update): -54.4727, error rate (pre-update): 0.10683
iter: 1330, Minibatch log likelihood (post-update): -54.4726, error rate (post-update): 0.10678

size_minibatch = 20000
Precon grad coeff: 0.022629, velocity coeff: 0.99014
norm(ch) = 0.93512
iter: 1331, Minibatch log likelihood (pre-update): -54.4726, error rate (pre-update): 0.10678

size_minibatch = 20000
Precon grad coeff: 0.025493, velocity coeff: 1.0203
norm(ch) = 0.95904
iter: 1332, Minibatch log likelihood (pre-update): -54.4724, error rate (pre-update): 0.10676

size_minibatch = 20000
Precon grad coeff: 0.025886, velocity coeff: 1.0286
norm(ch) = 0.99167
iter: 1333, Minibatch log likelihood (pre-update): -54.4722, error rate (pre-update): 0.10672

size_minibatch = 20000
Precon grad coeff: 0.025066, velocity coeff: 0.94626
norm(ch) = 0.94306
iter: 1334, Minibatch log likelihood (pre-update): -54.472, error rate (pre-update): 0.1067

size_minibatch = 20000
Precon grad coeff: 0.025406, velocity coeff: 1.028
norm(ch) = 0.9749
rho = 0.99982
New lambda: 7.6319e-028
iter: 1335, Minibatch log likelihood (pre-update): -54.4718, error rate (pre-update): 0.10666
iter: 1335, Minibatch log likelihood (post-update): -54.4716, error rate (post-update): 0.10663

size_minibatch = 20000
Precon grad coeff: 0.022936, velocity coeff: 0.93317
norm(ch) = 0.91403
iter: 1336, Minibatch log likelihood (pre-update): -54.4716, error rate (pre-update): 0.10663

size_minibatch = 20000
Precon grad coeff: 0.023781, velocity coeff: 1.0409
norm(ch) = 0.95616
iter: 1337, Minibatch log likelihood (pre-update): -54.4715, error rate (pre-update): 0.1066

size_minibatch = 20000
Precon grad coeff: 0.024924, velocity coeff: 1.0028
norm(ch) = 0.96351
iter: 1338, Minibatch log likelihood (pre-update): -54.4713, error rate (pre-update): 0.10656

size_minibatch = 20000
Precon grad coeff: 0.022247, velocity coeff: 0.93298
norm(ch) = 0.90301
iter: 1339, Minibatch log likelihood (pre-update): -54.4711, error rate (pre-update): 0.10652

size_minibatch = 20000
Precon grad coeff: 0.023987, velocity coeff: 0.99419
New gamma: 0.0031623
norm(ch) = 0.90298
rho = 1.0105
New lambda: 5.9054e-028
iter: 1340, Minibatch log likelihood (pre-update): -54.4709, error rate (pre-update): 0.10651
iter: 1340, Minibatch log likelihood (post-update): -54.4708, error rate (post-update): 0.10647

size_minibatch = 20000
Precon grad coeff: 0.02634, velocity coeff: 1.04
norm(ch) = 0.9452
iter: 1341, Minibatch log likelihood (pre-update): -54.4708, error rate (pre-update): 0.10647

size_minibatch = 20000
Precon grad coeff: 0.029091, velocity coeff: 1.0493
norm(ch) = 0.99758
iter: 1342, Minibatch log likelihood (pre-update): -54.4706, error rate (pre-update): 0.10644

size_minibatch = 20000
Precon grad coeff: 0.027971, velocity coeff: 0.97584
norm(ch) = 0.97931
iter: 1343, Minibatch log likelihood (pre-update): -54.4704, error rate (pre-update): 0.10641

size_minibatch = 20000
Precon grad coeff: 0.027727, velocity coeff: 1.0344
norm(ch) = 1.0187
iter: 1344, Minibatch log likelihood (pre-update): -54.4702, error rate (pre-update): 0.10636

size_minibatch = 20000
Precon grad coeff: 0.027056, velocity coeff: 0.95802
norm(ch) = 0.98144
rho = 0.996
New lambda: 4.5695e-028
iter: 1345, Minibatch log likelihood (pre-update): -54.47, error rate (pre-update): 0.10635
iter: 1345, Minibatch log likelihood (post-update): -54.4698, error rate (post-update): 0.1063

size_minibatch = 20000
Precon grad coeff: 0.022519, velocity coeff: 0.96378
norm(ch) = 0.95051
iter: 1346, Minibatch log likelihood (pre-update): -54.4698, error rate (pre-update): 0.1063

size_minibatch = 20000
Precon grad coeff: 0.025659, velocity coeff: 1.0786
norm(ch) = 1.0305
iter: 1347, Minibatch log likelihood (pre-update): -54.4696, error rate (pre-update): 0.10627

size_minibatch = 20000
Precon grad coeff: 0.02753, velocity coeff: 0.99285
norm(ch) = 1.0287
iter: 1348, Minibatch log likelihood (pre-update): -54.4694, error rate (pre-update): 0.10623

size_minibatch = 20000
Precon grad coeff: 0.025705, velocity coeff: 0.96582
norm(ch) = 0.99853
iter: 1349, Minibatch log likelihood (pre-update): -54.4692, error rate (pre-update): 0.1062

size_minibatch = 20000
Precon grad coeff: 0.025665, velocity coeff: 0.94821
norm(ch) = 0.95192
rho = 1.0112
New lambda: 3.5358e-028
iter: 1350, Minibatch log likelihood (pre-update): -54.4691, error rate (pre-update): 0.10616
iter: 1350, Minibatch log likelihood (post-update): -54.4689, error rate (post-update): 0.10614
---
Full log-likelihood: -54.4689, error rate: 0.10614
TEST log-likelihood: -54.741, error rate: 0.2411
Error difference (test - train): 0.13496
---
Full log-likelihood (averaged params): -54.5616, error rate (averaged params): 0.13733
TEST log-likelihood (averaged params): -54.7731, error rate (averaged params): 0.25408
Error difference (test - train) (averaged params): 0.11675

size_minibatch = 20000
Precon grad coeff: 0.024492, velocity coeff: 1.0017
norm(ch) = 0.95845
iter: 1351, Minibatch log likelihood (pre-update): -54.4689, error rate (pre-update): 0.10614

size_minibatch = 20000
Precon grad coeff: 0.026326, velocity coeff: 0.97689
norm(ch) = 0.94108
iter: 1352, Minibatch log likelihood (pre-update): -54.4687, error rate (pre-update): 0.10612

size_minibatch = 20000
Precon grad coeff: 0.023704, velocity coeff: 0.94899
norm(ch) = 0.89766
iter: 1353, Minibatch log likelihood (pre-update): -54.4685, error rate (pre-update): 0.10606

size_minibatch = 20000
Precon grad coeff: 0.023614, velocity coeff: 1.0021
norm(ch) = 0.90403
iter: 1354, Minibatch log likelihood (pre-update): -54.4683, error rate (pre-update): 0.10604

size_minibatch = 20000
Precon grad coeff: 0.024827, velocity coeff: 1.0186
norm(ch) = 0.92608
rho = 0.99815
New lambda: 2.7359e-028
iter: 1355, Minibatch log likelihood (pre-update): -54.4682, error rate (pre-update): 0.10601
iter: 1355, Minibatch log likelihood (post-update): -54.468, error rate (post-update): 0.10598

size_minibatch = 20000
Precon grad coeff: 0.023756, velocity coeff: 0.98812
norm(ch) = 0.91944
iter: 1356, Minibatch log likelihood (pre-update): -54.468, error rate (pre-update): 0.10598

size_minibatch = 20000
Precon grad coeff: 0.027305, velocity coeff: 1.0786
norm(ch) = 0.997
iter: 1357, Minibatch log likelihood (pre-update): -54.4678, error rate (pre-update): 0.10596

size_minibatch = 20000
Precon grad coeff: 0.027894, velocity coeff: 1.0148
norm(ch) = 1.017
iter: 1358, Minibatch log likelihood (pre-update): -54.4676, error rate (pre-update): 0.10592

size_minibatch = 20000
Precon grad coeff: 0.023619, velocity coeff: 0.8799
norm(ch) = 0.89916
iter: 1359, Minibatch log likelihood (pre-update): -54.4675, error rate (pre-update): 0.10589

size_minibatch = 20000
Precon grad coeff: 0.023682, velocity coeff: 0.99192
New gamma: 0.0031623
norm(ch) = 0.89698
rho = 1.011
New lambda: 2.117e-028
iter: 1360, Minibatch log likelihood (pre-update): -54.4673, error rate (pre-update): 0.10585
iter: 1360, Minibatch log likelihood (post-update): -54.4671, error rate (post-update): 0.10582

size_minibatch = 20000
Precon grad coeff: 0.023659, velocity coeff: 1.0213
norm(ch) = 0.92111
iter: 1361, Minibatch log likelihood (pre-update): -54.4671, error rate (pre-update): 0.10582

size_minibatch = 20000
Precon grad coeff: 0.026673, velocity coeff: 1.0755
norm(ch) = 0.99632
iter: 1362, Minibatch log likelihood (pre-update): -54.4669, error rate (pre-update): 0.1058

size_minibatch = 20000
Precon grad coeff: 0.028974, velocity coeff: 1.0235
norm(ch) = 1.0255
iter: 1363, Minibatch log likelihood (pre-update): -54.4668, error rate (pre-update): 0.10578

size_minibatch = 20000
Precon grad coeff: 0.026691, velocity coeff: 0.95704
norm(ch) = 0.9865
iter: 1364, Minibatch log likelihood (pre-update): -54.4666, error rate (pre-update): 0.10573

size_minibatch = 20000
Precon grad coeff: 0.028392, velocity coeff: 1.0586
norm(ch) = 1.0502
rho = 0.99596
New lambda: 1.6381e-028
iter: 1365, Minibatch log likelihood (pre-update): -54.4664, error rate (pre-update): 0.10568
iter: 1365, Minibatch log likelihood (post-update): -54.4662, error rate (post-update): 0.10565

size_minibatch = 20000
Precon grad coeff: 0.026407, velocity coeff: 0.90928
norm(ch) = 0.95975
iter: 1366, Minibatch log likelihood (pre-update): -54.4662, error rate (pre-update): 0.10565

size_minibatch = 20000
Precon grad coeff: 0.023059, velocity coeff: 0.97194
norm(ch) = 0.93734
iter: 1367, Minibatch log likelihood (pre-update): -54.466, error rate (pre-update): 0.10564

size_minibatch = 20000
Precon grad coeff: 0.023107, velocity coeff: 0.95283
norm(ch) = 0.89765
iter: 1368, Minibatch log likelihood (pre-update): -54.4658, error rate (pre-update): 0.10562

size_minibatch = 20000
Precon grad coeff: 0.02449, velocity coeff: 1.0516
norm(ch) = 0.94896
iter: 1369, Minibatch log likelihood (pre-update): -54.4657, error rate (pre-update): 0.10556

size_minibatch = 20000
Precon grad coeff: 0.024601, velocity coeff: 0.99703
norm(ch) = 0.95056
rho = 0.98427
New lambda: 1.2675e-028
iter: 1370, Minibatch log likelihood (pre-update): -54.4655, error rate (pre-update): 0.10554
iter: 1370, Minibatch log likelihood (post-update): -54.4653, error rate (post-update): 0.1055

size_minibatch = 20000
Precon grad coeff: 0.029697, velocity coeff: 1.0694
norm(ch) = 1.0226
iter: 1371, Minibatch log likelihood (pre-update): -54.4653, error rate (pre-update): 0.1055

size_minibatch = 20000
Precon grad coeff: 0.024116, velocity coeff: 0.87945
norm(ch) = 0.90424
iter: 1372, Minibatch log likelihood (pre-update): -54.4651, error rate (pre-update): 0.10548

size_minibatch = 20000
Precon grad coeff: 0.027871, velocity coeff: 1.0989
norm(ch) = 0.99858
iter: 1373, Minibatch log likelihood (pre-update): -54.465, error rate (pre-update): 0.10545

size_minibatch = 20000
Precon grad coeff: 0.024857, velocity coeff: 0.93936
norm(ch) = 0.94277
iter: 1374, Minibatch log likelihood (pre-update): -54.4648, error rate (pre-update): 0.10541

size_minibatch = 20000
Precon grad coeff: 0.025669, velocity coeff: 0.99353
norm(ch) = 0.94141
rho = 0.99724
New lambda: 9.8079e-029
iter: 1375, Minibatch log likelihood (pre-update): -54.4646, error rate (pre-update): 0.10538
iter: 1375, Minibatch log likelihood (post-update): -54.4645, error rate (post-update): 0.10535

size_minibatch = 20000
Precon grad coeff: 0.022369, velocity coeff: 0.94936
norm(ch) = 0.89803
iter: 1376, Minibatch log likelihood (pre-update): -54.4645, error rate (pre-update): 0.10535

size_minibatch = 20000
Precon grad coeff: 0.022265, velocity coeff: 1.0002
norm(ch) = 0.90234
iter: 1377, Minibatch log likelihood (pre-update): -54.4643, error rate (pre-update): 0.10533

size_minibatch = 20000
Precon grad coeff: 0.02354, velocity coeff: 1.02
norm(ch) = 0.92508
iter: 1378, Minibatch log likelihood (pre-update): -54.4641, error rate (pre-update): 0.10529

size_minibatch = 20000
Precon grad coeff: 0.024205, velocity coeff: 1.0051
norm(ch) = 0.93424
iter: 1379, Minibatch log likelihood (pre-update): -54.464, error rate (pre-update): 0.10526

size_minibatch = 20000
Precon grad coeff: 0.029743, velocity coeff: 1.042
New gamma: 0.0031623
norm(ch) = 0.97953
rho = 1.005
New lambda: 7.5892e-029
iter: 1380, Minibatch log likelihood (pre-update): -54.4638, error rate (pre-update): 0.10523
iter: 1380, Minibatch log likelihood (post-update): -54.4636, error rate (post-update): 0.10521

size_minibatch = 20000
Precon grad coeff: 0.030595, velocity coeff: 0.99712
norm(ch) = 0.9834
iter: 1381, Minibatch log likelihood (pre-update): -54.4636, error rate (pre-update): 0.10521

size_minibatch = 20000
Precon grad coeff: 0.026056, velocity coeff: 0.92862
norm(ch) = 0.91839
iter: 1382, Minibatch log likelihood (pre-update): -54.4634, error rate (pre-update): 0.10516

size_minibatch = 20000
Precon grad coeff: 0.028732, velocity coeff: 1.0848
norm(ch) = 1.0019
iter: 1383, Minibatch log likelihood (pre-update): -54.4633, error rate (pre-update): 0.10514

size_minibatch = 20000
Precon grad coeff: 0.025325, velocity coeff: 0.93014
norm(ch) = 0.93691
iter: 1384, Minibatch log likelihood (pre-update): -54.4631, error rate (pre-update): 0.10512

size_minibatch = 20000
Precon grad coeff: 0.025123, velocity coeff: 1.0268
norm(ch) = 0.9672
rho = 1.0074
New lambda: 5.8724e-029
iter: 1385, Minibatch log likelihood (pre-update): -54.4629, error rate (pre-update): 0.10508
iter: 1385, Minibatch log likelihood (post-update): -54.4627, error rate (post-update): 0.10506

size_minibatch = 20000
Precon grad coeff: 0.025094, velocity coeff: 1.0262
norm(ch) = 0.99754
iter: 1386, Minibatch log likelihood (pre-update): -54.4627, error rate (pre-update): 0.10506

size_minibatch = 20000
Precon grad coeff: 0.026316, velocity coeff: 1.005
norm(ch) = 1.0073
iter: 1387, Minibatch log likelihood (pre-update): -54.4625, error rate (pre-update): 0.10501

size_minibatch = 20000
Precon grad coeff: 0.027515, velocity coeff: 1.0275
norm(ch) = 1.0404
iter: 1388, Minibatch log likelihood (pre-update): -54.4624, error rate (pre-update): 0.10499

size_minibatch = 20000
Precon grad coeff: 0.03044, velocity coeff: 0.98605
norm(ch) = 1.0317
iter: 1389, Minibatch log likelihood (pre-update): -54.4622, error rate (pre-update): 0.10495

size_minibatch = 20000
Precon grad coeff: 0.024864, velocity coeff: 0.89663
norm(ch) = 0.92947
rho = 1.0175
New lambda: 4.5439e-029
iter: 1390, Minibatch log likelihood (pre-update): -54.462, error rate (pre-update): 0.10491
iter: 1390, Minibatch log likelihood (post-update): -54.4618, error rate (post-update): 0.10488

size_minibatch = 20000
Precon grad coeff: 0.026168, velocity coeff: 1.0158
norm(ch) = 0.94903
iter: 1391, Minibatch log likelihood (pre-update): -54.4618, error rate (pre-update): 0.10488

size_minibatch = 20000
Precon grad coeff: 0.024189, velocity coeff: 0.93629
norm(ch) = 0.89285
iter: 1392, Minibatch log likelihood (pre-update): -54.4616, error rate (pre-update): 0.10485

size_minibatch = 20000
Precon grad coeff: 0.024525, velocity coeff: 1.0082
norm(ch) = 0.90477
iter: 1393, Minibatch log likelihood (pre-update): -54.4615, error rate (pre-update): 0.10483

size_minibatch = 20000
Precon grad coeff: 0.023091, velocity coeff: 0.98702
norm(ch) = 0.89712
iter: 1394, Minibatch log likelihood (pre-update): -54.4613, error rate (pre-update): 0.1048

size_minibatch = 20000
Precon grad coeff: 0.027991, velocity coeff: 1.0996
norm(ch) = 0.99207
rho = 1.0068
New lambda: 3.516e-029
iter: 1395, Minibatch log likelihood (pre-update): -54.4612, error rate (pre-update): 0.10477
iter: 1395, Minibatch log likelihood (post-update): -54.461, error rate (post-update): 0.10475

size_minibatch = 20000
Precon grad coeff: 0.026681, velocity coeff: 0.96745
norm(ch) = 0.96456
iter: 1396, Minibatch log likelihood (pre-update): -54.461, error rate (pre-update): 0.10475

size_minibatch = 20000
Precon grad coeff: 0.025972, velocity coeff: 0.99971
norm(ch) = 0.96903
iter: 1397, Minibatch log likelihood (pre-update): -54.4608, error rate (pre-update): 0.1047

size_minibatch = 20000
Precon grad coeff: 0.026456, velocity coeff: 0.99386
norm(ch) = 0.96781
iter: 1398, Minibatch log likelihood (pre-update): -54.4606, error rate (pre-update): 0.10468

size_minibatch = 20000
Precon grad coeff: 0.025416, velocity coeff: 0.98753
norm(ch) = 0.96054
iter: 1399, Minibatch log likelihood (pre-update): -54.4605, error rate (pre-update): 0.10465

size_minibatch = 20000
Precon grad coeff: 0.023608, velocity coeff: 0.88825
New gamma: 0.0031623
norm(ch) = 0.85801
rho = 0.97993
New lambda: 2.7206e-029
iter: 1400, Minibatch log likelihood (pre-update): -54.4603, error rate (pre-update): 0.10462
iter: 1400, Minibatch log likelihood (post-update): -54.4601, error rate (post-update): 0.10459
---
Full log-likelihood: -54.4601, error rate: 0.10459
TEST log-likelihood: -54.7404, error rate: 0.24198
Error difference (test - train): 0.13738
---
Full log-likelihood (averaged params): -54.5463, error rate (averaged params): 0.13358
TEST log-likelihood (averaged params): -54.7683, error rate (averaged params): 0.25323
Error difference (test - train) (averaged params): 0.11964

size_minibatch = 20000
Precon grad coeff: 0.024047, velocity coeff: 1.0527
norm(ch) = 0.90774
iter: 1401, Minibatch log likelihood (pre-update): -54.4601, error rate (pre-update): 0.10459

size_minibatch = 20000
Precon grad coeff: 0.024034, velocity coeff: 0.96233
norm(ch) = 0.87838
iter: 1402, Minibatch log likelihood (pre-update): -54.46, error rate (pre-update): 0.10456

size_minibatch = 20000
Precon grad coeff: 0.025467, velocity coeff: 1.0645
norm(ch) = 0.93972
iter: 1403, Minibatch log likelihood (pre-update): -54.4598, error rate (pre-update): 0.10452

size_minibatch = 20000
Precon grad coeff: 0.026447, velocity coeff: 1.0222
norm(ch) = 0.96638
iter: 1404, Minibatch log likelihood (pre-update): -54.4597, error rate (pre-update): 0.10451

size_minibatch = 20000
Precon grad coeff: 0.026602, velocity coeff: 1.0053
norm(ch) = 0.97636
rho = 1.0025
New lambda: 2.1052e-029
iter: 1405, Minibatch log likelihood (pre-update): -54.4595, error rate (pre-update): 0.10447
iter: 1405, Minibatch log likelihood (post-update): -54.4593, error rate (post-update): 0.10444

size_minibatch = 20000
Precon grad coeff: 0.027535, velocity coeff: 1.0289
norm(ch) = 1.01
iter: 1406, Minibatch log likelihood (pre-update): -54.4593, error rate (pre-update): 0.10444

size_minibatch = 20000
Precon grad coeff: 0.026291, velocity coeff: 0.96998
norm(ch) = 0.98464
iter: 1407, Minibatch log likelihood (pre-update): -54.4591, error rate (pre-update): 0.10443

size_minibatch = 20000
Precon grad coeff: 0.026079, velocity coeff: 0.98536
norm(ch) = 0.9751
iter: 1408, Minibatch log likelihood (pre-update): -54.459, error rate (pre-update): 0.10436

size_minibatch = 20000
Precon grad coeff: 0.024873, velocity coeff: 0.97084
norm(ch) = 0.95117
iter: 1409, Minibatch log likelihood (pre-update): -54.4588, error rate (pre-update): 0.10436

size_minibatch = 20000
Precon grad coeff: 0.024725, velocity coeff: 0.98054
norm(ch) = 0.93733
rho = 1.0043
New lambda: 1.6289e-029
iter: 1410, Minibatch log likelihood (pre-update): -54.4586, error rate (pre-update): 0.10433
iter: 1410, Minibatch log likelihood (post-update): -54.4584, error rate (post-update): 0.10428

size_minibatch = 20000
Precon grad coeff: 0.022258, velocity coeff: 0.94189
norm(ch) = 0.88693
iter: 1411, Minibatch log likelihood (pre-update): -54.4584, error rate (pre-update): 0.10428

size_minibatch = 20000
Precon grad coeff: 0.02229, velocity coeff: 0.98965
norm(ch) = 0.88147
iter: 1412, Minibatch log likelihood (pre-update): -54.4583, error rate (pre-update): 0.10425

size_minibatch = 20000
Precon grad coeff: 0.026627, velocity coeff: 1.0989
norm(ch) = 0.97373
iter: 1413, Minibatch log likelihood (pre-update): -54.4581, error rate (pre-update): 0.10425

size_minibatch = 20000
Precon grad coeff: 0.026425, velocity coeff: 0.9666
norm(ch) = 0.94586
iter: 1414, Minibatch log likelihood (pre-update): -54.458, error rate (pre-update): 0.1042

size_minibatch = 20000
Precon grad coeff: 0.024599, velocity coeff: 0.94183
norm(ch) = 0.89516
rho = 1.0049
New lambda: 1.2604e-029
iter: 1415, Minibatch log likelihood (pre-update): -54.4578, error rate (pre-update): 0.10417
iter: 1415, Minibatch log likelihood (post-update): -54.4576, error rate (post-update): 0.10414

size_minibatch = 20000
Precon grad coeff: 0.024796, velocity coeff: 1.0403
norm(ch) = 0.93579
iter: 1416, Minibatch log likelihood (pre-update): -54.4576, error rate (pre-update): 0.10414

size_minibatch = 20000
Precon grad coeff: 0.027014, velocity coeff: 1.0302
norm(ch) = 0.96876
iter: 1417, Minibatch log likelihood (pre-update): -54.4575, error rate (pre-update): 0.10412

size_minibatch = 20000
Precon grad coeff: 0.024544, velocity coeff: 0.92025
norm(ch) = 0.89595
iter: 1418, Minibatch log likelihood (pre-update): -54.4573, error rate (pre-update): 0.10409

size_minibatch = 20000
Precon grad coeff: 0.024321, velocity coeff: 1.0536
norm(ch) = 0.94852
iter: 1419, Minibatch log likelihood (pre-update): -54.4571, error rate (pre-update): 0.10405

size_minibatch = 20000
Precon grad coeff: 0.025166, velocity coeff: 0.92298
New gamma: 0.0031623
norm(ch) = 0.8805
rho = 0.99475
New lambda: 9.753e-030
iter: 1420, Minibatch log likelihood (pre-update): -54.457, error rate (pre-update): 0.10403
iter: 1420, Minibatch log likelihood (post-update): -54.4568, error rate (post-update): 0.10398

size_minibatch = 20000
Precon grad coeff: 0.025132, velocity coeff: 1.0253
norm(ch) = 0.90753
iter: 1421, Minibatch log likelihood (pre-update): -54.4568, error rate (pre-update): 0.10398

size_minibatch = 20000
Precon grad coeff: 0.025712, velocity coeff: 1.0148
norm(ch) = 0.9262
iter: 1422, Minibatch log likelihood (pre-update): -54.4567, error rate (pre-update): 0.10398

size_minibatch = 20000
Precon grad coeff: 0.025619, velocity coeff: 0.99658
norm(ch) = 0.92783
iter: 1423, Minibatch log likelihood (pre-update): -54.4565, error rate (pre-update): 0.10396

size_minibatch = 20000
Precon grad coeff: 0.026479, velocity coeff: 1.0331
norm(ch) = 0.96367
iter: 1424, Minibatch log likelihood (pre-update): -54.4563, error rate (pre-update): 0.10391

size_minibatch = 20000
Precon grad coeff: 0.028519, velocity coeff: 1.0516
norm(ch) = 1.019
rho = 1.0116
New lambda: 7.5467e-030
iter: 1425, Minibatch log likelihood (pre-update): -54.4562, error rate (pre-update): 0.10387
iter: 1425, Minibatch log likelihood (post-update): -54.456, error rate (post-update): 0.10384

size_minibatch = 20000
Precon grad coeff: 0.027148, velocity coeff: 0.95234
norm(ch) = 0.97531
iter: 1426, Minibatch log likelihood (pre-update): -54.456, error rate (pre-update): 0.10384

size_minibatch = 20000
Precon grad coeff: 0.026617, velocity coeff: 1.0085
norm(ch) = 0.98882
iter: 1427, Minibatch log likelihood (pre-update): -54.4558, error rate (pre-update): 0.10382

size_minibatch = 20000
Precon grad coeff: 0.026067, velocity coeff: 0.96392
norm(ch) = 0.95788
iter: 1428, Minibatch log likelihood (pre-update): -54.4556, error rate (pre-update): 0.10379

size_minibatch = 20000
Precon grad coeff: 0.025753, velocity coeff: 0.9825
norm(ch) = 0.94572
iter: 1429, Minibatch log likelihood (pre-update): -54.4555, error rate (pre-update): 0.10374

size_minibatch = 20000
Precon grad coeff: 0.024364, velocity coeff: 0.94018
norm(ch) = 0.89345
rho = 1.0073
New lambda: 5.8395e-030
iter: 1430, Minibatch log likelihood (pre-update): -54.4553, error rate (pre-update): 0.10371
iter: 1430, Minibatch log likelihood (post-update): -54.4552, error rate (post-update): 0.1037

size_minibatch = 20000
Precon grad coeff: 0.022857, velocity coeff: 0.99199
norm(ch) = 0.89047
iter: 1431, Minibatch log likelihood (pre-update): -54.4552, error rate (pre-update): 0.1037

size_minibatch = 20000
Precon grad coeff: 0.025473, velocity coeff: 1.0279
norm(ch) = 0.91975
iter: 1432, Minibatch log likelihood (pre-update): -54.455, error rate (pre-update): 0.10366

size_minibatch = 20000
Precon grad coeff: 0.025359, velocity coeff: 0.98548
norm(ch) = 0.91154
iter: 1433, Minibatch log likelihood (pre-update): -54.4548, error rate (pre-update): 0.10364

size_minibatch = 20000
Precon grad coeff: 0.024544, velocity coeff: 0.9924
norm(ch) = 0.90873
iter: 1434, Minibatch log likelihood (pre-update): -54.4547, error rate (pre-update): 0.10362

size_minibatch = 20000
Precon grad coeff: 0.025612, velocity coeff: 1.0077
norm(ch) = 0.92017
rho = 0.99269
New lambda: 4.5185e-030
iter: 1435, Minibatch log likelihood (pre-update): -54.4545, error rate (pre-update): 0.10359
iter: 1435, Minibatch log likelihood (post-update): -54.4544, error rate (post-update): 0.10356

size_minibatch = 20000
Precon grad coeff: 0.027332, velocity coeff: 1.0439
norm(ch) = 0.96528
iter: 1436, Minibatch log likelihood (pre-update): -54.4544, error rate (pre-update): 0.10356

size_minibatch = 20000
Precon grad coeff: 0.024705, velocity coeff: 0.92067
norm(ch) = 0.89305
iter: 1437, Minibatch log likelihood (pre-update): -54.4542, error rate (pre-update): 0.10351

size_minibatch = 20000
Precon grad coeff: 0.023359, velocity coeff: 1.0144
norm(ch) = 0.91021
iter: 1438, Minibatch log likelihood (pre-update): -54.454, error rate (pre-update): 0.10349

size_minibatch = 20000
Precon grad coeff: 0.026269, velocity coeff: 1.0334
norm(ch) = 0.94524
iter: 1439, Minibatch log likelihood (pre-update): -54.4539, error rate (pre-update): 0.10347

size_minibatch = 20000
Precon grad coeff: 0.024942, velocity coeff: 0.92503
New gamma: 0.0031623
norm(ch) = 0.8791
rho = 1.0032
New lambda: 3.4963e-030
iter: 1440, Minibatch log likelihood (pre-update): -54.4537, error rate (pre-update): 0.10343
iter: 1440, Minibatch log likelihood (post-update): -54.4536, error rate (post-update): 0.10339

size_minibatch = 20000
Precon grad coeff: 0.022078, velocity coeff: 0.94196
norm(ch) = 0.83213
iter: 1441, Minibatch log likelihood (pre-update): -54.4536, error rate (pre-update): 0.10339

size_minibatch = 20000
Precon grad coeff: 0.025289, velocity coeff: 1.0986
norm(ch) = 0.91908
iter: 1442, Minibatch log likelihood (pre-update): -54.4534, error rate (pre-update): 0.10338

size_minibatch = 20000
Precon grad coeff: 0.025928, velocity coeff: 0.97662
norm(ch) = 0.90224
iter: 1443, Minibatch log likelihood (pre-update): -54.4533, error rate (pre-update): 0.10335

size_minibatch = 20000
Precon grad coeff: 0.024335, velocity coeff: 1.0222
norm(ch) = 0.92697
iter: 1444, Minibatch log likelihood (pre-update): -54.4531, error rate (pre-update): 0.10333

size_minibatch = 20000
Precon grad coeff: 0.027913, velocity coeff: 1.0579
norm(ch) = 0.986
rho = 0.99277
New lambda: 2.7054e-030
iter: 1445, Minibatch log likelihood (pre-update): -54.453, error rate (pre-update): 0.1033
iter: 1445, Minibatch log likelihood (post-update): -54.4528, error rate (post-update): 0.10327

size_minibatch = 20000
Precon grad coeff: 0.027319, velocity coeff: 0.98914
norm(ch) = 0.9801
iter: 1446, Minibatch log likelihood (pre-update): -54.4528, error rate (pre-update): 0.10327

size_minibatch = 20000
Precon grad coeff: 0.025468, velocity coeff: 0.94618
norm(ch) = 0.93237
iter: 1447, Minibatch log likelihood (pre-update): -54.4526, error rate (pre-update): 0.10322

size_minibatch = 20000
Precon grad coeff: 0.023557, velocity coeff: 0.97844
norm(ch) = 0.91668
iter: 1448, Minibatch log likelihood (pre-update): -54.4525, error rate (pre-update): 0.1032

size_minibatch = 20000
Precon grad coeff: 0.023181, velocity coeff: 0.94569
norm(ch) = 0.87073
iter: 1449, Minibatch log likelihood (pre-update): -54.4523, error rate (pre-update): 0.10319

size_minibatch = 20000
Precon grad coeff: 0.02254, velocity coeff: 1.0176
norm(ch) = 0.89026
rho = 1.0169
New lambda: 2.0934e-030
iter: 1450, Minibatch log likelihood (pre-update): -54.4522, error rate (pre-update): 0.10314
iter: 1450, Minibatch log likelihood (post-update): -54.452, error rate (post-update): 0.10312
---
Full log-likelihood: -54.452, error rate: 0.10312
TEST log-likelihood: -54.742, error rate: 0.24339
Error difference (test - train): 0.14028
---
Full log-likelihood (averaged params): -54.5321, error rate (averaged params): 0.13011
TEST log-likelihood (averaged params): -54.7649, error rate (averaged params): 0.2527
Error difference (test - train) (averaged params): 0.12258

size_minibatch = 20000
Precon grad coeff: 0.025483, velocity coeff: 1.0294
norm(ch) = 0.92094
iter: 1451, Minibatch log likelihood (pre-update): -54.452, error rate (pre-update): 0.10312

size_minibatch = 20000
Precon grad coeff: 0.02447, velocity coeff: 0.97029
norm(ch) = 0.89771
iter: 1452, Minibatch log likelihood (pre-update): -54.4518, error rate (pre-update): 0.1031

size_minibatch = 20000
Precon grad coeff: 0.028443, velocity coeff: 1.0731
norm(ch) = 0.96858
iter: 1453, Minibatch log likelihood (pre-update): -54.4517, error rate (pre-update): 0.10307

size_minibatch = 20000
Precon grad coeff: 0.023486, velocity coeff: 0.89138
norm(ch) = 0.86766
iter: 1454, Minibatch log likelihood (pre-update): -54.4515, error rate (pre-update): 0.10303

size_minibatch = 20000
Precon grad coeff: 0.02503, velocity coeff: 1.0204
norm(ch) = 0.88956
rho = 1.0059
New lambda: 1.6198e-030
iter: 1455, Minibatch log likelihood (pre-update): -54.4514, error rate (pre-update): 0.103
iter: 1455, Minibatch log likelihood (post-update): -54.4512, error rate (post-update): 0.10298

size_minibatch = 20000
Precon grad coeff: 0.024907, velocity coeff: 1.0276
norm(ch) = 0.91815
iter: 1456, Minibatch log likelihood (pre-update): -54.4512, error rate (pre-update): 0.10298

size_minibatch = 20000
Precon grad coeff: 0.02296, velocity coeff: 0.93956
norm(ch) = 0.86707
iter: 1457, Minibatch log likelihood (pre-update): -54.4511, error rate (pre-update): 0.10295

size_minibatch = 20000
Precon grad coeff: 0.021298, velocity coeff: 0.96886
norm(ch) = 0.84365
iter: 1458, Minibatch log likelihood (pre-update): -54.4509, error rate (pre-update): 0.10293

size_minibatch = 20000
Precon grad coeff: 0.02441, velocity coeff: 1.0941
norm(ch) = 0.92733
iter: 1459, Minibatch log likelihood (pre-update): -54.4508, error rate (pre-update): 0.1029

size_minibatch = 20000
Precon grad coeff: 0.025179, velocity coeff: 0.92919
New gamma: 0.0031623
norm(ch) = 0.86603
rho = 0.99552
New lambda: 1.2534e-030
iter: 1460, Minibatch log likelihood (pre-update): -54.4506, error rate (pre-update): 0.10287
iter: 1460, Minibatch log likelihood (post-update): -54.4505, error rate (post-update): 0.10284

size_minibatch = 20000
Precon grad coeff: 0.025625, velocity coeff: 1.0534
norm(ch) = 0.9174
iter: 1461, Minibatch log likelihood (pre-update): -54.4505, error rate (pre-update): 0.10284

size_minibatch = 20000
Precon grad coeff: 0.027141, velocity coeff: 1.0189
norm(ch) = 0.94001
iter: 1462, Minibatch log likelihood (pre-update): -54.4503, error rate (pre-update): 0.10282

size_minibatch = 20000
Precon grad coeff: 0.026922, velocity coeff: 0.98691
norm(ch) = 0.93219
iter: 1463, Minibatch log likelihood (pre-update): -54.4502, error rate (pre-update): 0.10277

size_minibatch = 20000
Precon grad coeff: 0.025376, velocity coeff: 0.99651
norm(ch) = 0.93352
iter: 1464, Minibatch log likelihood (pre-update): -54.45, error rate (pre-update): 0.10276

size_minibatch = 20000
Precon grad coeff: 0.022867, velocity coeff: 0.91493
norm(ch) = 0.8581
rho = 0.99892
New lambda: 9.6984e-031
iter: 1465, Minibatch log likelihood (pre-update): -54.4499, error rate (pre-update): 0.10272
iter: 1465, Minibatch log likelihood (post-update): -54.4497, error rate (post-update): 0.10267

size_minibatch = 20000
Precon grad coeff: 0.022917, velocity coeff: 1.0715
norm(ch) = 0.92324
iter: 1466, Minibatch log likelihood (pre-update): -54.4497, error rate (pre-update): 0.10267

size_minibatch = 20000
Precon grad coeff: 0.02654, velocity coeff: 1.0259
norm(ch) = 0.95192
iter: 1467, Minibatch log likelihood (pre-update): -54.4496, error rate (pre-update): 0.10268

size_minibatch = 20000
Precon grad coeff: 0.025542, velocity coeff: 0.98233
norm(ch) = 0.93952
iter: 1468, Minibatch log likelihood (pre-update): -54.4494, error rate (pre-update): 0.10266

size_minibatch = 20000
Precon grad coeff: 0.025843, velocity coeff: 0.99209
norm(ch) = 0.93675
iter: 1469, Minibatch log likelihood (pre-update): -54.4492, error rate (pre-update): 0.10261

size_minibatch = 20000
Precon grad coeff: 0.026395, velocity coeff: 0.98433
norm(ch) = 0.92652
rho = 0.99369
New lambda: 7.5045e-031
iter: 1470, Minibatch log likelihood (pre-update): -54.4491, error rate (pre-update): 0.10258
iter: 1470, Minibatch log likelihood (post-update): -54.4489, error rate (post-update): 0.10254

size_minibatch = 20000
Precon grad coeff: 0.024486, velocity coeff: 0.9335
norm(ch) = 0.86897
iter: 1471, Minibatch log likelihood (pre-update): -54.4489, error rate (pre-update): 0.10254

size_minibatch = 20000
Precon grad coeff: 0.022229, velocity coeff: 0.96824
norm(ch) = 0.84521
iter: 1472, Minibatch log likelihood (pre-update): -54.4488, error rate (pre-update): 0.10253

size_minibatch = 20000
Precon grad coeff: 0.02382, velocity coeff: 1.049
norm(ch) = 0.89085
iter: 1473, Minibatch log likelihood (pre-update): -54.4486, error rate (pre-update): 0.10251

size_minibatch = 20000
Precon grad coeff: 0.023506, velocity coeff: 0.96205
norm(ch) = 0.86075
iter: 1474, Minibatch log likelihood (pre-update): -54.4485, error rate (pre-update): 0.10247

size_minibatch = 20000
Precon grad coeff: 0.023564, velocity coeff: 1.0183
norm(ch) = 0.88074
rho = 1.0217
New lambda: 5.8068e-031
iter: 1475, Minibatch log likelihood (pre-update): -54.4483, error rate (pre-update): 0.10243
iter: 1475, Minibatch log likelihood (post-update): -54.4482, error rate (post-update): 0.10241

size_minibatch = 20000
Precon grad coeff: 0.027109, velocity coeff: 1.0892
norm(ch) = 0.96412
iter: 1476, Minibatch log likelihood (pre-update): -54.4482, error rate (pre-update): 0.10241

size_minibatch = 20000
Precon grad coeff: 0.023807, velocity coeff: 0.8721
norm(ch) = 0.8446
iter: 1477, Minibatch log likelihood (pre-update): -54.448, error rate (pre-update): 0.10239

size_minibatch = 20000
Precon grad coeff: 0.02315, velocity coeff: 1.083
norm(ch) = 0.9186
iter: 1478, Minibatch log likelihood (pre-update): -54.4479, error rate (pre-update): 0.10236

size_minibatch = 20000
Precon grad coeff: 0.023917, velocity coeff: 0.96406
norm(ch) = 0.88967
iter: 1479, Minibatch log likelihood (pre-update): -54.4477, error rate (pre-update): 0.10233

size_minibatch = 20000
Precon grad coeff: 0.025435, velocity coeff: 0.98984
New gamma: 0.0031623
norm(ch) = 0.8854
rho = 1.0095
New lambda: 4.4932e-031
iter: 1480, Minibatch log likelihood (pre-update): -54.4476, error rate (pre-update): 0.10231
iter: 1480, Minibatch log likelihood (post-update): -54.4475, error rate (post-update): 0.10229

size_minibatch = 20000
Precon grad coeff: 0.022613, velocity coeff: 0.95594
norm(ch) = 0.8504
iter: 1481, Minibatch log likelihood (pre-update): -54.4475, error rate (pre-update): 0.10229

size_minibatch = 20000
Precon grad coeff: 0.027851, velocity coeff: 1.1149
norm(ch) = 0.95337
iter: 1482, Minibatch log likelihood (pre-update): -54.4473, error rate (pre-update): 0.10223

size_minibatch = 20000
Precon grad coeff: 0.025961, velocity coeff: 0.95424
norm(ch) = 0.91413
iter: 1483, Minibatch log likelihood (pre-update): -54.4472, error rate (pre-update): 0.10221

size_minibatch = 20000
Precon grad coeff: 0.025411, velocity coeff: 1.0087
norm(ch) = 0.92624
iter: 1484, Minibatch log likelihood (pre-update): -54.447, error rate (pre-update): 0.1022

size_minibatch = 20000
Precon grad coeff: 0.025824, velocity coeff: 1.0066
norm(ch) = 0.93697
rho = 1.0237
New lambda: 3.4767e-031
iter: 1485, Minibatch log likelihood (pre-update): -54.4468, error rate (pre-update): 0.10217
iter: 1485, Minibatch log likelihood (post-update): -54.4467, error rate (post-update): 0.10213

size_minibatch = 20000
Precon grad coeff: 0.025606, velocity coeff: 0.98967
norm(ch) = 0.93212
iter: 1486, Minibatch log likelihood (pre-update): -54.4467, error rate (pre-update): 0.10213

size_minibatch = 20000
Precon grad coeff: 0.024169, velocity coeff: 0.98497
norm(ch) = 0.92228
iter: 1487, Minibatch log likelihood (pre-update): -54.4465, error rate (pre-update): 0.10208

size_minibatch = 20000
Precon grad coeff: 0.023113, velocity coeff: 0.93378
norm(ch) = 0.86477
iter: 1488, Minibatch log likelihood (pre-update): -54.4464, error rate (pre-update): 0.10206

size_minibatch = 20000
Precon grad coeff: 0.02451, velocity coeff: 1.0777
norm(ch) = 0.93659
iter: 1489, Minibatch log likelihood (pre-update): -54.4462, error rate (pre-update): 0.10205

size_minibatch = 20000
Precon grad coeff: 0.026225, velocity coeff: 0.98264
norm(ch) = 0.92456
rho = 0.9912
New lambda: 2.6902e-031
iter: 1490, Minibatch log likelihood (pre-update): -54.4461, error rate (pre-update): 0.10201
iter: 1490, Minibatch log likelihood (post-update): -54.4459, error rate (post-update): 0.10198

size_minibatch = 20000
Precon grad coeff: 0.026475, velocity coeff: 0.98808
norm(ch) = 0.91795
iter: 1491, Minibatch log likelihood (pre-update): -54.4459, error rate (pre-update): 0.10198

size_minibatch = 20000
Precon grad coeff: 0.022636, velocity coeff: 0.9207
norm(ch) = 0.84898
iter: 1492, Minibatch log likelihood (pre-update): -54.4458, error rate (pre-update): 0.10196

size_minibatch = 20000
Precon grad coeff: 0.026455, velocity coeff: 1.1079
norm(ch) = 0.94517
iter: 1493, Minibatch log likelihood (pre-update): -54.4456, error rate (pre-update): 0.10193

size_minibatch = 20000
Precon grad coeff: 0.022469, velocity coeff: 0.85083
norm(ch) = 0.80785
iter: 1494, Minibatch log likelihood (pre-update): -54.4455, error rate (pre-update): 0.1019

size_minibatch = 20000
Precon grad coeff: 0.023136, velocity coeff: 1.1238
norm(ch) = 0.91185
rho = 1.0134
New lambda: 2.0817e-031
iter: 1495, Minibatch log likelihood (pre-update): -54.4454, error rate (pre-update): 0.10187
iter: 1495, Minibatch log likelihood (post-update): -54.4452, error rate (post-update): 0.10183

size_minibatch = 20000
Precon grad coeff: 0.024935, velocity coeff: 0.97335
norm(ch) = 0.89149
iter: 1496, Minibatch log likelihood (pre-update): -54.4452, error rate (pre-update): 0.10183

size_minibatch = 20000
Precon grad coeff: 0.025147, velocity coeff: 1.038
norm(ch) = 0.92955
iter: 1497, Minibatch log likelihood (pre-update): -54.4451, error rate (pre-update): 0.10182

size_minibatch = 20000
Precon grad coeff: 0.024709, velocity coeff: 0.96938
norm(ch) = 0.90518
iter: 1498, Minibatch log likelihood (pre-update): -54.4449, error rate (pre-update): 0.10178

size_minibatch = 20000
Precon grad coeff: 0.024173, velocity coeff: 0.98219
norm(ch) = 0.89299
iter: 1499, Minibatch log likelihood (pre-update): -54.4448, error rate (pre-update): 0.10175

size_minibatch = 20000
Precon grad coeff: 0.024643, velocity coeff: 0.94987
New gamma: 0.0031623
norm(ch) = 0.85277
rho = 0.99293
New lambda: 1.6107e-031
iter: 1500, Minibatch log likelihood (pre-update): -54.4446, error rate (pre-update): 0.10173
iter: 1500, Minibatch log likelihood (post-update): -54.4445, error rate (post-update): 0.1017
---
Full log-likelihood: -54.4445, error rate: 0.1017
TEST log-likelihood: -54.7439, error rate: 0.2447
Error difference (test - train): 0.14299
---
Full log-likelihood (averaged params): -54.5197, error rate (averaged params): 0.12721
TEST log-likelihood (averaged params): -54.7635, error rate (averaged params): 0.25294
Error difference (test - train) (averaged params): 0.12573

size_minibatch = 20000
Precon grad coeff: 0.023727, velocity coeff: 1.0017
norm(ch) = 0.85854
iter: 1501, Minibatch log likelihood (pre-update): -54.4445, error rate (pre-update): 0.1017

size_minibatch = 20000
Precon grad coeff: 0.026037, velocity coeff: 1.0309
norm(ch) = 0.88988
iter: 1502, Minibatch log likelihood (pre-update): -54.4443, error rate (pre-update): 0.10168

size_minibatch = 20000
Precon grad coeff: 0.026911, velocity coeff: 1.0366
norm(ch) = 0.92746
iter: 1503, Minibatch log likelihood (pre-update): -54.4442, error rate (pre-update): 0.10163

size_minibatch = 20000
Precon grad coeff: 0.026866, velocity coeff: 0.99799
norm(ch) = 0.93005
iter: 1504, Minibatch log likelihood (pre-update): -54.444, error rate (pre-update): 0.10162

size_minibatch = 20000
Precon grad coeff: 0.023509, velocity coeff: 0.95281
norm(ch) = 0.89028
rho = 1.0112
New lambda: 1.2464e-031
iter: 1505, Minibatch log likelihood (pre-update): -54.4439, error rate (pre-update): 0.10159
iter: 1505, Minibatch log likelihood (post-update): -54.4437, error rate (post-update): 0.10154

size_minibatch = 20000
Precon grad coeff: 0.0282, velocity coeff: 1.1508
norm(ch) = 1.0298
iter: 1506, Minibatch log likelihood (pre-update): -54.4437, error rate (pre-update): 0.10154

size_minibatch = 20000
Precon grad coeff: 0.026746, velocity coeff: 0.89268
norm(ch) = 0.92384
iter: 1507, Minibatch log likelihood (pre-update): -54.4436, error rate (pre-update): 0.10154

size_minibatch = 20000
Precon grad coeff: 0.022545, velocity coeff: 0.97048
norm(ch) = 0.90027
iter: 1508, Minibatch log likelihood (pre-update): -54.4434, error rate (pre-update): 0.1015

size_minibatch = 20000
Precon grad coeff: 0.024022, velocity coeff: 1.0194
norm(ch) = 0.92174
iter: 1509, Minibatch log likelihood (pre-update): -54.4433, error rate (pre-update): 0.10146

size_minibatch = 20000
Precon grad coeff: 0.025774, velocity coeff: 1.0032
norm(ch) = 0.92924
rho = 1.0194
New lambda: 9.6441e-032
iter: 1510, Minibatch log likelihood (pre-update): -54.4431, error rate (pre-update): 0.10144
iter: 1510, Minibatch log likelihood (post-update): -54.443, error rate (post-update): 0.10141

size_minibatch = 20000
Precon grad coeff: 0.025298, velocity coeff: 0.95306
norm(ch) = 0.88985
iter: 1511, Minibatch log likelihood (pre-update): -54.443, error rate (pre-update): 0.10141

size_minibatch = 20000
Precon grad coeff: 0.022773, velocity coeff: 0.96976
norm(ch) = 0.86646
iter: 1512, Minibatch log likelihood (pre-update): -54.4428, error rate (pre-update): 0.10136

size_minibatch = 20000
Precon grad coeff: 0.026062, velocity coeff: 1.0256
norm(ch) = 0.89279
iter: 1513, Minibatch log likelihood (pre-update): -54.4427, error rate (pre-update): 0.10136

size_minibatch = 20000
Precon grad coeff: 0.024192, velocity coeff: 0.97075
norm(ch) = 0.87069
iter: 1514, Minibatch log likelihood (pre-update): -54.4425, error rate (pre-update): 0.10132

size_minibatch = 20000
Precon grad coeff: 0.027131, velocity coeff: 1.0883
norm(ch) = 0.95196
rho = 1.0104
New lambda: 7.4624e-032
iter: 1515, Minibatch log likelihood (pre-update): -54.4424, error rate (pre-update): 0.10129
iter: 1515, Minibatch log likelihood (post-update): -54.4422, error rate (post-update): 0.10128

size_minibatch = 20000
Precon grad coeff: 0.022745, velocity coeff: 0.85661
norm(ch) = 0.81908
iter: 1516, Minibatch log likelihood (pre-update): -54.4422, error rate (pre-update): 0.10128

size_minibatch = 20000
Precon grad coeff: 0.022987, velocity coeff: 1.1196
norm(ch) = 0.9209
iter: 1517, Minibatch log likelihood (pre-update): -54.4421, error rate (pre-update): 0.10123

size_minibatch = 20000
Precon grad coeff: 0.026971, velocity coeff: 1.0349
norm(ch) = 0.95723
iter: 1518, Minibatch log likelihood (pre-update): -54.442, error rate (pre-update): 0.10121

size_minibatch = 20000
Precon grad coeff: 0.021616, velocity coeff: 0.86055
norm(ch) = 0.82687
iter: 1519, Minibatch log likelihood (pre-update): -54.4418, error rate (pre-update): 0.10117

size_minibatch = 20000
Precon grad coeff: 0.025526, velocity coeff: 1.1457
New gamma: 0.0031623
norm(ch) = 0.95178
rho = 0.99764
New lambda: 5.7743e-032
iter: 1520, Minibatch log likelihood (pre-update): -54.4417, error rate (pre-update): 0.10115
iter: 1520, Minibatch log likelihood (post-update): -54.4415, error rate (post-update): 0.10114

size_minibatch = 20000
Precon grad coeff: 0.026529, velocity coeff: 0.94839
norm(ch) = 0.90745
iter: 1521, Minibatch log likelihood (pre-update): -54.4415, error rate (pre-update): 0.10114

size_minibatch = 20000
Precon grad coeff: 0.027915, velocity coeff: 1.0601
norm(ch) = 0.96695
iter: 1522, Minibatch log likelihood (pre-update): -54.4414, error rate (pre-update): 0.10111

size_minibatch = 20000
Precon grad coeff: 0.027338, velocity coeff: 0.977
norm(ch) = 0.94922
iter: 1523, Minibatch log likelihood (pre-update): -54.4412, error rate (pre-update): 0.10106

size_minibatch = 20000
Precon grad coeff: 0.024377, velocity coeff: 0.9302
norm(ch) = 0.88696
iter: 1524, Minibatch log likelihood (pre-update): -54.4411, error rate (pre-update): 0.10103

size_minibatch = 20000
Precon grad coeff: 0.023719, velocity coeff: 1.0323
norm(ch) = 0.91911
rho = 1.0292
New lambda: 4.468e-032
iter: 1525, Minibatch log likelihood (pre-update): -54.4409, error rate (pre-update): 0.10101
iter: 1525, Minibatch log likelihood (post-update): -54.4408, error rate (post-update): 0.10099

size_minibatch = 20000
Precon grad coeff: 0.024012, velocity coeff: 0.9486
norm(ch) = 0.87593
iter: 1526, Minibatch log likelihood (pre-update): -54.4408, error rate (pre-update): 0.10099

size_minibatch = 20000
Precon grad coeff: 0.02502, velocity coeff: 1.0863
norm(ch) = 0.95554
iter: 1527, Minibatch log likelihood (pre-update): -54.4406, error rate (pre-update): 0.10096

size_minibatch = 20000
Precon grad coeff: 0.025065, velocity coeff: 0.93193
norm(ch) = 0.89429
iter: 1528, Minibatch log likelihood (pre-update): -54.4405, error rate (pre-update): 0.10091

size_minibatch = 20000
Precon grad coeff: 0.023398, velocity coeff: 0.98942
norm(ch) = 0.88888
iter: 1529, Minibatch log likelihood (pre-update): -54.4403, error rate (pre-update): 0.1009

size_minibatch = 20000
Precon grad coeff: 0.027256, velocity coeff: 1.0744
norm(ch) = 0.95952
rho = 1.0194
New lambda: 3.4573e-032
iter: 1530, Minibatch log likelihood (pre-update): -54.4402, error rate (pre-update): 0.10087
iter: 1530, Minibatch log likelihood (post-update): -54.44, error rate (post-update): 0.10085

size_minibatch = 20000
Precon grad coeff: 0.02605, velocity coeff: 0.94122
norm(ch) = 0.90722
iter: 1531, Minibatch log likelihood (pre-update): -54.44, error rate (pre-update): 0.10085

size_minibatch = 20000
Precon grad coeff: 0.02262, velocity coeff: 0.95681
norm(ch) = 0.87149
iter: 1532, Minibatch log likelihood (pre-update): -54.4399, error rate (pre-update): 0.10083

size_minibatch = 20000
Precon grad coeff: 0.023511, velocity coeff: 1.0015
norm(ch) = 0.8766
iter: 1533, Minibatch log likelihood (pre-update): -54.4398, error rate (pre-update): 0.10078

size_minibatch = 20000
Precon grad coeff: 0.026488, velocity coeff: 1.055
norm(ch) = 0.92891
iter: 1534, Minibatch log likelihood (pre-update): -54.4396, error rate (pre-update): 0.10076

size_minibatch = 20000
Precon grad coeff: 0.0233, velocity coeff: 0.9421
norm(ch) = 0.87893
rho = 1.0105
New lambda: 2.6752e-032
iter: 1535, Minibatch log likelihood (pre-update): -54.4395, error rate (pre-update): 0.10073
iter: 1535, Minibatch log likelihood (post-update): -54.4393, error rate (post-update): 0.1007

size_minibatch = 20000
Precon grad coeff: 0.022476, velocity coeff: 0.97217
norm(ch) = 0.85767
iter: 1536, Minibatch log likelihood (pre-update): -54.4393, error rate (pre-update): 0.1007

size_minibatch = 20000
Precon grad coeff: 0.022552, velocity coeff: 1.0094
norm(ch) = 0.86944
iter: 1537, Minibatch log likelihood (pre-update): -54.4392, error rate (pre-update): 0.10068

size_minibatch = 20000
Precon grad coeff: 0.023935, velocity coeff: 1.0511
norm(ch) = 0.91754
iter: 1538, Minibatch log likelihood (pre-update): -54.4391, error rate (pre-update): 0.10066

size_minibatch = 20000
Precon grad coeff: 0.027589, velocity coeff: 1.0371
norm(ch) = 0.95563
iter: 1539, Minibatch log likelihood (pre-update): -54.4389, error rate (pre-update): 0.10062

size_minibatch = 20000
Precon grad coeff: 0.025206, velocity coeff: 0.92438
New gamma: 0.0031623
norm(ch) = 0.8879
rho = 1.0164
New lambda: 2.07e-032
iter: 1540, Minibatch log likelihood (pre-update): -54.4388, error rate (pre-update): 0.1006
iter: 1540, Minibatch log likelihood (post-update): -54.4386, error rate (post-update): 0.10058

size_minibatch = 20000
Precon grad coeff: 0.024674, velocity coeff: 0.99938
norm(ch) = 0.89139
iter: 1541, Minibatch log likelihood (pre-update): -54.4386, error rate (pre-update): 0.10058

size_minibatch = 20000
Precon grad coeff: 0.026596, velocity coeff: 1.0561
norm(ch) = 0.94637
iter: 1542, Minibatch log likelihood (pre-update): -54.4385, error rate (pre-update): 0.10055

size_minibatch = 20000
Precon grad coeff: 0.027137, velocity coeff: 0.99855
norm(ch) = 0.94956
iter: 1543, Minibatch log likelihood (pre-update): -54.4383, error rate (pre-update): 0.10052

size_minibatch = 20000
Precon grad coeff: 0.024119, velocity coeff: 0.9439
norm(ch) = 0.9002
iter: 1544, Minibatch log likelihood (pre-update): -54.4382, error rate (pre-update): 0.1005

size_minibatch = 20000
Precon grad coeff: 0.025613, velocity coeff: 1.0584
norm(ch) = 0.95722
rho = 1.0044
New lambda: 1.6017e-032
iter: 1545, Minibatch log likelihood (pre-update): -54.438, error rate (pre-update): 0.10046
iter: 1545, Minibatch log likelihood (post-update): -54.4379, error rate (post-update): 0.10041

size_minibatch = 20000
Precon grad coeff: 0.02425, velocity coeff: 0.93995
norm(ch) = 0.90345
iter: 1546, Minibatch log likelihood (pre-update): -54.4379, error rate (pre-update): 0.10041

size_minibatch = 20000
Precon grad coeff: 0.023712, velocity coeff: 0.99621
norm(ch) = 0.9041
iter: 1547, Minibatch log likelihood (pre-update): -54.4377, error rate (pre-update): 0.10041

size_minibatch = 20000
Precon grad coeff: 0.024259, velocity coeff: 1.018
norm(ch) = 0.92435
iter: 1548, Minibatch log likelihood (pre-update): -54.4376, error rate (pre-update): 0.10039

size_minibatch = 20000
Precon grad coeff: 0.025226, velocity coeff: 0.96468
norm(ch) = 0.89582
iter: 1549, Minibatch log likelihood (pre-update): -54.4375, error rate (pre-update): 0.10035

size_minibatch = 20000
Precon grad coeff: 0.021669, velocity coeff: 0.95388
norm(ch) = 0.85786
rho = 0.99037
New lambda: 1.2394e-032
iter: 1550, Minibatch log likelihood (pre-update): -54.4373, error rate (pre-update): 0.10032
iter: 1550, Minibatch log likelihood (post-update): -54.4372, error rate (post-update): 0.1003
---
Full log-likelihood: -54.4372, error rate: 0.1003
TEST log-likelihood: -54.7489, error rate: 0.24656
Error difference (test - train): 0.14626
---
Full log-likelihood (averaged params): -54.5092, error rate (averaged params): 0.12494
TEST log-likelihood (averaged params): -54.7638, error rate (averaged params): 0.2538
Error difference (test - train) (averaged params): 0.12886

size_minibatch = 20000
Precon grad coeff: 0.025941, velocity coeff: 1.0827
norm(ch) = 0.93281
iter: 1551, Minibatch log likelihood (pre-update): -54.4372, error rate (pre-update): 0.1003

size_minibatch = 20000
Precon grad coeff: 0.026611, velocity coeff: 0.99465
norm(ch) = 0.93181
iter: 1552, Minibatch log likelihood (pre-update): -54.437, error rate (pre-update): 0.10028

size_minibatch = 20000
Precon grad coeff: 0.023454, velocity coeff: 0.94336
norm(ch) = 0.88314
iter: 1553, Minibatch log likelihood (pre-update): -54.4369, error rate (pre-update): 0.10026

size_minibatch = 20000
Precon grad coeff: 0.024247, velocity coeff: 1.0301
norm(ch) = 0.91348
iter: 1554, Minibatch log likelihood (pre-update): -54.4368, error rate (pre-update): 0.10022

size_minibatch = 20000
Precon grad coeff: 0.026397, velocity coeff: 1.0203
norm(ch) = 0.93649
rho = 1.0223
New lambda: 9.5901e-033
iter: 1555, Minibatch log likelihood (pre-update): -54.4366, error rate (pre-update): 0.1002
iter: 1555, Minibatch log likelihood (post-update): -54.4365, error rate (post-update): 0.10017

size_minibatch = 20000
Precon grad coeff: 0.023465, velocity coeff: 0.94251
norm(ch) = 0.88616
iter: 1556, Minibatch log likelihood (pre-update): -54.4365, error rate (pre-update): 0.10017

size_minibatch = 20000
Precon grad coeff: 0.025335, velocity coeff: 1.032
norm(ch) = 0.91852
iter: 1557, Minibatch log likelihood (pre-update): -54.4363, error rate (pre-update): 0.10015

size_minibatch = 20000
Precon grad coeff: 0.023957, velocity coeff: 0.96057
norm(ch) = 0.88608
iter: 1558, Minibatch log likelihood (pre-update): -54.4362, error rate (pre-update): 0.10012

size_minibatch = 20000
Precon grad coeff: 0.02328, velocity coeff: 1.0258
norm(ch) = 0.91264
iter: 1559, Minibatch log likelihood (pre-update): -54.4361, error rate (pre-update): 0.10009

size_minibatch = 20000
Precon grad coeff: 0.02845, velocity coeff: 1.0174
New gamma: 0.0031623
norm(ch) = 0.93344
rho = 1.0024
New lambda: 7.4207e-033
iter: 1560, Minibatch log likelihood (pre-update): -54.4359, error rate (pre-update): 0.10006
iter: 1560, Minibatch log likelihood (post-update): -54.4358, error rate (post-update): 0.10004

size_minibatch = 20000
Precon grad coeff: 0.026566, velocity coeff: 0.98805
norm(ch) = 0.92693
iter: 1561, Minibatch log likelihood (pre-update): -54.4358, error rate (pre-update): 0.10004

size_minibatch = 20000
Precon grad coeff: 0.025401, velocity coeff: 0.97761
norm(ch) = 0.91049
iter: 1562, Minibatch log likelihood (pre-update): -54.4356, error rate (pre-update): 0.10002

size_minibatch = 20000
Precon grad coeff: 0.024818, velocity coeff: 1.0352
norm(ch) = 0.94627
iter: 1563, Minibatch log likelihood (pre-update): -54.4355, error rate (pre-update): 0.09999

size_minibatch = 20000
Precon grad coeff: 0.02871, velocity coeff: 1.0469
norm(ch) = 0.99554
iter: 1564, Minibatch log likelihood (pre-update): -54.4353, error rate (pre-update): 0.099958

size_minibatch = 20000
Precon grad coeff: 0.025118, velocity coeff: 0.93101
norm(ch) = 0.93096
rho = 1.0002
New lambda: 5.742e-033
iter: 1565, Minibatch log likelihood (pre-update): -54.4352, error rate (pre-update): 0.099923
iter: 1565, Minibatch log likelihood (post-update): -54.435, error rate (post-update): 0.099903

size_minibatch = 20000
Precon grad coeff: 0.024772, velocity coeff: 1.0237
norm(ch) = 0.9572
iter: 1566, Minibatch log likelihood (pre-update): -54.435, error rate (pre-update): 0.099903

size_minibatch = 20000
Precon grad coeff: 0.025436, velocity coeff: 0.96075
norm(ch) = 0.92342
iter: 1567, Minibatch log likelihood (pre-update): -54.4349, error rate (pre-update): 0.09989

size_minibatch = 20000
Precon grad coeff: 0.025197, velocity coeff: 0.99808
norm(ch) = 0.92597
iter: 1568, Minibatch log likelihood (pre-update): -54.4347, error rate (pre-update): 0.09984

size_minibatch = 20000
Precon grad coeff: 0.025989, velocity coeff: 0.99708
norm(ch) = 0.9271
iter: 1569, Minibatch log likelihood (pre-update): -54.4346, error rate (pre-update): 0.099815

size_minibatch = 20000
Precon grad coeff: 0.024682, velocity coeff: 0.94476
norm(ch) = 0.87955
rho = 1.0102
New lambda: 4.443e-033
iter: 1570, Minibatch log likelihood (pre-update): -54.4345, error rate (pre-update): 0.099796
iter: 1570, Minibatch log likelihood (post-update): -54.4343, error rate (post-update): 0.099762

size_minibatch = 20000
Precon grad coeff: 0.022839, velocity coeff: 0.97694
norm(ch) = 0.86292
iter: 1571, Minibatch log likelihood (pre-update): -54.4343, error rate (pre-update): 0.099762

size_minibatch = 20000
Precon grad coeff: 0.026006, velocity coeff: 1.0669
norm(ch) = 0.92492
iter: 1572, Minibatch log likelihood (pre-update): -54.4342, error rate (pre-update): 0.099758

size_minibatch = 20000
Precon grad coeff: 0.023599, velocity coeff: 0.94984
norm(ch) = 0.88215
iter: 1573, Minibatch log likelihood (pre-update): -54.4341, error rate (pre-update): 0.099728

size_minibatch = 20000
Precon grad coeff: 0.023027, velocity coeff: 0.994
norm(ch) = 0.88043
iter: 1574, Minibatch log likelihood (pre-update): -54.4339, error rate (pre-update): 0.099677

size_minibatch = 20000
Precon grad coeff: 0.023197, velocity coeff: 1.0194
norm(ch) = 0.90125
rho = 1.0033
New lambda: 3.4379e-033
iter: 1575, Minibatch log likelihood (pre-update): -54.4338, error rate (pre-update): 0.099678
iter: 1575, Minibatch log likelihood (post-update): -54.4336, error rate (post-update): 0.099652

size_minibatch = 20000
Precon grad coeff: 0.023869, velocity coeff: 1.0116
norm(ch) = 0.91552
iter: 1576, Minibatch log likelihood (pre-update): -54.4336, error rate (pre-update): 0.099652

size_minibatch = 20000
Precon grad coeff: 0.02539, velocity coeff: 0.9992
norm(ch) = 0.91862
iter: 1577, Minibatch log likelihood (pre-update): -54.4335, error rate (pre-update): 0.099614

size_minibatch = 20000
Precon grad coeff: 0.022331, velocity coeff: 0.94734
norm(ch) = 0.87354
iter: 1578, Minibatch log likelihood (pre-update): -54.4334, error rate (pre-update): 0.099606

size_minibatch = 20000
Precon grad coeff: 0.023294, velocity coeff: 1.0228
norm(ch) = 0.89717
iter: 1579, Minibatch log likelihood (pre-update): -54.4332, error rate (pre-update): 0.099564

size_minibatch = 20000
Precon grad coeff: 0.028144, velocity coeff: 1.0249
New gamma: 0.0031623
norm(ch) = 0.92452
rho = 0.98137
New lambda: 2.6602e-033
iter: 1580, Minibatch log likelihood (pre-update): -54.4331, error rate (pre-update): 0.099532
iter: 1580, Minibatch log likelihood (post-update): -54.433, error rate (post-update): 0.099527

size_minibatch = 20000
Precon grad coeff: 0.027555, velocity coeff: 0.98032
norm(ch) = 0.91109
iter: 1581, Minibatch log likelihood (pre-update): -54.433, error rate (pre-update): 0.099527

size_minibatch = 20000
Precon grad coeff: 0.023724, velocity coeff: 0.90784
norm(ch) = 0.83108
iter: 1582, Minibatch log likelihood (pre-update): -54.4328, error rate (pre-update): 0.099487

size_minibatch = 20000
Precon grad coeff: 0.028472, velocity coeff: 1.1989
norm(ch) = 1.0014
iter: 1583, Minibatch log likelihood (pre-update): -54.4327, error rate (pre-update): 0.099464

size_minibatch = 20000
Precon grad coeff: 0.028193, velocity coeff: 0.96177
norm(ch) = 0.96786
iter: 1584, Minibatch log likelihood (pre-update): -54.4325, error rate (pre-update): 0.099437

size_minibatch = 20000
Precon grad coeff: 0.025811, velocity coeff: 0.9953
norm(ch) = 0.96729
rho = 1.0169
New lambda: 2.0584e-033
iter: 1585, Minibatch log likelihood (pre-update): -54.4324, error rate (pre-update): 0.099413
iter: 1585, Minibatch log likelihood (post-update): -54.4322, error rate (post-update): 0.099387

size_minibatch = 20000
Precon grad coeff: 0.025424, velocity coeff: 0.99942
norm(ch) = 0.9709
iter: 1586, Minibatch log likelihood (pre-update): -54.4322, error rate (pre-update): 0.099387

size_minibatch = 20000
Precon grad coeff: 0.02481, velocity coeff: 0.96667
norm(ch) = 0.94253
iter: 1587, Minibatch log likelihood (pre-update): -54.4321, error rate (pre-update): 0.099357

size_minibatch = 20000
Precon grad coeff: 0.027394, velocity coeff: 1.0456
norm(ch) = 0.99038
iter: 1588, Minibatch log likelihood (pre-update): -54.4319, error rate (pre-update): 0.09933

size_minibatch = 20000
Precon grad coeff: 0.025324, velocity coeff: 0.92444
norm(ch) = 0.91931
iter: 1589, Minibatch log likelihood (pre-update): -54.4318, error rate (pre-update): 0.099286

size_minibatch = 20000
Precon grad coeff: 0.024538, velocity coeff: 0.97567
norm(ch) = 0.90043
rho = 1.008
New lambda: 1.5928e-033
iter: 1590, Minibatch log likelihood (pre-update): -54.4317, error rate (pre-update): 0.099259
iter: 1590, Minibatch log likelihood (post-update): -54.4315, error rate (post-update): 0.099254

size_minibatch = 20000
Precon grad coeff: 0.024668, velocity coeff: 0.97221
norm(ch) = 0.87944
iter: 1591, Minibatch log likelihood (pre-update): -54.4315, error rate (pre-update): 0.099254

size_minibatch = 20000
Precon grad coeff: 0.027347, velocity coeff: 1.0821
norm(ch) = 0.95592
iter: 1592, Minibatch log likelihood (pre-update): -54.4314, error rate (pre-update): 0.099215

size_minibatch = 20000
Precon grad coeff: 0.026065, velocity coeff: 0.92975
norm(ch) = 0.89267
iter: 1593, Minibatch log likelihood (pre-update): -54.4312, error rate (pre-update): 0.0992

size_minibatch = 20000
Precon grad coeff: 0.023067, velocity coeff: 0.94977
norm(ch) = 0.85141
iter: 1594, Minibatch log likelihood (pre-update): -54.4311, error rate (pre-update): 0.099172

size_minibatch = 20000
Precon grad coeff: 0.025719, velocity coeff: 1.139
norm(ch) = 0.97383
rho = 0.9899
New lambda: 1.2325e-033
iter: 1595, Minibatch log likelihood (pre-update): -54.431, error rate (pre-update): 0.099125
iter: 1595, Minibatch log likelihood (post-update): -54.4308, error rate (post-update): 0.099119

size_minibatch = 20000
Precon grad coeff: 0.027205, velocity coeff: 0.95628
norm(ch) = 0.93574
iter: 1596, Minibatch log likelihood (pre-update): -54.4308, error rate (pre-update): 0.099119

size_minibatch = 20000
Precon grad coeff: 0.023118, velocity coeff: 0.96937
norm(ch) = 0.91062
iter: 1597, Minibatch log likelihood (pre-update): -54.4307, error rate (pre-update): 0.099098

size_minibatch = 20000
Precon grad coeff: 0.024608, velocity coeff: 1.0009
norm(ch) = 0.91504
iter: 1598, Minibatch log likelihood (pre-update): -54.4305, error rate (pre-update): 0.099055

size_minibatch = 20000
Precon grad coeff: 0.024121, velocity coeff: 1.0045
norm(ch) = 0.92277
iter: 1599, Minibatch log likelihood (pre-update): -54.4304, error rate (pre-update): 0.099043

size_minibatch = 20000
Precon grad coeff: 0.027149, velocity coeff: 1.0033
New gamma: 0.0031623
norm(ch) = 0.9304
rho = 0.99974
New lambda: 9.5365e-034
iter: 1600, Minibatch log likelihood (pre-update): -54.4303, error rate (pre-update): 0.099001
iter: 1600, Minibatch log likelihood (post-update): -54.4301, error rate (post-update): 0.098972
---
Full log-likelihood: -54.4301, error rate: 0.098972
TEST log-likelihood: -54.7559, error rate: 0.24929
Error difference (test - train): 0.15031
---
Full log-likelihood (averaged params): -54.5016, error rate (averaged params): 0.12359
TEST log-likelihood (averaged params): -54.7666, error rate (averaged params): 0.25535
Error difference (test - train) (averaged params): 0.13176

size_minibatch = 20000
Precon grad coeff: 0.025058, velocity coeff: 0.96337
norm(ch) = 0.90007
iter: 1601, Minibatch log likelihood (pre-update): -54.4301, error rate (pre-update): 0.098972

size_minibatch = 20000
Precon grad coeff: 0.025678, velocity coeff: 1.0119
norm(ch) = 0.91521
iter: 1602, Minibatch log likelihood (pre-update): -54.43, error rate (pre-update): 0.09896

size_minibatch = 20000
Precon grad coeff: 0.023794, velocity coeff: 1.0023
norm(ch) = 0.9213
iter: 1603, Minibatch log likelihood (pre-update): -54.4299, error rate (pre-update): 0.098933

size_minibatch = 20000
Precon grad coeff: 0.026414, velocity coeff: 1.0206
norm(ch) = 0.94431
iter: 1604, Minibatch log likelihood (pre-update): -54.4297, error rate (pre-update): 0.09891

size_minibatch = 20000
Precon grad coeff: 0.023998, velocity coeff: 0.94776
norm(ch) = 0.89881
rho = 0.9881
New lambda: 7.3791e-034
iter: 1605, Minibatch log likelihood (pre-update): -54.4296, error rate (pre-update): 0.098886
iter: 1605, Minibatch log likelihood (post-update): -54.4294, error rate (post-update): 0.098838

size_minibatch = 20000
Precon grad coeff: 0.024881, velocity coeff: 1.0519
norm(ch) = 0.94958
iter: 1606, Minibatch log likelihood (pre-update): -54.4294, error rate (pre-update): 0.098838

size_minibatch = 20000
Precon grad coeff: 0.024872, velocity coeff: 0.96471
norm(ch) = 0.91967
iter: 1607, Minibatch log likelihood (pre-update): -54.4293, error rate (pre-update): 0.098825

size_minibatch = 20000
Precon grad coeff: 0.026244, velocity coeff: 1.0237
norm(ch) = 0.94551
iter: 1608, Minibatch log likelihood (pre-update): -54.4292, error rate (pre-update): 0.098807

size_minibatch = 20000
Precon grad coeff: 0.024573, velocity coeff: 0.93516
norm(ch) = 0.888
iter: 1609, Minibatch log likelihood (pre-update): -54.429, error rate (pre-update): 0.098773

size_minibatch = 20000
Precon grad coeff: 0.0252, velocity coeff: 1.0761
norm(ch) = 0.95919
rho = 1.013
New lambda: 5.7098e-034
iter: 1610, Minibatch log likelihood (pre-update): -54.4289, error rate (pre-update): 0.098763
iter: 1610, Minibatch log likelihood (post-update): -54.4287, error rate (post-update): 0.098729

size_minibatch = 20000
Precon grad coeff: 0.02857, velocity coeff: 0.97234
norm(ch) = 0.93682
iter: 1611, Minibatch log likelihood (pre-update): -54.4287, error rate (pre-update): 0.098729

size_minibatch = 20000
Precon grad coeff: 0.02156, velocity coeff: 0.90964
norm(ch) = 0.85558
iter: 1612, Minibatch log likelihood (pre-update): -54.4286, error rate (pre-update): 0.098696

size_minibatch = 20000
Precon grad coeff: 0.025797, velocity coeff: 1.102
norm(ch) = 0.94687
iter: 1613, Minibatch log likelihood (pre-update): -54.4285, error rate (pre-update): 0.098678

size_minibatch = 20000
Precon grad coeff: 0.025034, velocity coeff: 0.93895
norm(ch) = 0.89268
iter: 1614, Minibatch log likelihood (pre-update): -54.4283, error rate (pre-update): 0.098651

size_minibatch = 20000
Precon grad coeff: 0.021825, velocity coeff: 0.97598
norm(ch) = 0.87485
rho = 0.99356
New lambda: 4.4182e-034
iter: 1615, Minibatch log likelihood (pre-update): -54.4282, error rate (pre-update): 0.098634
iter: 1615, Minibatch log likelihood (post-update): -54.4281, error rate (post-update): 0.098607

size_minibatch = 20000
Precon grad coeff: 0.025101, velocity coeff: 1.0531
norm(ch) = 0.92511
iter: 1616, Minibatch log likelihood (pre-update): -54.4281, error rate (pre-update): 0.098607

size_minibatch = 20000
Precon grad coeff: 0.02249, velocity coeff: 0.91303
norm(ch) = 0.84785
iter: 1617, Minibatch log likelihood (pre-update): -54.4279, error rate (pre-update): 0.098584

size_minibatch = 20000
Precon grad coeff: 0.024651, velocity coeff: 1.1264
norm(ch) = 0.95894
iter: 1618, Minibatch log likelihood (pre-update): -54.4278, error rate (pre-update): 0.098551

size_minibatch = 20000
Precon grad coeff: 0.025218, velocity coeff: 0.9122
norm(ch) = 0.87837
iter: 1619, Minibatch log likelihood (pre-update): -54.4277, error rate (pre-update): 0.098518

size_minibatch = 20000
Precon grad coeff: 0.023677, velocity coeff: 0.98891
New gamma: 0.0031623
norm(ch) = 0.87278
rho = 1.0155
New lambda: 3.4187e-034
iter: 1620, Minibatch log likelihood (pre-update): -54.4275, error rate (pre-update): 0.0985
iter: 1620, Minibatch log likelihood (post-update): -54.4274, error rate (post-update): 0.098474

size_minibatch = 20000
Precon grad coeff: 0.026578, velocity coeff: 1.0721
norm(ch) = 0.94033
iter: 1621, Minibatch log likelihood (pre-update): -54.4274, error rate (pre-update): 0.098474

size_minibatch = 20000
Precon grad coeff: 0.029947, velocity coeff: 1.0214
norm(ch) = 0.96512
iter: 1622, Minibatch log likelihood (pre-update): -54.4273, error rate (pre-update): 0.098458

size_minibatch = 20000
Precon grad coeff: 0.026654, velocity coeff: 0.98327
norm(ch) = 0.95317
iter: 1623, Minibatch log likelihood (pre-update): -54.4271, error rate (pre-update): 0.098424

size_minibatch = 20000
Precon grad coeff: 0.025486, velocity coeff: 0.96233
norm(ch) = 0.92137
iter: 1624, Minibatch log likelihood (pre-update): -54.427, error rate (pre-update): 0.0984

size_minibatch = 20000
Precon grad coeff: 0.02611, velocity coeff: 1.0548
norm(ch) = 0.97656
rho = 1.0214
New lambda: 2.6453e-034
iter: 1625, Minibatch log likelihood (pre-update): -54.4269, error rate (pre-update): 0.098384
iter: 1625, Minibatch log likelihood (post-update): -54.4267, error rate (post-update): 0.098339

size_minibatch = 20000
Precon grad coeff: 0.025353, velocity coeff: 0.95271
norm(ch) = 0.93409
iter: 1626, Minibatch log likelihood (pre-update): -54.4267, error rate (pre-update): 0.098339

size_minibatch = 20000
Precon grad coeff: 0.026397, velocity coeff: 1.0435
norm(ch) = 0.9788
iter: 1627, Minibatch log likelihood (pre-update): -54.4266, error rate (pre-update): 0.098327

size_minibatch = 20000
Precon grad coeff: 0.025109, velocity coeff: 0.90788
norm(ch) = 0.89247
iter: 1628, Minibatch log likelihood (pre-update): -54.4264, error rate (pre-update): 0.098307

size_minibatch = 20000
Precon grad coeff: 0.023839, velocity coeff: 1.0044
norm(ch) = 0.89997
iter: 1629, Minibatch log likelihood (pre-update): -54.4263, error rate (pre-update): 0.098276

size_minibatch = 20000
Precon grad coeff: 0.023594, velocity coeff: 0.97512
norm(ch) = 0.88152
rho = 1.0252
New lambda: 2.0469e-034
iter: 1630, Minibatch log likelihood (pre-update): -54.4262, error rate (pre-update): 0.098248
iter: 1630, Minibatch log likelihood (post-update): -54.426, error rate (post-update): 0.09822

size_minibatch = 20000
Precon grad coeff: 0.023333, velocity coeff: 0.99262
norm(ch) = 0.8784
iter: 1631, Minibatch log likelihood (pre-update): -54.426, error rate (pre-update): 0.09822

size_minibatch = 20000
Precon grad coeff: 0.024537, velocity coeff: 0.98837
norm(ch) = 0.87196
iter: 1632, Minibatch log likelihood (pre-update): -54.4259, error rate (pre-update): 0.098206

size_minibatch = 20000
Precon grad coeff: 0.02345, velocity coeff: 1.0231
norm(ch) = 0.89575
iter: 1633, Minibatch log likelihood (pre-update): -54.4258, error rate (pre-update): 0.098184

size_minibatch = 20000
Precon grad coeff: 0.025516, velocity coeff: 1.0375
norm(ch) = 0.93337
iter: 1634, Minibatch log likelihood (pre-update): -54.4256, error rate (pre-update): 0.098158

size_minibatch = 20000
Precon grad coeff: 0.025301, velocity coeff: 0.97024
norm(ch) = 0.90981
rho = 0.99548
New lambda: 1.5838e-034
iter: 1635, Minibatch log likelihood (pre-update): -54.4255, error rate (pre-update): 0.098125
iter: 1635, Minibatch log likelihood (post-update): -54.4254, error rate (post-update): 0.098095

size_minibatch = 20000
Precon grad coeff: 0.026246, velocity coeff: 1.0544
norm(ch) = 0.9633
iter: 1636, Minibatch log likelihood (pre-update): -54.4254, error rate (pre-update): 0.098095

size_minibatch = 20000
Precon grad coeff: 0.023502, velocity coeff: 0.90831
norm(ch) = 0.87862
iter: 1637, Minibatch log likelihood (pre-update): -54.4252, error rate (pre-update): 0.098082

size_minibatch = 20000
Precon grad coeff: 0.024704, velocity coeff: 1.0454
norm(ch) = 0.92242
iter: 1638, Minibatch log likelihood (pre-update): -54.4251, error rate (pre-update): 0.098046

size_minibatch = 20000
Precon grad coeff: 0.025282, velocity coeff: 1.0162
norm(ch) = 0.94124
iter: 1639, Minibatch log likelihood (pre-update): -54.425, error rate (pre-update): 0.098032

size_minibatch = 20000
Precon grad coeff: 0.025868, velocity coeff: 0.91586
New gamma: 0.0031623
norm(ch) = 0.8663
rho = 1.0091
New lambda: 1.2256e-034
iter: 1640, Minibatch log likelihood (pre-update): -54.4248, error rate (pre-update): 0.098019
iter: 1640, Minibatch log likelihood (post-update): -54.4247, error rate (post-update): 0.097972

size_minibatch = 20000
Precon grad coeff: 0.025505, velocity coeff: 1.0402
norm(ch) = 0.90553
iter: 1641, Minibatch log likelihood (pre-update): -54.4247, error rate (pre-update): 0.097972

size_minibatch = 20000
Precon grad coeff: 0.024633, velocity coeff: 0.95597
norm(ch) = 0.86978
iter: 1642, Minibatch log likelihood (pre-update): -54.4246, error rate (pre-update): 0.097955

size_minibatch = 20000
Precon grad coeff: 0.02594, velocity coeff: 1.0706
norm(ch) = 0.9354
iter: 1643, Minibatch log likelihood (pre-update): -54.4244, error rate (pre-update): 0.097934

size_minibatch = 20000
Precon grad coeff: 0.024362, velocity coeff: 0.9708
norm(ch) = 0.91219
iter: 1644, Minibatch log likelihood (pre-update): -54.4243, error rate (pre-update): 0.097899

size_minibatch = 20000
Precon grad coeff: 0.024442, velocity coeff: 0.99619
norm(ch) = 0.91311
rho = 1.0307
New lambda: 9.4831e-035
iter: 1645, Minibatch log likelihood (pre-update): -54.4242, error rate (pre-update): 0.097883
iter: 1645, Minibatch log likelihood (post-update): -54.424, error rate (post-update): 0.097857

size_minibatch = 20000
Precon grad coeff: 0.02252, velocity coeff: 0.9891
norm(ch) = 0.9067
iter: 1646, Minibatch log likelihood (pre-update): -54.424, error rate (pre-update): 0.097857

size_minibatch = 20000
Precon grad coeff: 0.02441, velocity coeff: 1.0171
norm(ch) = 0.92628
iter: 1647, Minibatch log likelihood (pre-update): -54.4239, error rate (pre-update): 0.097835

size_minibatch = 20000
Precon grad coeff: 0.024636, velocity coeff: 0.98754
norm(ch) = 0.91863
iter: 1648, Minibatch log likelihood (pre-update): -54.4238, error rate (pre-update): 0.097803

size_minibatch = 20000
Precon grad coeff: 0.025747, velocity coeff: 1.0125
norm(ch) = 0.93411
iter: 1649, Minibatch log likelihood (pre-update): -54.4236, error rate (pre-update): 0.097781

size_minibatch = 20000
Precon grad coeff: 0.023238, velocity coeff: 0.91815
norm(ch) = 0.86135
rho = 1.0105
New lambda: 7.3378e-035
iter: 1650, Minibatch log likelihood (pre-update): -54.4235, error rate (pre-update): 0.097764
iter: 1650, Minibatch log likelihood (post-update): -54.4234, error rate (post-update): 0.097742
---
Full log-likelihood: -54.4234, error rate: 0.097742
TEST log-likelihood: -54.7645, error rate: 0.25227
Error difference (test - train): 0.15453
---
Full log-likelihood (averaged params): -54.4957, error rate (averaged params): 0.12284
TEST log-likelihood (averaged params): -54.772, error rate (averaged params): 0.25764
Error difference (test - train) (averaged params): 0.1348

size_minibatch = 20000
Precon grad coeff: 0.024057, velocity coeff: 1.0272
norm(ch) = 0.88895
iter: 1651, Minibatch log likelihood (pre-update): -54.4234, error rate (pre-update): 0.097742

size_minibatch = 20000
Precon grad coeff: 0.026136, velocity coeff: 1.0424
norm(ch) = 0.93041
iter: 1652, Minibatch log likelihood (pre-update): -54.4232, error rate (pre-update): 0.097717

size_minibatch = 20000
Precon grad coeff: 0.025556, velocity coeff: 0.97054
norm(ch) = 0.90682
iter: 1653, Minibatch log likelihood (pre-update): -54.4231, error rate (pre-update): 0.097675

size_minibatch = 20000
Precon grad coeff: 0.023809, velocity coeff: 0.97824
norm(ch) = 0.89078
iter: 1654, Minibatch log likelihood (pre-update): -54.423, error rate (pre-update): 0.097657

size_minibatch = 20000
Precon grad coeff: 0.02457, velocity coeff: 1.0184
norm(ch) = 0.9112
rho = 1.0082
New lambda: 5.6779e-035
iter: 1655, Minibatch log likelihood (pre-update): -54.4228, error rate (pre-update): 0.097647
iter: 1655, Minibatch log likelihood (post-update): -54.4227, error rate (post-update): 0.097617

size_minibatch = 20000
Precon grad coeff: 0.023666, velocity coeff: 0.97194
norm(ch) = 0.8893
iter: 1656, Minibatch log likelihood (pre-update): -54.4227, error rate (pre-update): 0.097617

size_minibatch = 20000
Precon grad coeff: 0.021879, velocity coeff: 0.96065
norm(ch) = 0.85733
iter: 1657, Minibatch log likelihood (pre-update): -54.4226, error rate (pre-update): 0.097588

size_minibatch = 20000
Precon grad coeff: 0.025007, velocity coeff: 1.091
norm(ch) = 0.93901
iter: 1658, Minibatch log likelihood (pre-update): -54.4225, error rate (pre-update): 0.097564

size_minibatch = 20000
Precon grad coeff: 0.021585, velocity coeff: 0.87863
norm(ch) = 0.82843
iter: 1659, Minibatch log likelihood (pre-update): -54.4223, error rate (pre-update): 0.097543

size_minibatch = 20000
Precon grad coeff: 0.022885, velocity coeff: 1.0233
New gamma: 0.0031623
norm(ch) = 0.85153
rho = 0.991
New lambda: 4.3934e-035
iter: 1660, Minibatch log likelihood (pre-update): -54.4222, error rate (pre-update): 0.097524
iter: 1660, Minibatch log likelihood (post-update): -54.4221, error rate (post-update): 0.097483

size_minibatch = 20000
Precon grad coeff: 0.024213, velocity coeff: 1.0245
norm(ch) = 0.8766
iter: 1661, Minibatch log likelihood (pre-update): -54.4221, error rate (pre-update): 0.097483

size_minibatch = 20000
Precon grad coeff: 0.026757, velocity coeff: 1.0695
norm(ch) = 0.94181
iter: 1662, Minibatch log likelihood (pre-update): -54.422, error rate (pre-update): 0.097471

size_minibatch = 20000
Precon grad coeff: 0.025939, velocity coeff: 0.9687
norm(ch) = 0.91635
iter: 1663, Minibatch log likelihood (pre-update): -54.4218, error rate (pre-update): 0.097454

size_minibatch = 20000
Precon grad coeff: 0.024977, velocity coeff: 1.0241
norm(ch) = 0.94251
iter: 1664, Minibatch log likelihood (pre-update): -54.4217, error rate (pre-update): 0.097417

size_minibatch = 20000
Precon grad coeff: 0.023521, velocity coeff: 0.94917
norm(ch) = 0.89818
rho = 1.0291
New lambda: 3.3996e-035
iter: 1665, Minibatch log likelihood (pre-update): -54.4215, error rate (pre-update): 0.097401
iter: 1665, Minibatch log likelihood (post-update): -54.4214, error rate (post-update): 0.097378

size_minibatch = 20000
Precon grad coeff: 0.027018, velocity coeff: 1.1029
norm(ch) = 0.99494
iter: 1666, Minibatch log likelihood (pre-update): -54.4214, error rate (pre-update): 0.097378

size_minibatch = 20000
Precon grad coeff: 0.022207, velocity coeff: 0.84289
norm(ch) = 0.84181
iter: 1667, Minibatch log likelihood (pre-update): -54.4213, error rate (pre-update): 0.097335

size_minibatch = 20000
Precon grad coeff: 0.02235, velocity coeff: 1.0649
norm(ch) = 0.90007
iter: 1668, Minibatch log likelihood (pre-update): -54.4212, error rate (pre-update): 0.097325

size_minibatch = 20000
Precon grad coeff: 0.02383, velocity coeff: 0.98108
norm(ch) = 0.88658
iter: 1669, Minibatch log likelihood (pre-update): -54.421, error rate (pre-update): 0.097296

size_minibatch = 20000
Precon grad coeff: 0.023138, velocity coeff: 0.97858
norm(ch) = 0.87116
rho = 1.0204
New lambda: 2.6305e-035
iter: 1670, Minibatch log likelihood (pre-update): -54.4209, error rate (pre-update): 0.097283
iter: 1670, Minibatch log likelihood (post-update): -54.4208, error rate (post-update): 0.097263

size_minibatch = 20000
Precon grad coeff: 0.023886, velocity coeff: 1.0128
norm(ch) = 0.886
iter: 1671, Minibatch log likelihood (pre-update): -54.4208, error rate (pre-update): 0.097263

size_minibatch = 20000
Precon grad coeff: 0.024948, velocity coeff: 0.99396
norm(ch) = 0.8844
iter: 1672, Minibatch log likelihood (pre-update): -54.4206, error rate (pre-update): 0.097222

size_minibatch = 20000
Precon grad coeff: 0.024762, velocity coeff: 1.027
norm(ch) = 0.912
iter: 1673, Minibatch log likelihood (pre-update): -54.4205, error rate (pre-update): 0.097207

size_minibatch = 20000
Precon grad coeff: 0.024316, velocity coeff: 0.96381
norm(ch) = 0.88234
iter: 1674, Minibatch log likelihood (pre-update): -54.4204, error rate (pre-update): 0.097183

size_minibatch = 20000
Precon grad coeff: 0.024257, velocity coeff: 1.0118
norm(ch) = 0.89659
rho = 0.99603
New lambda: 2.0354e-035
iter: 1675, Minibatch log likelihood (pre-update): -54.4203, error rate (pre-update): 0.09715
iter: 1675, Minibatch log likelihood (post-update): -54.4201, error rate (post-update): 0.097144

size_minibatch = 20000
Precon grad coeff: 0.022224, velocity coeff: 0.96754
norm(ch) = 0.87084
iter: 1676, Minibatch log likelihood (pre-update): -54.4201, error rate (pre-update): 0.097144

size_minibatch = 20000
Precon grad coeff: 0.021496, velocity coeff: 0.97551
norm(ch) = 0.85286
iter: 1677, Minibatch log likelihood (pre-update): -54.42, error rate (pre-update): 0.097111

size_minibatch = 20000
Precon grad coeff: 0.023078, velocity coeff: 1.0331
norm(ch) = 0.88441
iter: 1678, Minibatch log likelihood (pre-update): -54.4199, error rate (pre-update): 0.097088

size_minibatch = 20000
Precon grad coeff: 0.022038, velocity coeff: 0.98149
norm(ch) = 0.87115
iter: 1679, Minibatch log likelihood (pre-update): -54.4198, error rate (pre-update): 0.097066

size_minibatch = 20000
Precon grad coeff: 0.024924, velocity coeff: 0.97321
New gamma: 0.0031623
norm(ch) = 0.8522
rho = 1.023
New lambda: 1.575e-035
iter: 1680, Minibatch log likelihood (pre-update): -54.4196, error rate (pre-update): 0.097045
iter: 1680, Minibatch log likelihood (post-update): -54.4195, error rate (post-update): 0.097024

size_minibatch = 20000
Precon grad coeff: 0.025632, velocity coeff: 1.0381
norm(ch) = 0.88917
iter: 1681, Minibatch log likelihood (pre-update): -54.4195, error rate (pre-update): 0.097024

size_minibatch = 20000
Precon grad coeff: 0.028039, velocity coeff: 1.0183
norm(ch) = 0.91015
iter: 1682, Minibatch log likelihood (pre-update): -54.4194, error rate (pre-update): 0.097

size_minibatch = 20000
Precon grad coeff: 0.027593, velocity coeff: 1.0323
norm(ch) = 0.94409
iter: 1683, Minibatch log likelihood (pre-update): -54.4193, error rate (pre-update): 0.096983

size_minibatch = 20000
Precon grad coeff: 0.024673, velocity coeff: 0.91895
norm(ch) = 0.87141
iter: 1684, Minibatch log likelihood (pre-update): -54.4191, error rate (pre-update): 0.096948

size_minibatch = 20000
Precon grad coeff: 0.023028, velocity coeff: 1.0366
norm(ch) = 0.90726
rho = 1.0282
New lambda: 1.2187e-035
iter: 1685, Minibatch log likelihood (pre-update): -54.419, error rate (pre-update): 0.096924
iter: 1685, Minibatch log likelihood (post-update): -54.4189, error rate (post-update): 0.096905

size_minibatch = 20000
Precon grad coeff: 0.025517, velocity coeff: 1.0557
norm(ch) = 0.96204
iter: 1686, Minibatch log likelihood (pre-update): -54.4189, error rate (pre-update): 0.096905

size_minibatch = 20000
Precon grad coeff: 0.025215, velocity coeff: 0.98279
norm(ch) = 0.94926
iter: 1687, Minibatch log likelihood (pre-update): -54.4187, error rate (pre-update): 0.096875

size_minibatch = 20000
Precon grad coeff: 0.025314, velocity coeff: 0.96352
norm(ch) = 0.91843
iter: 1688, Minibatch log likelihood (pre-update): -54.4186, error rate (pre-update): 0.096844

size_minibatch = 20000
Precon grad coeff: 0.025317, velocity coeff: 1.0106
norm(ch) = 0.93204
iter: 1689, Minibatch log likelihood (pre-update): -54.4185, error rate (pre-update): 0.09684

size_minibatch = 20000
Precon grad coeff: 0.027015, velocity coeff: 0.98478
norm(ch) = 0.92185
rho = 0.99957
New lambda: 9.43e-036
iter: 1690, Minibatch log likelihood (pre-update): -54.4183, error rate (pre-update): 0.096793
iter: 1690, Minibatch log likelihood (post-update): -54.4182, error rate (post-update): 0.096772

size_minibatch = 20000
Precon grad coeff: 0.023252, velocity coeff: 0.89984
norm(ch) = 0.83291
iter: 1691, Minibatch log likelihood (pre-update): -54.4182, error rate (pre-update): 0.096772

size_minibatch = 20000
Precon grad coeff: 0.023624, velocity coeff: 1.0309
norm(ch) = 0.86234
iter: 1692, Minibatch log likelihood (pre-update): -54.4181, error rate (pre-update): 0.096766

size_minibatch = 20000
Precon grad coeff: 0.024603, velocity coeff: 1.0152
norm(ch) = 0.87904
iter: 1693, Minibatch log likelihood (pre-update): -54.4179, error rate (pre-update): 0.096731

size_minibatch = 20000
Precon grad coeff: 0.024459, velocity coeff: 0.98574
norm(ch) = 0.87013
iter: 1694, Minibatch log likelihood (pre-update): -54.4178, error rate (pre-update): 0.09671

size_minibatch = 20000
Precon grad coeff: 0.024158, velocity coeff: 1.0173
norm(ch) = 0.88885
rho = 1.0073
New lambda: 7.2968e-036
iter: 1695, Minibatch log likelihood (pre-update): -54.4177, error rate (pre-update): 0.096682
iter: 1695, Minibatch log likelihood (post-update): -54.4176, error rate (post-update): 0.09666

size_minibatch = 20000
Precon grad coeff: 0.024192, velocity coeff: 1.0144
norm(ch) = 0.90523
iter: 1696, Minibatch log likelihood (pre-update): -54.4176, error rate (pre-update): 0.09666

size_minibatch = 20000
Precon grad coeff: 0.023949, velocity coeff: 0.95526
norm(ch) = 0.8682
iter: 1697, Minibatch log likelihood (pre-update): -54.4174, error rate (pre-update): 0.096641

size_minibatch = 20000
Precon grad coeff: 0.023912, velocity coeff: 1.0665
norm(ch) = 0.92962
iter: 1698, Minibatch log likelihood (pre-update): -54.4173, error rate (pre-update): 0.096617

size_minibatch = 20000
Precon grad coeff: 0.027859, velocity coeff: 1.0241
norm(ch) = 0.95572
iter: 1699, Minibatch log likelihood (pre-update): -54.4172, error rate (pre-update): 0.09658

size_minibatch = 20000
Precon grad coeff: 0.026382, velocity coeff: 0.91782
New gamma: 0.0031623
norm(ch) = 0.88126
rho = 1.015
New lambda: 5.6461e-036
iter: 1700, Minibatch log likelihood (pre-update): -54.4171, error rate (pre-update): 0.09657
iter: 1700, Minibatch log likelihood (post-update): -54.4169, error rate (post-update): 0.096554
---
Full log-likelihood: -54.4169, error rate: 0.096554
TEST log-likelihood: -54.7733, error rate: 0.25514
Error difference (test - train): 0.15859
---
Full log-likelihood (averaged params): -54.4888, error rate (averaged params): 0.12157
TEST log-likelihood (averaged params): -54.7776, error rate (averaged params): 0.25977
Error difference (test - train) (averaged params): 0.1382

size_minibatch = 20000
Precon grad coeff: 0.026012, velocity coeff: 0.99265
norm(ch) = 0.87891
iter: 1701, Minibatch log likelihood (pre-update): -54.4169, error rate (pre-update): 0.096554

size_minibatch = 20000
Precon grad coeff: 0.02434, velocity coeff: 0.98997
norm(ch) = 0.87385
iter: 1702, Minibatch log likelihood (pre-update): -54.4168, error rate (pre-update): 0.096523

size_minibatch = 20000
Precon grad coeff: 0.025686, velocity coeff: 1.0263
norm(ch) = 0.90098
iter: 1703, Minibatch log likelihood (pre-update): -54.4167, error rate (pre-update): 0.096491

size_minibatch = 20000
Precon grad coeff: 0.023377, velocity coeff: 0.95851
norm(ch) = 0.86719
iter: 1704, Minibatch log likelihood (pre-update): -54.4166, error rate (pre-update): 0.096469

size_minibatch = 20000
Precon grad coeff: 0.025042, velocity coeff: 1.0625
norm(ch) = 0.92522
rho = 1.0189
New lambda: 4.3688e-036
iter: 1705, Minibatch log likelihood (pre-update): -54.4164, error rate (pre-update): 0.096457
iter: 1705, Minibatch log likelihood (post-update): -54.4163, error rate (post-update): 0.096417

size_minibatch = 20000
Precon grad coeff: 0.026877, velocity coeff: 1.0273
norm(ch) = 0.95448
iter: 1706, Minibatch log likelihood (pre-update): -54.4163, error rate (pre-update): 0.096417

size_minibatch = 20000
Precon grad coeff: 0.026953, velocity coeff: 0.97506
norm(ch) = 0.93465
iter: 1707, Minibatch log likelihood (pre-update): -54.4162, error rate (pre-update): 0.096406

size_minibatch = 20000
Precon grad coeff: 0.025793, velocity coeff: 0.98286
norm(ch) = 0.9224
iter: 1708, Minibatch log likelihood (pre-update): -54.416, error rate (pre-update): 0.096376

size_minibatch = 20000
Precon grad coeff: 0.026509, velocity coeff: 0.98225
norm(ch) = 0.91
iter: 1709, Minibatch log likelihood (pre-update): -54.4159, error rate (pre-update): 0.096348

size_minibatch = 20000
Precon grad coeff: 0.022696, velocity coeff: 0.89569
norm(ch) = 0.81826
rho = 0.98288
New lambda: 3.3805e-036
iter: 1710, Minibatch log likelihood (pre-update): -54.4158, error rate (pre-update): 0.096331
iter: 1710, Minibatch log likelihood (post-update): -54.4157, error rate (post-update): 0.0963

size_minibatch = 20000
Precon grad coeff: 0.023962, velocity coeff: 1.0852
norm(ch) = 0.89148
iter: 1711, Minibatch log likelihood (pre-update): -54.4157, error rate (pre-update): 0.0963

size_minibatch = 20000
Precon grad coeff: 0.023751, velocity coeff: 0.95125
norm(ch) = 0.8516
iter: 1712, Minibatch log likelihood (pre-update): -54.4155, error rate (pre-update): 0.096291

size_minibatch = 20000
Precon grad coeff: 0.025601, velocity coeff: 1.036
norm(ch) = 0.88614
iter: 1713, Minibatch log likelihood (pre-update): -54.4154, error rate (pre-update): 0.09626

size_minibatch = 20000
Precon grad coeff: 0.024129, velocity coeff: 1.0042
norm(ch) = 0.89311
iter: 1714, Minibatch log likelihood (pre-update): -54.4153, error rate (pre-update): 0.096236

size_minibatch = 20000
Precon grad coeff: 0.025697, velocity coeff: 0.99178
norm(ch) = 0.88961
rho = 1.0208
New lambda: 2.6158e-036
iter: 1715, Minibatch log likelihood (pre-update): -54.4152, error rate (pre-update): 0.096229
iter: 1715, Minibatch log likelihood (post-update): -54.4151, error rate (post-update): 0.096191

size_minibatch = 20000
Precon grad coeff: 0.02577, velocity coeff: 1.0083
norm(ch) = 0.90088
iter: 1716, Minibatch log likelihood (pre-update): -54.4151, error rate (pre-update): 0.096191

size_minibatch = 20000
Precon grad coeff: 0.021923, velocity coeff: 0.93081
norm(ch) = 0.84141
iter: 1717, Minibatch log likelihood (pre-update): -54.4149, error rate (pre-update): 0.096171

size_minibatch = 20000
Precon grad coeff: 0.024856, velocity coeff: 1.0366
norm(ch) = 0.87555
iter: 1718, Minibatch log likelihood (pre-update): -54.4148, error rate (pre-update): 0.096152

size_minibatch = 20000
Precon grad coeff: 0.023378, velocity coeff: 0.98703
norm(ch) = 0.86758
iter: 1719, Minibatch log likelihood (pre-update): -54.4147, error rate (pre-update): 0.096133

size_minibatch = 20000
Precon grad coeff: 0.024817, velocity coeff: 0.98417
New gamma: 0.0031623
norm(ch) = 0.85777
rho = 1.0052
New lambda: 2.024e-036
iter: 1720, Minibatch log likelihood (pre-update): -54.4146, error rate (pre-update): 0.09611
iter: 1720, Minibatch log likelihood (post-update): -54.4145, error rate (post-update): 0.096084

size_minibatch = 20000
Precon grad coeff: 0.026089, velocity coeff: 1.0503
norm(ch) = 0.90493
iter: 1721, Minibatch log likelihood (pre-update): -54.4145, error rate (pre-update): 0.096084

size_minibatch = 20000
Precon grad coeff: 0.027458, velocity coeff: 1.0155
norm(ch) = 0.92293
iter: 1722, Minibatch log likelihood (pre-update): -54.4143, error rate (pre-update): 0.096067

size_minibatch = 20000
Precon grad coeff: 0.023118, velocity coeff: 0.9145
norm(ch) = 0.8473
iter: 1723, Minibatch log likelihood (pre-update): -54.4142, error rate (pre-update): 0.096052

size_minibatch = 20000
Precon grad coeff: 0.023533, velocity coeff: 1.0356
norm(ch) = 0.881
iter: 1724, Minibatch log likelihood (pre-update): -54.4141, error rate (pre-update): 0.096016

size_minibatch = 20000
Precon grad coeff: 0.02231, velocity coeff: 0.96601
norm(ch) = 0.85429
rho = 1.0085
New lambda: 1.5662e-036
iter: 1725, Minibatch log likelihood (pre-update): -54.414, error rate (pre-update): 0.095997
iter: 1725, Minibatch log likelihood (post-update): -54.4139, error rate (post-update): 0.095978

size_minibatch = 20000
Precon grad coeff: 0.025628, velocity coeff: 1.0689
norm(ch) = 0.91646
iter: 1726, Minibatch log likelihood (pre-update): -54.4139, error rate (pre-update): 0.095978

size_minibatch = 20000
Precon grad coeff: 0.024382, velocity coeff: 0.95509
norm(ch) = 0.8788
iter: 1727, Minibatch log likelihood (pre-update): -54.4137, error rate (pre-update): 0.095957

size_minibatch = 20000
Precon grad coeff: 0.026061, velocity coeff: 1.0176
norm(ch) = 0.89803
iter: 1728, Minibatch log likelihood (pre-update): -54.4136, error rate (pre-update): 0.095933

size_minibatch = 20000
Precon grad coeff: 0.024833, velocity coeff: 0.95712
norm(ch) = 0.86261
iter: 1729, Minibatch log likelihood (pre-update): -54.4135, error rate (pre-update): 0.095909

size_minibatch = 20000
Precon grad coeff: 0.025516, velocity coeff: 1.0314
norm(ch) = 0.89334
rho = 1.002
New lambda: 1.2119e-036
iter: 1730, Minibatch log likelihood (pre-update): -54.4134, error rate (pre-update): 0.095898
iter: 1730, Minibatch log likelihood (post-update): -54.4132, error rate (post-update): 0.095871

size_minibatch = 20000
Precon grad coeff: 0.022709, velocity coeff: 0.91624
norm(ch) = 0.82186
iter: 1731, Minibatch log likelihood (pre-update): -54.4132, error rate (pre-update): 0.095871

size_minibatch = 20000
Precon grad coeff: 0.023732, velocity coeff: 1.0345
norm(ch) = 0.85354
iter: 1732, Minibatch log likelihood (pre-update): -54.4131, error rate (pre-update): 0.095847

size_minibatch = 20000
Precon grad coeff: 0.023281, velocity coeff: 0.9975
norm(ch) = 0.85456
iter: 1733, Minibatch log likelihood (pre-update): -54.413, error rate (pre-update): 0.095844

size_minibatch = 20000
Precon grad coeff: 0.025461, velocity coeff: 1.0493
norm(ch) = 0.90028
iter: 1734, Minibatch log likelihood (pre-update): -54.4129, error rate (pre-update): 0.095806

size_minibatch = 20000
Precon grad coeff: 0.023182, velocity coeff: 0.91656
norm(ch) = 0.82806
rho = 1.0139
New lambda: 9.3772e-037
iter: 1735, Minibatch log likelihood (pre-update): -54.4128, error rate (pre-update): 0.095785
iter: 1735, Minibatch log likelihood (post-update): -54.4127, error rate (post-update): 0.095772

size_minibatch = 20000
Precon grad coeff: 0.024942, velocity coeff: 1.0965
norm(ch) = 0.91156
iter: 1736, Minibatch log likelihood (pre-update): -54.4127, error rate (pre-update): 0.095772

size_minibatch = 20000
Precon grad coeff: 0.026331, velocity coeff: 0.97765
norm(ch) = 0.89482
iter: 1737, Minibatch log likelihood (pre-update): -54.4125, error rate (pre-update): 0.095744

size_minibatch = 20000
Precon grad coeff: 0.024073, velocity coeff: 0.95295
norm(ch) = 0.85593
iter: 1738, Minibatch log likelihood (pre-update): -54.4124, error rate (pre-update): 0.095716

size_minibatch = 20000
Precon grad coeff: 0.024507, velocity coeff: 1.007
norm(ch) = 0.86538
iter: 1739, Minibatch log likelihood (pre-update): -54.4123, error rate (pre-update): 0.095698

size_minibatch = 20000
Precon grad coeff: 0.025013, velocity coeff: 0.95193
New gamma: 0.0031623
norm(ch) = 0.82749
rho = 1.0332
New lambda: 7.2559e-037
iter: 1740, Minibatch log likelihood (pre-update): -54.4122, error rate (pre-update): 0.095694
iter: 1740, Minibatch log likelihood (post-update): -54.4121, error rate (post-update): 0.095668

size_minibatch = 20000
Precon grad coeff: 0.022765, velocity coeff: 0.92436
norm(ch) = 0.76828
iter: 1741, Minibatch log likelihood (pre-update): -54.4121, error rate (pre-update): 0.095668

size_minibatch = 20000
Precon grad coeff: 0.024323, velocity coeff: 1.0651
norm(ch) = 0.82215
iter: 1742, Minibatch log likelihood (pre-update): -54.412, error rate (pre-update): 0.095643

size_minibatch = 20000
Precon grad coeff: 0.024681, velocity coeff: 1.0345
norm(ch) = 0.85404
iter: 1743, Minibatch log likelihood (pre-update): -54.4119, error rate (pre-update): 0.095627

size_minibatch = 20000
Precon grad coeff: 0.02386, velocity coeff: 0.98323
norm(ch) = 0.84344
iter: 1744, Minibatch log likelihood (pre-update): -54.4117, error rate (pre-update): 0.095593

size_minibatch = 20000
Precon grad coeff: 0.026771, velocity coeff: 1.1265
norm(ch) = 0.95435
rho = 1.0053
New lambda: 5.6145e-037
iter: 1745, Minibatch log likelihood (pre-update): -54.4116, error rate (pre-update): 0.09559
iter: 1745, Minibatch log likelihood (post-update): -54.4115, error rate (post-update): 0.095574

size_minibatch = 20000
Precon grad coeff: 0.027552, velocity coeff: 0.96768
norm(ch) = 0.92778
iter: 1746, Minibatch log likelihood (pre-update): -54.4115, error rate (pre-update): 0.095574

size_minibatch = 20000
Precon grad coeff: 0.024042, velocity coeff: 0.94364
norm(ch) = 0.87879
iter: 1747, Minibatch log likelihood (pre-update): -54.4114, error rate (pre-update): 0.095532

size_minibatch = 20000
Precon grad coeff: 0.025092, velocity coeff: 1.0454
norm(ch) = 0.92226
iter: 1748, Minibatch log likelihood (pre-update): -54.4112, error rate (pre-update): 0.095509

size_minibatch = 20000
Precon grad coeff: 0.024587, velocity coeff: 0.92315
norm(ch) = 0.85505
iter: 1749, Minibatch log likelihood (pre-update): -54.4111, error rate (pre-update): 0.095488

size_minibatch = 20000
Precon grad coeff: 0.021825, velocity coeff: 0.93892
norm(ch) = 0.80579
rho = 1.0189
New lambda: 4.3444e-037
iter: 1750, Minibatch log likelihood (pre-update): -54.411, error rate (pre-update): 0.095476
iter: 1750, Minibatch log likelihood (post-update): -54.4109, error rate (post-update): 0.095459
---
Full log-likelihood: -54.4109, error rate: 0.095459
TEST log-likelihood: -54.7849, error rate: 0.25893
Error difference (test - train): 0.16347
---
Full log-likelihood (averaged params): -54.48, error rate (averaged params): 0.1194
TEST log-likelihood (averaged params): -54.783, error rate (averaged params): 0.26149
Error difference (test - train) (averaged params): 0.1421

size_minibatch = 20000
Precon grad coeff: 0.023001, velocity coeff: 1.0218
norm(ch) = 0.82667
iter: 1751, Minibatch log likelihood (pre-update): -54.4109, error rate (pre-update): 0.095459

size_minibatch = 20000
Precon grad coeff: 0.022685, velocity coeff: 0.99
norm(ch) = 0.82156
iter: 1752, Minibatch log likelihood (pre-update): -54.4108, error rate (pre-update): 0.095445

size_minibatch = 20000
Precon grad coeff: 0.025507, velocity coeff: 1.0447
norm(ch) = 0.86203
iter: 1753, Minibatch log likelihood (pre-update): -54.4107, error rate (pre-update): 0.095412

size_minibatch = 20000
Precon grad coeff: 0.026325, velocity coeff: 1.0157
norm(ch) = 0.87953
iter: 1754, Minibatch log likelihood (pre-update): -54.4106, error rate (pre-update): 0.095394

size_minibatch = 20000
Precon grad coeff: 0.025107, velocity coeff: 0.96629
norm(ch) = 0.85345
rho = 1.0045
New lambda: 3.3616e-037
iter: 1755, Minibatch log likelihood (pre-update): -54.4104, error rate (pre-update): 0.095385
iter: 1755, Minibatch log likelihood (post-update): -54.4103, error rate (post-update): 0.095352

size_minibatch = 20000
Precon grad coeff: 0.023695, velocity coeff: 0.9855
norm(ch) = 0.84445
iter: 1756, Minibatch log likelihood (pre-update): -54.4103, error rate (pre-update): 0.095352

size_minibatch = 20000
Precon grad coeff: 0.024718, velocity coeff: 1.0274
norm(ch) = 0.87113
iter: 1757, Minibatch log likelihood (pre-update): -54.4102, error rate (pre-update): 0.095329

size_minibatch = 20000
Precon grad coeff: 0.023693, velocity coeff: 0.98724
norm(ch) = 0.86314
iter: 1758, Minibatch log likelihood (pre-update): -54.4101, error rate (pre-update): 0.095316

size_minibatch = 20000
Precon grad coeff: 0.020943, velocity coeff: 0.89749
norm(ch) = 0.77749
iter: 1759, Minibatch log likelihood (pre-update): -54.41, error rate (pre-update): 0.095295

size_minibatch = 20000
Precon grad coeff: 0.024221, velocity coeff: 1.0797
New gamma: 0.0031623
norm(ch) = 0.84346
rho = 1.0001
New lambda: 2.6011e-037
iter: 1760, Minibatch log likelihood (pre-update): -54.4099, error rate (pre-update): 0.095271
iter: 1760, Minibatch log likelihood (post-update): -54.4097, error rate (post-update): 0.095255

size_minibatch = 20000
Precon grad coeff: 0.024256, velocity coeff: 0.95892
norm(ch) = 0.81265
iter: 1761, Minibatch log likelihood (pre-update): -54.4097, error rate (pre-update): 0.095255

size_minibatch = 20000
Precon grad coeff: 0.023299, velocity coeff: 0.991
norm(ch) = 0.809
iter: 1762, Minibatch log likelihood (pre-update): -54.4096, error rate (pre-update): 0.095224

size_minibatch = 20000
Precon grad coeff: 0.026639, velocity coeff: 1.1007
norm(ch) = 0.89457
iter: 1763, Minibatch log likelihood (pre-update): -54.4095, error rate (pre-update): 0.095215

size_minibatch = 20000
Precon grad coeff: 0.02574, velocity coeff: 0.94715
norm(ch) = 0.85122
iter: 1764, Minibatch log likelihood (pre-update): -54.4094, error rate (pre-update): 0.095203

size_minibatch = 20000
Precon grad coeff: 0.025684, velocity coeff: 1.0484
norm(ch) = 0.89626
rho = 0.99927
New lambda: 2.0127e-037
iter: 1765, Minibatch log likelihood (pre-update): -54.4093, error rate (pre-update): 0.095174
iter: 1765, Minibatch log likelihood (post-update): -54.4092, error rate (post-update): 0.095153

size_minibatch = 20000
Precon grad coeff: 0.024946, velocity coeff: 0.9851
norm(ch) = 0.88678
iter: 1766, Minibatch log likelihood (pre-update): -54.4092, error rate (pre-update): 0.095153

size_minibatch = 20000
Precon grad coeff: 0.024655, velocity coeff: 0.96456
norm(ch) = 0.85869
iter: 1767, Minibatch log likelihood (pre-update): -54.409, error rate (pre-update): 0.095125

size_minibatch = 20000
Precon grad coeff: 0.025349, velocity coeff: 1.0616
norm(ch) = 0.9155
iter: 1768, Minibatch log likelihood (pre-update): -54.4089, error rate (pre-update): 0.095105

size_minibatch = 20000
Precon grad coeff: 0.025197, velocity coeff: 0.90911
norm(ch) = 0.83595
iter: 1769, Minibatch log likelihood (pre-update): -54.4088, error rate (pre-update): 0.095079

size_minibatch = 20000
Precon grad coeff: 0.02165, velocity coeff: 0.96945
norm(ch) = 0.81326
rho = 1.0032
New lambda: 1.5574e-037
iter: 1770, Minibatch log likelihood (pre-update): -54.4087, error rate (pre-update): 0.095077
iter: 1770, Minibatch log likelihood (post-update): -54.4086, error rate (post-update): 0.095056

size_minibatch = 20000
Precon grad coeff: 0.022641, velocity coeff: 1.0006
norm(ch) = 0.81715
iter: 1771, Minibatch log likelihood (pre-update): -54.4086, error rate (pre-update): 0.095056

size_minibatch = 20000
Precon grad coeff: 0.023455, velocity coeff: 0.99526
norm(ch) = 0.81655
iter: 1772, Minibatch log likelihood (pre-update): -54.4085, error rate (pre-update): 0.095019

size_minibatch = 20000
Precon grad coeff: 0.022634, velocity coeff: 0.98784
norm(ch) = 0.80973
iter: 1773, Minibatch log likelihood (pre-update): -54.4084, error rate (pre-update): 0.095003

size_minibatch = 20000
Precon grad coeff: 0.02314, velocity coeff: 1.0148
norm(ch) = 0.82494
iter: 1774, Minibatch log likelihood (pre-update): -54.4083, error rate (pre-update): 0.095004

size_minibatch = 20000
Precon grad coeff: 0.0247, velocity coeff: 1.0202
norm(ch) = 0.84476
rho = 1.0165
New lambda: 1.2051e-037
iter: 1775, Minibatch log likelihood (pre-update): -54.4081, error rate (pre-update): 0.094967
iter: 1775, Minibatch log likelihood (post-update): -54.408, error rate (post-update): 0.094944

size_minibatch = 20000
Precon grad coeff: 0.023495, velocity coeff: 0.98294
norm(ch) = 0.83333
iter: 1776, Minibatch log likelihood (pre-update): -54.408, error rate (pre-update): 0.094944

size_minibatch = 20000
Precon grad coeff: 0.025166, velocity coeff: 1.0307
norm(ch) = 0.86247
iter: 1777, Minibatch log likelihood (pre-update): -54.4079, error rate (pre-update): 0.094933

size_minibatch = 20000
Precon grad coeff: 0.02415, velocity coeff: 0.95846
norm(ch) = 0.83005
iter: 1778, Minibatch log likelihood (pre-update): -54.4078, error rate (pre-update): 0.094908

size_minibatch = 20000
Precon grad coeff: 0.02259, velocity coeff: 1.0203
norm(ch) = 0.84979
iter: 1779, Minibatch log likelihood (pre-update): -54.4077, error rate (pre-update): 0.09489

size_minibatch = 20000
Precon grad coeff: 0.027677, velocity coeff: 0.99516
New gamma: 0.0031623
norm(ch) = 0.84986
rho = 1.0024
New lambda: 9.3247e-038
iter: 1780, Minibatch log likelihood (pre-update): -54.4076, error rate (pre-update): 0.09485
iter: 1780, Minibatch log likelihood (post-update): -54.4075, error rate (post-update): 0.094837

size_minibatch = 20000
Precon grad coeff: 0.023105, velocity coeff: 0.92846
norm(ch) = 0.79247
iter: 1781, Minibatch log likelihood (pre-update): -54.4075, error rate (pre-update): 0.094837

size_minibatch = 20000
Precon grad coeff: 0.023775, velocity coeff: 1.048
norm(ch) = 0.83375
iter: 1782, Minibatch log likelihood (pre-update): -54.4074, error rate (pre-update): 0.094825

size_minibatch = 20000
Precon grad coeff: 0.024545, velocity coeff: 0.98203
norm(ch) = 0.8223
iter: 1783, Minibatch log likelihood (pre-update): -54.4073, error rate (pre-update): 0.094809

size_minibatch = 20000
Precon grad coeff: 0.022774, velocity coeff: 1.0239
norm(ch) = 0.8454
iter: 1784, Minibatch log likelihood (pre-update): -54.4071, error rate (pre-update): 0.094783

size_minibatch = 20000
Precon grad coeff: 0.025316, velocity coeff: 1.0419
norm(ch) = 0.88412
rho = 1.0216
New lambda: 7.2153e-038
iter: 1785, Minibatch log likelihood (pre-update): -54.407, error rate (pre-update): 0.094768
iter: 1785, Minibatch log likelihood (post-update): -54.4069, error rate (post-update): 0.094751

size_minibatch = 20000
Precon grad coeff: 0.028547, velocity coeff: 1.0478
norm(ch) = 0.93027
iter: 1786, Minibatch log likelihood (pre-update): -54.4069, error rate (pre-update): 0.094751

size_minibatch = 20000
Precon grad coeff: 0.026288, velocity coeff: 0.95286
norm(ch) = 0.89044
iter: 1787, Minibatch log likelihood (pre-update): -54.4068, error rate (pre-update): 0.094715

size_minibatch = 20000
Precon grad coeff: 0.024557, velocity coeff: 0.9297
norm(ch) = 0.83092
iter: 1788, Minibatch log likelihood (pre-update): -54.4067, error rate (pre-update): 0.094696

size_minibatch = 20000
Precon grad coeff: 0.024775, velocity coeff: 1.0364
norm(ch) = 0.86445
iter: 1789, Minibatch log likelihood (pre-update): -54.4065, error rate (pre-update): 0.094688

size_minibatch = 20000
Precon grad coeff: 0.022792, velocity coeff: 0.91395
norm(ch) = 0.79297
rho = 0.98832
New lambda: 5.5831e-038
iter: 1790, Minibatch log likelihood (pre-update): -54.4064, error rate (pre-update): 0.094666
iter: 1790, Minibatch log likelihood (post-update): -54.4063, error rate (post-update): 0.094625

size_minibatch = 20000
Precon grad coeff: 0.022144, velocity coeff: 1.0101
norm(ch) = 0.80407
iter: 1791, Minibatch log likelihood (pre-update): -54.4063, error rate (pre-update): 0.094625

size_minibatch = 20000
Precon grad coeff: 0.023134, velocity coeff: 1.024
norm(ch) = 0.82655
iter: 1792, Minibatch log likelihood (pre-update): -54.4062, error rate (pre-update): 0.094606

size_minibatch = 20000
Precon grad coeff: 0.024513, velocity coeff: 0.99602
norm(ch) = 0.82644
iter: 1793, Minibatch log likelihood (pre-update): -54.4061, error rate (pre-update): 0.094603

size_minibatch = 20000
Precon grad coeff: 0.025171, velocity coeff: 1.0378
norm(ch) = 0.86112
iter: 1794, Minibatch log likelihood (pre-update): -54.406, error rate (pre-update): 0.094593

size_minibatch = 20000
Precon grad coeff: 0.023536, velocity coeff: 0.92612
norm(ch) = 0.80034
rho = 1.0106
New lambda: 4.3201e-038
iter: 1795, Minibatch log likelihood (pre-update): -54.4059, error rate (pre-update): 0.094561
iter: 1795, Minibatch log likelihood (post-update): -54.4058, error rate (post-update): 0.094549

size_minibatch = 20000
Precon grad coeff: 0.026697, velocity coeff: 1.1175
norm(ch) = 0.8984
iter: 1796, Minibatch log likelihood (pre-update): -54.4058, error rate (pre-update): 0.094549

size_minibatch = 20000
Precon grad coeff: 0.023453, velocity coeff: 0.89182
norm(ch) = 0.80391
iter: 1797, Minibatch log likelihood (pre-update): -54.4057, error rate (pre-update): 0.094514

size_minibatch = 20000
Precon grad coeff: 0.022346, velocity coeff: 0.99765
norm(ch) = 0.80503
iter: 1798, Minibatch log likelihood (pre-update): -54.4056, error rate (pre-update): 0.094497

size_minibatch = 20000
Precon grad coeff: 0.021168, velocity coeff: 0.97118
norm(ch) = 0.7846
iter: 1799, Minibatch log likelihood (pre-update): -54.4054, error rate (pre-update): 0.094495

size_minibatch = 20000
Precon grad coeff: 0.023965, velocity coeff: 1.0586
New gamma: 0.0031623
norm(ch) = 0.83387
rho = 1.0152
New lambda: 3.3428e-038
iter: 1800, Minibatch log likelihood (pre-update): -54.4053, error rate (pre-update): 0.094463
iter: 1800, Minibatch log likelihood (post-update): -54.4052, error rate (post-update): 0.094451
---
Full log-likelihood: -54.4052, error rate: 0.094451
TEST log-likelihood: -54.7964, error rate: 0.26266
Error difference (test - train): 0.16821
---
Full log-likelihood (averaged params): -54.4691, error rate (averaged params): 0.11637
TEST log-likelihood (averaged params): -54.7882, error rate (averaged params): 0.26288
Error difference (test - train) (averaged params): 0.14651

size_minibatch = 20000
Precon grad coeff: 0.025309, velocity coeff: 1.0267
norm(ch) = 0.85973
iter: 1801, Minibatch log likelihood (pre-update): -54.4052, error rate (pre-update): 0.094451

size_minibatch = 20000
Precon grad coeff: 0.027904, velocity coeff: 1.0307
norm(ch) = 0.88994
iter: 1802, Minibatch log likelihood (pre-update): -54.4051, error rate (pre-update): 0.094439

size_minibatch = 20000
Precon grad coeff: 0.026051, velocity coeff: 0.97454
norm(ch) = 0.87095
iter: 1803, Minibatch log likelihood (pre-update): -54.405, error rate (pre-update): 0.094401

size_minibatch = 20000
Precon grad coeff: 0.025032, velocity coeff: 0.97265
norm(ch) = 0.85006
iter: 1804, Minibatch log likelihood (pre-update): -54.4049, error rate (pre-update): 0.094381

size_minibatch = 20000
Precon grad coeff: 0.02384, velocity coeff: 0.99125
norm(ch) = 0.84578
rho = 1.008
New lambda: 2.5866e-038
iter: 1805, Minibatch log likelihood (pre-update): -54.4048, error rate (pre-update): 0.094374
iter: 1805, Minibatch log likelihood (post-update): -54.4047, error rate (post-update): 0.094347

size_minibatch = 20000
Precon grad coeff: 0.021767, velocity coeff: 0.93095
norm(ch) = 0.79031
iter: 1806, Minibatch log likelihood (pre-update): -54.4047, error rate (pre-update): 0.094347

size_minibatch = 20000
Precon grad coeff: 0.022227, velocity coeff: 1.0073
norm(ch) = 0.79916
iter: 1807, Minibatch log likelihood (pre-update): -54.4046, error rate (pre-update): 0.094327

size_minibatch = 20000
Precon grad coeff: 0.023916, velocity coeff: 1.058
norm(ch) = 0.84836
iter: 1808, Minibatch log likelihood (pre-update): -54.4045, error rate (pre-update): 0.094318

size_minibatch = 20000
Precon grad coeff: 0.024771, velocity coeff: 0.96279
norm(ch) = 0.81987
iter: 1809, Minibatch log likelihood (pre-update): -54.4043, error rate (pre-update): 0.094301

size_minibatch = 20000
Precon grad coeff: 0.024342, velocity coeff: 1.0164
norm(ch) = 0.83667
rho = 1.0113
New lambda: 2.0014e-038
iter: 1810, Minibatch log likelihood (pre-update): -54.4042, error rate (pre-update): 0.094258
iter: 1810, Minibatch log likelihood (post-update): -54.4041, error rate (post-update): 0.094254

size_minibatch = 20000
Precon grad coeff: 0.024525, velocity coeff: 0.97632
norm(ch) = 0.82
iter: 1811, Minibatch log likelihood (pre-update): -54.4041, error rate (pre-update): 0.094254

size_minibatch = 20000
Precon grad coeff: 0.024973, velocity coeff: 1.0255
norm(ch) = 0.84416
iter: 1812, Minibatch log likelihood (pre-update): -54.404, error rate (pre-update): 0.094239

size_minibatch = 20000
Precon grad coeff: 0.024884, velocity coeff: 0.99668
norm(ch) = 0.84462
iter: 1813, Minibatch log likelihood (pre-update): -54.4039, error rate (pre-update): 0.094225

size_minibatch = 20000
Precon grad coeff: 0.024431, velocity coeff: 0.97244
norm(ch) = 0.82429
iter: 1814, Minibatch log likelihood (pre-update): -54.4038, error rate (pre-update): 0.094202

size_minibatch = 20000
Precon grad coeff: 0.021352, velocity coeff: 0.94564
norm(ch) = 0.78221
rho = 0.98487
New lambda: 1.5487e-038
iter: 1815, Minibatch log likelihood (pre-update): -54.4037, error rate (pre-update): 0.094176
iter: 1815, Minibatch log likelihood (post-update): -54.4036, error rate (post-update): 0.094153

size_minibatch = 20000
Precon grad coeff: 0.022433, velocity coeff: 1.0439
norm(ch) = 0.8197
iter: 1816, Minibatch log likelihood (pre-update): -54.4036, error rate (pre-update): 0.094153

size_minibatch = 20000
Precon grad coeff: 0.020881, velocity coeff: 0.93378
norm(ch) = 0.76797
iter: 1817, Minibatch log likelihood (pre-update): -54.4035, error rate (pre-update): 0.094148

size_minibatch = 20000
Precon grad coeff: 0.023931, velocity coeff: 1.0682
norm(ch) = 0.82336
iter: 1818, Minibatch log likelihood (pre-update): -54.4034, error rate (pre-update): 0.094136

size_minibatch = 20000
Precon grad coeff: 0.024073, velocity coeff: 1.0349
norm(ch) = 0.85508
iter: 1819, Minibatch log likelihood (pre-update): -54.4033, error rate (pre-update): 0.094114

size_minibatch = 20000
Precon grad coeff: 0.025389, velocity coeff: 0.90368
New gamma: 0.0031623
norm(ch) = 0.77616
rho = 0.99768
New lambda: 1.1983e-038
iter: 1820, Minibatch log likelihood (pre-update): -54.4032, error rate (pre-update): 0.094094
iter: 1820, Minibatch log likelihood (post-update): -54.4031, error rate (post-update): 0.094069

size_minibatch = 20000
Precon grad coeff: 0.025748, velocity coeff: 1.0804
norm(ch) = 0.84232
iter: 1821, Minibatch log likelihood (pre-update): -54.4031, error rate (pre-update): 0.094069

size_minibatch = 20000
Precon grad coeff: 0.025828, velocity coeff: 0.94061
norm(ch) = 0.7959
iter: 1822, Minibatch log likelihood (pre-update): -54.4029, error rate (pre-update): 0.094037

size_minibatch = 20000
Precon grad coeff: 0.022447, velocity coeff: 1.002
norm(ch) = 0.80081
iter: 1823, Minibatch log likelihood (pre-update): -54.4028, error rate (pre-update): 0.094039

size_minibatch = 20000
Precon grad coeff: 0.02404, velocity coeff: 1.0212
norm(ch) = 0.82094
iter: 1824, Minibatch log likelihood (pre-update): -54.4027, error rate (pre-update): 0.094028

size_minibatch = 20000
Precon grad coeff: 0.023548, velocity coeff: 1.0202
norm(ch) = 0.84091
rho = 1.0095
New lambda: 9.2725e-039
iter: 1825, Minibatch log likelihood (pre-update): -54.4026, error rate (pre-update): 0.094011
iter: 1825, Minibatch log likelihood (post-update): -54.4025, error rate (post-update): 0.093976

size_minibatch = 20000
Precon grad coeff: 0.023784, velocity coeff: 1.0088
norm(ch) = 0.85167
iter: 1826, Minibatch log likelihood (pre-update): -54.4025, error rate (pre-update): 0.093976

size_minibatch = 20000
Precon grad coeff: 0.026139, velocity coeff: 1.0353
norm(ch) = 0.88539
iter: 1827, Minibatch log likelihood (pre-update): -54.4024, error rate (pre-update): 0.093951

size_minibatch = 20000
Precon grad coeff: 0.023517, velocity coeff: 0.92027
norm(ch) = 0.81794
iter: 1828, Minibatch log likelihood (pre-update): -54.4023, error rate (pre-update): 0.093943

size_minibatch = 20000
Precon grad coeff: 0.024949, velocity coeff: 1.0133
norm(ch) = 0.83216
iter: 1829, Minibatch log likelihood (pre-update): -54.4022, error rate (pre-update): 0.093933

size_minibatch = 20000
Precon grad coeff: 0.024322, velocity coeff: 0.98635
norm(ch) = 0.82396
rho = 0.99798
New lambda: 7.1749e-039
iter: 1830, Minibatch log likelihood (pre-update): -54.4021, error rate (pre-update): 0.093914
iter: 1830, Minibatch log likelihood (post-update): -54.402, error rate (post-update): 0.093881

size_minibatch = 20000
Precon grad coeff: 0.023858, velocity coeff: 0.96499
norm(ch) = 0.79812
iter: 1831, Minibatch log likelihood (pre-update): -54.402, error rate (pre-update): 0.093881

size_minibatch = 20000
Precon grad coeff: 0.022817, velocity coeff: 0.98314
norm(ch) = 0.78762
iter: 1832, Minibatch log likelihood (pre-update): -54.4019, error rate (pre-update): 0.093862

size_minibatch = 20000
Precon grad coeff: 0.023603, velocity coeff: 1.0041
norm(ch) = 0.79408
iter: 1833, Minibatch log likelihood (pre-update): -54.4018, error rate (pre-update): 0.093853

size_minibatch = 20000
Precon grad coeff: 0.022162, velocity coeff: 0.966
norm(ch) = 0.77002
iter: 1834, Minibatch log likelihood (pre-update): -54.4017, error rate (pre-update): 0.09383

size_minibatch = 20000
Precon grad coeff: 0.023615, velocity coeff: 1.0685
norm(ch) = 0.82596
rho = 0.99224
New lambda: 5.5518e-039
iter: 1835, Minibatch log likelihood (pre-update): -54.4016, error rate (pre-update): 0.093823
iter: 1835, Minibatch log likelihood (post-update): -54.4014, error rate (post-update): 0.093802

size_minibatch = 20000
Precon grad coeff: 0.023696, velocity coeff: 0.97329
norm(ch) = 0.80683
iter: 1836, Minibatch log likelihood (pre-update): -54.4014, error rate (pre-update): 0.093802

size_minibatch = 20000
Precon grad coeff: 0.024075, velocity coeff: 1.0179
norm(ch) = 0.82443
iter: 1837, Minibatch log likelihood (pre-update): -54.4013, error rate (pre-update): 0.093782

size_minibatch = 20000
Precon grad coeff: 0.02478, velocity coeff: 1.0282
norm(ch) = 0.85075
iter: 1838, Minibatch log likelihood (pre-update): -54.4012, error rate (pre-update): 0.093758

size_minibatch = 20000
Precon grad coeff: 0.024566, velocity coeff: 0.95615
norm(ch) = 0.8167
iter: 1839, Minibatch log likelihood (pre-update): -54.4011, error rate (pre-update): 0.093737

size_minibatch = 20000
Precon grad coeff: 0.025198, velocity coeff: 1.0125
New gamma: 0.0031623
norm(ch) = 0.8306
rho = 1.0445
New lambda: 4.2959e-039
iter: 1840, Minibatch log likelihood (pre-update): -54.401, error rate (pre-update): 0.09373
iter: 1840, Minibatch log likelihood (post-update): -54.4009, error rate (post-update): 0.093714

size_minibatch = 20000
Precon grad coeff: 0.025459, velocity coeff: 0.94557
norm(ch) = 0.7887
iter: 1841, Minibatch log likelihood (pre-update): -54.4009, error rate (pre-update): 0.093714

size_minibatch = 20000
Precon grad coeff: 0.022653, velocity coeff: 0.9923
norm(ch) = 0.78585
iter: 1842, Minibatch log likelihood (pre-update): -54.4008, error rate (pre-update): 0.093688

size_minibatch = 20000
Precon grad coeff: 0.022762, velocity coeff: 1.0045
norm(ch) = 0.79235
iter: 1843, Minibatch log likelihood (pre-update): -54.4007, error rate (pre-update): 0.093671

size_minibatch = 20000
Precon grad coeff: 0.023806, velocity coeff: 1.0291
norm(ch) = 0.8186
iter: 1844, Minibatch log likelihood (pre-update): -54.4006, error rate (pre-update): 0.09365

size_minibatch = 20000
Precon grad coeff: 0.024076, velocity coeff: 1.0272
norm(ch) = 0.84421
rho = 0.9959
New lambda: 3.3241e-039
iter: 1845, Minibatch log likelihood (pre-update): -54.4005, error rate (pre-update): 0.093631
iter: 1845, Minibatch log likelihood (post-update): -54.4004, error rate (post-update): 0.093613

size_minibatch = 20000
Precon grad coeff: 0.026029, velocity coeff: 1.0088
norm(ch) = 0.85517
iter: 1846, Minibatch log likelihood (pre-update): -54.4004, error rate (pre-update): 0.093613

size_minibatch = 20000
Precon grad coeff: 0.024337, velocity coeff: 0.98258
norm(ch) = 0.8438
iter: 1847, Minibatch log likelihood (pre-update): -54.4003, error rate (pre-update): 0.093592

size_minibatch = 20000
Precon grad coeff: 0.025455, velocity coeff: 0.98179
norm(ch) = 0.8315
iter: 1848, Minibatch log likelihood (pre-update): -54.4002, error rate (pre-update): 0.093567

size_minibatch = 20000
Precon grad coeff: 0.024351, velocity coeff: 0.98107
norm(ch) = 0.81902
iter: 1849, Minibatch log likelihood (pre-update): -54.4001, error rate (pre-update): 0.093564

size_minibatch = 20000
Precon grad coeff: 0.02603, velocity coeff: 1.0187
norm(ch) = 0.83785
rho = 0.99015
New lambda: 2.5721e-039
iter: 1850, Minibatch log likelihood (pre-update): -54.3999, error rate (pre-update): 0.093535
iter: 1850, Minibatch log likelihood (post-update): -54.3998, error rate (post-update): 0.093518
---
Full log-likelihood: -54.3998, error rate: 0.093518
TEST log-likelihood: -54.8062, error rate: 0.26565
Error difference (test - train): 0.17213
---
Full log-likelihood (averaged params): -54.4578, error rate (averaged params): 0.11323
TEST log-likelihood (averaged params): -54.7938, error rate (averaged params): 0.26433
Error difference (test - train) (averaged params): 0.15109

size_minibatch = 20000
Precon grad coeff: 0.022755, velocity coeff: 0.9269
norm(ch) = 0.77937
iter: 1851, Minibatch log likelihood (pre-update): -54.3998, error rate (pre-update): 0.093518

size_minibatch = 20000
Precon grad coeff: 0.022804, velocity coeff: 0.98376
norm(ch) = 0.76978
iter: 1852, Minibatch log likelihood (pre-update): -54.3997, error rate (pre-update): 0.093507

size_minibatch = 20000
Precon grad coeff: 0.021354, velocity coeff: 1.016
norm(ch) = 0.78491
iter: 1853, Minibatch log likelihood (pre-update): -54.3996, error rate (pre-update): 0.093478

size_minibatch = 20000
Precon grad coeff: 0.02416, velocity coeff: 1.0323
norm(ch) = 0.81337
iter: 1854, Minibatch log likelihood (pre-update): -54.3995, error rate (pre-update): 0.09346

size_minibatch = 20000
Precon grad coeff: 0.022562, velocity coeff: 0.97376
norm(ch) = 0.79485
rho = 1.0091
New lambda: 1.9902e-039
iter: 1855, Minibatch log likelihood (pre-update): -54.3994, error rate (pre-update): 0.093464
iter: 1855, Minibatch log likelihood (post-update): -54.3993, error rate (post-update): 0.093429

size_minibatch = 20000
Precon grad coeff: 0.026348, velocity coeff: 1.0793
norm(ch) = 0.86118
iter: 1856, Minibatch log likelihood (pre-update): -54.3993, error rate (pre-update): 0.093429

size_minibatch = 20000
Precon grad coeff: 0.024617, velocity coeff: 0.94597
norm(ch) = 0.81778
iter: 1857, Minibatch log likelihood (pre-update): -54.3992, error rate (pre-update): 0.093395

size_minibatch = 20000
Precon grad coeff: 0.023606, velocity coeff: 0.98612
norm(ch) = 0.8093
iter: 1858, Minibatch log likelihood (pre-update): -54.3991, error rate (pre-update): 0.093388

size_minibatch = 20000
Precon grad coeff: 0.024708, velocity coeff: 1.017
norm(ch) = 0.82617
iter: 1859, Minibatch log likelihood (pre-update): -54.399, error rate (pre-update): 0.093382

size_minibatch = 20000
Precon grad coeff: 0.024699, velocity coeff: 0.94448
New gamma: 0.0031623
norm(ch) = 0.78366
rho = 1.0033
New lambda: 1.54e-039
iter: 1860, Minibatch log likelihood (pre-update): -54.3989, error rate (pre-update): 0.093353
iter: 1860, Minibatch log likelihood (post-update): -54.3988, error rate (post-update): 0.093333

size_minibatch = 20000
Precon grad coeff: 0.025791, velocity coeff: 1.0738
norm(ch) = 0.84526
iter: 1861, Minibatch log likelihood (pre-update): -54.3988, error rate (pre-update): 0.093333

size_minibatch = 20000
Precon grad coeff: 0.021918, velocity coeff: 0.89069
norm(ch) = 0.75557
iter: 1862, Minibatch log likelihood (pre-update): -54.3987, error rate (pre-update): 0.093305

size_minibatch = 20000
Precon grad coeff: 0.024603, velocity coeff: 1.0958
norm(ch) = 0.83114
iter: 1863, Minibatch log likelihood (pre-update): -54.3986, error rate (pre-update): 0.09329

size_minibatch = 20000
Precon grad coeff: 0.025272, velocity coeff: 1.02
norm(ch) = 0.85141
iter: 1864, Minibatch log likelihood (pre-update): -54.3985, error rate (pre-update): 0.09328

size_minibatch = 20000
Precon grad coeff: 0.023261, velocity coeff: 0.97107
norm(ch) = 0.82969
rho = 0.9911
New lambda: 1.1916e-039
iter: 1865, Minibatch log likelihood (pre-update): -54.3984, error rate (pre-update): 0.09326
iter: 1865, Minibatch log likelihood (post-update): -54.3983, error rate (post-update): 0.093241

size_minibatch = 20000
Precon grad coeff: 0.025916, velocity coeff: 1.0247
norm(ch) = 0.85362
iter: 1866, Minibatch log likelihood (pre-update): -54.3983, error rate (pre-update): 0.093241

size_minibatch = 20000
Precon grad coeff: 0.027142, velocity coeff: 1.0318
norm(ch) = 0.88422
iter: 1867, Minibatch log likelihood (pre-update): -54.3982, error rate (pre-update): 0.093226

size_minibatch = 20000
Precon grad coeff: 0.022151, velocity coeff: 0.86869
norm(ch) = 0.7709
iter: 1868, Minibatch log likelihood (pre-update): -54.3981, error rate (pre-update): 0.09319

size_minibatch = 20000
Precon grad coeff: 0.027125, velocity coeff: 1.1191
norm(ch) = 0.8661
iter: 1869, Minibatch log likelihood (pre-update): -54.398, error rate (pre-update): 0.093175

size_minibatch = 20000
Precon grad coeff: 0.02479, velocity coeff: 0.93582
norm(ch) = 0.81356
rho = 1.0092
New lambda: 9.2206e-040
iter: 1870, Minibatch log likelihood (pre-update): -54.3979, error rate (pre-update): 0.093152
iter: 1870, Minibatch log likelihood (post-update): -54.3978, error rate (post-update): 0.093144

size_minibatch = 20000
Precon grad coeff: 0.024743, velocity coeff: 1.0021
norm(ch) = 0.81848
iter: 1871, Minibatch log likelihood (pre-update): -54.3978, error rate (pre-update): 0.093144

size_minibatch = 20000
Precon grad coeff: 0.026386, velocity coeff: 1.0494
norm(ch) = 0.86242
iter: 1872, Minibatch log likelihood (pre-update): -54.3977, error rate (pre-update): 0.093123

size_minibatch = 20000
Precon grad coeff: 0.024994, velocity coeff: 0.93492
norm(ch) = 0.80927
iter: 1873, Minibatch log likelihood (pre-update): -54.3976, error rate (pre-update): 0.093105

size_minibatch = 20000
Precon grad coeff: 0.023458, velocity coeff: 1.0013
norm(ch) = 0.81332
iter: 1874, Minibatch log likelihood (pre-update): -54.3975, error rate (pre-update): 0.093084

size_minibatch = 20000
Precon grad coeff: 0.024202, velocity coeff: 0.9735
norm(ch) = 0.79495
rho = 1.0316
New lambda: 7.1348e-040
iter: 1875, Minibatch log likelihood (pre-update): -54.3974, error rate (pre-update): 0.093059
iter: 1875, Minibatch log likelihood (post-update): -54.3973, error rate (post-update): 0.093046

size_minibatch = 20000
Precon grad coeff: 0.021003, velocity coeff: 0.96288
norm(ch) = 0.76804
iter: 1876, Minibatch log likelihood (pre-update): -54.3973, error rate (pre-update): 0.093046

size_minibatch = 20000
Precon grad coeff: 0.023788, velocity coeff: 1.0402
norm(ch) = 0.802
iter: 1877, Minibatch log likelihood (pre-update): -54.3972, error rate (pre-update): 0.093023

size_minibatch = 20000
Precon grad coeff: 0.023844, velocity coeff: 1.0316
norm(ch) = 0.83046
iter: 1878, Minibatch log likelihood (pre-update): -54.3971, error rate (pre-update): 0.093011

size_minibatch = 20000
Precon grad coeff: 0.024192, velocity coeff: 0.95558
norm(ch) = 0.7966
iter: 1879, Minibatch log likelihood (pre-update): -54.397, error rate (pre-update): 0.09299

size_minibatch = 20000
Precon grad coeff: 0.025108, velocity coeff: 1.0236
New gamma: 0.0031623
norm(ch) = 0.81876
rho = 1.0232
New lambda: 5.5207e-040
iter: 1880, Minibatch log likelihood (pre-update): -54.3969, error rate (pre-update): 0.092968
iter: 1880, Minibatch log likelihood (post-update): -54.3967, error rate (post-update): 0.09295

size_minibatch = 20000
Precon grad coeff: 0.025109, velocity coeff: 0.95637
norm(ch) = 0.78673
iter: 1881, Minibatch log likelihood (pre-update): -54.3968, error rate (pre-update): 0.09295

size_minibatch = 20000
Precon grad coeff: 0.0247, velocity coeff: 1.0483
norm(ch) = 0.82798
iter: 1882, Minibatch log likelihood (pre-update): -54.3967, error rate (pre-update): 0.09293

size_minibatch = 20000
Precon grad coeff: 0.027345, velocity coeff: 1.047
norm(ch) = 0.87056
iter: 1883, Minibatch log likelihood (pre-update): -54.3965, error rate (pre-update): 0.092916

size_minibatch = 20000
Precon grad coeff: 0.025219, velocity coeff: 0.95086
norm(ch) = 0.83135
iter: 1884, Minibatch log likelihood (pre-update): -54.3964, error rate (pre-update): 0.092891

size_minibatch = 20000
Precon grad coeff: 0.025412, velocity coeff: 1.0361
norm(ch) = 0.86472
rho = 1.0368
New lambda: 4.2718e-040
iter: 1885, Minibatch log likelihood (pre-update): -54.3963, error rate (pre-update): 0.092871
iter: 1885, Minibatch log likelihood (post-update): -54.3962, error rate (post-update): 0.092854

size_minibatch = 20000
Precon grad coeff: 0.025385, velocity coeff: 0.99311
norm(ch) = 0.86199
iter: 1886, Minibatch log likelihood (pre-update): -54.3962, error rate (pre-update): 0.092854

size_minibatch = 20000
Precon grad coeff: 0.021591, velocity coeff: 0.87824
norm(ch) = 0.75988
iter: 1887, Minibatch log likelihood (pre-update): -54.3961, error rate (pre-update): 0.092828

size_minibatch = 20000
Precon grad coeff: 0.022736, velocity coeff: 1.0691
norm(ch) = 0.81543
iter: 1888, Minibatch log likelihood (pre-update): -54.396, error rate (pre-update): 0.092814

size_minibatch = 20000
Precon grad coeff: 0.022577, velocity coeff: 0.98291
norm(ch) = 0.80427
iter: 1889, Minibatch log likelihood (pre-update): -54.3959, error rate (pre-update): 0.092804

size_minibatch = 20000
Precon grad coeff: 0.024747, velocity coeff: 0.98801
norm(ch) = 0.79771
rho = 0.99446
New lambda: 3.3055e-040
iter: 1890, Minibatch log likelihood (pre-update): -54.3958, error rate (pre-update): 0.092776
iter: 1890, Minibatch log likelihood (post-update): -54.3957, error rate (post-update): 0.092762

size_minibatch = 20000
Precon grad coeff: 0.024464, velocity coeff: 1.0401
norm(ch) = 0.83269
iter: 1891, Minibatch log likelihood (pre-update): -54.3957, error rate (pre-update): 0.092762

size_minibatch = 20000
Precon grad coeff: 0.024115, velocity coeff: 0.95337
norm(ch) = 0.797
iter: 1892, Minibatch log likelihood (pre-update): -54.3956, error rate (pre-update): 0.092736

size_minibatch = 20000
Precon grad coeff: 0.025225, velocity coeff: 1.0369
norm(ch) = 0.82962
iter: 1893, Minibatch log likelihood (pre-update): -54.3955, error rate (pre-update): 0.092718

size_minibatch = 20000
Precon grad coeff: 0.023011, velocity coeff: 0.94754
norm(ch) = 0.78886
iter: 1894, Minibatch log likelihood (pre-update): -54.3954, error rate (pre-update): 0.092701

size_minibatch = 20000
Precon grad coeff: 0.026437, velocity coeff: 1.1027
norm(ch) = 0.87313
rho = 1.0148
New lambda: 2.5577e-040
iter: 1895, Minibatch log likelihood (pre-update): -54.3953, error rate (pre-update): 0.092686
iter: 1895, Minibatch log likelihood (post-update): -54.3952, error rate (post-update): 0.092666

size_minibatch = 20000
Precon grad coeff: 0.025007, velocity coeff: 0.95369
norm(ch) = 0.83599
iter: 1896, Minibatch log likelihood (pre-update): -54.3952, error rate (pre-update): 0.092666

size_minibatch = 20000
Precon grad coeff: 0.024403, velocity coeff: 0.97852
norm(ch) = 0.82101
iter: 1897, Minibatch log likelihood (pre-update): -54.3951, error rate (pre-update): 0.092641

size_minibatch = 20000
Precon grad coeff: 0.022884, velocity coeff: 0.9752
norm(ch) = 0.80362
iter: 1898, Minibatch log likelihood (pre-update): -54.395, error rate (pre-update): 0.092626

size_minibatch = 20000
Precon grad coeff: 0.020593, velocity coeff: 0.93738
norm(ch) = 0.75558
iter: 1899, Minibatch log likelihood (pre-update): -54.3949, error rate (pre-update): 0.092608

size_minibatch = 20000
Precon grad coeff: 0.024432, velocity coeff: 1.0521
New gamma: 0.0031623
norm(ch) = 0.79811
rho = 1.0042
New lambda: 1.9791e-040
iter: 1900, Minibatch log likelihood (pre-update): -54.3948, error rate (pre-update): 0.092593
iter: 1900, Minibatch log likelihood (post-update): -54.3947, error rate (post-update): 0.092566
---
Full log-likelihood: -54.3947, error rate: 0.092566
TEST log-likelihood: -54.8168, error rate: 0.2686
Error difference (test - train): 0.17603
---
Full log-likelihood (averaged params): -54.4485, error rate (averaged params): 0.1108
TEST log-likelihood (averaged params): -54.8015, error rate (averaged params): 0.26647
Error difference (test - train) (averaged params): 0.15567

size_minibatch = 20000
Precon grad coeff: 0.024105, velocity coeff: 0.97592
norm(ch) = 0.78218
iter: 1901, Minibatch log likelihood (pre-update): -54.3947, error rate (pre-update): 0.092566

size_minibatch = 20000
Precon grad coeff: 0.026526, velocity coeff: 1.0907
norm(ch) = 0.85675
iter: 1902, Minibatch log likelihood (pre-update): -54.3946, error rate (pre-update): 0.092551

size_minibatch = 20000
Precon grad coeff: 0.026201, velocity coeff: 0.9558
norm(ch) = 0.82231
iter: 1903, Minibatch log likelihood (pre-update): -54.3945, error rate (pre-update): 0.092535

size_minibatch = 20000
Precon grad coeff: 0.024842, velocity coeff: 1.0369
norm(ch) = 0.85604
iter: 1904, Minibatch log likelihood (pre-update): -54.3944, error rate (pre-update): 0.092511

size_minibatch = 20000
Precon grad coeff: 0.026642, velocity coeff: 1.0068
norm(ch) = 0.8654
rho = 0.98423
New lambda: 1.5314e-040
iter: 1905, Minibatch log likelihood (pre-update): -54.3943, error rate (pre-update): 0.092495
iter: 1905, Minibatch log likelihood (post-update): -54.3942, error rate (post-update): 0.092472

size_minibatch = 20000
Precon grad coeff: 0.022659, velocity coeff: 0.94141
norm(ch) = 0.81741
iter: 1906, Minibatch log likelihood (pre-update): -54.3942, error rate (pre-update): 0.092472

size_minibatch = 20000
Precon grad coeff: 0.023615, velocity coeff: 1.0228
norm(ch) = 0.83907
iter: 1907, Minibatch log likelihood (pre-update): -54.3941, error rate (pre-update): 0.092463

size_minibatch = 20000
Precon grad coeff: 0.023456, velocity coeff: 0.97905
norm(ch) = 0.82424
iter: 1908, Minibatch log likelihood (pre-update): -54.394, error rate (pre-update): 0.092431

size_minibatch = 20000
Precon grad coeff: 0.024205, velocity coeff: 0.99608
norm(ch) = 0.82404
iter: 1909, Minibatch log likelihood (pre-update): -54.3939, error rate (pre-update): 0.092407

size_minibatch = 20000
Precon grad coeff: 0.025975, velocity coeff: 1.0231
norm(ch) = 0.84631
rho = 1.0082
New lambda: 1.185e-040
iter: 1910, Minibatch log likelihood (pre-update): -54.3938, error rate (pre-update): 0.092403
iter: 1910, Minibatch log likelihood (post-update): -54.3937, error rate (post-update): 0.092382

size_minibatch = 20000
Precon grad coeff: 0.026021, velocity coeff: 0.96754
norm(ch) = 0.822
iter: 1911, Minibatch log likelihood (pre-update): -54.3937, error rate (pre-update): 0.092382

size_minibatch = 20000
Precon grad coeff: 0.023781, velocity coeff: 0.96166
norm(ch) = 0.7933
iter: 1912, Minibatch log likelihood (pre-update): -54.3936, error rate (pre-update): 0.092362

size_minibatch = 20000
Precon grad coeff: 0.023781, velocity coeff: 1.0156
norm(ch) = 0.80872
iter: 1913, Minibatch log likelihood (pre-update): -54.3935, error rate (pre-update): 0.092339

size_minibatch = 20000
Precon grad coeff: 0.022233, velocity coeff: 0.95194
norm(ch) = 0.77261
iter: 1914, Minibatch log likelihood (pre-update): -54.3934, error rate (pre-update): 0.092317

size_minibatch = 20000
Precon grad coeff: 0.024257, velocity coeff: 1.1006
norm(ch) = 0.85317
rho = 1.0083
New lambda: 9.169e-041
iter: 1915, Minibatch log likelihood (pre-update): -54.3933, error rate (pre-update): 0.092303
iter: 1915, Minibatch log likelihood (post-update): -54.3932, error rate (post-update): 0.09229

size_minibatch = 20000
Precon grad coeff: 0.02304, velocity coeff: 0.93378
norm(ch) = 0.79949
iter: 1916, Minibatch log likelihood (pre-update): -54.3932, error rate (pre-update): 0.09229

size_minibatch = 20000
Precon grad coeff: 0.024966, velocity coeff: 1.0682
norm(ch) = 0.85687
iter: 1917, Minibatch log likelihood (pre-update): -54.3931, error rate (pre-update): 0.092251

size_minibatch = 20000
Precon grad coeff: 0.024173, velocity coeff: 0.9662
norm(ch) = 0.83087
iter: 1918, Minibatch log likelihood (pre-update): -54.393, error rate (pre-update): 0.092244

size_minibatch = 20000
Precon grad coeff: 0.024787, velocity coeff: 0.99199
norm(ch) = 0.82719
iter: 1919, Minibatch log likelihood (pre-update): -54.3929, error rate (pre-update): 0.092243

size_minibatch = 20000
Precon grad coeff: 0.024683, velocity coeff: 0.96287
New gamma: 0.0031623
norm(ch) = 0.79966
rho = 1.0123
New lambda: 7.0948e-041
iter: 1920, Minibatch log likelihood (pre-update): -54.3928, error rate (pre-update): 0.092202
iter: 1920, Minibatch log likelihood (post-update): -54.3927, error rate (post-update): 0.092187

size_minibatch = 20000
Precon grad coeff: 0.024041, velocity coeff: 0.98746
norm(ch) = 0.79286
iter: 1921, Minibatch log likelihood (pre-update): -54.3927, error rate (pre-update): 0.092187

size_minibatch = 20000
Precon grad coeff: 0.023078, velocity coeff: 0.99273
norm(ch) = 0.79019
iter: 1922, Minibatch log likelihood (pre-update): -54.3926, error rate (pre-update): 0.092167

size_minibatch = 20000
Precon grad coeff: 0.024531, velocity coeff: 1.0238
norm(ch) = 0.81228
iter: 1923, Minibatch log likelihood (pre-update): -54.3925, error rate (pre-update): 0.09215

size_minibatch = 20000
Precon grad coeff: 0.023491, velocity coeff: 1.0314
norm(ch) = 0.8407
iter: 1924, Minibatch log likelihood (pre-update): -54.3924, error rate (pre-update): 0.092141

size_minibatch = 20000
Precon grad coeff: 0.0262, velocity coeff: 1.0445
norm(ch) = 0.88122
rho = 1.0065
New lambda: 5.4898e-041
iter: 1925, Minibatch log likelihood (pre-update): -54.3923, error rate (pre-update): 0.092122
iter: 1925, Minibatch log likelihood (post-update): -54.3922, error rate (post-update): 0.092095

size_minibatch = 20000
Precon grad coeff: 0.027666, velocity coeff: 0.99701
norm(ch) = 0.88211
iter: 1926, Minibatch log likelihood (pre-update): -54.3922, error rate (pre-update): 0.092095

size_minibatch = 20000
Precon grad coeff: 0.023154, velocity coeff: 0.91822
norm(ch) = 0.81302
iter: 1927, Minibatch log likelihood (pre-update): -54.3921, error rate (pre-update): 0.09207

size_minibatch = 20000
Precon grad coeff: 0.024494, velocity coeff: 1.018
norm(ch) = 0.83079
iter: 1928, Minibatch log likelihood (pre-update): -54.392, error rate (pre-update): 0.092046

size_minibatch = 20000
Precon grad coeff: 0.022291, velocity coeff: 0.91434
norm(ch) = 0.76224
iter: 1929, Minibatch log likelihood (pre-update): -54.3919, error rate (pre-update): 0.092038

size_minibatch = 20000
Precon grad coeff: 0.022058, velocity coeff: 1.0493
norm(ch) = 0.80255
rho = 0.98714
New lambda: 4.2479e-041
iter: 1930, Minibatch log likelihood (pre-update): -54.3918, error rate (pre-update): 0.092027
iter: 1930, Minibatch log likelihood (post-update): -54.3917, error rate (post-update): 0.091996

size_minibatch = 20000
Precon grad coeff: 0.025942, velocity coeff: 1.0271
norm(ch) = 0.82744
iter: 1931, Minibatch log likelihood (pre-update): -54.3917, error rate (pre-update): 0.091996

size_minibatch = 20000
Precon grad coeff: 0.024763, velocity coeff: 0.99551
norm(ch) = 0.82685
iter: 1932, Minibatch log likelihood (pre-update): -54.3916, error rate (pre-update): 0.091976

size_minibatch = 20000
Precon grad coeff: 0.024064, velocity coeff: 0.9704
norm(ch) = 0.8054
iter: 1933, Minibatch log likelihood (pre-update): -54.3915, error rate (pre-update): 0.091959

size_minibatch = 20000
Precon grad coeff: 0.024572, velocity coeff: 1.0342
norm(ch) = 0.8359
iter: 1934, Minibatch log likelihood (pre-update): -54.3914, error rate (pre-update): 0.091949

size_minibatch = 20000
Precon grad coeff: 0.024274, velocity coeff: 0.9783
norm(ch) = 0.82088
rho = 1.0271
New lambda: 3.287e-041
iter: 1935, Minibatch log likelihood (pre-update): -54.3913, error rate (pre-update): 0.091919
iter: 1935, Minibatch log likelihood (post-update): -54.3912, error rate (post-update): 0.091896

size_minibatch = 20000
Precon grad coeff: 0.021674, velocity coeff: 0.93026
norm(ch) = 0.76607
iter: 1936, Minibatch log likelihood (pre-update): -54.3912, error rate (pre-update): 0.091896

size_minibatch = 20000
Precon grad coeff: 0.022182, velocity coeff: 1.0478
norm(ch) = 0.80523
iter: 1937, Minibatch log likelihood (pre-update): -54.3911, error rate (pre-update): 0.091891

size_minibatch = 20000
Precon grad coeff: 0.023388, velocity coeff: 0.99596
norm(ch) = 0.80484
iter: 1938, Minibatch log likelihood (pre-update): -54.391, error rate (pre-update): 0.091871

size_minibatch = 20000
Precon grad coeff: 0.024233, velocity coeff: 1.0266
norm(ch) = 0.82929
iter: 1939, Minibatch log likelihood (pre-update): -54.3909, error rate (pre-update): 0.091853

size_minibatch = 20000
Precon grad coeff: 0.024678, velocity coeff: 0.95421
New gamma: 0.0031623
norm(ch) = 0.79453
rho = 1.0249
New lambda: 2.5434e-041
iter: 1940, Minibatch log likelihood (pre-update): -54.3908, error rate (pre-update): 0.091824
iter: 1940, Minibatch log likelihood (post-update): -54.3907, error rate (post-update): 0.091802

size_minibatch = 20000
Precon grad coeff: 0.027206, velocity coeff: 1.0635
norm(ch) = 0.84849
iter: 1941, Minibatch log likelihood (pre-update): -54.3907, error rate (pre-update): 0.091802

size_minibatch = 20000
Precon grad coeff: 0.024518, velocity coeff: 0.95398
norm(ch) = 0.81273
iter: 1942, Minibatch log likelihood (pre-update): -54.3906, error rate (pre-update): 0.091802

size_minibatch = 20000
Precon grad coeff: 0.025568, velocity coeff: 1.0538
norm(ch) = 0.85971
iter: 1943, Minibatch log likelihood (pre-update): -54.3905, error rate (pre-update): 0.091785

size_minibatch = 20000
Precon grad coeff: 0.026331, velocity coeff: 1.0006
norm(ch) = 0.8636
iter: 1944, Minibatch log likelihood (pre-update): -54.3904, error rate (pre-update): 0.091748

size_minibatch = 20000
Precon grad coeff: 0.02282, velocity coeff: 0.91795
norm(ch) = 0.79566
rho = 0.97043
New lambda: 1.968e-041
iter: 1945, Minibatch log likelihood (pre-update): -54.3903, error rate (pre-update): 0.091733
iter: 1945, Minibatch log likelihood (post-update): -54.3902, error rate (post-update): 0.091725

size_minibatch = 20000
Precon grad coeff: 0.024697, velocity coeff: 1.0865
norm(ch) = 0.86772
iter: 1946, Minibatch log likelihood (pre-update): -54.3902, error rate (pre-update): 0.091725

size_minibatch = 20000
Precon grad coeff: 0.024828, velocity coeff: 0.94462
norm(ch) = 0.82239
iter: 1947, Minibatch log likelihood (pre-update): -54.3901, error rate (pre-update): 0.091692

size_minibatch = 20000
Precon grad coeff: 0.025465, velocity coeff: 1.0111
norm(ch) = 0.83461
iter: 1948, Minibatch log likelihood (pre-update): -54.39, error rate (pre-update): 0.091673

size_minibatch = 20000
Precon grad coeff: 0.024225, velocity coeff: 0.97224
norm(ch) = 0.81456
iter: 1949, Minibatch log likelihood (pre-update): -54.3899, error rate (pre-update): 0.091666

size_minibatch = 20000
Precon grad coeff: 0.025744, velocity coeff: 1.0384
norm(ch) = 0.84906
rho = 0.99042
New lambda: 1.5228e-041
iter: 1950, Minibatch log likelihood (pre-update): -54.3898, error rate (pre-update): 0.091645
iter: 1950, Minibatch log likelihood (post-update): -54.3897, error rate (post-update): 0.091616
---
Full log-likelihood: -54.3897, error rate: 0.091616
TEST log-likelihood: -54.8275, error rate: 0.27134
Error difference (test - train): 0.17973
---
Full log-likelihood (averaged params): -54.4425, error rate (averaged params): 0.10951
TEST log-likelihood (averaged params): -54.8124, error rate (averaged params): 0.26951
Error difference (test - train) (averaged params): 0.16

size_minibatch = 20000
Precon grad coeff: 0.025794, velocity coeff: 0.97014
norm(ch) = 0.82694
iter: 1951, Minibatch log likelihood (pre-update): -54.3897, error rate (pre-update): 0.091616

size_minibatch = 20000
Precon grad coeff: 0.023773, velocity coeff: 0.94764
norm(ch) = 0.7863
iter: 1952, Minibatch log likelihood (pre-update): -54.3896, error rate (pre-update): 0.091603

size_minibatch = 20000
Precon grad coeff: 0.023099, velocity coeff: 1.0175
norm(ch) = 0.80286
iter: 1953, Minibatch log likelihood (pre-update): -54.3895, error rate (pre-update): 0.091588

size_minibatch = 20000
Precon grad coeff: 0.023666, velocity coeff: 1.0137
norm(ch) = 0.81673
iter: 1954, Minibatch log likelihood (pre-update): -54.3894, error rate (pre-update): 0.091567

size_minibatch = 20000
Precon grad coeff: 0.024976, velocity coeff: 1.0273
norm(ch) = 0.8423
rho = 0.99828
New lambda: 1.1783e-041
iter: 1955, Minibatch log likelihood (pre-update): -54.3893, error rate (pre-update): 0.09155
iter: 1955, Minibatch log likelihood (post-update): -54.3892, error rate (post-update): 0.091528

size_minibatch = 20000
Precon grad coeff: 0.024583, velocity coeff: 0.95892
norm(ch) = 0.81065
iter: 1956, Minibatch log likelihood (pre-update): -54.3892, error rate (pre-update): 0.091528

size_minibatch = 20000
Precon grad coeff: 0.024937, velocity coeff: 1.0419
norm(ch) = 0.84751
iter: 1957, Minibatch log likelihood (pre-update): -54.3891, error rate (pre-update): 0.091518

size_minibatch = 20000
Precon grad coeff: 0.024491, velocity coeff: 0.93978
norm(ch) = 0.79951
iter: 1958, Minibatch log likelihood (pre-update): -54.389, error rate (pre-update): 0.091496

size_minibatch = 20000
Precon grad coeff: 0.02301, velocity coeff: 1.0025
norm(ch) = 0.8043
iter: 1959, Minibatch log likelihood (pre-update): -54.3889, error rate (pre-update): 0.091479

size_minibatch = 20000
Precon grad coeff: 0.025899, velocity coeff: 0.9916
New gamma: 0.0031623
norm(ch) = 0.80092
rho = 1.0483
New lambda: 9.1177e-042
iter: 1960, Minibatch log likelihood (pre-update): -54.3888, error rate (pre-update): 0.091465
iter: 1960, Minibatch log likelihood (post-update): -54.3888, error rate (post-update): 0.091447

size_minibatch = 20000
Precon grad coeff: 0.020839, velocity coeff: 0.91572
norm(ch) = 0.73615
iter: 1961, Minibatch log likelihood (pre-update): -54.3888, error rate (pre-update): 0.091447

size_minibatch = 20000
Precon grad coeff: 0.024497, velocity coeff: 1.1108
norm(ch) = 0.82089
iter: 1962, Minibatch log likelihood (pre-update): -54.3887, error rate (pre-update): 0.091436

size_minibatch = 20000
Precon grad coeff: 0.026037, velocity coeff: 1.0106
norm(ch) = 0.83298
iter: 1963, Minibatch log likelihood (pre-update): -54.3886, error rate (pre-update): 0.091408

size_minibatch = 20000
Precon grad coeff: 0.023347, velocity coeff: 0.96987
norm(ch) = 0.8109
iter: 1964, Minibatch log likelihood (pre-update): -54.3885, error rate (pre-update): 0.091391

size_minibatch = 20000
Precon grad coeff: 0.027126, velocity coeff: 1.0959
norm(ch) = 0.89207
rho = 1.0385
New lambda: 7.0551e-042
iter: 1965, Minibatch log likelihood (pre-update): -54.3884, error rate (pre-update): 0.091387
iter: 1965, Minibatch log likelihood (post-update): -54.3883, error rate (post-update): 0.091355

size_minibatch = 20000
Precon grad coeff: 0.023764, velocity coeff: 0.91747
norm(ch) = 0.82144
iter: 1966, Minibatch log likelihood (pre-update): -54.3883, error rate (pre-update): 0.091355

size_minibatch = 20000
Precon grad coeff: 0.023239, velocity coeff: 0.96643
norm(ch) = 0.79685
iter: 1967, Minibatch log likelihood (pre-update): -54.3882, error rate (pre-update): 0.091342

size_minibatch = 20000
Precon grad coeff: 0.023819, velocity coeff: 1.0402
norm(ch) = 0.83156
iter: 1968, Minibatch log likelihood (pre-update): -54.3881, error rate (pre-update): 0.091328

size_minibatch = 20000
Precon grad coeff: 0.023937, velocity coeff: 0.9676
norm(ch) = 0.80748
iter: 1969, Minibatch log likelihood (pre-update): -54.388, error rate (pre-update): 0.091303

size_minibatch = 20000
Precon grad coeff: 0.024105, velocity coeff: 0.99541
norm(ch) = 0.80661
rho = 1.0382
New lambda: 5.4591e-042
iter: 1970, Minibatch log likelihood (pre-update): -54.3879, error rate (pre-update): 0.091279
iter: 1970, Minibatch log likelihood (post-update): -54.3878, error rate (post-update): 0.09127

size_minibatch = 20000
Precon grad coeff: 0.022462, velocity coeff: 0.93365
norm(ch) = 0.75583
iter: 1971, Minibatch log likelihood (pre-update): -54.3878, error rate (pre-update): 0.09127

size_minibatch = 20000
Precon grad coeff: 0.02379, velocity coeff: 1.0701
norm(ch) = 0.81159
iter: 1972, Minibatch log likelihood (pre-update): -54.3877, error rate (pre-update): 0.091264

size_minibatch = 20000
Precon grad coeff: 0.02187, velocity coeff: 0.92483
norm(ch) = 0.75313
iter: 1973, Minibatch log likelihood (pre-update): -54.3876, error rate (pre-update): 0.091249

size_minibatch = 20000
Precon grad coeff: 0.023888, velocity coeff: 1.0976
norm(ch) = 0.82955
iter: 1974, Minibatch log likelihood (pre-update): -54.3875, error rate (pre-update): 0.091219

size_minibatch = 20000
Precon grad coeff: 0.026083, velocity coeff: 1.0155
norm(ch) = 0.84541
rho = 0.99854
New lambda: 4.2242e-042
iter: 1975, Minibatch log likelihood (pre-update): -54.3874, error rate (pre-update): 0.091193
iter: 1975, Minibatch log likelihood (post-update): -54.3873, error rate (post-update): 0.091188

size_minibatch = 20000
Precon grad coeff: 0.02555, velocity coeff: 0.99198
norm(ch) = 0.84167
iter: 1976, Minibatch log likelihood (pre-update): -54.3873, error rate (pre-update): 0.091188

size_minibatch = 20000
Precon grad coeff: 0.023123, velocity coeff: 0.95015
norm(ch) = 0.80245
iter: 1977, Minibatch log likelihood (pre-update): -54.3872, error rate (pre-update): 0.091165

size_minibatch = 20000
Precon grad coeff: 0.024591, velocity coeff: 1.0263
norm(ch) = 0.82631
iter: 1978, Minibatch log likelihood (pre-update): -54.3871, error rate (pre-update): 0.091154

size_minibatch = 20000
Precon grad coeff: 0.023338, velocity coeff: 0.95657
norm(ch) = 0.793
iter: 1979, Minibatch log likelihood (pre-update): -54.387, error rate (pre-update): 0.091139

size_minibatch = 20000
Precon grad coeff: 0.024619, velocity coeff: 0.98324
New gamma: 0.0031623
norm(ch) = 0.78282
rho = 1.0022
New lambda: 3.2686e-042
iter: 1980, Minibatch log likelihood (pre-update): -54.3869, error rate (pre-update): 0.091114
iter: 1980, Minibatch log likelihood (post-update): -54.3869, error rate (post-update): 0.091091

size_minibatch = 20000
Precon grad coeff: 0.021667, velocity coeff: 0.92829
norm(ch) = 0.72941
iter: 1981, Minibatch log likelihood (pre-update): -54.3869, error rate (pre-update): 0.091091

size_minibatch = 20000
Precon grad coeff: 0.026555, velocity coeff: 1.167
norm(ch) = 0.85445
iter: 1982, Minibatch log likelihood (pre-update): -54.3868, error rate (pre-update): 0.091087

size_minibatch = 20000
Precon grad coeff: 0.02572, velocity coeff: 0.94925
norm(ch) = 0.8143
iter: 1983, Minibatch log likelihood (pre-update): -54.3867, error rate (pre-update): 0.091074

size_minibatch = 20000
Precon grad coeff: 0.027255, velocity coeff: 1.0629
norm(ch) = 0.86885
iter: 1984, Minibatch log likelihood (pre-update): -54.3866, error rate (pre-update): 0.09105

size_minibatch = 20000
Precon grad coeff: 0.02559, velocity coeff: 0.99112
norm(ch) = 0.86415
rho = 1.0468
New lambda: 2.5292e-042
iter: 1985, Minibatch log likelihood (pre-update): -54.3865, error rate (pre-update): 0.091031
iter: 1985, Minibatch log likelihood (post-update): -54.3864, error rate (post-update): 0.091019

size_minibatch = 20000
Precon grad coeff: 0.025454, velocity coeff: 0.96135
norm(ch) = 0.83397
iter: 1986, Minibatch log likelihood (pre-update): -54.3864, error rate (pre-update): 0.091019

size_minibatch = 20000
Precon grad coeff: 0.023827, velocity coeff: 0.97822
norm(ch) = 0.81865
iter: 1987, Minibatch log likelihood (pre-update): -54.3863, error rate (pre-update): 0.090993

size_minibatch = 20000
Precon grad coeff: 0.020537, velocity coeff: 0.91879
norm(ch) = 0.75462
iter: 1988, Minibatch log likelihood (pre-update): -54.3862, error rate (pre-update): 0.090969

size_minibatch = 20000
Precon grad coeff: 0.027524, velocity coeff: 1.178
norm(ch) = 0.89225
iter: 1989, Minibatch log likelihood (pre-update): -54.3861, error rate (pre-update): 0.090968

size_minibatch = 20000
Precon grad coeff: 0.025541, velocity coeff: 0.89235
norm(ch) = 0.79898
rho = 1.0134
New lambda: 1.957e-042
iter: 1990, Minibatch log likelihood (pre-update): -54.386, error rate (pre-update): 0.09095
iter: 1990, Minibatch log likelihood (post-update): -54.3859, error rate (post-update): 0.090923

size_minibatch = 20000
Precon grad coeff: 0.024865, velocity coeff: 1.0263
norm(ch) = 0.82283
iter: 1991, Minibatch log likelihood (pre-update): -54.3859, error rate (pre-update): 0.090923

size_minibatch = 20000
Precon grad coeff: 0.027162, velocity coeff: 1.0243
norm(ch) = 0.84606
iter: 1992, Minibatch log likelihood (pre-update): -54.3858, error rate (pre-update): 0.090909

size_minibatch = 20000
Precon grad coeff: 0.02481, velocity coeff: 0.93145
norm(ch) = 0.79094
iter: 1993, Minibatch log likelihood (pre-update): -54.3857, error rate (pre-update): 0.090883

size_minibatch = 20000
Precon grad coeff: 0.020377, velocity coeff: 0.93678
norm(ch) = 0.74316
iter: 1994, Minibatch log likelihood (pre-update): -54.3856, error rate (pre-update): 0.090869

size_minibatch = 20000
Precon grad coeff: 0.024545, velocity coeff: 1.1275
norm(ch) = 0.84075
rho = 1.026
New lambda: 1.5143e-042
iter: 1995, Minibatch log likelihood (pre-update): -54.3855, error rate (pre-update): 0.090864
iter: 1995, Minibatch log likelihood (post-update): -54.3854, error rate (post-update): 0.090854

size_minibatch = 20000
Precon grad coeff: 0.024486, velocity coeff: 0.95144
norm(ch) = 0.80286
iter: 1996, Minibatch log likelihood (pre-update): -54.3854, error rate (pre-update): 0.090854

size_minibatch = 20000
Precon grad coeff: 0.025163, velocity coeff: 1.0507
norm(ch) = 0.84634
iter: 1997, Minibatch log likelihood (pre-update): -54.3853, error rate (pre-update): 0.090818

size_minibatch = 20000
Precon grad coeff: 0.025968, velocity coeff: 1.0002
norm(ch) = 0.8495
iter: 1998, Minibatch log likelihood (pre-update): -54.3852, error rate (pre-update): 0.09079

size_minibatch = 20000
Precon grad coeff: 0.025769, velocity coeff: 0.96638
norm(ch) = 0.82363
iter: 1999, Minibatch log likelihood (pre-update): -54.3851, error rate (pre-update): 0.09079

size_minibatch = 20000
Precon grad coeff: 0.021664, velocity coeff: 0.88814
New gamma: 0.0031623
norm(ch) = 0.73416
rho = 1.0126
New lambda: 1.1717e-042
iter: 2000, Minibatch log likelihood (pre-update): -54.385, error rate (pre-update): 0.090776
iter: 2000, Minibatch log likelihood (post-update): -54.385, error rate (post-update): 0.090755
---
Full log-likelihood: -54.385, error rate: 0.090755
TEST log-likelihood: -54.8344, error rate: 0.27379
Error difference (test - train): 0.18303
---
Full log-likelihood (averaged params): -54.4372, error rate (averaged params): 0.10856
TEST log-likelihood (averaged params): -54.8226, error rate (averaged params): 0.27242
Error difference (test - train) (averaged params): 0.16386

size_minibatch = 20000
Precon grad coeff: 0.023905, velocity coeff: 1.0727
norm(ch) = 0.79052
iter: 2001, Minibatch log likelihood (pre-update): -54.385, error rate (pre-update): 0.090755

size_minibatch = 20000
Precon grad coeff: 0.021069, velocity coeff: 0.94258
norm(ch) = 0.74772
iter: 2002, Minibatch log likelihood (pre-update): -54.3849, error rate (pre-update): 0.090737

size_minibatch = 20000
Precon grad coeff: 0.025292, velocity coeff: 1.1193
norm(ch) = 0.84005
iter: 2003, Minibatch log likelihood (pre-update): -54.3848, error rate (pre-update): 0.090726

size_minibatch = 20000
Precon grad coeff: 0.025796, velocity coeff: 0.99416
norm(ch) = 0.83835
iter: 2004, Minibatch log likelihood (pre-update): -54.3847, error rate (pre-update): 0.090702

size_minibatch = 20000
Precon grad coeff: 0.025388, velocity coeff: 1.0095
norm(ch) = 0.84916
rho = 1.0233
New lambda: 9.0667e-043
iter: 2005, Minibatch log likelihood (pre-update): -54.3846, error rate (pre-update): 0.090698
iter: 2005, Minibatch log likelihood (post-update): -54.3845, error rate (post-update): 0.090669

size_minibatch = 20000
Precon grad coeff: 0.027138, velocity coeff: 1.019
norm(ch) = 0.86857
iter: 2006, Minibatch log likelihood (pre-update): -54.3845, error rate (pre-update): 0.090669

size_minibatch = 20000
Precon grad coeff: 0.026704, velocity coeff: 0.9685
norm(ch) = 0.84439
iter: 2007, Minibatch log likelihood (pre-update): -54.3844, error rate (pre-update): 0.090642

size_minibatch = 20000
Precon grad coeff: 0.02378, velocity coeff: 0.94896
norm(ch) = 0.80416
iter: 2008, Minibatch log likelihood (pre-update): -54.3843, error rate (pre-update): 0.090644

size_minibatch = 20000
Precon grad coeff: 0.023091, velocity coeff: 0.96326
norm(ch) = 0.77748
iter: 2009, Minibatch log likelihood (pre-update): -54.3842, error rate (pre-update): 0.090615

size_minibatch = 20000
Precon grad coeff: 0.021601, velocity coeff: 0.98551
norm(ch) = 0.76857
rho = 1.0284
New lambda: 7.0156e-043
iter: 2010, Minibatch log likelihood (pre-update): -54.3841, error rate (pre-update): 0.090596
iter: 2010, Minibatch log likelihood (post-update): -54.384, error rate (post-update): 0.090587

size_minibatch = 20000
Precon grad coeff: 0.02259, velocity coeff: 0.99086
norm(ch) = 0.76422
iter: 2011, Minibatch log likelihood (pre-update): -54.384, error rate (pre-update): 0.090587

size_minibatch = 20000
Precon grad coeff: 0.023526, velocity coeff: 1.0765
norm(ch) = 0.82533
iter: 2012, Minibatch log likelihood (pre-update): -54.3839, error rate (pre-update): 0.090575

size_minibatch = 20000
Precon grad coeff: 0.023331, velocity coeff: 0.93851
norm(ch) = 0.77731
iter: 2013, Minibatch log likelihood (pre-update): -54.3838, error rate (pre-update): 0.090555

size_minibatch = 20000
Precon grad coeff: 0.026492, velocity coeff: 1.0812
norm(ch) = 0.84368
iter: 2014, Minibatch log likelihood (pre-update): -54.3838, error rate (pre-update): 0.09054

size_minibatch = 20000
Precon grad coeff: 0.022444, velocity coeff: 0.91437
norm(ch) = 0.7739
rho = 1.0289
New lambda: 5.4285e-043
iter: 2015, Minibatch log likelihood (pre-update): -54.3837, error rate (pre-update): 0.090519
iter: 2015, Minibatch log likelihood (post-update): -54.3836, error rate (post-update): 0.090509

size_minibatch = 20000
Precon grad coeff: 0.02525, velocity coeff: 1.0884
norm(ch) = 0.84525
iter: 2016, Minibatch log likelihood (pre-update): -54.3836, error rate (pre-update): 0.090509

size_minibatch = 20000
Precon grad coeff: 0.025311, velocity coeff: 0.96595
norm(ch) = 0.81942
iter: 2017, Minibatch log likelihood (pre-update): -54.3835, error rate (pre-update): 0.090483

size_minibatch = 20000
Precon grad coeff: 0.024194, velocity coeff: 0.98428
norm(ch) = 0.8092
iter: 2018, Minibatch log likelihood (pre-update): -54.3834, error rate (pre-update): 0.090469

size_minibatch = 20000
Precon grad coeff: 0.022247, velocity coeff: 0.95011
norm(ch) = 0.77122
iter: 2019, Minibatch log likelihood (pre-update): -54.3833, error rate (pre-update): 0.09045

size_minibatch = 20000
Precon grad coeff: 0.022116, velocity coeff: 0.96799
New gamma: 0.0031623
norm(ch) = 0.74938
rho = 0.97969
New lambda: 4.2005e-043
iter: 2020, Minibatch log likelihood (pre-update): -54.3832, error rate (pre-update): 0.090429
iter: 2020, Minibatch log likelihood (post-update): -54.3831, error rate (post-update): 0.090427

size_minibatch = 20000
Precon grad coeff: 0.023646, velocity coeff: 1.0648
norm(ch) = 0.80088
iter: 2021, Minibatch log likelihood (pre-update): -54.3831, error rate (pre-update): 0.090427

size_minibatch = 20000
Precon grad coeff: 0.027928, velocity coeff: 1.0821
norm(ch) = 0.87
iter: 2022, Minibatch log likelihood (pre-update): -54.383, error rate (pre-update): 0.09041

size_minibatch = 20000
Precon grad coeff: 0.027024, velocity coeff: 0.96293
norm(ch) = 0.84093
iter: 2023, Minibatch log likelihood (pre-update): -54.3829, error rate (pre-update): 0.090396

size_minibatch = 20000
Precon grad coeff: 0.023969, velocity coeff: 0.9808
norm(ch) = 0.82762
iter: 2024, Minibatch log likelihood (pre-update): -54.3828, error rate (pre-update): 0.090384

size_minibatch = 20000
Precon grad coeff: 0.026637, velocity coeff: 1.0188
norm(ch) = 0.84653
rho = 1.0073
New lambda: 3.2503e-043
iter: 2025, Minibatch log likelihood (pre-update): -54.3827, error rate (pre-update): 0.090347
iter: 2025, Minibatch log likelihood (post-update): -54.3827, error rate (post-update): 0.09034

size_minibatch = 20000
Precon grad coeff: 0.022905, velocity coeff: 0.94835
norm(ch) = 0.80543
iter: 2026, Minibatch log likelihood (pre-update): -54.3827, error rate (pre-update): 0.09034

size_minibatch = 20000
Precon grad coeff: 0.022501, velocity coeff: 0.95304
norm(ch) = 0.77018
iter: 2027, Minibatch log likelihood (pre-update): -54.3826, error rate (pre-update): 0.090323

size_minibatch = 20000
Precon grad coeff: 0.023177, velocity coeff: 1.0592
norm(ch) = 0.81843
iter: 2028, Minibatch log likelihood (pre-update): -54.3825, error rate (pre-update): 0.090301

size_minibatch = 20000
Precon grad coeff: 0.024639, velocity coeff: 0.9843
norm(ch) = 0.80841
iter: 2029, Minibatch log likelihood (pre-update): -54.3824, error rate (pre-update): 0.090288

size_minibatch = 20000
Precon grad coeff: 0.026041, velocity coeff: 1.033
norm(ch) = 0.83797
rho = 0.99263
New lambda: 2.515e-043
iter: 2030, Minibatch log likelihood (pre-update): -54.3823, error rate (pre-update): 0.090274
iter: 2030, Minibatch log likelihood (post-update): -54.3822, error rate (post-update): 0.090253

size_minibatch = 20000
Precon grad coeff: 0.024751, velocity coeff: 0.97011
norm(ch) = 0.81578
iter: 2031, Minibatch log likelihood (pre-update): -54.3822, error rate (pre-update): 0.090253

size_minibatch = 20000
Precon grad coeff: 0.022993, velocity coeff: 0.94195
norm(ch) = 0.77084
iter: 2032, Minibatch log likelihood (pre-update): -54.3821, error rate (pre-update): 0.090241

size_minibatch = 20000
Precon grad coeff: 0.024266, velocity coeff: 1.0603
norm(ch) = 0.82026
iter: 2033, Minibatch log likelihood (pre-update): -54.382, error rate (pre-update): 0.090229

size_minibatch = 20000
Precon grad coeff: 0.024044, velocity coeff: 0.9834
norm(ch) = 0.80934
iter: 2034, Minibatch log likelihood (pre-update): -54.3819, error rate (pre-update): 0.090205

size_minibatch = 20000
Precon grad coeff: 0.024238, velocity coeff: 0.98749
norm(ch) = 0.80197
rho = 1.0087
New lambda: 1.9461e-043
iter: 2035, Minibatch log likelihood (pre-update): -54.3818, error rate (pre-update): 0.090189
iter: 2035, Minibatch log likelihood (post-update): -54.3817, error rate (post-update): 0.090171

size_minibatch = 20000
Precon grad coeff: 0.02192, velocity coeff: 0.97093
norm(ch) = 0.78109
iter: 2036, Minibatch log likelihood (pre-update): -54.3817, error rate (pre-update): 0.090171

size_minibatch = 20000
Precon grad coeff: 0.022883, velocity coeff: 0.99867
norm(ch) = 0.78253
iter: 2037, Minibatch log likelihood (pre-update): -54.3817, error rate (pre-update): 0.09016

size_minibatch = 20000
Precon grad coeff: 0.022836, velocity coeff: 1.0323
norm(ch) = 0.81041
iter: 2038, Minibatch log likelihood (pre-update): -54.3816, error rate (pre-update): 0.090142

size_minibatch = 20000
Precon grad coeff: 0.024894, velocity coeff: 1.0003
norm(ch) = 0.81321
iter: 2039, Minibatch log likelihood (pre-update): -54.3815, error rate (pre-update): 0.090128

size_minibatch = 20000
Precon grad coeff: 0.025662, velocity coeff: 0.98388
New gamma: 0.0031623
norm(ch) = 0.80333
rho = 1.0045
New lambda: 1.5058e-043
iter: 2040, Minibatch log likelihood (pre-update): -54.3814, error rate (pre-update): 0.090116
iter: 2040, Minibatch log likelihood (post-update): -54.3813, error rate (post-update): 0.090079

size_minibatch = 20000
Precon grad coeff: 0.027445, velocity coeff: 1.0831
norm(ch) = 0.87346
iter: 2041, Minibatch log likelihood (pre-update): -54.3813, error rate (pre-update): 0.090079

size_minibatch = 20000
Precon grad coeff: 0.02428, velocity coeff: 0.88494
norm(ch) = 0.7756
iter: 2042, Minibatch log likelihood (pre-update): -54.3812, error rate (pre-update): 0.090071

size_minibatch = 20000
Precon grad coeff: 0.022999, velocity coeff: 1.0563
norm(ch) = 0.82224
iter: 2043, Minibatch log likelihood (pre-update): -54.3811, error rate (pre-update): 0.090066

size_minibatch = 20000
Precon grad coeff: 0.02232, velocity coeff: 0.96467
norm(ch) = 0.79568
iter: 2044, Minibatch log likelihood (pre-update): -54.381, error rate (pre-update): 0.090048

size_minibatch = 20000
Precon grad coeff: 0.024804, velocity coeff: 1.0553
norm(ch) = 0.84269
rho = 1.02
New lambda: 1.1652e-043
iter: 2045, Minibatch log likelihood (pre-update): -54.3809, error rate (pre-update): 0.09003
iter: 2045, Minibatch log likelihood (post-update): -54.3808, error rate (post-update): 0.090009

size_minibatch = 20000
Precon grad coeff: 0.026109, velocity coeff: 1.0094
norm(ch) = 0.85388
iter: 2046, Minibatch log likelihood (pre-update): -54.3808, error rate (pre-update): 0.090009

size_minibatch = 20000
Precon grad coeff: 0.024079, velocity coeff: 0.92513
norm(ch) = 0.79254
iter: 2047, Minibatch log likelihood (pre-update): -54.3808, error rate (pre-update): 0.089978

size_minibatch = 20000
Precon grad coeff: 0.024451, velocity coeff: 1.0471
norm(ch) = 0.83267
iter: 2048, Minibatch log likelihood (pre-update): -54.3807, error rate (pre-update): 0.089976

size_minibatch = 20000
Precon grad coeff: 0.025881, velocity coeff: 0.96377
norm(ch) = 0.80539
iter: 2049, Minibatch log likelihood (pre-update): -54.3806, error rate (pre-update): 0.089968

size_minibatch = 20000
Precon grad coeff: 0.024593, velocity coeff: 0.98869
norm(ch) = 0.79922
rho = 1.0419
New lambda: 9.0159e-044
iter: 2050, Minibatch log likelihood (pre-update): -54.3805, error rate (pre-update): 0.089948
iter: 2050, Minibatch log likelihood (post-update): -54.3804, error rate (post-update): 0.089923
---
Full log-likelihood: -54.3804, error rate: 0.089923
TEST log-likelihood: -54.8395, error rate: 0.27613
Error difference (test - train): 0.18621
---
Full log-likelihood (averaged params): -54.4313, error rate (averaged params): 0.10739
TEST log-likelihood (averaged params): -54.8304, error rate (averaged params): 0.27483
Error difference (test - train) (averaged params): 0.16745

size_minibatch = 20000
Precon grad coeff: 0.020685, velocity coeff: 0.93752
norm(ch) = 0.75167
iter: 2051, Minibatch log likelihood (pre-update): -54.3804, error rate (pre-update): 0.089923

size_minibatch = 20000
Precon grad coeff: 0.023863, velocity coeff: 1.0675
norm(ch) = 0.80518
iter: 2052, Minibatch log likelihood (pre-update): -54.3803, error rate (pre-update): 0.089903

size_minibatch = 20000
Precon grad coeff: 0.023396, velocity coeff: 1.0044
norm(ch) = 0.8114
iter: 2053, Minibatch log likelihood (pre-update): -54.3802, error rate (pre-update): 0.0899

size_minibatch = 20000
Precon grad coeff: 0.02743, velocity coeff: 1.0904
norm(ch) = 0.88782
iter: 2054, Minibatch log likelihood (pre-update): -54.3801, error rate (pre-update): 0.089881

size_minibatch = 20000
Precon grad coeff: 0.026677, velocity coeff: 0.92895
norm(ch) = 0.82776
rho = 0.98591
New lambda: 6.9763e-044
iter: 2055, Minibatch log likelihood (pre-update): -54.38, error rate (pre-update): 0.089864
iter: 2055, Minibatch log likelihood (post-update): -54.3799, error rate (post-update): 0.089848

size_minibatch = 20000
Precon grad coeff: 0.021438, velocity coeff: 0.90402
norm(ch) = 0.75064
iter: 2056, Minibatch log likelihood (pre-update): -54.3799, error rate (pre-update): 0.089848

size_minibatch = 20000
Precon grad coeff: 0.0243, velocity coeff: 1.117
norm(ch) = 0.84108
iter: 2057, Minibatch log likelihood (pre-update): -54.3799, error rate (pre-update): 0.089818

size_minibatch = 20000
Precon grad coeff: 0.023898, velocity coeff: 0.90358
norm(ch) = 0.76267
iter: 2058, Minibatch log likelihood (pre-update): -54.3798, error rate (pre-update): 0.089811

size_minibatch = 20000
Precon grad coeff: 0.020682, velocity coeff: 0.99797
norm(ch) = 0.76351
iter: 2059, Minibatch log likelihood (pre-update): -54.3797, error rate (pre-update): 0.089797

size_minibatch = 20000
Precon grad coeff: 0.024835, velocity coeff: 1.0277
New gamma: 0.0031623
norm(ch) = 0.78791
rho = 0.99007
New lambda: 5.3982e-044
iter: 2060, Minibatch log likelihood (pre-update): -54.3796, error rate (pre-update): 0.089777
iter: 2060, Minibatch log likelihood (post-update): -54.3795, error rate (post-update): 0.089765

size_minibatch = 20000
Precon grad coeff: 0.025528, velocity coeff: 1.02
norm(ch) = 0.80678
iter: 2061, Minibatch log likelihood (pre-update): -54.3795, error rate (pre-update): 0.089765

size_minibatch = 20000
Precon grad coeff: 0.026284, velocity coeff: 1.0073
norm(ch) = 0.81567
iter: 2062, Minibatch log likelihood (pre-update): -54.3794, error rate (pre-update): 0.089751

size_minibatch = 20000
Precon grad coeff: 0.025751, velocity coeff: 1.0079
norm(ch) = 0.8252
iter: 2063, Minibatch log likelihood (pre-update): -54.3793, error rate (pre-update): 0.08973

size_minibatch = 20000
Precon grad coeff: 0.02452, velocity coeff: 0.98443
norm(ch) = 0.81545
iter: 2064, Minibatch log likelihood (pre-update): -54.3792, error rate (pre-update): 0.089715

size_minibatch = 20000
Precon grad coeff: 0.025091, velocity coeff: 1.0317
norm(ch) = 0.84438
rho = 0.98493
New lambda: 4.177e-044
iter: 2065, Minibatch log likelihood (pre-update): -54.3792, error rate (pre-update): 0.089697
iter: 2065, Minibatch log likelihood (post-update): -54.3791, error rate (post-update): 0.089686

size_minibatch = 20000
Precon grad coeff: 0.022473, velocity coeff: 0.93242
norm(ch) = 0.78977
iter: 2066, Minibatch log likelihood (pre-update): -54.3791, error rate (pre-update): 0.089686

size_minibatch = 20000
Precon grad coeff: 0.02561, velocity coeff: 1.0822
norm(ch) = 0.85774
iter: 2067, Minibatch log likelihood (pre-update): -54.379, error rate (pre-update): 0.089677

size_minibatch = 20000
Precon grad coeff: 0.024641, velocity coeff: 0.95235
norm(ch) = 0.81963
iter: 2068, Minibatch log likelihood (pre-update): -54.3789, error rate (pre-update): 0.089647

size_minibatch = 20000
Precon grad coeff: 0.024193, velocity coeff: 0.96421
norm(ch) = 0.79305
iter: 2069, Minibatch log likelihood (pre-update): -54.3788, error rate (pre-update): 0.089631

size_minibatch = 20000
Precon grad coeff: 0.025573, velocity coeff: 1.0479
norm(ch) = 0.83408
rho = 1.0447
New lambda: 3.2321e-044
iter: 2070, Minibatch log likelihood (pre-update): -54.3787, error rate (pre-update): 0.089618
iter: 2070, Minibatch log likelihood (post-update): -54.3786, error rate (post-update): 0.08961

size_minibatch = 20000
Precon grad coeff: 0.026226, velocity coeff: 0.97359
norm(ch) = 0.81487
iter: 2071, Minibatch log likelihood (pre-update): -54.3786, error rate (pre-update): 0.08961

size_minibatch = 20000
Precon grad coeff: 0.021721, velocity coeff: 0.89038
norm(ch) = 0.72779
iter: 2072, Minibatch log likelihood (pre-update): -54.3785, error rate (pre-update): 0.089591

size_minibatch = 20000
Precon grad coeff: 0.022864, velocity coeff: 1.0912
norm(ch) = 0.79677
iter: 2073, Minibatch log likelihood (pre-update): -54.3784, error rate (pre-update): 0.089566

size_minibatch = 20000
Precon grad coeff: 0.027539, velocity coeff: 1.0802
norm(ch) = 0.86349
iter: 2074, Minibatch log likelihood (pre-update): -54.3784, error rate (pre-update): 0.089559

size_minibatch = 20000
Precon grad coeff: 0.025082, velocity coeff: 0.93971
norm(ch) = 0.81426
rho = 0.98457
New lambda: 2.5009e-044
iter: 2075, Minibatch log likelihood (pre-update): -54.3783, error rate (pre-update): 0.089548
iter: 2075, Minibatch log likelihood (post-update): -54.3782, error rate (post-update): 0.089526

size_minibatch = 20000
Precon grad coeff: 0.025187, velocity coeff: 1.0058
norm(ch) = 0.82173
iter: 2076, Minibatch log likelihood (pre-update): -54.3782, error rate (pre-update): 0.089526

size_minibatch = 20000
Precon grad coeff: 0.023051, velocity coeff: 0.9501
norm(ch) = 0.78318
iter: 2077, Minibatch log likelihood (pre-update): -54.3781, error rate (pre-update): 0.0895

size_minibatch = 20000
Precon grad coeff: 0.022233, velocity coeff: 0.98974
norm(ch) = 0.77739
iter: 2078, Minibatch log likelihood (pre-update): -54.378, error rate (pre-update): 0.089488

size_minibatch = 20000
Precon grad coeff: 0.024416, velocity coeff: 1.0418
norm(ch) = 0.81242
iter: 2079, Minibatch log likelihood (pre-update): -54.3779, error rate (pre-update): 0.089491

size_minibatch = 20000
Precon grad coeff: 0.025122, velocity coeff: 0.96243
New gamma: 0.0031623
norm(ch) = 0.78468
rho = 1.0201
New lambda: 1.9352e-044
iter: 2080, Minibatch log likelihood (pre-update): -54.3778, error rate (pre-update): 0.089467
iter: 2080, Minibatch log likelihood (post-update): -54.3777, error rate (post-update): 0.089453

size_minibatch = 20000
Precon grad coeff: 0.024224, velocity coeff: 1.0239
norm(ch) = 0.80636
iter: 2081, Minibatch log likelihood (pre-update): -54.3777, error rate (pre-update): 0.089453

size_minibatch = 20000
Precon grad coeff: 0.026521, velocity coeff: 1.0152
norm(ch) = 0.82163
iter: 2082, Minibatch log likelihood (pre-update): -54.3777, error rate (pre-update): 0.089437

size_minibatch = 20000
Precon grad coeff: 0.024426, velocity coeff: 0.98655
norm(ch) = 0.81322
iter: 2083, Minibatch log likelihood (pre-update): -54.3776, error rate (pre-update): 0.089406

size_minibatch = 20000
Precon grad coeff: 0.026177, velocity coeff: 1.0362
norm(ch) = 0.8459
iter: 2084, Minibatch log likelihood (pre-update): -54.3775, error rate (pre-update): 0.089409

size_minibatch = 20000
Precon grad coeff: 0.025276, velocity coeff: 0.98167
norm(ch) = 0.83319
rho = 1.0362
New lambda: 1.4974e-044
iter: 2085, Minibatch log likelihood (pre-update): -54.3774, error rate (pre-update): 0.089388
iter: 2085, Minibatch log likelihood (post-update): -54.3773, error rate (post-update): 0.089369

size_minibatch = 20000
Precon grad coeff: 0.023871, velocity coeff: 0.93786
norm(ch) = 0.78398
iter: 2086, Minibatch log likelihood (pre-update): -54.3773, error rate (pre-update): 0.089369

size_minibatch = 20000
Precon grad coeff: 0.021433, velocity coeff: 0.98087
norm(ch) = 0.77129
iter: 2087, Minibatch log likelihood (pre-update): -54.3772, error rate (pre-update): 0.089364

size_minibatch = 20000
Precon grad coeff: 0.026162, velocity coeff: 1.078
norm(ch) = 0.83433
iter: 2088, Minibatch log likelihood (pre-update): -54.3771, error rate (pre-update): 0.089345

size_minibatch = 20000
Precon grad coeff: 0.023107, velocity coeff: 0.9208
norm(ch) = 0.77076
iter: 2089, Minibatch log likelihood (pre-update): -54.377, error rate (pre-update): 0.089329

size_minibatch = 20000
Precon grad coeff: 0.02518, velocity coeff: 1.0723
norm(ch) = 0.82941
rho = 0.98466
New lambda: 1.1587e-044
iter: 2090, Minibatch log likelihood (pre-update): -54.377, error rate (pre-update): 0.089314
iter: 2090, Minibatch log likelihood (post-update): -54.3769, error rate (post-update): 0.089296

size_minibatch = 20000
Precon grad coeff: 0.024834, velocity coeff: 0.95134
norm(ch) = 0.79179
iter: 2091, Minibatch log likelihood (pre-update): -54.3769, error rate (pre-update): 0.089296

size_minibatch = 20000
Precon grad coeff: 0.024308, velocity coeff: 1.0071
norm(ch) = 0.80009
iter: 2092, Minibatch log likelihood (pre-update): -54.3768, error rate (pre-update): 0.089294

size_minibatch = 20000
Precon grad coeff: 0.023976, velocity coeff: 0.99994
norm(ch) = 0.80266
iter: 2093, Minibatch log likelihood (pre-update): -54.3767, error rate (pre-update): 0.089272

size_minibatch = 20000
Precon grad coeff: 0.025619, velocity coeff: 1.0332
norm(ch) = 0.8318
iter: 2094, Minibatch log likelihood (pre-update): -54.3766, error rate (pre-update): 0.089261

size_minibatch = 20000
Precon grad coeff: 0.025876, velocity coeff: 0.96509
norm(ch) = 0.80551
rho = 1.0431
New lambda: 8.9655e-045
iter: 2095, Minibatch log likelihood (pre-update): -54.3765, error rate (pre-update): 0.089243
iter: 2095, Minibatch log likelihood (post-update): -54.3764, error rate (post-update): 0.089223

size_minibatch = 20000
Precon grad coeff: 0.02055, velocity coeff: 0.9262
norm(ch) = 0.74837
iter: 2096, Minibatch log likelihood (pre-update): -54.3764, error rate (pre-update): 0.089223

size_minibatch = 20000
Precon grad coeff: 0.023263, velocity coeff: 1.0507
norm(ch) = 0.78884
iter: 2097, Minibatch log likelihood (pre-update): -54.3764, error rate (pre-update): 0.089216

size_minibatch = 20000
Precon grad coeff: 0.023538, velocity coeff: 1.0096
norm(ch) = 0.79878
iter: 2098, Minibatch log likelihood (pre-update): -54.3763, error rate (pre-update): 0.089197

size_minibatch = 20000
Precon grad coeff: 0.024869, velocity coeff: 1.0042
norm(ch) = 0.80483
iter: 2099, Minibatch log likelihood (pre-update): -54.3762, error rate (pre-update): 0.089181

size_minibatch = 20000
Precon grad coeff: 0.02565, velocity coeff: 0.98348
New gamma: 0.0031623
norm(ch) = 0.79445
rho = 1.0173
New lambda: 6.9373e-045
iter: 2100, Minibatch log likelihood (pre-update): -54.3761, error rate (pre-update): 0.089165
iter: 2100, Minibatch log likelihood (post-update): -54.376, error rate (post-update): 0.089149
---
Full log-likelihood: -54.376, error rate: 0.089149
TEST log-likelihood: -54.8451, error rate: 0.27845
Error difference (test - train): 0.1893
---
Full log-likelihood (averaged params): -54.4254, error rate (averaged params): 0.10614
TEST log-likelihood (averaged params): -54.8366, error rate (averaged params): 0.27707
Error difference (test - train) (averaged params): 0.17093

size_minibatch = 20000
Precon grad coeff: 0.024348, velocity coeff: 0.98049
norm(ch) = 0.78164
iter: 2101, Minibatch log likelihood (pre-update): -54.376, error rate (pre-update): 0.089149

size_minibatch = 20000
Precon grad coeff: 0.025895, velocity coeff: 1.0656
norm(ch) = 0.83593
iter: 2102, Minibatch log likelihood (pre-update): -54.3759, error rate (pre-update): 0.089146

size_minibatch = 20000
Precon grad coeff: 0.027807, velocity coeff: 1.0251
norm(ch) = 0.85999
iter: 2103, Minibatch log likelihood (pre-update): -54.3759, error rate (pre-update): 0.089131

size_minibatch = 20000
Precon grad coeff: 0.025727, velocity coeff: 0.96806
norm(ch) = 0.83538
iter: 2104, Minibatch log likelihood (pre-update): -54.3758, error rate (pre-update): 0.089108

size_minibatch = 20000
Precon grad coeff: 0.022878, velocity coeff: 0.93085
norm(ch) = 0.77991
rho = 0.97401
New lambda: 5.3679e-045
iter: 2105, Minibatch log likelihood (pre-update): -54.3757, error rate (pre-update): 0.089088
iter: 2105, Minibatch log likelihood (post-update): -54.3756, error rate (post-update): 0.089078

size_minibatch = 20000
Precon grad coeff: 0.023707, velocity coeff: 1.0358
norm(ch) = 0.81042
iter: 2106, Minibatch log likelihood (pre-update): -54.3756, error rate (pre-update): 0.089078

size_minibatch = 20000
Precon grad coeff: 0.024715, velocity coeff: 1.0071
norm(ch) = 0.81887
iter: 2107, Minibatch log likelihood (pre-update): -54.3755, error rate (pre-update): 0.089059

size_minibatch = 20000
Precon grad coeff: 0.0263, velocity coeff: 0.9819
norm(ch) = 0.80683
iter: 2108, Minibatch log likelihood (pre-update): -54.3754, error rate (pre-update): 0.089048

size_minibatch = 20000
Precon grad coeff: 0.02238, velocity coeff: 0.92717
norm(ch) = 0.75035
iter: 2109, Minibatch log likelihood (pre-update): -54.3753, error rate (pre-update): 0.089048

size_minibatch = 20000
Precon grad coeff: 0.024629, velocity coeff: 1.0776
norm(ch) = 0.81132
rho = 0.99603
New lambda: 4.1536e-045
iter: 2110, Minibatch log likelihood (pre-update): -54.3753, error rate (pre-update): 0.08902
iter: 2110, Minibatch log likelihood (post-update): -54.3752, error rate (post-update): 0.088994

size_minibatch = 20000
Precon grad coeff: 0.027313, velocity coeff: 1.0184
norm(ch) = 0.82913
iter: 2111, Minibatch log likelihood (pre-update): -54.3752, error rate (pre-update): 0.088994

size_minibatch = 20000
Precon grad coeff: 0.025998, velocity coeff: 0.99409
norm(ch) = 0.82699
iter: 2112, Minibatch log likelihood (pre-update): -54.3751, error rate (pre-update): 0.088994

size_minibatch = 20000
Precon grad coeff: 0.023657, velocity coeff: 0.92276
norm(ch) = 0.76534
iter: 2113, Minibatch log likelihood (pre-update): -54.375, error rate (pre-update): 0.088976

size_minibatch = 20000
Precon grad coeff: 0.023093, velocity coeff: 1.0178
norm(ch) = 0.78144
iter: 2114, Minibatch log likelihood (pre-update): -54.3749, error rate (pre-update): 0.088961

size_minibatch = 20000
Precon grad coeff: 0.021824, velocity coeff: 0.9902
norm(ch) = 0.77604
rho = 1.0214
New lambda: 3.214e-045
iter: 2115, Minibatch log likelihood (pre-update): -54.3748, error rate (pre-update): 0.088945
iter: 2115, Minibatch log likelihood (post-update): -54.3748, error rate (post-update): 0.088929

size_minibatch = 20000
Precon grad coeff: 0.025684, velocity coeff: 1.073
norm(ch) = 0.83547
iter: 2116, Minibatch log likelihood (pre-update): -54.3748, error rate (pre-update): 0.088929

size_minibatch = 20000
Precon grad coeff: 0.027125, velocity coeff: 1.0158
norm(ch) = 0.85124
iter: 2117, Minibatch log likelihood (pre-update): -54.3747, error rate (pre-update): 0.088926

size_minibatch = 20000
Precon grad coeff: 0.025941, velocity coeff: 0.94312
norm(ch) = 0.80557
iter: 2118, Minibatch log likelihood (pre-update): -54.3746, error rate (pre-update): 0.088899

size_minibatch = 20000
Precon grad coeff: 0.022091, velocity coeff: 0.91452
norm(ch) = 0.73896
iter: 2119, Minibatch log likelihood (pre-update): -54.3745, error rate (pre-update): 0.088888

size_minibatch = 20000
Precon grad coeff: 0.025363, velocity coeff: 1.0837
New gamma: 0.0031623
norm(ch) = 0.80345
rho = 0.99799
New lambda: 2.4869e-045
iter: 2120, Minibatch log likelihood (pre-update): -54.3744, error rate (pre-update): 0.088881
iter: 2120, Minibatch log likelihood (post-update): -54.3743, error rate (post-update): 0.088874

size_minibatch = 20000
Precon grad coeff: 0.025272, velocity coeff: 0.96134
norm(ch) = 0.77527
iter: 2121, Minibatch log likelihood (pre-update): -54.3743, error rate (pre-update): 0.088874

size_minibatch = 20000
Precon grad coeff: 0.025045, velocity coeff: 1.0215
norm(ch) = 0.79461
iter: 2122, Minibatch log likelihood (pre-update): -54.3743, error rate (pre-update): 0.088853

size_minibatch = 20000
Precon grad coeff: 0.024661, velocity coeff: 1.0214
norm(ch) = 0.81441
iter: 2123, Minibatch log likelihood (pre-update): -54.3742, error rate (pre-update): 0.088823

size_minibatch = 20000
Precon grad coeff: 0.024127, velocity coeff: 0.96517
norm(ch) = 0.78877
iter: 2124, Minibatch log likelihood (pre-update): -54.3741, error rate (pre-update): 0.088817

size_minibatch = 20000
Precon grad coeff: 0.026288, velocity coeff: 1.1072
norm(ch) = 0.87612
rho = 1.0244
New lambda: 1.9243e-045
iter: 2125, Minibatch log likelihood (pre-update): -54.374, error rate (pre-update): 0.08881
iter: 2125, Minibatch log likelihood (post-update): -54.3739, error rate (post-update): 0.088799

size_minibatch = 20000
Precon grad coeff: 0.027765, velocity coeff: 0.96631
norm(ch) = 0.84944
iter: 2126, Minibatch log likelihood (pre-update): -54.3739, error rate (pre-update): 0.088799

size_minibatch = 20000
Precon grad coeff: 0.025391, velocity coeff: 0.95938
norm(ch) = 0.81761
iter: 2127, Minibatch log likelihood (pre-update): -54.3738, error rate (pre-update): 0.088782

size_minibatch = 20000
Precon grad coeff: 0.025153, velocity coeff: 0.98628
norm(ch) = 0.80904
iter: 2128, Minibatch log likelihood (pre-update): -54.3737, error rate (pre-update): 0.08876

size_minibatch = 20000
Precon grad coeff: 0.026814, velocity coeff: 1.0156
norm(ch) = 0.82434
iter: 2129, Minibatch log likelihood (pre-update): -54.3737, error rate (pre-update): 0.088745

size_minibatch = 20000
Precon grad coeff: 0.025445, velocity coeff: 0.95251
norm(ch) = 0.78783
rho = 0.95408
New lambda: 1.489e-045
iter: 2130, Minibatch log likelihood (pre-update): -54.3736, error rate (pre-update): 0.088731
iter: 2130, Minibatch log likelihood (post-update): -54.3735, error rate (post-update): 0.088733

size_minibatch = 20000
Precon grad coeff: 0.025108, velocity coeff: 1.0207
norm(ch) = 0.80673
iter: 2131, Minibatch log likelihood (pre-update): -54.3735, error rate (pre-update): 0.088733

size_minibatch = 20000
Precon grad coeff: 0.024568, velocity coeff: 0.96468
norm(ch) = 0.78077
iter: 2132, Minibatch log likelihood (pre-update): -54.3734, error rate (pre-update): 0.088712

size_minibatch = 20000
Precon grad coeff: 0.023431, velocity coeff: 1.0019
norm(ch) = 0.78463
iter: 2133, Minibatch log likelihood (pre-update): -54.3733, error rate (pre-update): 0.08869

size_minibatch = 20000
Precon grad coeff: 0.024586, velocity coeff: 1.0173
norm(ch) = 0.80084
iter: 2134, Minibatch log likelihood (pre-update): -54.3732, error rate (pre-update): 0.088682

size_minibatch = 20000
Precon grad coeff: 0.023116, velocity coeff: 0.9739
norm(ch) = 0.78207
rho = 0.97887
New lambda: 1.1522e-045
iter: 2135, Minibatch log likelihood (pre-update): -54.3732, error rate (pre-update): 0.08867
iter: 2135, Minibatch log likelihood (post-update): -54.3731, error rate (post-update): 0.088657

size_minibatch = 20000
Precon grad coeff: 0.024178, velocity coeff: 0.9953
norm(ch) = 0.78075
iter: 2136, Minibatch log likelihood (pre-update): -54.3731, error rate (pre-update): 0.088657

size_minibatch = 20000
Precon grad coeff: 0.02494, velocity coeff: 1.0487
norm(ch) = 0.82139
iter: 2137, Minibatch log likelihood (pre-update): -54.373, error rate (pre-update): 0.08865

size_minibatch = 20000
Precon grad coeff: 0.027496, velocity coeff: 1.0203
norm(ch) = 0.84095
iter: 2138, Minibatch log likelihood (pre-update): -54.3729, error rate (pre-update): 0.088625

size_minibatch = 20000
Precon grad coeff: 0.025732, velocity coeff: 0.96154
norm(ch) = 0.81106
iter: 2139, Minibatch log likelihood (pre-update): -54.3728, error rate (pre-update): 0.088616

size_minibatch = 20000
Precon grad coeff: 0.025063, velocity coeff: 0.9248
New gamma: 0.0031623
norm(ch) = 0.75272
rho = 1.0306
New lambda: 8.9153e-046
iter: 2140, Minibatch log likelihood (pre-update): -54.3727, error rate (pre-update): 0.088599
iter: 2140, Minibatch log likelihood (post-update): -54.3727, error rate (post-update): 0.088591

size_minibatch = 20000
Precon grad coeff: 0.025536, velocity coeff: 1.0789
norm(ch) = 0.81481
iter: 2141, Minibatch log likelihood (pre-update): -54.3727, error rate (pre-update): 0.088591

size_minibatch = 20000
Precon grad coeff: 0.027885, velocity coeff: 1.0185
norm(ch) = 0.8329
iter: 2142, Minibatch log likelihood (pre-update): -54.3726, error rate (pre-update): 0.088583

size_minibatch = 20000
Precon grad coeff: 0.023701, velocity coeff: 0.93499
norm(ch) = 0.78114
iter: 2143, Minibatch log likelihood (pre-update): -54.3725, error rate (pre-update): 0.08856

size_minibatch = 20000
Precon grad coeff: 0.024391, velocity coeff: 1.0371
norm(ch) = 0.81271
iter: 2144, Minibatch log likelihood (pre-update): -54.3724, error rate (pre-update): 0.088549

size_minibatch = 20000
Precon grad coeff: 0.024164, velocity coeff: 0.99253
norm(ch) = 0.80906
rho = 1.0391
New lambda: 6.8985e-046
iter: 2145, Minibatch log likelihood (pre-update): -54.3723, error rate (pre-update): 0.088534
iter: 2145, Minibatch log likelihood (post-update): -54.3723, error rate (post-update): 0.088525

size_minibatch = 20000
Precon grad coeff: 0.027597, velocity coeff: 1.0664
norm(ch) = 0.86592
iter: 2146, Minibatch log likelihood (pre-update): -54.3723, error rate (pre-update): 0.088525

size_minibatch = 20000
Precon grad coeff: 0.027123, velocity coeff: 0.95366
norm(ch) = 0.82856
iter: 2147, Minibatch log likelihood (pre-update): -54.3722, error rate (pre-update): 0.08851

size_minibatch = 20000
Precon grad coeff: 0.024302, velocity coeff: 0.92438
norm(ch) = 0.76829
iter: 2148, Minibatch log likelihood (pre-update): -54.3721, error rate (pre-update): 0.088484

size_minibatch = 20000
Precon grad coeff: 0.023322, velocity coeff: 1.0059
norm(ch) = 0.77522
iter: 2149, Minibatch log likelihood (pre-update): -54.372, error rate (pre-update): 0.088485

size_minibatch = 20000
Precon grad coeff: 0.024766, velocity coeff: 1.0205
norm(ch) = 0.79357
rho = 0.98145
New lambda: 5.3379e-046
iter: 2150, Minibatch log likelihood (pre-update): -54.3719, error rate (pre-update): 0.088479
iter: 2150, Minibatch log likelihood (post-update): -54.3718, error rate (post-update): 0.088457
---
Full log-likelihood: -54.3718, error rate: 0.088457
TEST log-likelihood: -54.8535, error rate: 0.28134
Error difference (test - train): 0.19289
---
Full log-likelihood (averaged params): -54.4186, error rate (averaged params): 0.1045
TEST log-likelihood (averaged params): -54.8414, error rate (averaged params): 0.27893
Error difference (test - train) (averaged params): 0.17443

size_minibatch = 20000
Precon grad coeff: 0.024123, velocity coeff: 0.97154
norm(ch) = 0.77353
iter: 2151, Minibatch log likelihood (pre-update): -54.3718, error rate (pre-update): 0.088457

size_minibatch = 20000
Precon grad coeff: 0.025178, velocity coeff: 1.0474
norm(ch) = 0.81276
iter: 2152, Minibatch log likelihood (pre-update): -54.3718, error rate (pre-update): 0.088438

size_minibatch = 20000
Precon grad coeff: 0.025664, velocity coeff: 1.0004
norm(ch) = 0.81568
iter: 2153, Minibatch log likelihood (pre-update): -54.3717, error rate (pre-update): 0.088421

size_minibatch = 20000
Precon grad coeff: 0.024316, velocity coeff: 0.95837
norm(ch) = 0.78406
iter: 2154, Minibatch log likelihood (pre-update): -54.3716, error rate (pre-update): 0.088422

size_minibatch = 20000
Precon grad coeff: 0.026182, velocity coeff: 1.0627
norm(ch) = 0.83595
rho = 1.0228
New lambda: 4.1304e-046
iter: 2155, Minibatch log likelihood (pre-update): -54.3715, error rate (pre-update): 0.08841
iter: 2155, Minibatch log likelihood (post-update): -54.3714, error rate (post-update): 0.088386

size_minibatch = 20000
Precon grad coeff: 0.026634, velocity coeff: 0.97789
norm(ch) = 0.82015
iter: 2156, Minibatch log likelihood (pre-update): -54.3714, error rate (pre-update): 0.088386

size_minibatch = 20000
Precon grad coeff: 0.022603, velocity coeff: 0.89104
norm(ch) = 0.73291
iter: 2157, Minibatch log likelihood (pre-update): -54.3713, error rate (pre-update): 0.088379

size_minibatch = 20000
Precon grad coeff: 0.022033, velocity coeff: 1.0475
norm(ch) = 0.76992
iter: 2158, Minibatch log likelihood (pre-update): -54.3713, error rate (pre-update): 0.088373

size_minibatch = 20000
Precon grad coeff: 0.024515, velocity coeff: 1.032
norm(ch) = 0.79705
iter: 2159, Minibatch log likelihood (pre-update): -54.3712, error rate (pre-update): 0.088357

size_minibatch = 20000
Precon grad coeff: 0.026792, velocity coeff: 1.0127
New gamma: 0.0031623
norm(ch) = 0.81015
rho = 1.012
New lambda: 3.196e-046
iter: 2160, Minibatch log likelihood (pre-update): -54.3711, error rate (pre-update): 0.088339
iter: 2160, Minibatch log likelihood (post-update): -54.371, error rate (post-update): 0.088324

size_minibatch = 20000
Precon grad coeff: 0.027548, velocity coeff: 1.0161
norm(ch) = 0.82619
iter: 2161, Minibatch log likelihood (pre-update): -54.371, error rate (pre-update): 0.088324

size_minibatch = 20000
Precon grad coeff: 0.02649, velocity coeff: 0.98175
norm(ch) = 0.81403
iter: 2162, Minibatch log likelihood (pre-update): -54.3709, error rate (pre-update): 0.088312

size_minibatch = 20000
Precon grad coeff: 0.026247, velocity coeff: 1
norm(ch) = 0.81676
iter: 2163, Minibatch log likelihood (pre-update): -54.3709, error rate (pre-update): 0.088298

size_minibatch = 20000
Precon grad coeff: 0.023611, velocity coeff: 0.96566
norm(ch) = 0.79121
iter: 2164, Minibatch log likelihood (pre-update): -54.3708, error rate (pre-update): 0.088286

size_minibatch = 20000
Precon grad coeff: 0.02429, velocity coeff: 1.0386
norm(ch) = 0.82449
rho = 1.0108
New lambda: 2.473e-046
iter: 2165, Minibatch log likelihood (pre-update): -54.3707, error rate (pre-update): 0.088278
iter: 2165, Minibatch log likelihood (post-update): -54.3706, error rate (post-update): 0.088259

size_minibatch = 20000
Precon grad coeff: 0.024773, velocity coeff: 0.96516
norm(ch) = 0.79816
iter: 2166, Minibatch log likelihood (pre-update): -54.3706, error rate (pre-update): 0.088259

size_minibatch = 20000
Precon grad coeff: 0.02483, velocity coeff: 1.0256
norm(ch) = 0.82124
iter: 2167, Minibatch log likelihood (pre-update): -54.3705, error rate (pre-update): 0.088241

size_minibatch = 20000
Precon grad coeff: 0.027778, velocity coeff: 1.0336
norm(ch) = 0.85176
iter: 2168, Minibatch log likelihood (pre-update): -54.3705, error rate (pre-update): 0.088232

size_minibatch = 20000
Precon grad coeff: 0.024621, velocity coeff: 0.87813
norm(ch) = 0.75049
iter: 2169, Minibatch log likelihood (pre-update): -54.3704, error rate (pre-update): 0.088218

size_minibatch = 20000
Precon grad coeff: 0.023213, velocity coeff: 1.0533
norm(ch) = 0.79276
rho = 1.011
New lambda: 1.9136e-046
iter: 2170, Minibatch log likelihood (pre-update): -54.3703, error rate (pre-update): 0.088205
iter: 2170, Minibatch log likelihood (post-update): -54.3702, error rate (post-update): 0.088191

size_minibatch = 20000
Precon grad coeff: 0.024994, velocity coeff: 0.98789
norm(ch) = 0.78567
iter: 2171, Minibatch log likelihood (pre-update): -54.3702, error rate (pre-update): 0.088191

size_minibatch = 20000
Precon grad coeff: 0.025628, velocity coeff: 1.0211
norm(ch) = 0.80493
iter: 2172, Minibatch log likelihood (pre-update): -54.3701, error rate (pre-update): 0.088182

size_minibatch = 20000
Precon grad coeff: 0.024138, velocity coeff: 0.99086
norm(ch) = 0.80007
iter: 2173, Minibatch log likelihood (pre-update): -54.3701, error rate (pre-update): 0.088161

size_minibatch = 20000
Precon grad coeff: 0.026616, velocity coeff: 1.0308
norm(ch) = 0.82732
iter: 2174, Minibatch log likelihood (pre-update): -54.37, error rate (pre-update): 0.088148

size_minibatch = 20000
Precon grad coeff: 0.02416, velocity coeff: 0.9469
norm(ch) = 0.78578
rho = 0.99392
New lambda: 1.4807e-046
iter: 2175, Minibatch log likelihood (pre-update): -54.3699, error rate (pre-update): 0.088137
iter: 2175, Minibatch log likelihood (post-update): -54.3698, error rate (post-update): 0.088119

size_minibatch = 20000
Precon grad coeff: 0.023537, velocity coeff: 0.98736
norm(ch) = 0.77817
iter: 2176, Minibatch log likelihood (pre-update): -54.3698, error rate (pre-update): 0.088119

size_minibatch = 20000
Precon grad coeff: 0.022398, velocity coeff: 0.96667
norm(ch) = 0.75445
iter: 2177, Minibatch log likelihood (pre-update): -54.3697, error rate (pre-update): 0.088101

size_minibatch = 20000
Precon grad coeff: 0.024856, velocity coeff: 1.0791
norm(ch) = 0.81671
iter: 2178, Minibatch log likelihood (pre-update): -54.3697, error rate (pre-update): 0.088089

size_minibatch = 20000
Precon grad coeff: 0.024443, velocity coeff: 0.94782
norm(ch) = 0.77661
iter: 2179, Minibatch log likelihood (pre-update): -54.3696, error rate (pre-update): 0.088083

size_minibatch = 20000
Precon grad coeff: 0.026755, velocity coeff: 1.0472
New gamma: 0.0031623
norm(ch) = 0.81613
rho = 1.0028
New lambda: 1.1457e-046
iter: 2180, Minibatch log likelihood (pre-update): -54.3695, error rate (pre-update): 0.088081
iter: 2180, Minibatch log likelihood (post-update): -54.3694, error rate (post-update): 0.088055

size_minibatch = 20000
Precon grad coeff: 0.025275, velocity coeff: 0.94373
norm(ch) = 0.7729
iter: 2181, Minibatch log likelihood (pre-update): -54.3694, error rate (pre-update): 0.088055

size_minibatch = 20000
Precon grad coeff: 0.026452, velocity coeff: 1.0785
norm(ch) = 0.83641
iter: 2182, Minibatch log likelihood (pre-update): -54.3693, error rate (pre-update): 0.088032

size_minibatch = 20000
Precon grad coeff: 0.025705, velocity coeff: 0.96098
norm(ch) = 0.80641
iter: 2183, Minibatch log likelihood (pre-update): -54.3693, error rate (pre-update): 0.08803

size_minibatch = 20000
Precon grad coeff: 0.025959, velocity coeff: 1.0128
norm(ch) = 0.81944
iter: 2184, Minibatch log likelihood (pre-update): -54.3692, error rate (pre-update): 0.088009

size_minibatch = 20000
Precon grad coeff: 0.024267, velocity coeff: 1.0047
norm(ch) = 0.82594
rho = 1.0367
New lambda: 8.8654e-047
iter: 2185, Minibatch log likelihood (pre-update): -54.3691, error rate (pre-update): 0.088001
iter: 2185, Minibatch log likelihood (post-update): -54.369, error rate (post-update): 0.087985

size_minibatch = 20000
Precon grad coeff: 0.025417, velocity coeff: 0.96256
norm(ch) = 0.79771
iter: 2186, Minibatch log likelihood (pre-update): -54.369, error rate (pre-update): 0.087985

size_minibatch = 20000
Precon grad coeff: 0.024708, velocity coeff: 1.0068
norm(ch) = 0.80563
iter: 2187, Minibatch log likelihood (pre-update): -54.3689, error rate (pre-update): 0.087968

size_minibatch = 20000
Precon grad coeff: 0.025, velocity coeff: 0.99018
norm(ch) = 0.80033
iter: 2188, Minibatch log likelihood (pre-update): -54.3688, error rate (pre-update): 0.087956

size_minibatch = 20000
Precon grad coeff: 0.026357, velocity coeff: 1.014
norm(ch) = 0.81431
iter: 2189, Minibatch log likelihood (pre-update): -54.3688, error rate (pre-update): 0.087943

size_minibatch = 20000
Precon grad coeff: 0.026288, velocity coeff: 0.99109
norm(ch) = 0.8097
rho = 0.98024
New lambda: 6.8599e-047
iter: 2190, Minibatch log likelihood (pre-update): -54.3687, error rate (pre-update): 0.087936
iter: 2190, Minibatch log likelihood (post-update): -54.3686, error rate (post-update): 0.087918

size_minibatch = 20000
Precon grad coeff: 0.024528, velocity coeff: 0.95753
norm(ch) = 0.77788
iter: 2191, Minibatch log likelihood (pre-update): -54.3686, error rate (pre-update): 0.087918

size_minibatch = 20000
Precon grad coeff: 0.024692, velocity coeff: 1.0359
norm(ch) = 0.80814
iter: 2192, Minibatch log likelihood (pre-update): -54.3685, error rate (pre-update): 0.087897

size_minibatch = 20000
Precon grad coeff: 0.026785, velocity coeff: 1.0243
norm(ch) = 0.8305
iter: 2193, Minibatch log likelihood (pre-update): -54.3684, error rate (pre-update): 0.087886

size_minibatch = 20000
Precon grad coeff: 0.024883, velocity coeff: 0.93647
norm(ch) = 0.78018
iter: 2194, Minibatch log likelihood (pre-update): -54.3684, error rate (pre-update): 0.087881

size_minibatch = 20000
Precon grad coeff: 0.023754, velocity coeff: 0.9957
norm(ch) = 0.77914
rho = 1.0278
New lambda: 5.308e-047
iter: 2195, Minibatch log likelihood (pre-update): -54.3683, error rate (pre-update): 0.087869
iter: 2195, Minibatch log likelihood (post-update): -54.3682, error rate (post-update): 0.087849

size_minibatch = 20000
Precon grad coeff: 0.022646, velocity coeff: 0.97982
norm(ch) = 0.76562
iter: 2196, Minibatch log likelihood (pre-update): -54.3682, error rate (pre-update): 0.087849

size_minibatch = 20000
Precon grad coeff: 0.025162, velocity coeff: 1.054
norm(ch) = 0.8094
iter: 2197, Minibatch log likelihood (pre-update): -54.3681, error rate (pre-update): 0.08784

size_minibatch = 20000
Precon grad coeff: 0.025208, velocity coeff: 0.96551
norm(ch) = 0.7841
iter: 2198, Minibatch log likelihood (pre-update): -54.3681, error rate (pre-update): 0.087825

size_minibatch = 20000
Precon grad coeff: 0.023721, velocity coeff: 0.99305
norm(ch) = 0.781
iter: 2199, Minibatch log likelihood (pre-update): -54.368, error rate (pre-update): 0.087817

size_minibatch = 20000
Precon grad coeff: 0.02806, velocity coeff: 1.0532
New gamma: 0.0031623
norm(ch) = 0.82558
rho = 1.0111
New lambda: 4.1072e-047
iter: 2200, Minibatch log likelihood (pre-update): -54.3679, error rate (pre-update): 0.087799
iter: 2200, Minibatch log likelihood (post-update): -54.3678, error rate (post-update): 0.087786
---
Full log-likelihood: -54.3678, error rate: 0.087786
TEST log-likelihood: -54.8658, error rate: 0.28532
Error difference (test - train): 0.19753
---
Full log-likelihood (averaged params): -54.4112, error rate (averaged params): 0.10264
TEST log-likelihood (averaged params): -54.846, error rate (averaged params): 0.28069
Error difference (test - train) (averaged params): 0.17804

size_minibatch = 20000
Precon grad coeff: 0.027154, velocity coeff: 0.96019
norm(ch) = 0.79547
iter: 2201, Minibatch log likelihood (pre-update): -54.3678, error rate (pre-update): 0.087786

size_minibatch = 20000
Precon grad coeff: 0.022429, velocity coeff: 0.92639
norm(ch) = 0.73927
iter: 2202, Minibatch log likelihood (pre-update): -54.3677, error rate (pre-update): 0.087775

size_minibatch = 20000
Precon grad coeff: 0.025323, velocity coeff: 1.104
norm(ch) = 0.81876
iter: 2203, Minibatch log likelihood (pre-update): -54.3677, error rate (pre-update): 0.087753

size_minibatch = 20000
Precon grad coeff: 0.025755, velocity coeff: 0.99878
norm(ch) = 0.82045
iter: 2204, Minibatch log likelihood (pre-update): -54.3676, error rate (pre-update): 0.087741

size_minibatch = 20000
Precon grad coeff: 0.024716, velocity coeff: 0.96054
norm(ch) = 0.79052
rho = 1.0334
New lambda: 3.1781e-047
iter: 2205, Minibatch log likelihood (pre-update): -54.3675, error rate (pre-update): 0.087742
iter: 2205, Minibatch log likelihood (post-update): -54.3674, error rate (post-update): 0.087715

size_minibatch = 20000
Precon grad coeff: 0.0239, velocity coeff: 1.0111
norm(ch) = 0.80186
iter: 2206, Minibatch log likelihood (pre-update): -54.3674, error rate (pre-update): 0.087715

size_minibatch = 20000
Precon grad coeff: 0.026244, velocity coeff: 1.0054
norm(ch) = 0.80878
iter: 2207, Minibatch log likelihood (pre-update): -54.3673, error rate (pre-update): 0.087704

size_minibatch = 20000
Precon grad coeff: 0.027481, velocity coeff: 1.0078
norm(ch) = 0.81782
iter: 2208, Minibatch log likelihood (pre-update): -54.3673, error rate (pre-update): 0.087694

size_minibatch = 20000
Precon grad coeff: 0.022463, velocity coeff: 0.88758
norm(ch) = 0.72801
iter: 2209, Minibatch log likelihood (pre-update): -54.3672, error rate (pre-update): 0.087682

size_minibatch = 20000
Precon grad coeff: 0.025117, velocity coeff: 1.0959
norm(ch) = 0.80042
rho = 1.0542
New lambda: 2.4592e-047
iter: 2210, Minibatch log likelihood (pre-update): -54.3671, error rate (pre-update): 0.08767
iter: 2210, Minibatch log likelihood (post-update): -54.367, error rate (post-update): 0.087651

size_minibatch = 20000
Precon grad coeff: 0.025481, velocity coeff: 0.96849
norm(ch) = 0.77777
iter: 2211, Minibatch log likelihood (pre-update): -54.367, error rate (pre-update): 0.087651

size_minibatch = 20000
Precon grad coeff: 0.023435, velocity coeff: 0.9847
norm(ch) = 0.76822
iter: 2212, Minibatch log likelihood (pre-update): -54.367, error rate (pre-update): 0.087641

size_minibatch = 20000
Precon grad coeff: 0.023744, velocity coeff: 1.0048
norm(ch) = 0.77419
iter: 2213, Minibatch log likelihood (pre-update): -54.3669, error rate (pre-update): 0.087633

size_minibatch = 20000
Precon grad coeff: 0.024299, velocity coeff: 1.0117
norm(ch) = 0.78576
iter: 2214, Minibatch log likelihood (pre-update): -54.3668, error rate (pre-update): 0.087615

size_minibatch = 20000
Precon grad coeff: 0.025472, velocity coeff: 1.0238
norm(ch) = 0.80687
rho = 0.99879
New lambda: 1.9029e-047
iter: 2215, Minibatch log likelihood (pre-update): -54.3667, error rate (pre-update): 0.087606
iter: 2215, Minibatch log likelihood (post-update): -54.3666, error rate (post-update): 0.087588

size_minibatch = 20000
Precon grad coeff: 0.024267, velocity coeff: 0.94223
norm(ch) = 0.76255
iter: 2216, Minibatch log likelihood (pre-update): -54.3667, error rate (pre-update): 0.087588

size_minibatch = 20000
Precon grad coeff: 0.025025, velocity coeff: 1.0425
norm(ch) = 0.79725
iter: 2217, Minibatch log likelihood (pre-update): -54.3666, error rate (pre-update): 0.087581

size_minibatch = 20000
Precon grad coeff: 0.024919, velocity coeff: 0.9751
norm(ch) = 0.7798
iter: 2218, Minibatch log likelihood (pre-update): -54.3665, error rate (pre-update): 0.087571

size_minibatch = 20000
Precon grad coeff: 0.023635, velocity coeff: 0.95869
norm(ch) = 0.74979
iter: 2219, Minibatch log likelihood (pre-update): -54.3664, error rate (pre-update): 0.087551

size_minibatch = 20000
Precon grad coeff: 0.021876, velocity coeff: 0.96612
New gamma: 0.0031623
norm(ch) = 0.72673
rho = 0.99613
New lambda: 1.4724e-047
iter: 2220, Minibatch log likelihood (pre-update): -54.3663, error rate (pre-update): 0.087534
iter: 2220, Minibatch log likelihood (post-update): -54.3663, error rate (post-update): 0.087532

size_minibatch = 20000
Precon grad coeff: 0.026019, velocity coeff: 1.1066
norm(ch) = 0.80672
iter: 2221, Minibatch log likelihood (pre-update): -54.3663, error rate (pre-update): 0.087532

size_minibatch = 20000
Precon grad coeff: 0.025831, velocity coeff: 0.96355
norm(ch) = 0.78
iter: 2222, Minibatch log likelihood (pre-update): -54.3662, error rate (pre-update): 0.087517

size_minibatch = 20000
Precon grad coeff: 0.024717, velocity coeff: 1.01
norm(ch) = 0.79027
iter: 2223, Minibatch log likelihood (pre-update): -54.3661, error rate (pre-update): 0.087503

size_minibatch = 20000
Precon grad coeff: 0.022582, velocity coeff: 0.95604
norm(ch) = 0.75779
iter: 2224, Minibatch log likelihood (pre-update): -54.366, error rate (pre-update): 0.087491

size_minibatch = 20000
Precon grad coeff: 0.025807, velocity coeff: 1.0776
norm(ch) = 0.81916
rho = 1.037
New lambda: 1.1393e-047
iter: 2225, Minibatch log likelihood (pre-update): -54.366, error rate (pre-update): 0.087488
iter: 2225, Minibatch log likelihood (post-update): -54.3659, error rate (post-update): 0.087464

size_minibatch = 20000
Precon grad coeff: 0.024485, velocity coeff: 0.94764
norm(ch) = 0.77871
iter: 2226, Minibatch log likelihood (pre-update): -54.3659, error rate (pre-update): 0.087464

size_minibatch = 20000
Precon grad coeff: 0.023297, velocity coeff: 0.96336
norm(ch) = 0.75237
iter: 2227, Minibatch log likelihood (pre-update): -54.3658, error rate (pre-update): 0.08745

size_minibatch = 20000
Precon grad coeff: 0.022867, velocity coeff: 1.0233
norm(ch) = 0.77216
iter: 2228, Minibatch log likelihood (pre-update): -54.3657, error rate (pre-update): 0.087443

size_minibatch = 20000
Precon grad coeff: 0.025366, velocity coeff: 1.0131
norm(ch) = 0.78454
iter: 2229, Minibatch log likelihood (pre-update): -54.3657, error rate (pre-update): 0.087439

size_minibatch = 20000
Precon grad coeff: 0.023571, velocity coeff: 0.9538
norm(ch) = 0.75065
rho = 1.017
New lambda: 8.8157e-048
iter: 2230, Minibatch log likelihood (pre-update): -54.3656, error rate (pre-update): 0.087424
iter: 2230, Minibatch log likelihood (post-update): -54.3655, error rate (post-update): 0.087409

size_minibatch = 20000
Precon grad coeff: 0.024088, velocity coeff: 1.0383
norm(ch) = 0.78173
iter: 2231, Minibatch log likelihood (pre-update): -54.3655, error rate (pre-update): 0.087409

size_minibatch = 20000
Precon grad coeff: 0.022797, velocity coeff: 0.93831
norm(ch) = 0.73572
iter: 2232, Minibatch log likelihood (pre-update): -54.3654, error rate (pre-update): 0.087391

size_minibatch = 20000
Precon grad coeff: 0.023825, velocity coeff: 1.0628
norm(ch) = 0.78418
iter: 2233, Minibatch log likelihood (pre-update): -54.3654, error rate (pre-update): 0.087382

size_minibatch = 20000
Precon grad coeff: 0.024623, velocity coeff: 0.96762
norm(ch) = 0.7611
iter: 2234, Minibatch log likelihood (pre-update): -54.3653, error rate (pre-update): 0.087372

size_minibatch = 20000
Precon grad coeff: 0.023886, velocity coeff: 1.0361
norm(ch) = 0.79077
rho = 1.0604
New lambda: 6.8215e-048
iter: 2235, Minibatch log likelihood (pre-update): -54.3652, error rate (pre-update): 0.087369
iter: 2235, Minibatch log likelihood (post-update): -54.3651, error rate (post-update): 0.087346

size_minibatch = 20000
Precon grad coeff: 0.023883, velocity coeff: 0.94218
norm(ch) = 0.74733
iter: 2236, Minibatch log likelihood (pre-update): -54.3651, error rate (pre-update): 0.087346

size_minibatch = 20000
Precon grad coeff: 0.021838, velocity coeff: 1.0054
norm(ch) = 0.75353
iter: 2237, Minibatch log likelihood (pre-update): -54.3651, error rate (pre-update): 0.087344

size_minibatch = 20000
Precon grad coeff: 0.023368, velocity coeff: 0.99131
norm(ch) = 0.7491
iter: 2238, Minibatch log likelihood (pre-update): -54.365, error rate (pre-update): 0.08733

size_minibatch = 20000
Precon grad coeff: 0.023093, velocity coeff: 1.0376
norm(ch) = 0.77934
iter: 2239, Minibatch log likelihood (pre-update): -54.3649, error rate (pre-update): 0.087308

size_minibatch = 20000
Precon grad coeff: 0.025222, velocity coeff: 0.97462
New gamma: 0.0031623
norm(ch) = 0.76224
rho = 0.99431
New lambda: 5.2783e-048
iter: 2240, Minibatch log likelihood (pre-update): -54.3648, error rate (pre-update): 0.087307
iter: 2240, Minibatch log likelihood (post-update): -54.3648, error rate (post-update): 0.087298

size_minibatch = 20000
Precon grad coeff: 0.024803, velocity coeff: 1.0192
norm(ch) = 0.77939
iter: 2241, Minibatch log likelihood (pre-update): -54.3648, error rate (pre-update): 0.087298

size_minibatch = 20000
Precon grad coeff: 0.023158, velocity coeff: 0.952
norm(ch) = 0.7443
iter: 2242, Minibatch log likelihood (pre-update): -54.3647, error rate (pre-update): 0.087278

size_minibatch = 20000
Precon grad coeff: 0.025308, velocity coeff: 1.0898
norm(ch) = 0.81361
iter: 2243, Minibatch log likelihood (pre-update): -54.3646, error rate (pre-update): 0.087269

size_minibatch = 20000
Precon grad coeff: 0.025689, velocity coeff: 0.96536
norm(ch) = 0.7879
iter: 2244, Minibatch log likelihood (pre-update): -54.3645, error rate (pre-update): 0.087259

size_minibatch = 20000
Precon grad coeff: 0.024768, velocity coeff: 1.0341
norm(ch) = 0.81722
rho = 1.0125
New lambda: 4.0843e-048
iter: 2245, Minibatch log likelihood (pre-update): -54.3645, error rate (pre-update): 0.087249
iter: 2245, Minibatch log likelihood (post-update): -54.3644, error rate (post-update): 0.087233

size_minibatch = 20000
Precon grad coeff: 0.025311, velocity coeff: 0.95166
norm(ch) = 0.78026
iter: 2246, Minibatch log likelihood (pre-update): -54.3644, error rate (pre-update): 0.087233

size_minibatch = 20000
Precon grad coeff: 0.02127, velocity coeff: 0.93192
norm(ch) = 0.72911
iter: 2247, Minibatch log likelihood (pre-update): -54.3643, error rate (pre-update): 0.087224

size_minibatch = 20000
Precon grad coeff: 0.023182, velocity coeff: 1.0617
norm(ch) = 0.7765
iter: 2248, Minibatch log likelihood (pre-update): -54.3642, error rate (pre-update): 0.087214

size_minibatch = 20000
Precon grad coeff: 0.026294, velocity coeff: 1.0276
norm(ch) = 0.8005
iter: 2249, Minibatch log likelihood (pre-update): -54.3642, error rate (pre-update): 0.087202

size_minibatch = 20000
Precon grad coeff: 0.024022, velocity coeff: 0.94756
norm(ch) = 0.76079
rho = 1.0628
New lambda: 3.1603e-048
iter: 2250, Minibatch log likelihood (pre-update): -54.3641, error rate (pre-update): 0.087193
iter: 2250, Minibatch log likelihood (post-update): -54.364, error rate (post-update): 0.087187
---
Full log-likelihood: -54.364, error rate: 0.087187
TEST log-likelihood: -54.8837, error rate: 0.29062
Error difference (test - train): 0.20343
---
Full log-likelihood (averaged params): -54.404, error rate (averaged params): 0.1009
TEST log-likelihood (averaged params): -54.8532, error rate (averaged params): 0.2831
Error difference (test - train) (averaged params): 0.18221

size_minibatch = 20000
Precon grad coeff: 0.023693, velocity coeff: 0.99539
norm(ch) = 0.75957
iter: 2251, Minibatch log likelihood (pre-update): -54.364, error rate (pre-update): 0.087187

size_minibatch = 20000
Precon grad coeff: 0.023099, velocity coeff: 0.98245
norm(ch) = 0.7484
iter: 2252, Minibatch log likelihood (pre-update): -54.3639, error rate (pre-update): 0.087155

size_minibatch = 20000
Precon grad coeff: 0.02457, velocity coeff: 1.0654
norm(ch) = 0.79986
iter: 2253, Minibatch log likelihood (pre-update): -54.3639, error rate (pre-update): 0.087152

size_minibatch = 20000
Precon grad coeff: 0.025345, velocity coeff: 0.95421
norm(ch) = 0.76572
iter: 2254, Minibatch log likelihood (pre-update): -54.3638, error rate (pre-update): 0.087148

size_minibatch = 20000
Precon grad coeff: 0.022506, velocity coeff: 1.0142
norm(ch) = 0.77867
rho = 1.0313
New lambda: 2.4454e-048
iter: 2255, Minibatch log likelihood (pre-update): -54.3637, error rate (pre-update): 0.087128
iter: 2255, Minibatch log likelihood (post-update): -54.3637, error rate (post-update): 0.087118

size_minibatch = 20000
Precon grad coeff: 0.023984, velocity coeff: 0.96043
norm(ch) = 0.75021
iter: 2256, Minibatch log likelihood (pre-update): -54.3637, error rate (pre-update): 0.087118

size_minibatch = 20000
Precon grad coeff: 0.022, velocity coeff: 0.99737
norm(ch) = 0.75026
iter: 2257, Minibatch log likelihood (pre-update): -54.3636, error rate (pre-update): 0.087107

size_minibatch = 20000
Precon grad coeff: 0.021933, velocity coeff: 0.9904
norm(ch) = 0.74512
iter: 2258, Minibatch log likelihood (pre-update): -54.3635, error rate (pre-update): 0.08709

size_minibatch = 20000
Precon grad coeff: 0.024614, velocity coeff: 1.0471
norm(ch) = 0.78257
iter: 2259, Minibatch log likelihood (pre-update): -54.3634, error rate (pre-update): 0.087089

size_minibatch = 20000
Precon grad coeff: 0.026625, velocity coeff: 0.99687
New gamma: 0.0031623
norm(ch) = 0.78284
rho = 1.0259
New lambda: 1.8922e-048
iter: 2260, Minibatch log likelihood (pre-update): -54.3634, error rate (pre-update): 0.087076
iter: 2260, Minibatch log likelihood (post-update): -54.3633, error rate (post-update): 0.087058

size_minibatch = 20000
Precon grad coeff: 0.025876, velocity coeff: 0.94541
norm(ch) = 0.7428
iter: 2261, Minibatch log likelihood (pre-update): -54.3633, error rate (pre-update): 0.087058

size_minibatch = 20000
Precon grad coeff: 0.02538, velocity coeff: 1.0661
norm(ch) = 0.79483
iter: 2262, Minibatch log likelihood (pre-update): -54.3632, error rate (pre-update): 0.087049

size_minibatch = 20000
Precon grad coeff: 0.024887, velocity coeff: 0.97367
norm(ch) = 0.7765
iter: 2263, Minibatch log likelihood (pre-update): -54.3631, error rate (pre-update): 0.087037

size_minibatch = 20000
Precon grad coeff: 0.023405, velocity coeff: 0.98947
norm(ch) = 0.77064
iter: 2264, Minibatch log likelihood (pre-update): -54.3631, error rate (pre-update): 0.087023

size_minibatch = 20000
Precon grad coeff: 0.023594, velocity coeff: 1.0281
norm(ch) = 0.79474
rho = 1.0317
New lambda: 1.4641e-048
iter: 2265, Minibatch log likelihood (pre-update): -54.363, error rate (pre-update): 0.08701
iter: 2265, Minibatch log likelihood (post-update): -54.3629, error rate (post-update): 0.086994

size_minibatch = 20000
Precon grad coeff: 0.023298, velocity coeff: 0.98326
norm(ch) = 0.78368
iter: 2266, Minibatch log likelihood (pre-update): -54.3629, error rate (pre-update): 0.086994

size_minibatch = 20000
Precon grad coeff: 0.024954, velocity coeff: 1.0083
norm(ch) = 0.79277
iter: 2267, Minibatch log likelihood (pre-update): -54.3628, error rate (pre-update): 0.086987

size_minibatch = 20000
Precon grad coeff: 0.02458, velocity coeff: 0.95729
norm(ch) = 0.76138
iter: 2268, Minibatch log likelihood (pre-update): -54.3628, error rate (pre-update): 0.086975

size_minibatch = 20000
Precon grad coeff: 0.023457, velocity coeff: 0.96961
norm(ch) = 0.74059
iter: 2269, Minibatch log likelihood (pre-update): -54.3627, error rate (pre-update): 0.086965

size_minibatch = 20000
Precon grad coeff: 0.026858, velocity coeff: 1.0878
norm(ch) = 0.80828
rho = 1.0274
New lambda: 1.1329e-048
iter: 2270, Minibatch log likelihood (pre-update): -54.3626, error rate (pre-update): 0.086949
iter: 2270, Minibatch log likelihood (post-update): -54.3625, error rate (post-update): 0.086932

size_minibatch = 20000
Precon grad coeff: 0.025893, velocity coeff: 0.94588
norm(ch) = 0.76697
iter: 2271, Minibatch log likelihood (pre-update): -54.3626, error rate (pre-update): 0.086932

size_minibatch = 20000
Precon grad coeff: 0.023639, velocity coeff: 0.9746
norm(ch) = 0.74987
iter: 2272, Minibatch log likelihood (pre-update): -54.3625, error rate (pre-update): 0.086916

size_minibatch = 20000
Precon grad coeff: 0.022276, velocity coeff: 0.9999
norm(ch) = 0.75196
iter: 2273, Minibatch log likelihood (pre-update): -54.3624, error rate (pre-update): 0.086922

size_minibatch = 20000
Precon grad coeff: 0.024578, velocity coeff: 1.0322
norm(ch) = 0.7784
iter: 2274, Minibatch log likelihood (pre-update): -54.3623, error rate (pre-update): 0.086906

size_minibatch = 20000
Precon grad coeff: 0.022521, velocity coeff: 0.94665
norm(ch) = 0.73909
rho = 1.0297
New lambda: 8.7664e-049
iter: 2275, Minibatch log likelihood (pre-update): -54.3623, error rate (pre-update): 0.086887
iter: 2275, Minibatch log likelihood (post-update): -54.3622, error rate (post-update): 0.086882

size_minibatch = 20000
Precon grad coeff: 0.022853, velocity coeff: 1.0193
norm(ch) = 0.75565
iter: 2276, Minibatch log likelihood (pre-update): -54.3622, error rate (pre-update): 0.086882

size_minibatch = 20000
Precon grad coeff: 0.023459, velocity coeff: 1.0175
norm(ch) = 0.77117
iter: 2277, Minibatch log likelihood (pre-update): -54.3621, error rate (pre-update): 0.086868

size_minibatch = 20000
Precon grad coeff: 0.025311, velocity coeff: 0.99996
norm(ch) = 0.77351
iter: 2278, Minibatch log likelihood (pre-update): -54.362, error rate (pre-update): 0.08685

size_minibatch = 20000
Precon grad coeff: 0.024371, velocity coeff: 0.96212
norm(ch) = 0.7463
iter: 2279, Minibatch log likelihood (pre-update): -54.362, error rate (pre-update): 0.086842

size_minibatch = 20000
Precon grad coeff: 0.025933, velocity coeff: 1.0298
New gamma: 0.0031623
norm(ch) = 0.77127
rho = 0.99174
New lambda: 6.7833e-049
iter: 2280, Minibatch log likelihood (pre-update): -54.3619, error rate (pre-update): 0.086832
iter: 2280, Minibatch log likelihood (post-update): -54.3618, error rate (post-update): 0.086822

size_minibatch = 20000
Precon grad coeff: 0.026633, velocity coeff: 0.9827
norm(ch) = 0.76085
iter: 2281, Minibatch log likelihood (pre-update): -54.3618, error rate (pre-update): 0.086822

size_minibatch = 20000
Precon grad coeff: 0.024011, velocity coeff: 0.97403
norm(ch) = 0.74362
iter: 2282, Minibatch log likelihood (pre-update): -54.3618, error rate (pre-update): 0.086803

size_minibatch = 20000
Precon grad coeff: 0.023764, velocity coeff: 1.0448
norm(ch) = 0.77926
iter: 2283, Minibatch log likelihood (pre-update): -54.3617, error rate (pre-update): 0.0868

size_minibatch = 20000
Precon grad coeff: 0.023561, velocity coeff: 0.98851
norm(ch) = 0.77268
iter: 2284, Minibatch log likelihood (pre-update): -54.3616, error rate (pre-update): 0.086789

size_minibatch = 20000
Precon grad coeff: 0.027367, velocity coeff: 1.0971
norm(ch) = 0.85037
rho = 1.014
New lambda: 5.2488e-049
iter: 2285, Minibatch log likelihood (pre-update): -54.3615, error rate (pre-update): 0.086767
iter: 2285, Minibatch log likelihood (post-update): -54.3615, error rate (post-update): 0.086754

size_minibatch = 20000
Precon grad coeff: 0.025478, velocity coeff: 0.91083
norm(ch) = 0.77702
iter: 2286, Minibatch log likelihood (pre-update): -54.3615, error rate (pre-update): 0.086754

size_minibatch = 20000
Precon grad coeff: 0.024112, velocity coeff: 0.969
norm(ch) = 0.75542
iter: 2287, Minibatch log likelihood (pre-update): -54.3614, error rate (pre-update): 0.086751

size_minibatch = 20000
Precon grad coeff: 0.023882, velocity coeff: 0.99905
norm(ch) = 0.7569
iter: 2288, Minibatch log likelihood (pre-update): -54.3613, error rate (pre-update): 0.086732

size_minibatch = 20000
Precon grad coeff: 0.024887, velocity coeff: 0.99594
norm(ch) = 0.75626
iter: 2289, Minibatch log likelihood (pre-update): -54.3612, error rate (pre-update): 0.086722

size_minibatch = 20000
Precon grad coeff: 0.024572, velocity coeff: 1.0124
norm(ch) = 0.76793
rho = 1.0075
New lambda: 4.0614e-049
iter: 2290, Minibatch log likelihood (pre-update): -54.3612, error rate (pre-update): 0.086714
iter: 2290, Minibatch log likelihood (post-update): -54.3611, error rate (post-update): 0.086697

size_minibatch = 20000
Precon grad coeff: 0.025016, velocity coeff: 0.97067
norm(ch) = 0.74793
iter: 2291, Minibatch log likelihood (pre-update): -54.3611, error rate (pre-update): 0.086697

size_minibatch = 20000
Precon grad coeff: 0.022643, velocity coeff: 0.98583
norm(ch) = 0.73947
iter: 2292, Minibatch log likelihood (pre-update): -54.361, error rate (pre-update): 0.086676

size_minibatch = 20000
Precon grad coeff: 0.02521, velocity coeff: 1.0497
norm(ch) = 0.77868
iter: 2293, Minibatch log likelihood (pre-update): -54.361, error rate (pre-update): 0.086676

size_minibatch = 20000
Precon grad coeff: 0.024269, velocity coeff: 0.97308
norm(ch) = 0.76
iter: 2294, Minibatch log likelihood (pre-update): -54.3609, error rate (pre-update): 0.086668

size_minibatch = 20000
Precon grad coeff: 0.02224, velocity coeff: 0.98677
norm(ch) = 0.75196
rho = 1.0302
New lambda: 3.1426e-049
iter: 2295, Minibatch log likelihood (pre-update): -54.3608, error rate (pre-update): 0.086655
iter: 2295, Minibatch log likelihood (post-update): -54.3607, error rate (post-update): 0.086639

size_minibatch = 20000
Precon grad coeff: 0.026612, velocity coeff: 1.0475
norm(ch) = 0.79014
iter: 2296, Minibatch log likelihood (pre-update): -54.3607, error rate (pre-update): 0.086639

size_minibatch = 20000
Precon grad coeff: 0.02363, velocity coeff: 0.95204
norm(ch) = 0.75443
iter: 2297, Minibatch log likelihood (pre-update): -54.3607, error rate (pre-update): 0.086628

size_minibatch = 20000
Precon grad coeff: 0.023263, velocity coeff: 0.94723
norm(ch) = 0.71682
iter: 2298, Minibatch log likelihood (pre-update): -54.3606, error rate (pre-update): 0.086615

size_minibatch = 20000
Precon grad coeff: 0.022029, velocity coeff: 1.0159
norm(ch) = 0.7302
iter: 2299, Minibatch log likelihood (pre-update): -54.3605, error rate (pre-update): 0.086605

size_minibatch = 20000
Precon grad coeff: 0.025813, velocity coeff: 1.068
New gamma: 0.0031623
norm(ch) = 0.78248
rho = 1.0438
New lambda: 2.4317e-049
iter: 2300, Minibatch log likelihood (pre-update): -54.3605, error rate (pre-update): 0.086599
iter: 2300, Minibatch log likelihood (post-update): -54.3604, error rate (post-update): 0.08658
---
Full log-likelihood: -54.3604, error rate: 0.08658
TEST log-likelihood: -54.9008, error rate: 0.29566
Error difference (test - train): 0.20908
---
Full log-likelihood (averaged params): -54.397, error rate (averaged params): 0.099261
TEST log-likelihood (averaged params): -54.8634, error rate (averaged params): 0.28631
Error difference (test - train) (averaged params): 0.18705

size_minibatch = 20000
Precon grad coeff: 0.025833, velocity coeff: 0.94399
norm(ch) = 0.74117
iter: 2301, Minibatch log likelihood (pre-update): -54.3604, error rate (pre-update): 0.08658

size_minibatch = 20000
Precon grad coeff: 0.022875, velocity coeff: 0.997
norm(ch) = 0.74122
iter: 2302, Minibatch log likelihood (pre-update): -54.3603, error rate (pre-update): 0.086572

size_minibatch = 20000
Precon grad coeff: 0.020375, velocity coeff: 0.94034
norm(ch) = 0.69891
iter: 2303, Minibatch log likelihood (pre-update): -54.3603, error rate (pre-update): 0.086562

size_minibatch = 20000
Precon grad coeff: 0.02422, velocity coeff: 1.1216
norm(ch) = 0.78638
iter: 2304, Minibatch log likelihood (pre-update): -54.3602, error rate (pre-update): 0.086548

size_minibatch = 20000
Precon grad coeff: 0.022743, velocity coeff: 0.94111
norm(ch) = 0.74213
rho = 1.0145
New lambda: 1.8816e-049
iter: 2305, Minibatch log likelihood (pre-update): -54.3601, error rate (pre-update): 0.08653
iter: 2305, Minibatch log likelihood (post-update): -54.36, error rate (post-update): 0.086527

size_minibatch = 20000
Precon grad coeff: 0.024368, velocity coeff: 1.0344
norm(ch) = 0.76996
iter: 2306, Minibatch log likelihood (pre-update): -54.36, error rate (pre-update): 0.086527

size_minibatch = 20000
Precon grad coeff: 0.023643, velocity coeff: 0.95935
norm(ch) = 0.74083
iter: 2307, Minibatch log likelihood (pre-update): -54.36, error rate (pre-update): 0.086522

size_minibatch = 20000
Precon grad coeff: 0.022449, velocity coeff: 0.96632
norm(ch) = 0.71803
iter: 2308, Minibatch log likelihood (pre-update): -54.3599, error rate (pre-update): 0.086508

size_minibatch = 20000
Precon grad coeff: 0.022135, velocity coeff: 0.99283
norm(ch) = 0.71506
iter: 2309, Minibatch log likelihood (pre-update): -54.3598, error rate (pre-update): 0.086486

size_minibatch = 20000
Precon grad coeff: 0.021495, velocity coeff: 0.99319
norm(ch) = 0.71229
rho = 0.96393
New lambda: 1.456e-049
iter: 2310, Minibatch log likelihood (pre-update): -54.3598, error rate (pre-update): 0.086481
iter: 2310, Minibatch log likelihood (post-update): -54.3597, error rate (post-update): 0.086472

size_minibatch = 20000
Precon grad coeff: 0.022833, velocity coeff: 1.0335
norm(ch) = 0.73813
iter: 2311, Minibatch log likelihood (pre-update): -54.3597, error rate (pre-update): 0.086472

size_minibatch = 20000
Precon grad coeff: 0.024647, velocity coeff: 1.0334
norm(ch) = 0.765
iter: 2312, Minibatch log likelihood (pre-update): -54.3596, error rate (pre-update): 0.086458

size_minibatch = 20000
Precon grad coeff: 0.021917, velocity coeff: 0.91346
norm(ch) = 0.70075
iter: 2313, Minibatch log likelihood (pre-update): -54.3596, error rate (pre-update): 0.086445

size_minibatch = 20000
Precon grad coeff: 0.022385, velocity coeff: 1.0789
norm(ch) = 0.75822
iter: 2314, Minibatch log likelihood (pre-update): -54.3595, error rate (pre-update): 0.08643

size_minibatch = 20000
Precon grad coeff: 0.023382, velocity coeff: 0.93952
norm(ch) = 0.71448
rho = 0.98047
New lambda: 1.1266e-049
iter: 2315, Minibatch log likelihood (pre-update): -54.3594, error rate (pre-update): 0.086422
iter: 2315, Minibatch log likelihood (post-update): -54.3594, error rate (post-update): 0.086417

size_minibatch = 20000
Precon grad coeff: 0.020931, velocity coeff: 1.0092
norm(ch) = 0.72293
iter: 2316, Minibatch log likelihood (pre-update): -54.3594, error rate (pre-update): 0.086417

size_minibatch = 20000
Precon grad coeff: 0.021966, velocity coeff: 0.9784
norm(ch) = 0.70919
iter: 2317, Minibatch log likelihood (pre-update): -54.3593, error rate (pre-update): 0.086403

size_minibatch = 20000
Precon grad coeff: 0.023239, velocity coeff: 1.065
norm(ch) = 0.75746
iter: 2318, Minibatch log likelihood (pre-update): -54.3592, error rate (pre-update): 0.086394

size_minibatch = 20000
Precon grad coeff: 0.022897, velocity coeff: 0.93204
norm(ch) = 0.70789
iter: 2319, Minibatch log likelihood (pre-update): -54.3592, error rate (pre-update): 0.086379

size_minibatch = 20000
Precon grad coeff: 0.023047, velocity coeff: 1.0204
New gamma: 0.0031623
norm(ch) = 0.7248
rho = 0.9687
New lambda: 8.7173e-050
iter: 2320, Minibatch log likelihood (pre-update): -54.3591, error rate (pre-update): 0.086373
iter: 2320, Minibatch log likelihood (post-update): -54.359, error rate (post-update): 0.086361

size_minibatch = 20000
Precon grad coeff: 0.023928, velocity coeff: 0.96787
norm(ch) = 0.70372
iter: 2321, Minibatch log likelihood (pre-update): -54.359, error rate (pre-update): 0.086361

size_minibatch = 20000
Precon grad coeff: 0.026812, velocity coeff: 1.107
norm(ch) = 0.78175
iter: 2322, Minibatch log likelihood (pre-update): -54.359, error rate (pre-update): 0.086345

size_minibatch = 20000
Precon grad coeff: 0.025915, velocity coeff: 0.96902
norm(ch) = 0.75994
iter: 2323, Minibatch log likelihood (pre-update): -54.3589, error rate (pre-update): 0.08633

size_minibatch = 20000
Precon grad coeff: 0.024449, velocity coeff: 0.99742
norm(ch) = 0.7602
iter: 2324, Minibatch log likelihood (pre-update): -54.3588, error rate (pre-update): 0.086323

size_minibatch = 20000
Precon grad coeff: 0.024718, velocity coeff: 1.0248
norm(ch) = 0.78142
rho = 0.99482
New lambda: 6.7453e-050
iter: 2325, Minibatch log likelihood (pre-update): -54.3587, error rate (pre-update): 0.086319
iter: 2325, Minibatch log likelihood (post-update): -54.3587, error rate (post-update): 0.086303

size_minibatch = 20000
Precon grad coeff: 0.022698, velocity coeff: 0.95217
norm(ch) = 0.74616
iter: 2326, Minibatch log likelihood (pre-update): -54.3587, error rate (pre-update): 0.086303

size_minibatch = 20000
Precon grad coeff: 0.025374, velocity coeff: 1.0611
norm(ch) = 0.79413
iter: 2327, Minibatch log likelihood (pre-update): -54.3586, error rate (pre-update): 0.086285

size_minibatch = 20000
Precon grad coeff: 0.023338, velocity coeff: 0.90776
norm(ch) = 0.72285
iter: 2328, Minibatch log likelihood (pre-update): -54.3585, error rate (pre-update): 0.086279

size_minibatch = 20000
Precon grad coeff: 0.020609, velocity coeff: 0.95971
norm(ch) = 0.69566
iter: 2329, Minibatch log likelihood (pre-update): -54.3585, error rate (pre-update): 0.086269

size_minibatch = 20000
Precon grad coeff: 0.023551, velocity coeff: 1.0235
norm(ch) = 0.71421
rho = 1.0124
New lambda: 5.2194e-050
iter: 2330, Minibatch log likelihood (pre-update): -54.3584, error rate (pre-update): 0.086249
iter: 2330, Minibatch log likelihood (post-update): -54.3583, error rate (post-update): 0.086238

size_minibatch = 20000
Precon grad coeff: 0.024137, velocity coeff: 1.0638
norm(ch) = 0.76195
iter: 2331, Minibatch log likelihood (pre-update): -54.3583, error rate (pre-update): 0.086238

size_minibatch = 20000
Precon grad coeff: 0.022596, velocity coeff: 0.90219
norm(ch) = 0.68931
iter: 2332, Minibatch log likelihood (pre-update): -54.3583, error rate (pre-update): 0.08623

size_minibatch = 20000
Precon grad coeff: 0.025498, velocity coeff: 1.1284
norm(ch) = 0.7802
iter: 2333, Minibatch log likelihood (pre-update): -54.3582, error rate (pre-update): 0.086222

size_minibatch = 20000
Precon grad coeff: 0.022725, velocity coeff: 0.91993
norm(ch) = 0.71968
iter: 2334, Minibatch log likelihood (pre-update): -54.3581, error rate (pre-update): 0.086208

size_minibatch = 20000
Precon grad coeff: 0.022422, velocity coeff: 1.0087
norm(ch) = 0.72799
rho = 0.99643
New lambda: 4.0387e-050
iter: 2335, Minibatch log likelihood (pre-update): -54.3581, error rate (pre-update): 0.086199
iter: 2335, Minibatch log likelihood (post-update): -54.358, error rate (post-update): 0.086184

size_minibatch = 20000
Precon grad coeff: 0.024788, velocity coeff: 1.0492
norm(ch) = 0.7661
iter: 2336, Minibatch log likelihood (pre-update): -54.358, error rate (pre-update): 0.086184

size_minibatch = 20000
Precon grad coeff: 0.024612, velocity coeff: 0.99197
norm(ch) = 0.7621
iter: 2337, Minibatch log likelihood (pre-update): -54.3579, error rate (pre-update): 0.086163

size_minibatch = 20000
Precon grad coeff: 0.022865, velocity coeff: 0.93415
norm(ch) = 0.71382
iter: 2338, Minibatch log likelihood (pre-update): -54.3578, error rate (pre-update): 0.086171

size_minibatch = 20000
Precon grad coeff: 0.024292, velocity coeff: 1.0559
norm(ch) = 0.75585
iter: 2339, Minibatch log likelihood (pre-update): -54.3578, error rate (pre-update): 0.086153

size_minibatch = 20000
Precon grad coeff: 0.022883, velocity coeff: 0.89817
New gamma: 0.0031623
norm(ch) = 0.68102
rho = 1.0663
New lambda: 3.125e-050
iter: 2340, Minibatch log likelihood (pre-update): -54.3577, error rate (pre-update): 0.086134
iter: 2340, Minibatch log likelihood (post-update): -54.3576, error rate (post-update): 0.086127

size_minibatch = 20000
Precon grad coeff: 0.022064, velocity coeff: 1.0406
norm(ch) = 0.71078
iter: 2341, Minibatch log likelihood (pre-update): -54.3576, error rate (pre-update): 0.086127

size_minibatch = 20000
Precon grad coeff: 0.023655, velocity coeff: 1.0105
norm(ch) = 0.72054
iter: 2342, Minibatch log likelihood (pre-update): -54.3576, error rate (pre-update): 0.086112

size_minibatch = 20000
Precon grad coeff: 0.02223, velocity coeff: 1.0026
norm(ch) = 0.72435
iter: 2343, Minibatch log likelihood (pre-update): -54.3575, error rate (pre-update): 0.086103

size_minibatch = 20000
Precon grad coeff: 0.022273, velocity coeff: 0.99647
norm(ch) = 0.72387
iter: 2344, Minibatch log likelihood (pre-update): -54.3574, error rate (pre-update): 0.086092

size_minibatch = 20000
Precon grad coeff: 0.023914, velocity coeff: 1.0547
norm(ch) = 0.76572
rho = 1.0229
New lambda: 2.4181e-050
iter: 2345, Minibatch log likelihood (pre-update): -54.3574, error rate (pre-update): 0.086083
iter: 2345, Minibatch log likelihood (post-update): -54.3573, error rate (post-update): 0.086075

size_minibatch = 20000
Precon grad coeff: 0.025258, velocity coeff: 0.9881
norm(ch) = 0.75907
iter: 2346, Minibatch log likelihood (pre-update): -54.3573, error rate (pre-update): 0.086075

size_minibatch = 20000
Precon grad coeff: 0.024108, velocity coeff: 0.98148
norm(ch) = 0.74707
iter: 2347, Minibatch log likelihood (pre-update): -54.3572, error rate (pre-update): 0.086055

size_minibatch = 20000
Precon grad coeff: 0.023271, velocity coeff: 0.98066
norm(ch) = 0.73468
iter: 2348, Minibatch log likelihood (pre-update): -54.3572, error rate (pre-update): 0.08604

size_minibatch = 20000
Precon grad coeff: 0.024522, velocity coeff: 0.98502
norm(ch) = 0.72587
iter: 2349, Minibatch log likelihood (pre-update): -54.3571, error rate (pre-update): 0.086036

size_minibatch = 20000
Precon grad coeff: 0.020697, velocity coeff: 0.91266
norm(ch) = 0.66444
rho = 0.99716
New lambda: 1.8711e-050
iter: 2350, Minibatch log likelihood (pre-update): -54.357, error rate (pre-update): 0.08602
iter: 2350, Minibatch log likelihood (post-update): -54.357, error rate (post-update): 0.086006
---
Full log-likelihood: -54.357, error rate: 0.086006
TEST log-likelihood: -54.9177, error rate: 0.30023
Error difference (test - train): 0.21422
---
Full log-likelihood (averaged params): -54.3906, error rate (averaged params): 0.097787
TEST log-likelihood (averaged params): -54.8753, error rate (averaged params): 0.2899
Error difference (test - train) (averaged params): 0.19211

size_minibatch = 20000
Precon grad coeff: 0.021036, velocity coeff: 1.0588
norm(ch) = 0.70541
iter: 2351, Minibatch log likelihood (pre-update): -54.357, error rate (pre-update): 0.086006

size_minibatch = 20000
Precon grad coeff: 0.02408, velocity coeff: 1.0865
norm(ch) = 0.76851
iter: 2352, Minibatch log likelihood (pre-update): -54.3569, error rate (pre-update): 0.085995

size_minibatch = 20000
Precon grad coeff: 0.024826, velocity coeff: 0.93026
norm(ch) = 0.71718
iter: 2353, Minibatch log likelihood (pre-update): -54.3568, error rate (pre-update): 0.085989

size_minibatch = 20000
Precon grad coeff: 0.022335, velocity coeff: 1.0264
norm(ch) = 0.73821
iter: 2354, Minibatch log likelihood (pre-update): -54.3568, error rate (pre-update): 0.085977

size_minibatch = 20000
Precon grad coeff: 0.023536, velocity coeff: 0.98878
norm(ch) = 0.73197
rho = 0.99489
New lambda: 1.4478e-050
iter: 2355, Minibatch log likelihood (pre-update): -54.3567, error rate (pre-update): 0.085962
iter: 2355, Minibatch log likelihood (post-update): -54.3566, error rate (post-update): 0.085948

size_minibatch = 20000
Precon grad coeff: 0.024326, velocity coeff: 0.99435
norm(ch) = 0.72991
iter: 2356, Minibatch log likelihood (pre-update): -54.3566, error rate (pre-update): 0.085948

size_minibatch = 20000
Precon grad coeff: 0.024075, velocity coeff: 1.0224
norm(ch) = 0.74828
iter: 2357, Minibatch log likelihood (pre-update): -54.3566, error rate (pre-update): 0.085936

size_minibatch = 20000
Precon grad coeff: 0.019694, velocity coeff: 0.86614
norm(ch) = 0.64977
iter: 2358, Minibatch log likelihood (pre-update): -54.3565, error rate (pre-update): 0.085923

size_minibatch = 20000
Precon grad coeff: 0.022156, velocity coeff: 1.1065
norm(ch) = 0.72093
iter: 2359, Minibatch log likelihood (pre-update): -54.3564, error rate (pre-update): 0.085915

size_minibatch = 20000
Precon grad coeff: 0.022591, velocity coeff: 0.95808
New gamma: 0.0031623
norm(ch) = 0.69288
rho = 1.0095
New lambda: 1.1203e-050
iter: 2360, Minibatch log likelihood (pre-update): -54.3564, error rate (pre-update): 0.085901
iter: 2360, Minibatch log likelihood (post-update): -54.3563, error rate (post-update): 0.085891

size_minibatch = 20000
Precon grad coeff: 0.023153, velocity coeff: 1.042
norm(ch) = 0.72422
iter: 2361, Minibatch log likelihood (pre-update): -54.3563, error rate (pre-update): 0.085891

size_minibatch = 20000
Precon grad coeff: 0.023531, velocity coeff: 0.97647
norm(ch) = 0.70922
iter: 2362, Minibatch log likelihood (pre-update): -54.3562, error rate (pre-update): 0.085881

size_minibatch = 20000
Precon grad coeff: 0.023717, velocity coeff: 1.0766
norm(ch) = 0.7657
iter: 2363, Minibatch log likelihood (pre-update): -54.3562, error rate (pre-update): 0.085868

size_minibatch = 20000
Precon grad coeff: 0.027292, velocity coeff: 1.0114
norm(ch) = 0.7769
iter: 2364, Minibatch log likelihood (pre-update): -54.3561, error rate (pre-update): 0.085856

size_minibatch = 20000
Precon grad coeff: 0.026565, velocity coeff: 1.0148
norm(ch) = 0.79092
rho = 1.0665
New lambda: 8.6685e-051
iter: 2365, Minibatch log likelihood (pre-update): -54.356, error rate (pre-update): 0.085845
iter: 2365, Minibatch log likelihood (post-update): -54.356, error rate (post-update): 0.08583

size_minibatch = 20000
Precon grad coeff: 0.025537, velocity coeff: 0.94156
norm(ch) = 0.7471
iter: 2366, Minibatch log likelihood (pre-update): -54.356, error rate (pre-update): 0.08583

size_minibatch = 20000
Precon grad coeff: 0.022649, velocity coeff: 0.9588
norm(ch) = 0.71826
iter: 2367, Minibatch log likelihood (pre-update): -54.3559, error rate (pre-update): 0.085812

size_minibatch = 20000
Precon grad coeff: 0.021031, velocity coeff: 0.93763
norm(ch) = 0.67541
iter: 2368, Minibatch log likelihood (pre-update): -54.3558, error rate (pre-update): 0.085798

size_minibatch = 20000
Precon grad coeff: 0.023616, velocity coeff: 1.1109
norm(ch) = 0.75241
iter: 2369, Minibatch log likelihood (pre-update): -54.3558, error rate (pre-update): 0.085794

size_minibatch = 20000
Precon grad coeff: 0.021636, velocity coeff: 0.89409
norm(ch) = 0.67457
rho = 1.0072
New lambda: 6.7075e-051
iter: 2370, Minibatch log likelihood (pre-update): -54.3557, error rate (pre-update): 0.085781
iter: 2370, Minibatch log likelihood (post-update): -54.3556, error rate (post-update): 0.085763

size_minibatch = 20000
Precon grad coeff: 0.022957, velocity coeff: 1.0717
norm(ch) = 0.72493
iter: 2371, Minibatch log likelihood (pre-update): -54.3556, error rate (pre-update): 0.085763

size_minibatch = 20000
Precon grad coeff: 0.023849, velocity coeff: 1.0253
norm(ch) = 0.74536
iter: 2372, Minibatch log likelihood (pre-update): -54.3556, error rate (pre-update): 0.085755

size_minibatch = 20000
Precon grad coeff: 0.025354, velocity coeff: 0.98884
norm(ch) = 0.73914
iter: 2373, Minibatch log likelihood (pre-update): -54.3555, error rate (pre-update): 0.085747

size_minibatch = 20000
Precon grad coeff: 0.025161, velocity coeff: 1.0245
norm(ch) = 0.75949
iter: 2374, Minibatch log likelihood (pre-update): -54.3554, error rate (pre-update): 0.085728

size_minibatch = 20000
Precon grad coeff: 0.023163, velocity coeff: 0.92515
norm(ch) = 0.70463
rho = 1.0275
New lambda: 5.1902e-051
iter: 2375, Minibatch log likelihood (pre-update): -54.3554, error rate (pre-update): 0.085717
iter: 2375, Minibatch log likelihood (post-update): -54.3553, error rate (post-update): 0.085704

size_minibatch = 20000
Precon grad coeff: 0.023235, velocity coeff: 1.0283
norm(ch) = 0.72654
iter: 2376, Minibatch log likelihood (pre-update): -54.3553, error rate (pre-update): 0.085704

size_minibatch = 20000
Precon grad coeff: 0.02499, velocity coeff: 1.0223
norm(ch) = 0.74498
iter: 2377, Minibatch log likelihood (pre-update): -54.3552, error rate (pre-update): 0.085696

size_minibatch = 20000
Precon grad coeff: 0.020391, velocity coeff: 0.89664
norm(ch) = 0.66971
iter: 2378, Minibatch log likelihood (pre-update): -54.3552, error rate (pre-update): 0.085685

size_minibatch = 20000
Precon grad coeff: 0.02038, velocity coeff: 1.0023
norm(ch) = 0.6729
iter: 2379, Minibatch log likelihood (pre-update): -54.3551, error rate (pre-update): 0.08567

size_minibatch = 20000
Precon grad coeff: 0.025384, velocity coeff: 1.0966
New gamma: 0.0031623
norm(ch) = 0.74045
rho = 1.0129
New lambda: 4.0161e-051
iter: 2380, Minibatch log likelihood (pre-update): -54.355, error rate (pre-update): 0.08566
iter: 2380, Minibatch log likelihood (post-update): -54.355, error rate (post-update): 0.08565

size_minibatch = 20000
Precon grad coeff: 0.02554, velocity coeff: 0.9729
norm(ch) = 0.72288
iter: 2381, Minibatch log likelihood (pre-update): -54.355, error rate (pre-update): 0.08565

size_minibatch = 20000
Precon grad coeff: 0.025897, velocity coeff: 1.0234
norm(ch) = 0.74231
iter: 2382, Minibatch log likelihood (pre-update): -54.3549, error rate (pre-update): 0.085631

size_minibatch = 20000
Precon grad coeff: 0.025615, velocity coeff: 1.0111
norm(ch) = 0.75272
iter: 2383, Minibatch log likelihood (pre-update): -54.3548, error rate (pre-update): 0.085621

size_minibatch = 20000
Precon grad coeff: 0.025176, velocity coeff: 0.98015
norm(ch) = 0.74019
iter: 2384, Minibatch log likelihood (pre-update): -54.3548, error rate (pre-update): 0.085607

size_minibatch = 20000
Precon grad coeff: 0.023624, velocity coeff: 1.0146
norm(ch) = 0.75331
rho = 1.0188
New lambda: 3.1075e-051
iter: 2385, Minibatch log likelihood (pre-update): -54.3547, error rate (pre-update): 0.085597
iter: 2385, Minibatch log likelihood (post-update): -54.3546, error rate (post-update): 0.085597

size_minibatch = 20000
Precon grad coeff: 0.026476, velocity coeff: 1.0409
norm(ch) = 0.78652
iter: 2386, Minibatch log likelihood (pre-update): -54.3546, error rate (pre-update): 0.085597

size_minibatch = 20000
Precon grad coeff: 0.02458, velocity coeff: 0.92624
norm(ch) = 0.73067
iter: 2387, Minibatch log likelihood (pre-update): -54.3546, error rate (pre-update): 0.085577

size_minibatch = 20000
Precon grad coeff: 0.022579, velocity coeff: 0.94453
norm(ch) = 0.6923
iter: 2388, Minibatch log likelihood (pre-update): -54.3545, error rate (pre-update): 0.08556

size_minibatch = 20000
Precon grad coeff: 0.022663, velocity coeff: 1.0312
norm(ch) = 0.7159
iter: 2389, Minibatch log likelihood (pre-update): -54.3544, error rate (pre-update): 0.085551

size_minibatch = 20000
Precon grad coeff: 0.022853, velocity coeff: 0.9754
norm(ch) = 0.70032
rho = 0.97174
New lambda: 2.4046e-051
iter: 2390, Minibatch log likelihood (pre-update): -54.3544, error rate (pre-update): 0.085538
iter: 2390, Minibatch log likelihood (post-update): -54.3543, error rate (post-update): 0.085523

size_minibatch = 20000
Precon grad coeff: 0.024038, velocity coeff: 1.0211
norm(ch) = 0.71723
iter: 2391, Minibatch log likelihood (pre-update): -54.3543, error rate (pre-update): 0.085523

size_minibatch = 20000
Precon grad coeff: 0.025887, velocity coeff: 1.073
norm(ch) = 0.77193
iter: 2392, Minibatch log likelihood (pre-update): -54.3542, error rate (pre-update): 0.08552

size_minibatch = 20000
Precon grad coeff: 0.023968, velocity coeff: 0.90653
norm(ch) = 0.70184
iter: 2393, Minibatch log likelihood (pre-update): -54.3542, error rate (pre-update): 0.085504

size_minibatch = 20000
Precon grad coeff: 0.023848, velocity coeff: 1.0416
norm(ch) = 0.73312
iter: 2394, Minibatch log likelihood (pre-update): -54.3541, error rate (pre-update): 0.085487

size_minibatch = 20000
Precon grad coeff: 0.024361, velocity coeff: 1.0051
norm(ch) = 0.73904
rho = 1.0205
New lambda: 1.8606e-051
iter: 2395, Minibatch log likelihood (pre-update): -54.354, error rate (pre-update): 0.08547
iter: 2395, Minibatch log likelihood (post-update): -54.354, error rate (post-update): 0.085465

size_minibatch = 20000
Precon grad coeff: 0.025456, velocity coeff: 1.0119
norm(ch) = 0.75
iter: 2396, Minibatch log likelihood (pre-update): -54.354, error rate (pre-update): 0.085465

size_minibatch = 20000
Precon grad coeff: 0.025244, velocity coeff: 0.97269
norm(ch) = 0.73165
iter: 2397, Minibatch log likelihood (pre-update): -54.3539, error rate (pre-update): 0.085463

size_minibatch = 20000
Precon grad coeff: 0.024171, velocity coeff: 0.99521
norm(ch) = 0.73021
iter: 2398, Minibatch log likelihood (pre-update): -54.3538, error rate (pre-update): 0.085437

size_minibatch = 20000
Precon grad coeff: 0.022994, velocity coeff: 0.95341
norm(ch) = 0.69818
iter: 2399, Minibatch log likelihood (pre-update): -54.3538, error rate (pre-update): 0.085432

size_minibatch = 20000
Precon grad coeff: 0.025007, velocity coeff: 1.0386
New gamma: 0.0031623
norm(ch) = 0.72749
rho = 0.97304
New lambda: 1.4397e-051
iter: 2400, Minibatch log likelihood (pre-update): -54.3537, error rate (pre-update): 0.085423
iter: 2400, Minibatch log likelihood (post-update): -54.3537, error rate (post-update): 0.085406
---
Full log-likelihood: -54.3537, error rate: 0.085406
TEST log-likelihood: -54.9383, error rate: 0.30569
Error difference (test - train): 0.22028
---
Full log-likelihood (averaged params): -54.3845, error rate (averaged params): 0.096346
TEST log-likelihood (averaged params): -54.8889, error rate (averaged params): 0.29384
Error difference (test - train) (averaged params): 0.19749

size_minibatch = 20000
Precon grad coeff: 0.023619, velocity coeff: 0.93138
norm(ch) = 0.67977
iter: 2401, Minibatch log likelihood (pre-update): -54.3537, error rate (pre-update): 0.085406

size_minibatch = 20000
Precon grad coeff: 0.022998, velocity coeff: 1.0257
norm(ch) = 0.69941
iter: 2402, Minibatch log likelihood (pre-update): -54.3536, error rate (pre-update): 0.085398

size_minibatch = 20000
Precon grad coeff: 0.024462, velocity coeff: 1.0673
norm(ch) = 0.74869
iter: 2403, Minibatch log likelihood (pre-update): -54.3535, error rate (pre-update): 0.085389

size_minibatch = 20000
Precon grad coeff: 0.024786, velocity coeff: 0.96631
norm(ch) = 0.72568
iter: 2404, Minibatch log likelihood (pre-update): -54.3535, error rate (pre-update): 0.085374

size_minibatch = 20000
Precon grad coeff: 0.023253, velocity coeff: 1.0188
norm(ch) = 0.74146
rho = 1.0229
New lambda: 1.114e-051
iter: 2405, Minibatch log likelihood (pre-update): -54.3534, error rate (pre-update): 0.08536
iter: 2405, Minibatch log likelihood (post-update): -54.3533, error rate (post-update): 0.085348

size_minibatch = 20000
Precon grad coeff: 0.024207, velocity coeff: 0.98477
norm(ch) = 0.73224
iter: 2406, Minibatch log likelihood (pre-update): -54.3533, error rate (pre-update): 0.085348

size_minibatch = 20000
Precon grad coeff: 0.025575, velocity coeff: 1.0341
norm(ch) = 0.75955
iter: 2407, Minibatch log likelihood (pre-update): -54.3533, error rate (pre-update): 0.085343

size_minibatch = 20000
Precon grad coeff: 0.02398, velocity coeff: 0.93269
norm(ch) = 0.71053
iter: 2408, Minibatch log likelihood (pre-update): -54.3532, error rate (pre-update): 0.085324

size_minibatch = 20000
Precon grad coeff: 0.02514, velocity coeff: 1.0311
norm(ch) = 0.73467
iter: 2409, Minibatch log likelihood (pre-update): -54.3531, error rate (pre-update): 0.085321

size_minibatch = 20000
Precon grad coeff: 0.024449, velocity coeff: 0.9746
norm(ch) = 0.71805
rho = 1.0718
New lambda: 8.62e-052
iter: 2410, Minibatch log likelihood (pre-update): -54.3531, error rate (pre-update): 0.085309
iter: 2410, Minibatch log likelihood (post-update): -54.353, error rate (post-update): 0.085289

size_minibatch = 20000
Precon grad coeff: 0.025306, velocity coeff: 1.0195
norm(ch) = 0.73432
iter: 2411, Minibatch log likelihood (pre-update): -54.353, error rate (pre-update): 0.085289

size_minibatch = 20000
Precon grad coeff: 0.024696, velocity coeff: 0.96961
norm(ch) = 0.71424
iter: 2412, Minibatch log likelihood (pre-update): -54.3529, error rate (pre-update): 0.085283

size_minibatch = 20000
Precon grad coeff: 0.022701, velocity coeff: 0.98516
norm(ch) = 0.70543
iter: 2413, Minibatch log likelihood (pre-update): -54.3529, error rate (pre-update): 0.085271

size_minibatch = 20000
Precon grad coeff: 0.026743, velocity coeff: 1.088
norm(ch) = 0.76986
iter: 2414, Minibatch log likelihood (pre-update): -54.3528, error rate (pre-update): 0.085265

size_minibatch = 20000
Precon grad coeff: 0.024999, velocity coeff: 0.95891
norm(ch) = 0.74034
rho = 1.0138
New lambda: 6.67e-052
iter: 2415, Minibatch log likelihood (pre-update): -54.3527, error rate (pre-update): 0.08525
iter: 2415, Minibatch log likelihood (post-update): -54.3527, error rate (post-update): 0.085233

size_minibatch = 20000
Precon grad coeff: 0.024608, velocity coeff: 0.9776
norm(ch) = 0.72568
iter: 2416, Minibatch log likelihood (pre-update): -54.3527, error rate (pre-update): 0.085233

size_minibatch = 20000
Precon grad coeff: 0.022458, velocity coeff: 0.95242
norm(ch) = 0.69304
iter: 2417, Minibatch log likelihood (pre-update): -54.3526, error rate (pre-update): 0.085227

size_minibatch = 20000
Precon grad coeff: 0.023914, velocity coeff: 1.0329
norm(ch) = 0.71778
iter: 2418, Minibatch log likelihood (pre-update): -54.3525, error rate (pre-update): 0.085218

size_minibatch = 20000
Precon grad coeff: 0.02579, velocity coeff: 1.0414
norm(ch) = 0.74959
iter: 2419, Minibatch log likelihood (pre-update): -54.3525, error rate (pre-update): 0.08521

size_minibatch = 20000
Precon grad coeff: 0.026109, velocity coeff: 0.9617
New gamma: 0.0031623
norm(ch) = 0.72314
rho = 1.0127
New lambda: 5.1611e-052
iter: 2420, Minibatch log likelihood (pre-update): -54.3524, error rate (pre-update): 0.085198
iter: 2420, Minibatch log likelihood (post-update): -54.3523, error rate (post-update): 0.085179

size_minibatch = 20000
Precon grad coeff: 0.024489, velocity coeff: 0.98101
norm(ch) = 0.71161
iter: 2421, Minibatch log likelihood (pre-update): -54.3523, error rate (pre-update): 0.085179

size_minibatch = 20000
Precon grad coeff: 0.021222, velocity coeff: 0.95544
norm(ch) = 0.68175
iter: 2422, Minibatch log likelihood (pre-update): -54.3523, error rate (pre-update): 0.085168

size_minibatch = 20000
Precon grad coeff: 0.025144, velocity coeff: 1.0892
norm(ch) = 0.74474
iter: 2423, Minibatch log likelihood (pre-update): -54.3522, error rate (pre-update): 0.085157

size_minibatch = 20000
Precon grad coeff: 0.023122, velocity coeff: 0.94289
norm(ch) = 0.7042
iter: 2424, Minibatch log likelihood (pre-update): -54.3522, error rate (pre-update): 0.08515

size_minibatch = 20000
Precon grad coeff: 0.022632, velocity coeff: 1.0005
norm(ch) = 0.70651
rho = 1.0145
New lambda: 3.9936e-052
iter: 2425, Minibatch log likelihood (pre-update): -54.3521, error rate (pre-update): 0.085142
iter: 2425, Minibatch log likelihood (post-update): -54.352, error rate (post-update): 0.085132

size_minibatch = 20000
Precon grad coeff: 0.024602, velocity coeff: 1.0333
norm(ch) = 0.73221
iter: 2426, Minibatch log likelihood (pre-update): -54.352, error rate (pre-update): 0.085132

size_minibatch = 20000
Precon grad coeff: 0.024822, velocity coeff: 0.9869
norm(ch) = 0.7247
iter: 2427, Minibatch log likelihood (pre-update): -54.352, error rate (pre-update): 0.085115

size_minibatch = 20000
Precon grad coeff: 0.024389, velocity coeff: 0.98104
norm(ch) = 0.71305
iter: 2428, Minibatch log likelihood (pre-update): -54.3519, error rate (pre-update): 0.085109

size_minibatch = 20000
Precon grad coeff: 0.024826, velocity coeff: 1.0091
norm(ch) = 0.72171
iter: 2429, Minibatch log likelihood (pre-update): -54.3518, error rate (pre-update): 0.085108

size_minibatch = 20000
Precon grad coeff: 0.026211, velocity coeff: 1.039
norm(ch) = 0.75237
rho = 1.0269
New lambda: 3.0902e-052
iter: 2430, Minibatch log likelihood (pre-update): -54.3518, error rate (pre-update): 0.085088
iter: 2430, Minibatch log likelihood (post-update): -54.3517, error rate (post-update): 0.085072

size_minibatch = 20000
Precon grad coeff: 0.024217, velocity coeff: 0.94068
norm(ch) = 0.70973
iter: 2431, Minibatch log likelihood (pre-update): -54.3517, error rate (pre-update): 0.085072

size_minibatch = 20000
Precon grad coeff: 0.02196, velocity coeff: 0.96658
norm(ch) = 0.68779
iter: 2432, Minibatch log likelihood (pre-update): -54.3516, error rate (pre-update): 0.085063

size_minibatch = 20000
Precon grad coeff: 0.024794, velocity coeff: 1.0343
norm(ch) = 0.71342
iter: 2433, Minibatch log likelihood (pre-update): -54.3516, error rate (pre-update): 0.085053

size_minibatch = 20000
Precon grad coeff: 0.021442, velocity coeff: 0.94312
norm(ch) = 0.67484
iter: 2434, Minibatch log likelihood (pre-update): -54.3515, error rate (pre-update): 0.085047

size_minibatch = 20000
Precon grad coeff: 0.022438, velocity coeff: 1.0393
norm(ch) = 0.70319
rho = 1.0014
New lambda: 2.3911e-052
iter: 2435, Minibatch log likelihood (pre-update): -54.3515, error rate (pre-update): 0.085041
iter: 2435, Minibatch log likelihood (post-update): -54.3514, error rate (post-update): 0.085025

size_minibatch = 20000
Precon grad coeff: 0.022828, velocity coeff: 0.97171
norm(ch) = 0.68518
iter: 2436, Minibatch log likelihood (pre-update): -54.3514, error rate (pre-update): 0.085025

size_minibatch = 20000
Precon grad coeff: 0.023259, velocity coeff: 1.028
norm(ch) = 0.70629
iter: 2437, Minibatch log likelihood (pre-update): -54.3513, error rate (pre-update): 0.085015

size_minibatch = 20000
Precon grad coeff: 0.024627, velocity coeff: 1.0283
norm(ch) = 0.7283
iter: 2438, Minibatch log likelihood (pre-update): -54.3513, error rate (pre-update): 0.084998

size_minibatch = 20000
Precon grad coeff: 0.023902, velocity coeff: 0.95418
norm(ch) = 0.69686
iter: 2439, Minibatch log likelihood (pre-update): -54.3512, error rate (pre-update): 0.08499

size_minibatch = 20000
Precon grad coeff: 0.023371, velocity coeff: 0.96551
New gamma: 0.0031623
norm(ch) = 0.67492
rho = 1.011
New lambda: 1.8502e-052
iter: 2440, Minibatch log likelihood (pre-update): -54.3511, error rate (pre-update): 0.084987
iter: 2440, Minibatch log likelihood (post-update): -54.3511, error rate (post-update): 0.084979

size_minibatch = 20000
Precon grad coeff: 0.026587, velocity coeff: 1.0975
norm(ch) = 0.74316
iter: 2441, Minibatch log likelihood (pre-update): -54.3511, error rate (pre-update): 0.084979

size_minibatch = 20000
Precon grad coeff: 0.02575, velocity coeff: 0.94243
norm(ch) = 0.70248
iter: 2442, Minibatch log likelihood (pre-update): -54.351, error rate (pre-update): 0.084966

size_minibatch = 20000
Precon grad coeff: 0.02215, velocity coeff: 0.98643
norm(ch) = 0.69496
iter: 2443, Minibatch log likelihood (pre-update): -54.351, error rate (pre-update): 0.084949

size_minibatch = 20000
Precon grad coeff: 0.024114, velocity coeff: 1.0179
norm(ch) = 0.70948
iter: 2444, Minibatch log likelihood (pre-update): -54.3509, error rate (pre-update): 0.084937

size_minibatch = 20000
Precon grad coeff: 0.023472, velocity coeff: 1.0364
norm(ch) = 0.73762
rho = 1.0143
New lambda: 1.4316e-052
iter: 2445, Minibatch log likelihood (pre-update): -54.3508, error rate (pre-update): 0.084933
iter: 2445, Minibatch log likelihood (post-update): -54.3508, error rate (post-update): 0.084932

size_minibatch = 20000
Precon grad coeff: 0.024449, velocity coeff: 0.96304
norm(ch) = 0.71229
iter: 2446, Minibatch log likelihood (pre-update): -54.3508, error rate (pre-update): 0.084932

size_minibatch = 20000
Precon grad coeff: 0.023098, velocity coeff: 0.97605
norm(ch) = 0.69715
iter: 2447, Minibatch log likelihood (pre-update): -54.3507, error rate (pre-update): 0.084906

size_minibatch = 20000
Precon grad coeff: 0.022855, velocity coeff: 0.98293
norm(ch) = 0.68712
iter: 2448, Minibatch log likelihood (pre-update): -54.3507, error rate (pre-update): 0.084901

size_minibatch = 20000
Precon grad coeff: 0.024043, velocity coeff: 1.0179
norm(ch) = 0.70123
iter: 2449, Minibatch log likelihood (pre-update): -54.3506, error rate (pre-update): 0.084895

size_minibatch = 20000
Precon grad coeff: 0.02519, velocity coeff: 1.0334
norm(ch) = 0.72675
rho = 1.0316
New lambda: 1.1078e-052
iter: 2450, Minibatch log likelihood (pre-update): -54.3505, error rate (pre-update): 0.084874
iter: 2450, Minibatch log likelihood (post-update): -54.3505, error rate (post-update): 0.084871
---
Full log-likelihood: -54.3505, error rate: 0.084871
TEST log-likelihood: -54.9579, error rate: 0.31102
Error difference (test - train): 0.22614
---
Full log-likelihood (averaged params): -54.3788, error rate (averaged params): 0.095019
TEST log-likelihood (averaged params): -54.904, error rate (averaged params): 0.29807
Error difference (test - train) (averaged params): 0.20305

size_minibatch = 20000
Precon grad coeff: 0.026724, velocity coeff: 0.99929
norm(ch) = 0.72851
iter: 2451, Minibatch log likelihood (pre-update): -54.3505, error rate (pre-update): 0.084871

size_minibatch = 20000
Precon grad coeff: 0.022687, velocity coeff: 0.90893
norm(ch) = 0.66404
iter: 2452, Minibatch log likelihood (pre-update): -54.3504, error rate (pre-update): 0.084857

size_minibatch = 20000
Precon grad coeff: 0.020939, velocity coeff: 1.0057
norm(ch) = 0.66949
iter: 2453, Minibatch log likelihood (pre-update): -54.3503, error rate (pre-update): 0.084851

size_minibatch = 20000
Precon grad coeff: 0.024198, velocity coeff: 1.0708
norm(ch) = 0.71882
iter: 2454, Minibatch log likelihood (pre-update): -54.3503, error rate (pre-update): 0.084839

size_minibatch = 20000
Precon grad coeff: 0.02485, velocity coeff: 1.0171
norm(ch) = 0.73309
rho = 1.0544
New lambda: 8.5718e-053
iter: 2455, Minibatch log likelihood (pre-update): -54.3502, error rate (pre-update): 0.084825
iter: 2455, Minibatch log likelihood (post-update): -54.3502, error rate (post-update): 0.084821

size_minibatch = 20000
Precon grad coeff: 0.022616, velocity coeff: 0.89598
norm(ch) = 0.65882
iter: 2456, Minibatch log likelihood (pre-update): -54.3502, error rate (pre-update): 0.084821

size_minibatch = 20000
Precon grad coeff: 0.023624, velocity coeff: 1.1044
norm(ch) = 0.72947
iter: 2457, Minibatch log likelihood (pre-update): -54.3501, error rate (pre-update): 0.084813

size_minibatch = 20000
Precon grad coeff: 0.023855, velocity coeff: 0.94936
norm(ch) = 0.69424
iter: 2458, Minibatch log likelihood (pre-update): -54.35, error rate (pre-update): 0.084793

size_minibatch = 20000
Precon grad coeff: 0.023827, velocity coeff: 0.98785
norm(ch) = 0.68761
iter: 2459, Minibatch log likelihood (pre-update): -54.35, error rate (pre-update): 0.084785

size_minibatch = 20000
Precon grad coeff: 0.025745, velocity coeff: 1.0284
New gamma: 0.0031623
norm(ch) = 0.70927
rho = 1.0202
New lambda: 6.6327e-053
iter: 2460, Minibatch log likelihood (pre-update): -54.3499, error rate (pre-update): 0.084777
iter: 2460, Minibatch log likelihood (post-update): -54.3499, error rate (post-update): 0.084761

size_minibatch = 20000
Precon grad coeff: 0.023055, velocity coeff: 0.90911
norm(ch) = 0.64676
iter: 2461, Minibatch log likelihood (pre-update): -54.3499, error rate (pre-update): 0.084761

size_minibatch = 20000
Precon grad coeff: 0.024405, velocity coeff: 1.1098
norm(ch) = 0.71972
iter: 2462, Minibatch log likelihood (pre-update): -54.3498, error rate (pre-update): 0.084761

size_minibatch = 20000
Precon grad coeff: 0.025027, velocity coeff: 0.98169
norm(ch) = 0.7087
iter: 2463, Minibatch log likelihood (pre-update): -54.3497, error rate (pre-update): 0.084747

size_minibatch = 20000
Precon grad coeff: 0.024476, velocity coeff: 1.0123
norm(ch) = 0.71947
iter: 2464, Minibatch log likelihood (pre-update): -54.3497, error rate (pre-update): 0.084732

size_minibatch = 20000
Precon grad coeff: 0.025935, velocity coeff: 1.0434
norm(ch) = 0.75274
rho = 1.0136
New lambda: 5.1322e-053
iter: 2465, Minibatch log likelihood (pre-update): -54.3496, error rate (pre-update): 0.084726
iter: 2465, Minibatch log likelihood (post-update): -54.3495, error rate (post-update): 0.084711

size_minibatch = 20000
Precon grad coeff: 0.02391, velocity coeff: 0.91053
norm(ch) = 0.68725
iter: 2466, Minibatch log likelihood (pre-update): -54.3495, error rate (pre-update): 0.084711

size_minibatch = 20000
Precon grad coeff: 0.026049, velocity coeff: 1.0918
norm(ch) = 0.75245
iter: 2467, Minibatch log likelihood (pre-update): -54.3495, error rate (pre-update): 0.084703

size_minibatch = 20000
Precon grad coeff: 0.025044, velocity coeff: 0.91741
norm(ch) = 0.69243
iter: 2468, Minibatch log likelihood (pre-update): -54.3494, error rate (pre-update): 0.084695

size_minibatch = 20000
Precon grad coeff: 0.022061, velocity coeff: 0.95076
norm(ch) = 0.65991
iter: 2469, Minibatch log likelihood (pre-update): -54.3494, error rate (pre-update): 0.084685

size_minibatch = 20000
Precon grad coeff: 0.023243, velocity coeff: 1.0346
norm(ch) = 0.68464
rho = 0.95752
New lambda: 3.9712e-053
iter: 2470, Minibatch log likelihood (pre-update): -54.3493, error rate (pre-update): 0.084668
iter: 2470, Minibatch log likelihood (post-update): -54.3492, error rate (post-update): 0.08466

size_minibatch = 20000
Precon grad coeff: 0.025011, velocity coeff: 1.0487
norm(ch) = 0.71989
iter: 2471, Minibatch log likelihood (pre-update): -54.3492, error rate (pre-update): 0.08466

size_minibatch = 20000
Precon grad coeff: 0.02707, velocity coeff: 1.0138
norm(ch) = 0.73197
iter: 2472, Minibatch log likelihood (pre-update): -54.3492, error rate (pre-update): 0.084652

size_minibatch = 20000
Precon grad coeff: 0.025974, velocity coeff: 0.98542
norm(ch) = 0.7234
iter: 2473, Minibatch log likelihood (pre-update): -54.3491, error rate (pre-update): 0.08464

size_minibatch = 20000
Precon grad coeff: 0.023126, velocity coeff: 0.93497
norm(ch) = 0.67819
iter: 2474, Minibatch log likelihood (pre-update): -54.3491, error rate (pre-update): 0.084633

size_minibatch = 20000
Precon grad coeff: 0.022568, velocity coeff: 0.98983
norm(ch) = 0.67308
rho = 0.98185
New lambda: 3.0729e-053
iter: 2475, Minibatch log likelihood (pre-update): -54.349, error rate (pre-update): 0.084622
iter: 2475, Minibatch log likelihood (post-update): -54.3489, error rate (post-update): 0.084618

size_minibatch = 20000
Precon grad coeff: 0.022951, velocity coeff: 1.022
norm(ch) = 0.68951
iter: 2476, Minibatch log likelihood (pre-update): -54.3489, error rate (pre-update): 0.084618

size_minibatch = 20000
Precon grad coeff: 0.025666, velocity coeff: 1.0613
norm(ch) = 0.73385
iter: 2477, Minibatch log likelihood (pre-update): -54.3489, error rate (pre-update): 0.0846

size_minibatch = 20000
Precon grad coeff: 0.027498, velocity coeff: 0.99602
norm(ch) = 0.73298
iter: 2478, Minibatch log likelihood (pre-update): -54.3488, error rate (pre-update): 0.084587

size_minibatch = 20000
Precon grad coeff: 0.023107, velocity coeff: 0.89665
norm(ch) = 0.65905
iter: 2479, Minibatch log likelihood (pre-update): -54.3488, error rate (pre-update): 0.084588

size_minibatch = 20000
Precon grad coeff: 0.021605, velocity coeff: 1.0015
New gamma: 0.0031623
norm(ch) = 0.66169
rho = 0.97345
New lambda: 2.3777e-053
iter: 2480, Minibatch log likelihood (pre-update): -54.3487, error rate (pre-update): 0.084569
iter: 2480, Minibatch log likelihood (post-update): -54.3486, error rate (post-update): 0.084559

size_minibatch = 20000
Precon grad coeff: 0.023434, velocity coeff: 1.042
norm(ch) = 0.69141
iter: 2481, Minibatch log likelihood (pre-update): -54.3486, error rate (pre-update): 0.084559

size_minibatch = 20000
Precon grad coeff: 0.02589, velocity coeff: 1.0541
norm(ch) = 0.73085
iter: 2482, Minibatch log likelihood (pre-update): -54.3486, error rate (pre-update): 0.084558

size_minibatch = 20000
Precon grad coeff: 0.025061, velocity coeff: 0.97476
norm(ch) = 0.71432
iter: 2483, Minibatch log likelihood (pre-update): -54.3485, error rate (pre-update): 0.084536

size_minibatch = 20000
Precon grad coeff: 0.023538, velocity coeff: 0.97699
norm(ch) = 0.6997
iter: 2484, Minibatch log likelihood (pre-update): -54.3485, error rate (pre-update): 0.084535

size_minibatch = 20000
Precon grad coeff: 0.02625, velocity coeff: 1.0477
norm(ch) = 0.7352
rho = 1.0059
New lambda: 1.8398e-053
iter: 2485, Minibatch log likelihood (pre-update): -54.3484, error rate (pre-update): 0.084527
iter: 2485, Minibatch log likelihood (post-update): -54.3483, error rate (post-update): 0.084515

size_minibatch = 20000
Precon grad coeff: 0.024719, velocity coeff: 0.93315
norm(ch) = 0.6879
iter: 2486, Minibatch log likelihood (pre-update): -54.3483, error rate (pre-update): 0.084515

size_minibatch = 20000
Precon grad coeff: 0.024734, velocity coeff: 1.0184
norm(ch) = 0.7025
iter: 2487, Minibatch log likelihood (pre-update): -54.3483, error rate (pre-update): 0.084505

size_minibatch = 20000
Precon grad coeff: 0.02393, velocity coeff: 0.95318
norm(ch) = 0.67131
iter: 2488, Minibatch log likelihood (pre-update): -54.3482, error rate (pre-update): 0.084495

size_minibatch = 20000
Precon grad coeff: 0.02207, velocity coeff: 0.96353
norm(ch) = 0.64863
iter: 2489, Minibatch log likelihood (pre-update): -54.3482, error rate (pre-update): 0.084485

size_minibatch = 20000
Precon grad coeff: 0.022171, velocity coeff: 1.0449
norm(ch) = 0.67945
rho = 1.0716
New lambda: 1.4236e-053
iter: 2490, Minibatch log likelihood (pre-update): -54.3481, error rate (pre-update): 0.084474
iter: 2490, Minibatch log likelihood (post-update): -54.348, error rate (post-update): 0.084466

size_minibatch = 20000
Precon grad coeff: 0.025089, velocity coeff: 1.0384
norm(ch) = 0.70753
iter: 2491, Minibatch log likelihood (pre-update): -54.348, error rate (pre-update): 0.084466

size_minibatch = 20000
Precon grad coeff: 0.022399, velocity coeff: 0.93999
norm(ch) = 0.66679
iter: 2492, Minibatch log likelihood (pre-update): -54.348, error rate (pre-update): 0.084464

size_minibatch = 20000
Precon grad coeff: 0.024573, velocity coeff: 1.0399
norm(ch) = 0.6952
iter: 2493, Minibatch log likelihood (pre-update): -54.3479, error rate (pre-update): 0.08445

size_minibatch = 20000
Precon grad coeff: 0.024101, velocity coeff: 1.0107
norm(ch) = 0.70456
iter: 2494, Minibatch log likelihood (pre-update): -54.3479, error rate (pre-update): 0.084439

size_minibatch = 20000
Precon grad coeff: 0.026191, velocity coeff: 0.98978
norm(ch) = 0.69934
rho = 1.0501
New lambda: 1.1016e-053
iter: 2495, Minibatch log likelihood (pre-update): -54.3478, error rate (pre-update): 0.084429
iter: 2495, Minibatch log likelihood (post-update): -54.3478, error rate (post-update): 0.084414

size_minibatch = 20000
Precon grad coeff: 0.024784, velocity coeff: 1.0166
norm(ch) = 0.71287
iter: 2496, Minibatch log likelihood (pre-update): -54.3478, error rate (pre-update): 0.084414

size_minibatch = 20000
Precon grad coeff: 0.023905, velocity coeff: 0.91279
norm(ch) = 0.65248
iter: 2497, Minibatch log likelihood (pre-update): -54.3477, error rate (pre-update): 0.084406

size_minibatch = 20000
Precon grad coeff: 0.021734, velocity coeff: 1.0176
norm(ch) = 0.66554
iter: 2498, Minibatch log likelihood (pre-update): -54.3476, error rate (pre-update): 0.084408

size_minibatch = 20000
Precon grad coeff: 0.021306, velocity coeff: 0.97134
norm(ch) = 0.64819
iter: 2499, Minibatch log likelihood (pre-update): -54.3476, error rate (pre-update): 0.084394

size_minibatch = 20000
Precon grad coeff: 0.024345, velocity coeff: 1.0416
New gamma: 0.0031623
norm(ch) = 0.67718
rho = 0.97815
New lambda: 8.5238e-054
iter: 2500, Minibatch log likelihood (pre-update): -54.3475, error rate (pre-update): 0.084377
iter: 2500, Minibatch log likelihood (post-update): -54.3475, error rate (post-update): 0.084375
---
Full log-likelihood: -54.3475, error rate: 0.084375
TEST log-likelihood: -54.9753, error rate: 0.31606
Error difference (test - train): 0.23169
---
Full log-likelihood (averaged params): -54.3738, error rate (averaged params): 0.093871
TEST log-likelihood (averaged params): -54.9202, error rate (averaged params): 0.30259
Error difference (test - train) (averaged params): 0.20872

size_minibatch = 20000
Precon grad coeff: 0.022073, velocity coeff: 0.95561
norm(ch) = 0.6489
iter: 2501, Minibatch log likelihood (pre-update): -54.3475, error rate (pre-update): 0.084375

size_minibatch = 20000
Precon grad coeff: 0.024168, velocity coeff: 1.0612
norm(ch) = 0.69047
iter: 2502, Minibatch log likelihood (pre-update): -54.3474, error rate (pre-update): 0.084371

size_minibatch = 20000
Precon grad coeff: 0.025641, velocity coeff: 1.0231
norm(ch) = 0.70843
iter: 2503, Minibatch log likelihood (pre-update): -54.3474, error rate (pre-update): 0.084355

size_minibatch = 20000
Precon grad coeff: 0.024532, velocity coeff: 0.97125
norm(ch) = 0.69008
iter: 2504, Minibatch log likelihood (pre-update): -54.3473, error rate (pre-update): 0.084353

size_minibatch = 20000
Precon grad coeff: 0.022965, velocity coeff: 0.96507
norm(ch) = 0.66785
rho = 1.0574
New lambda: 6.5955e-054
iter: 2505, Minibatch log likelihood (pre-update): -54.3472, error rate (pre-update): 0.084337
iter: 2505, Minibatch log likelihood (post-update): -54.3472, error rate (post-update): 0.084326

size_minibatch = 20000
Precon grad coeff: 0.021395, velocity coeff: 0.97412
norm(ch) = 0.6522
iter: 2506, Minibatch log likelihood (pre-update): -54.3472, error rate (pre-update): 0.084326

size_minibatch = 20000
Precon grad coeff: 0.022579, velocity coeff: 1.02
norm(ch) = 0.66712
iter: 2507, Minibatch log likelihood (pre-update): -54.3471, error rate (pre-update): 0.084318

size_minibatch = 20000
Precon grad coeff: 0.02174, velocity coeff: 0.99003
norm(ch) = 0.66231
iter: 2508, Minibatch log likelihood (pre-update): -54.3471, error rate (pre-update): 0.084308

size_minibatch = 20000
Precon grad coeff: 0.025119, velocity coeff: 1.0604
norm(ch) = 0.70423
iter: 2509, Minibatch log likelihood (pre-update): -54.347, error rate (pre-update): 0.084306

size_minibatch = 20000
Precon grad coeff: 0.028523, velocity coeff: 1.0466
norm(ch) = 0.73913
rho = 1.0176
New lambda: 5.1035e-054
iter: 2510, Minibatch log likelihood (pre-update): -54.347, error rate (pre-update): 0.084294
iter: 2510, Minibatch log likelihood (post-update): -54.3469, error rate (post-update): 0.084288

size_minibatch = 20000
Precon grad coeff: 0.024393, velocity coeff: 0.89463
norm(ch) = 0.66312
iter: 2511, Minibatch log likelihood (pre-update): -54.3469, error rate (pre-update): 0.084288

size_minibatch = 20000
Precon grad coeff: 0.021007, velocity coeff: 0.93604
norm(ch) = 0.62234
iter: 2512, Minibatch log likelihood (pre-update): -54.3468, error rate (pre-update): 0.084273

size_minibatch = 20000
Precon grad coeff: 0.020217, velocity coeff: 1.0177
norm(ch) = 0.63496
iter: 2513, Minibatch log likelihood (pre-update): -54.3468, error rate (pre-update): 0.084263

size_minibatch = 20000
Precon grad coeff: 0.025198, velocity coeff: 1.1201
norm(ch) = 0.71321
iter: 2514, Minibatch log likelihood (pre-update): -54.3467, error rate (pre-update): 0.08426

size_minibatch = 20000
Precon grad coeff: 0.023635, velocity coeff: 0.92316
norm(ch) = 0.66029
rho = 1.0154
New lambda: 3.949e-054
iter: 2515, Minibatch log likelihood (pre-update): -54.3467, error rate (pre-update): 0.084251
iter: 2515, Minibatch log likelihood (post-update): -54.3466, error rate (post-update): 0.084243

size_minibatch = 20000
Precon grad coeff: 0.022076, velocity coeff: 1.005
norm(ch) = 0.66524
iter: 2516, Minibatch log likelihood (pre-update): -54.3466, error rate (pre-update): 0.084243

size_minibatch = 20000
Precon grad coeff: 0.02303, velocity coeff: 1.003
norm(ch) = 0.66891
iter: 2517, Minibatch log likelihood (pre-update): -54.3466, error rate (pre-update): 0.084234

size_minibatch = 20000
Precon grad coeff: 0.024325, velocity coeff: 1.0287
norm(ch) = 0.69004
iter: 2518, Minibatch log likelihood (pre-update): -54.3465, error rate (pre-update): 0.08423

size_minibatch = 20000
Precon grad coeff: 0.023273, velocity coeff: 0.95553
norm(ch) = 0.66113
iter: 2519, Minibatch log likelihood (pre-update): -54.3465, error rate (pre-update): 0.084215

size_minibatch = 20000
Precon grad coeff: 0.022962, velocity coeff: 0.94899
New gamma: 0.0031623
norm(ch) = 0.62921
rho = 1.0228
New lambda: 3.0557e-054
iter: 2520, Minibatch log likelihood (pre-update): -54.3464, error rate (pre-update): 0.084205
iter: 2520, Minibatch log likelihood (post-update): -54.3464, error rate (post-update): 0.084197

size_minibatch = 20000
Precon grad coeff: 0.020453, velocity coeff: 0.96392
norm(ch) = 0.60816
iter: 2521, Minibatch log likelihood (pre-update): -54.3464, error rate (pre-update): 0.084197

size_minibatch = 20000
Precon grad coeff: 0.021584, velocity coeff: 1.0566
norm(ch) = 0.64426
iter: 2522, Minibatch log likelihood (pre-update): -54.3463, error rate (pre-update): 0.08419

size_minibatch = 20000
Precon grad coeff: 0.023773, velocity coeff: 1.0676
norm(ch) = 0.68984
iter: 2523, Minibatch log likelihood (pre-update): -54.3462, error rate (pre-update): 0.084186

size_minibatch = 20000
Precon grad coeff: 0.026503, velocity coeff: 1.0434
norm(ch) = 0.72211
iter: 2524, Minibatch log likelihood (pre-update): -54.3462, error rate (pre-update): 0.084177

size_minibatch = 20000
Precon grad coeff: 0.024454, velocity coeff: 0.95216
norm(ch) = 0.68947
rho = 1.0031
New lambda: 2.3644e-054
iter: 2525, Minibatch log likelihood (pre-update): -54.3461, error rate (pre-update): 0.084159
iter: 2525, Minibatch log likelihood (post-update): -54.3461, error rate (post-update): 0.08416

size_minibatch = 20000
Precon grad coeff: 0.024779, velocity coeff: 1.008
norm(ch) = 0.69698
iter: 2526, Minibatch log likelihood (pre-update): -54.3461, error rate (pre-update): 0.08416

size_minibatch = 20000
Precon grad coeff: 0.023177, velocity coeff: 0.94864
norm(ch) = 0.66283
iter: 2527, Minibatch log likelihood (pre-update): -54.346, error rate (pre-update): 0.084151

size_minibatch = 20000
Precon grad coeff: 0.021002, velocity coeff: 0.92419
norm(ch) = 0.61434
iter: 2528, Minibatch log likelihood (pre-update): -54.346, error rate (pre-update): 0.084143

size_minibatch = 20000
Precon grad coeff: 0.019331, velocity coeff: 1.0212
norm(ch) = 0.62879
iter: 2529, Minibatch log likelihood (pre-update): -54.3459, error rate (pre-update): 0.084131

size_minibatch = 20000
Precon grad coeff: 0.024218, velocity coeff: 1.0802
norm(ch) = 0.68102
rho = 1.0687
New lambda: 1.8295e-054
iter: 2530, Minibatch log likelihood (pre-update): -54.3459, error rate (pre-update): 0.084117
iter: 2530, Minibatch log likelihood (post-update): -54.3458, error rate (post-update): 0.084114

size_minibatch = 20000
Precon grad coeff: 0.026848, velocity coeff: 1.0504
norm(ch) = 0.7175
iter: 2531, Minibatch log likelihood (pre-update): -54.3458, error rate (pre-update): 0.084114

size_minibatch = 20000
Precon grad coeff: 0.0253, velocity coeff: 0.93313
norm(ch) = 0.67159
iter: 2532, Minibatch log likelihood (pre-update): -54.3457, error rate (pre-update): 0.084101

size_minibatch = 20000
Precon grad coeff: 0.021931, velocity coeff: 0.96853
norm(ch) = 0.65213
iter: 2533, Minibatch log likelihood (pre-update): -54.3457, error rate (pre-update): 0.084097

size_minibatch = 20000
Precon grad coeff: 0.023986, velocity coeff: 1.0253
norm(ch) = 0.67041
iter: 2534, Minibatch log likelihood (pre-update): -54.3456, error rate (pre-update): 0.084095

size_minibatch = 20000
Precon grad coeff: 0.021223, velocity coeff: 0.92316
norm(ch) = 0.62058
rho = 0.99432
New lambda: 1.4157e-054
iter: 2535, Minibatch log likelihood (pre-update): -54.3456, error rate (pre-update): 0.084076
iter: 2535, Minibatch log likelihood (post-update): -54.3455, error rate (post-update): 0.084067

size_minibatch = 20000
Precon grad coeff: 0.018768, velocity coeff: 1.0069
norm(ch) = 0.62619
iter: 2536, Minibatch log likelihood (pre-update): -54.3455, error rate (pre-update): 0.084067

size_minibatch = 20000
Precon grad coeff: 0.023098, velocity coeff: 1.0696
norm(ch) = 0.67147
iter: 2537, Minibatch log likelihood (pre-update): -54.3455, error rate (pre-update): 0.084064

size_minibatch = 20000
Precon grad coeff: 0.024853, velocity coeff: 1.0355
norm(ch) = 0.69709
iter: 2538, Minibatch log likelihood (pre-update): -54.3454, error rate (pre-update): 0.084058

size_minibatch = 20000
Precon grad coeff: 0.025612, velocity coeff: 0.99468
norm(ch) = 0.69529
iter: 2539, Minibatch log likelihood (pre-update): -54.3454, error rate (pre-update): 0.084044

size_minibatch = 20000
Precon grad coeff: 0.024898, velocity coeff: 0.9347
New gamma: 0.0031623
norm(ch) = 0.65189
rho = 0.97214
New lambda: 1.0954e-054
iter: 2540, Minibatch log likelihood (pre-update): -54.3453, error rate (pre-update): 0.084036
iter: 2540, Minibatch log likelihood (post-update): -54.3453, error rate (post-update): 0.084029

size_minibatch = 20000
Precon grad coeff: 0.025696, velocity coeff: 1.0455
norm(ch) = 0.68364
iter: 2541, Minibatch log likelihood (pre-update): -54.3453, error rate (pre-update): 0.084029

size_minibatch = 20000
Precon grad coeff: 0.022882, velocity coeff: 0.94755
norm(ch) = 0.64965
iter: 2542, Minibatch log likelihood (pre-update): -54.3452, error rate (pre-update): 0.084016

size_minibatch = 20000
Precon grad coeff: 0.022114, velocity coeff: 0.99302
norm(ch) = 0.64666
iter: 2543, Minibatch log likelihood (pre-update): -54.3451, error rate (pre-update): 0.084006

size_minibatch = 20000
Precon grad coeff: 0.024428, velocity coeff: 1.0833
norm(ch) = 0.70241
iter: 2544, Minibatch log likelihood (pre-update): -54.3451, error rate (pre-update): 0.084004

size_minibatch = 20000
Precon grad coeff: 0.022961, velocity coeff: 0.97076
norm(ch) = 0.68365
rho = 0.99507
New lambda: 8.4761e-055
iter: 2545, Minibatch log likelihood (pre-update): -54.345, error rate (pre-update): 0.083996
iter: 2545, Minibatch log likelihood (post-update): -54.345, error rate (post-update): 0.083977

size_minibatch = 20000
Precon grad coeff: 0.027899, velocity coeff: 1.097
norm(ch) = 0.75216
iter: 2546, Minibatch log likelihood (pre-update): -54.345, error rate (pre-update): 0.083977

size_minibatch = 20000
Precon grad coeff: 0.023174, velocity coeff: 0.85206
norm(ch) = 0.64256
iter: 2547, Minibatch log likelihood (pre-update): -54.3449, error rate (pre-update): 0.083973

size_minibatch = 20000
Precon grad coeff: 0.022566, velocity coeff: 1.0044
norm(ch) = 0.64708
iter: 2548, Minibatch log likelihood (pre-update): -54.3449, error rate (pre-update): 0.083962

size_minibatch = 20000
Precon grad coeff: 0.022559, velocity coeff: 1.0197
norm(ch) = 0.66157
iter: 2549, Minibatch log likelihood (pre-update): -54.3448, error rate (pre-update): 0.083954

size_minibatch = 20000
Precon grad coeff: 0.02578, velocity coeff: 1.0233
norm(ch) = 0.67892
rho = 1.0107
New lambda: 6.5586e-055
iter: 2550, Minibatch log likelihood (pre-update): -54.3448, error rate (pre-update): 0.083947
iter: 2550, Minibatch log likelihood (post-update): -54.3447, error rate (post-update): 0.083929
---
Full log-likelihood: -54.3447, error rate: 0.083929
TEST log-likelihood: -54.9927, error rate: 0.32111
Error difference (test - train): 0.23718
---
Full log-likelihood (averaged params): -54.3693, error rate (averaged params): 0.092844
TEST log-likelihood (averaged params): -54.9372, error rate (averaged params): 0.30739
Error difference (test - train) (averaged params): 0.21454

size_minibatch = 20000
Precon grad coeff: 0.024897, velocity coeff: 1.0301
norm(ch) = 0.70113
iter: 2551, Minibatch log likelihood (pre-update): -54.3447, error rate (pre-update): 0.083929

size_minibatch = 20000
Precon grad coeff: 0.02593, velocity coeff: 0.95457
norm(ch) = 0.67108
iter: 2552, Minibatch log likelihood (pre-update): -54.3446, error rate (pre-update): 0.083927

size_minibatch = 20000
Precon grad coeff: 0.020619, velocity coeff: 0.93933
norm(ch) = 0.63192
iter: 2553, Minibatch log likelihood (pre-update): -54.3446, error rate (pre-update): 0.083923

size_minibatch = 20000
Precon grad coeff: 0.023062, velocity coeff: 1.0513
norm(ch) = 0.66603
iter: 2554, Minibatch log likelihood (pre-update): -54.3445, error rate (pre-update): 0.083912

size_minibatch = 20000
Precon grad coeff: 0.022619, velocity coeff: 0.98025
norm(ch) = 0.65459
rho = 1.0107
New lambda: 5.0749e-055
iter: 2555, Minibatch log likelihood (pre-update): -54.3445, error rate (pre-update): 0.083901
iter: 2555, Minibatch log likelihood (post-update): -54.3444, error rate (post-update): 0.083891

size_minibatch = 20000
Precon grad coeff: 0.023536, velocity coeff: 1.0389
norm(ch) = 0.68181
iter: 2556, Minibatch log likelihood (pre-update): -54.3444, error rate (pre-update): 0.083891

size_minibatch = 20000
Precon grad coeff: 0.026372, velocity coeff: 1.037
norm(ch) = 0.70891
iter: 2557, Minibatch log likelihood (pre-update): -54.3444, error rate (pre-update): 0.083877

size_minibatch = 20000
Precon grad coeff: 0.026595, velocity coeff: 0.98954
norm(ch) = 0.70332
iter: 2558, Minibatch log likelihood (pre-update): -54.3443, error rate (pre-update): 0.083877

size_minibatch = 20000
Precon grad coeff: 0.025433, velocity coeff: 0.96081
norm(ch) = 0.67755
iter: 2559, Minibatch log likelihood (pre-update): -54.3443, error rate (pre-update): 0.083863

size_minibatch = 20000
Precon grad coeff: 0.024128, velocity coeff: 0.94026
New gamma: 0.0031623
norm(ch) = 0.639
rho = 1.0504
New lambda: 3.9269e-055
iter: 2560, Minibatch log likelihood (pre-update): -54.3442, error rate (pre-update): 0.083854
iter: 2560, Minibatch log likelihood (post-update): -54.3442, error rate (post-update): 0.083852

size_minibatch = 20000
Precon grad coeff: 0.02293, velocity coeff: 1.0237
norm(ch) = 0.6559
iter: 2561, Minibatch log likelihood (pre-update): -54.3442, error rate (pre-update): 0.083852

size_minibatch = 20000
Precon grad coeff: 0.023452, velocity coeff: 0.9708
norm(ch) = 0.63855
iter: 2562, Minibatch log likelihood (pre-update): -54.3441, error rate (pre-update): 0.083836

size_minibatch = 20000
Precon grad coeff: 0.021153, velocity coeff: 1.0085
norm(ch) = 0.64568
iter: 2563, Minibatch log likelihood (pre-update): -54.3441, error rate (pre-update): 0.083826

size_minibatch = 20000
Precon grad coeff: 0.025148, velocity coeff: 1.0891
norm(ch) = 0.70499
iter: 2564, Minibatch log likelihood (pre-update): -54.344, error rate (pre-update): 0.083822

size_minibatch = 20000
Precon grad coeff: 0.023615, velocity coeff: 0.93952
norm(ch) = 0.66409
rho = 1.0407
New lambda: 3.0386e-055
iter: 2565, Minibatch log likelihood (pre-update): -54.344, error rate (pre-update): 0.083811
iter: 2565, Minibatch log likelihood (post-update): -54.3439, error rate (post-update): 0.0838

size_minibatch = 20000
Precon grad coeff: 0.022023, velocity coeff: 0.97541
norm(ch) = 0.64928
iter: 2566, Minibatch log likelihood (pre-update): -54.3439, error rate (pre-update): 0.0838

size_minibatch = 20000
Precon grad coeff: 0.021816, velocity coeff: 1.0059
norm(ch) = 0.65488
iter: 2567, Minibatch log likelihood (pre-update): -54.3438, error rate (pre-update): 0.083796

size_minibatch = 20000
Precon grad coeff: 0.026792, velocity coeff: 1.0743
norm(ch) = 0.70553
iter: 2568, Minibatch log likelihood (pre-update): -54.3438, error rate (pre-update): 0.083788

size_minibatch = 20000
Precon grad coeff: 0.022248, velocity coeff: 0.90198
norm(ch) = 0.63797
iter: 2569, Minibatch log likelihood (pre-update): -54.3437, error rate (pre-update): 0.083775

size_minibatch = 20000
Precon grad coeff: 0.025475, velocity coeff: 1.0664
norm(ch) = 0.68217
rho = 1.0294
New lambda: 2.3512e-055
iter: 2570, Minibatch log likelihood (pre-update): -54.3437, error rate (pre-update): 0.083764
iter: 2570, Minibatch log likelihood (post-update): -54.3436, error rate (post-update): 0.08376

size_minibatch = 20000
Precon grad coeff: 0.026749, velocity coeff: 1.0373
norm(ch) = 0.70947
iter: 2571, Minibatch log likelihood (pre-update): -54.3436, error rate (pre-update): 0.08376

size_minibatch = 20000
Precon grad coeff: 0.025293, velocity coeff: 0.92961
norm(ch) = 0.66136
iter: 2572, Minibatch log likelihood (pre-update): -54.3436, error rate (pre-update): 0.083749

size_minibatch = 20000
Precon grad coeff: 0.021512, velocity coeff: 0.95284
norm(ch) = 0.63178
iter: 2573, Minibatch log likelihood (pre-update): -54.3435, error rate (pre-update): 0.083733

size_minibatch = 20000
Precon grad coeff: 0.020348, velocity coeff: 0.97776
norm(ch) = 0.61922
iter: 2574, Minibatch log likelihood (pre-update): -54.3435, error rate (pre-update): 0.083732

size_minibatch = 20000
Precon grad coeff: 0.022759, velocity coeff: 1.0738
norm(ch) = 0.66642
rho = 1.0605
New lambda: 1.8193e-055
iter: 2575, Minibatch log likelihood (pre-update): -54.3434, error rate (pre-update): 0.083727
iter: 2575, Minibatch log likelihood (post-update): -54.3434, error rate (post-update): 0.083713

size_minibatch = 20000
Precon grad coeff: 0.024487, velocity coeff: 1.0173
norm(ch) = 0.67975
iter: 2576, Minibatch log likelihood (pre-update): -54.3434, error rate (pre-update): 0.083713

size_minibatch = 20000
Precon grad coeff: 0.023822, velocity coeff: 0.96031
norm(ch) = 0.65442
iter: 2577, Minibatch log likelihood (pre-update): -54.3433, error rate (pre-update): 0.083705

size_minibatch = 20000
Precon grad coeff: 0.023697, velocity coeff: 1.032
norm(ch) = 0.67712
iter: 2578, Minibatch log likelihood (pre-update): -54.3433, error rate (pre-update): 0.083696

size_minibatch = 20000
Precon grad coeff: 0.02375, velocity coeff: 0.96275
norm(ch) = 0.65347
iter: 2579, Minibatch log likelihood (pre-update): -54.3432, error rate (pre-update): 0.083687

size_minibatch = 20000
Precon grad coeff: 0.021811, velocity coeff: 0.92819
New gamma: 0.0031623
norm(ch) = 0.60818
rho = 1.0095
New lambda: 1.4077e-055
iter: 2580, Minibatch log likelihood (pre-update): -54.3432, error rate (pre-update): 0.083683
iter: 2580, Minibatch log likelihood (post-update): -54.3431, error rate (post-update): 0.083674

size_minibatch = 20000
Precon grad coeff: 0.023952, velocity coeff: 1.1112
norm(ch) = 0.67758
iter: 2581, Minibatch log likelihood (pre-update): -54.3431, error rate (pre-update): 0.083674

size_minibatch = 20000
Precon grad coeff: 0.024512, velocity coeff: 0.98815
norm(ch) = 0.6713
iter: 2582, Minibatch log likelihood (pre-update): -54.343, error rate (pre-update): 0.083664

size_minibatch = 20000
Precon grad coeff: 0.023382, velocity coeff: 0.99342
norm(ch) = 0.66856
iter: 2583, Minibatch log likelihood (pre-update): -54.343, error rate (pre-update): 0.083655

size_minibatch = 20000
Precon grad coeff: 0.024667, velocity coeff: 1.0069
norm(ch) = 0.67505
iter: 2584, Minibatch log likelihood (pre-update): -54.3429, error rate (pre-update): 0.083645

size_minibatch = 20000
Precon grad coeff: 0.021668, velocity coeff: 0.94336
norm(ch) = 0.63846
rho = 0.96146
New lambda: 1.0893e-055
iter: 2585, Minibatch log likelihood (pre-update): -54.3429, error rate (pre-update): 0.08364
iter: 2585, Minibatch log likelihood (post-update): -54.3428, error rate (post-update): 0.083625

size_minibatch = 20000
Precon grad coeff: 0.024178, velocity coeff: 1.054
norm(ch) = 0.67457
iter: 2586, Minibatch log likelihood (pre-update): -54.3428, error rate (pre-update): 0.083625

size_minibatch = 20000
Precon grad coeff: 0.022338, velocity coeff: 0.95837
norm(ch) = 0.64804
iter: 2587, Minibatch log likelihood (pre-update): -54.3428, error rate (pre-update): 0.083617

size_minibatch = 20000
Precon grad coeff: 0.022734, velocity coeff: 1.0081
norm(ch) = 0.65489
iter: 2588, Minibatch log likelihood (pre-update): -54.3427, error rate (pre-update): 0.083615

size_minibatch = 20000
Precon grad coeff: 0.025942, velocity coeff: 1.0426
norm(ch) = 0.68471
iter: 2589, Minibatch log likelihood (pre-update): -54.3427, error rate (pre-update): 0.083606

size_minibatch = 20000
Precon grad coeff: 0.026027, velocity coeff: 0.98935
norm(ch) = 0.6792
rho = 0.99213
New lambda: 8.4286e-056
iter: 2590, Minibatch log likelihood (pre-update): -54.3426, error rate (pre-update): 0.083593
iter: 2590, Minibatch log likelihood (post-update): -54.3426, error rate (post-update): 0.083582

size_minibatch = 20000
Precon grad coeff: 0.024513, velocity coeff: 0.99691
norm(ch) = 0.67878
iter: 2591, Minibatch log likelihood (pre-update): -54.3426, error rate (pre-update): 0.083582

size_minibatch = 20000
Precon grad coeff: 0.02147, velocity coeff: 0.87677
norm(ch) = 0.59671
iter: 2592, Minibatch log likelihood (pre-update): -54.3425, error rate (pre-update): 0.083574

size_minibatch = 20000
Precon grad coeff: 0.022637, velocity coeff: 1.1179
norm(ch) = 0.66876
iter: 2593, Minibatch log likelihood (pre-update): -54.3425, error rate (pre-update): 0.083568

size_minibatch = 20000
Precon grad coeff: 0.023039, velocity coeff: 0.97603
norm(ch) = 0.65425
iter: 2594, Minibatch log likelihood (pre-update): -54.3424, error rate (pre-update): 0.083559

size_minibatch = 20000
Precon grad coeff: 0.022797, velocity coeff: 0.98414
norm(ch) = 0.64546
rho = 1.0239
New lambda: 6.5219e-056
iter: 2595, Minibatch log likelihood (pre-update): -54.3424, error rate (pre-update): 0.083555
iter: 2595, Minibatch log likelihood (post-update): -54.3423, error rate (post-update): 0.083543

size_minibatch = 20000
Precon grad coeff: 0.022728, velocity coeff: 1.005
norm(ch) = 0.65016
iter: 2596, Minibatch log likelihood (pre-update): -54.3423, error rate (pre-update): 0.083543

size_minibatch = 20000
Precon grad coeff: 0.022619, velocity coeff: 0.9825
norm(ch) = 0.64025
iter: 2597, Minibatch log likelihood (pre-update): -54.3423, error rate (pre-update): 0.083527

size_minibatch = 20000
Precon grad coeff: 0.022295, velocity coeff: 0.99461
norm(ch) = 0.63836
iter: 2598, Minibatch log likelihood (pre-update): -54.3422, error rate (pre-update): 0.083525

size_minibatch = 20000
Precon grad coeff: 0.021653, velocity coeff: 0.98083
norm(ch) = 0.62758
iter: 2599, Minibatch log likelihood (pre-update): -54.3422, error rate (pre-update): 0.083519

size_minibatch = 20000
Precon grad coeff: 0.024349, velocity coeff: 1.0384
New gamma: 0.0031623
norm(ch) = 0.65336
rho = 0.97318
New lambda: 5.0465e-056
iter: 2600, Minibatch log likelihood (pre-update): -54.3421, error rate (pre-update): 0.08351
iter: 2600, Minibatch log likelihood (post-update): -54.3421, error rate (post-update): 0.083507
---
Full log-likelihood: -54.3421, error rate: 0.083507
TEST log-likelihood: -55.0095, error rate: 0.32578
Error difference (test - train): 0.24227
---
Full log-likelihood (averaged params): -54.365, error rate (averaged params): 0.091881
TEST log-likelihood (averaged params): -54.9545, error rate (averaged params): 0.31232
Error difference (test - train) (averaged params): 0.22044

size_minibatch = 20000
Precon grad coeff: 0.02478, velocity coeff: 1.014
norm(ch) = 0.66424
iter: 2601, Minibatch log likelihood (pre-update): -54.3421, error rate (pre-update): 0.083507

size_minibatch = 20000
Precon grad coeff: 0.024475, velocity coeff: 1.0087
norm(ch) = 0.67192
iter: 2602, Minibatch log likelihood (pre-update): -54.342, error rate (pre-update): 0.083492

size_minibatch = 20000
Precon grad coeff: 0.026157, velocity coeff: 1.0188
norm(ch) = 0.6865
iter: 2603, Minibatch log likelihood (pre-update): -54.342, error rate (pre-update): 0.083479

size_minibatch = 20000
Precon grad coeff: 0.022032, velocity coeff: 0.93517
norm(ch) = 0.64354
iter: 2604, Minibatch log likelihood (pre-update): -54.3419, error rate (pre-update): 0.083469

size_minibatch = 20000
Precon grad coeff: 0.02184, velocity coeff: 0.97521
norm(ch) = 0.62899
rho = 0.98787
New lambda: 3.9049e-056
iter: 2605, Minibatch log likelihood (pre-update): -54.3419, error rate (pre-update): 0.083464
iter: 2605, Minibatch log likelihood (post-update): -54.3418, error rate (post-update): 0.083459

size_minibatch = 20000
Precon grad coeff: 0.023278, velocity coeff: 1.076
norm(ch) = 0.67853
iter: 2606, Minibatch log likelihood (pre-update): -54.3418, error rate (pre-update): 0.083459

size_minibatch = 20000
Precon grad coeff: 0.024622, velocity coeff: 0.97473
norm(ch) = 0.66304
iter: 2607, Minibatch log likelihood (pre-update): -54.3418, error rate (pre-update): 0.083444

size_minibatch = 20000
Precon grad coeff: 0.023124, velocity coeff: 0.98343
norm(ch) = 0.6537
iter: 2608, Minibatch log likelihood (pre-update): -54.3417, error rate (pre-update): 0.083431

size_minibatch = 20000
Precon grad coeff: 0.022587, velocity coeff: 0.96341
norm(ch) = 0.63125
iter: 2609, Minibatch log likelihood (pre-update): -54.3417, error rate (pre-update): 0.083431

size_minibatch = 20000
Precon grad coeff: 0.023475, velocity coeff: 1.0266
norm(ch) = 0.64965
rho = 0.99268
New lambda: 3.0215e-056
iter: 2610, Minibatch log likelihood (pre-update): -54.3416, error rate (pre-update): 0.083424
iter: 2610, Minibatch log likelihood (post-update): -54.3416, error rate (post-update): 0.083412

size_minibatch = 20000
Precon grad coeff: 0.024481, velocity coeff: 1.0187
norm(ch) = 0.66341
iter: 2611, Minibatch log likelihood (pre-update): -54.3416, error rate (pre-update): 0.083412

size_minibatch = 20000
Precon grad coeff: 0.023134, velocity coeff: 0.94541
norm(ch) = 0.62877
iter: 2612, Minibatch log likelihood (pre-update): -54.3415, error rate (pre-update): 0.083404

size_minibatch = 20000
Precon grad coeff: 0.021057, velocity coeff: 1.0079
norm(ch) = 0.63523
iter: 2613, Minibatch log likelihood (pre-update): -54.3415, error rate (pre-update): 0.08339

size_minibatch = 20000
Precon grad coeff: 0.023667, velocity coeff: 1.0121
norm(ch) = 0.64448
iter: 2614, Minibatch log likelihood (pre-update): -54.3414, error rate (pre-update): 0.083384

size_minibatch = 20000
Precon grad coeff: 0.02134, velocity coeff: 0.98153
norm(ch) = 0.63408
rho = 0.99974
New lambda: 2.338e-056
iter: 2615, Minibatch log likelihood (pre-update): -54.3414, error rate (pre-update): 0.083377
iter: 2615, Minibatch log likelihood (post-update): -54.3413, error rate (post-update): 0.083365

size_minibatch = 20000
Precon grad coeff: 0.024768, velocity coeff: 1.0609
norm(ch) = 0.67437
iter: 2616, Minibatch log likelihood (pre-update): -54.3413, error rate (pre-update): 0.083365

size_minibatch = 20000
Precon grad coeff: 0.022899, velocity coeff: 0.94252
norm(ch) = 0.63705
iter: 2617, Minibatch log likelihood (pre-update): -54.3413, error rate (pre-update): 0.083363

size_minibatch = 20000
Precon grad coeff: 0.022861, velocity coeff: 1.0283
norm(ch) = 0.65653
iter: 2618, Minibatch log likelihood (pre-update): -54.3412, error rate (pre-update): 0.083354

size_minibatch = 20000
Precon grad coeff: 0.023463, velocity coeff: 0.95469
norm(ch) = 0.62825
iter: 2619, Minibatch log likelihood (pre-update): -54.3412, error rate (pre-update): 0.08334

size_minibatch = 20000
Precon grad coeff: 0.02186, velocity coeff: 0.99397
New gamma: 0.0031623
norm(ch) = 0.62613
rho = 0.98211
New lambda: 1.8091e-056
iter: 2620, Minibatch log likelihood (pre-update): -54.3411, error rate (pre-update): 0.083326
iter: 2620, Minibatch log likelihood (post-update): -54.3411, error rate (post-update): 0.083317

size_minibatch = 20000
Precon grad coeff: 0.021989, velocity coeff: 0.99004
norm(ch) = 0.62142
iter: 2621, Minibatch log likelihood (pre-update): -54.3411, error rate (pre-update): 0.083317

size_minibatch = 20000
Precon grad coeff: 0.024164, velocity coeff: 1.0674
norm(ch) = 0.66504
iter: 2622, Minibatch log likelihood (pre-update): -54.341, error rate (pre-update): 0.083318

size_minibatch = 20000
Precon grad coeff: 0.024672, velocity coeff: 0.9975
norm(ch) = 0.66522
iter: 2623, Minibatch log likelihood (pre-update): -54.341, error rate (pre-update): 0.083309

size_minibatch = 20000
Precon grad coeff: 0.023326, velocity coeff: 0.99968
norm(ch) = 0.66658
iter: 2624, Minibatch log likelihood (pre-update): -54.3409, error rate (pre-update): 0.083295

size_minibatch = 20000
Precon grad coeff: 0.022928, velocity coeff: 0.94325
norm(ch) = 0.6304
rho = 1.0043
New lambda: 1.3999e-056
iter: 2625, Minibatch log likelihood (pre-update): -54.3409, error rate (pre-update): 0.083288
iter: 2625, Minibatch log likelihood (post-update): -54.3408, error rate (post-update): 0.08328

size_minibatch = 20000
Precon grad coeff: 0.021652, velocity coeff: 1.0121
norm(ch) = 0.63955
iter: 2626, Minibatch log likelihood (pre-update): -54.3408, error rate (pre-update): 0.08328

size_minibatch = 20000
Precon grad coeff: 0.022234, velocity coeff: 0.99705
norm(ch) = 0.63909
iter: 2627, Minibatch log likelihood (pre-update): -54.3408, error rate (pre-update): 0.083276

size_minibatch = 20000
Precon grad coeff: 0.023344, velocity coeff: 1.0105
norm(ch) = 0.64737
iter: 2628, Minibatch log likelihood (pre-update): -54.3407, error rate (pre-update): 0.083263

size_minibatch = 20000
Precon grad coeff: 0.024159, velocity coeff: 1.0266
norm(ch) = 0.66633
iter: 2629, Minibatch log likelihood (pre-update): -54.3407, error rate (pre-update): 0.083243

size_minibatch = 20000
Precon grad coeff: 0.021985, velocity coeff: 0.9127
norm(ch) = 0.60967
rho = 1.0607
New lambda: 1.0832e-056
iter: 2630, Minibatch log likelihood (pre-update): -54.3406, error rate (pre-update): 0.083243
iter: 2630, Minibatch log likelihood (post-update): -54.3406, error rate (post-update): 0.083238

size_minibatch = 20000
Precon grad coeff: 0.021441, velocity coeff: 1.0152
norm(ch) = 0.62034
iter: 2631, Minibatch log likelihood (pre-update): -54.3406, error rate (pre-update): 0.083238

size_minibatch = 20000
Precon grad coeff: 0.022582, velocity coeff: 1.0415
norm(ch) = 0.64768
iter: 2632, Minibatch log likelihood (pre-update): -54.3405, error rate (pre-update): 0.083227

size_minibatch = 20000
Precon grad coeff: 0.023175, velocity coeff: 0.99167
norm(ch) = 0.64381
iter: 2633, Minibatch log likelihood (pre-update): -54.3405, error rate (pre-update): 0.083218

size_minibatch = 20000
Precon grad coeff: 0.022502, velocity coeff: 1.0023
norm(ch) = 0.64686
iter: 2634, Minibatch log likelihood (pre-update): -54.3404, error rate (pre-update): 0.083202

size_minibatch = 20000
Precon grad coeff: 0.022731, velocity coeff: 0.95216
norm(ch) = 0.61739
rho = 1.0374
New lambda: 8.3814e-057
iter: 2635, Minibatch log likelihood (pre-update): -54.3404, error rate (pre-update): 0.083194
iter: 2635, Minibatch log likelihood (post-update): -54.3403, error rate (post-update): 0.083192

size_minibatch = 20000
Precon grad coeff: 0.022541, velocity coeff: 1.0567
norm(ch) = 0.65394
iter: 2636, Minibatch log likelihood (pre-update): -54.3403, error rate (pre-update): 0.083192

size_minibatch = 20000
Precon grad coeff: 0.022162, velocity coeff: 0.92911
norm(ch) = 0.60897
iter: 2637, Minibatch log likelihood (pre-update): -54.3403, error rate (pre-update): 0.083177

size_minibatch = 20000
Precon grad coeff: 0.019685, velocity coeff: 1.002
norm(ch) = 0.6114
iter: 2638, Minibatch log likelihood (pre-update): -54.3402, error rate (pre-update): 0.083167

size_minibatch = 20000
Precon grad coeff: 0.024361, velocity coeff: 1.0961
norm(ch) = 0.67175
iter: 2639, Minibatch log likelihood (pre-update): -54.3402, error rate (pre-update): 0.083165

size_minibatch = 20000
Precon grad coeff: 0.023587, velocity coeff: 0.93521
New gamma: 0.0031623
norm(ch) = 0.62984
rho = 0.99604
New lambda: 6.4854e-057
iter: 2640, Minibatch log likelihood (pre-update): -54.3401, error rate (pre-update): 0.08315
iter: 2640, Minibatch log likelihood (post-update): -54.3401, error rate (post-update): 0.083139

size_minibatch = 20000
Precon grad coeff: 0.022783, velocity coeff: 0.97624
norm(ch) = 0.61649
iter: 2641, Minibatch log likelihood (pre-update): -54.3401, error rate (pre-update): 0.083139

size_minibatch = 20000
Precon grad coeff: 0.02054, velocity coeff: 0.99438
norm(ch) = 0.61457
iter: 2642, Minibatch log likelihood (pre-update): -54.34, error rate (pre-update): 0.083135

size_minibatch = 20000
Precon grad coeff: 0.022988, velocity coeff: 1.0389
norm(ch) = 0.64
iter: 2643, Minibatch log likelihood (pre-update): -54.34, error rate (pre-update): 0.083129

size_minibatch = 20000
Precon grad coeff: 0.022119, velocity coeff: 0.99757
norm(ch) = 0.63997
iter: 2644, Minibatch log likelihood (pre-update): -54.3399, error rate (pre-update): 0.083116

size_minibatch = 20000
Precon grad coeff: 0.024393, velocity coeff: 1.0627
norm(ch) = 0.68175
rho = 1.0017
New lambda: 5.0183e-057
iter: 2645, Minibatch log likelihood (pre-update): -54.3399, error rate (pre-update): 0.083105
iter: 2645, Minibatch log likelihood (post-update): -54.3398, error rate (post-update): 0.083102

size_minibatch = 20000
Precon grad coeff: 0.023776, velocity coeff: 0.95043
norm(ch) = 0.64959
iter: 2646, Minibatch log likelihood (pre-update): -54.3398, error rate (pre-update): 0.083102

size_minibatch = 20000
Precon grad coeff: 0.020268, velocity coeff: 0.90889
norm(ch) = 0.59177
iter: 2647, Minibatch log likelihood (pre-update): -54.3398, error rate (pre-update): 0.083092

size_minibatch = 20000
Precon grad coeff: 0.019781, velocity coeff: 1.0465
norm(ch) = 0.62065
iter: 2648, Minibatch log likelihood (pre-update): -54.3397, error rate (pre-update): 0.083078

size_minibatch = 20000
Precon grad coeff: 0.024501, velocity coeff: 1.0569
norm(ch) = 0.65759
iter: 2649, Minibatch log likelihood (pre-update): -54.3397, error rate (pre-update): 0.083065

size_minibatch = 20000
Precon grad coeff: 0.02261, velocity coeff: 0.95223
norm(ch) = 0.62755
rho = 0.99387
New lambda: 3.8831e-057
iter: 2650, Minibatch log likelihood (pre-update): -54.3396, error rate (pre-update): 0.083062
iter: 2650, Minibatch log likelihood (post-update): -54.3396, error rate (post-update): 0.083056
---
Full log-likelihood: -54.3396, error rate: 0.083056
TEST log-likelihood: -55.0263, error rate: 0.33024
Error difference (test - train): 0.24718
---
Full log-likelihood (averaged params): -54.3611, error rate (averaged params): 0.091011
TEST log-likelihood (averaged params): -54.9716, error rate (averaged params): 0.31718
Error difference (test - train) (averaged params): 0.22617

size_minibatch = 20000
Precon grad coeff: 0.020667, velocity coeff: 0.95033
norm(ch) = 0.59775
iter: 2651, Minibatch log likelihood (pre-update): -54.3396, error rate (pre-update): 0.083056

size_minibatch = 20000
Precon grad coeff: 0.022476, velocity coeff: 1.0738
norm(ch) = 0.64335
iter: 2652, Minibatch log likelihood (pre-update): -54.3395, error rate (pre-update): 0.083047

size_minibatch = 20000
Precon grad coeff: 0.021126, velocity coeff: 0.95583
norm(ch) = 0.61633
iter: 2653, Minibatch log likelihood (pre-update): -54.3395, error rate (pre-update): 0.083038

size_minibatch = 20000
Precon grad coeff: 0.021535, velocity coeff: 1.0248
norm(ch) = 0.63303
iter: 2654, Minibatch log likelihood (pre-update): -54.3395, error rate (pre-update): 0.083026

size_minibatch = 20000
Precon grad coeff: 0.023147, velocity coeff: 1.0298
norm(ch) = 0.65355
rho = 1.1127
New lambda: 3.0046e-057
iter: 2655, Minibatch log likelihood (pre-update): -54.3394, error rate (pre-update): 0.083016
iter: 2655, Minibatch log likelihood (post-update): -54.3394, error rate (post-update): 0.083009

size_minibatch = 20000
Precon grad coeff: 0.022655, velocity coeff: 0.9381
norm(ch) = 0.61452
iter: 2656, Minibatch log likelihood (pre-update): -54.3394, error rate (pre-update): 0.083009

size_minibatch = 20000
Precon grad coeff: 0.021743, velocity coeff: 1.0529
norm(ch) = 0.64854
iter: 2657, Minibatch log likelihood (pre-update): -54.3393, error rate (pre-update): 0.082998

size_minibatch = 20000
Precon grad coeff: 0.020682, velocity coeff: 0.89564
norm(ch) = 0.58204
iter: 2658, Minibatch log likelihood (pre-update): -54.3393, error rate (pre-update): 0.082985

size_minibatch = 20000
Precon grad coeff: 0.019215, velocity coeff: 1.0348
norm(ch) = 0.60353
iter: 2659, Minibatch log likelihood (pre-update): -54.3392, error rate (pre-update): 0.082982

size_minibatch = 20000
Precon grad coeff: 0.026101, velocity coeff: 1.1028
New gamma: 0.0031623
norm(ch) = 0.6675
rho = 0.95719
New lambda: 2.3249e-057
iter: 2660, Minibatch log likelihood (pre-update): -54.3392, error rate (pre-update): 0.082978
iter: 2660, Minibatch log likelihood (post-update): -54.3391, error rate (post-update): 0.082968

size_minibatch = 20000
Precon grad coeff: 0.024835, velocity coeff: 0.92646
norm(ch) = 0.6202
iter: 2661, Minibatch log likelihood (pre-update): -54.3391, error rate (pre-update): 0.082968

size_minibatch = 20000
Precon grad coeff: 0.023874, velocity coeff: 1.0025
norm(ch) = 0.62357
iter: 2662, Minibatch log likelihood (pre-update): -54.3391, error rate (pre-update): 0.08296

size_minibatch = 20000
Precon grad coeff: 0.02198, velocity coeff: 1.0108
norm(ch) = 0.63182
iter: 2663, Minibatch log likelihood (pre-update): -54.339, error rate (pre-update): 0.082946

size_minibatch = 20000
Precon grad coeff: 0.023195, velocity coeff: 1.0417
norm(ch) = 0.65992
iter: 2664, Minibatch log likelihood (pre-update): -54.339, error rate (pre-update): 0.082936

size_minibatch = 20000
Precon grad coeff: 0.024137, velocity coeff: 1.0171
norm(ch) = 0.67288
rho = 0.99799
New lambda: 1.799e-057
iter: 2665, Minibatch log likelihood (pre-update): -54.3389, error rate (pre-update): 0.082933
iter: 2665, Minibatch log likelihood (post-update): -54.3389, error rate (post-update): 0.082926

size_minibatch = 20000
Precon grad coeff: 0.026698, velocity coeff: 1.05
norm(ch) = 0.70847
iter: 2666, Minibatch log likelihood (pre-update): -54.3389, error rate (pre-update): 0.082926

size_minibatch = 20000
Precon grad coeff: 0.021958, velocity coeff: 0.89063
norm(ch) = 0.63243
iter: 2667, Minibatch log likelihood (pre-update): -54.3388, error rate (pre-update): 0.082914

size_minibatch = 20000
Precon grad coeff: 0.025541, velocity coeff: 1.0936
norm(ch) = 0.69355
iter: 2668, Minibatch log likelihood (pre-update): -54.3388, error rate (pre-update): 0.082902

size_minibatch = 20000
Precon grad coeff: 0.02743, velocity coeff: 0.98655
norm(ch) = 0.68605
iter: 2669, Minibatch log likelihood (pre-update): -54.3387, error rate (pre-update): 0.082883

size_minibatch = 20000
Precon grad coeff: 0.02168, velocity coeff: 0.83895
norm(ch) = 0.57695
rho = 1.0173
New lambda: 1.392e-057
iter: 2670, Minibatch log likelihood (pre-update): -54.3387, error rate (pre-update): 0.082884
iter: 2670, Minibatch log likelihood (post-update): -54.3386, error rate (post-update): 0.082881

size_minibatch = 20000
Precon grad coeff: 0.020494, velocity coeff: 1.0653
norm(ch) = 0.61593
iter: 2671, Minibatch log likelihood (pre-update): -54.3386, error rate (pre-update): 0.082881

size_minibatch = 20000
Precon grad coeff: 0.023474, velocity coeff: 1.0395
norm(ch) = 0.64182
iter: 2672, Minibatch log likelihood (pre-update): -54.3386, error rate (pre-update): 0.082864

size_minibatch = 20000
Precon grad coeff: 0.022875, velocity coeff: 0.98714
norm(ch) = 0.63519
iter: 2673, Minibatch log likelihood (pre-update): -54.3385, error rate (pre-update): 0.082851

size_minibatch = 20000
Precon grad coeff: 0.024937, velocity coeff: 1.0765
norm(ch) = 0.68546
iter: 2674, Minibatch log likelihood (pre-update): -54.3385, error rate (pre-update): 0.082848

size_minibatch = 20000
Precon grad coeff: 0.024865, velocity coeff: 0.9556
norm(ch) = 0.65659
rho = 0.96883
New lambda: 1.0771e-057
iter: 2675, Minibatch log likelihood (pre-update): -54.3384, error rate (pre-update): 0.08283
iter: 2675, Minibatch log likelihood (post-update): -54.3384, error rate (post-update): 0.082829

size_minibatch = 20000
Precon grad coeff: 0.023423, velocity coeff: 0.98311
norm(ch) = 0.64703
iter: 2676, Minibatch log likelihood (pre-update): -54.3384, error rate (pre-update): 0.082829

size_minibatch = 20000
Precon grad coeff: 0.021737, velocity coeff: 0.95878
norm(ch) = 0.62173
iter: 2677, Minibatch log likelihood (pre-update): -54.3383, error rate (pre-update): 0.082822

size_minibatch = 20000
Precon grad coeff: 0.022194, velocity coeff: 0.99809
norm(ch) = 0.62199
iter: 2678, Minibatch log likelihood (pre-update): -54.3383, error rate (pre-update): 0.082807

size_minibatch = 20000
Precon grad coeff: 0.023284, velocity coeff: 1.0564
norm(ch) = 0.65848
iter: 2679, Minibatch log likelihood (pre-update): -54.3382, error rate (pre-update): 0.082802

size_minibatch = 20000
Precon grad coeff: 0.026567, velocity coeff: 1.0074
New gamma: 0.0031623
norm(ch) = 0.66508
rho = 0.94979
New lambda: 8.3345e-058
iter: 2680, Minibatch log likelihood (pre-update): -54.3382, error rate (pre-update): 0.082794
iter: 2680, Minibatch log likelihood (post-update): -54.3381, error rate (post-update): 0.082783

size_minibatch = 20000
Precon grad coeff: 0.024339, velocity coeff: 0.97391
norm(ch) = 0.64933
iter: 2681, Minibatch log likelihood (pre-update): -54.3381, error rate (pre-update): 0.082783

size_minibatch = 20000
Precon grad coeff: 0.022659, velocity coeff: 0.93825
norm(ch) = 0.61069
iter: 2682, Minibatch log likelihood (pre-update): -54.3381, error rate (pre-update): 0.082774

size_minibatch = 20000
Precon grad coeff: 0.02224, velocity coeff: 1.0686
norm(ch) = 0.65425
iter: 2683, Minibatch log likelihood (pre-update): -54.338, error rate (pre-update): 0.082765

size_minibatch = 20000
Precon grad coeff: 0.021643, velocity coeff: 0.945
norm(ch) = 0.6197
iter: 2684, Minibatch log likelihood (pre-update): -54.338, error rate (pre-update): 0.08276

size_minibatch = 20000
Precon grad coeff: 0.021019, velocity coeff: 1.0099
norm(ch) = 0.62718
rho = 1.0319
New lambda: 6.4491e-058
iter: 2685, Minibatch log likelihood (pre-update): -54.3379, error rate (pre-update): 0.082752
iter: 2685, Minibatch log likelihood (post-update): -54.3379, error rate (post-update): 0.082739

size_minibatch = 20000
Precon grad coeff: 0.026332, velocity coeff: 1.1313
norm(ch) = 0.71138
iter: 2686, Minibatch log likelihood (pre-update): -54.3379, error rate (pre-update): 0.082739

size_minibatch = 20000
Precon grad coeff: 0.026427, velocity coeff: 0.94864
norm(ch) = 0.67654
iter: 2687, Minibatch log likelihood (pre-update): -54.3378, error rate (pre-update): 0.082726

size_minibatch = 20000
Precon grad coeff: 0.024613, velocity coeff: 0.94389
norm(ch) = 0.64025
iter: 2688, Minibatch log likelihood (pre-update): -54.3378, error rate (pre-update): 0.082718

size_minibatch = 20000
Precon grad coeff: 0.022839, velocity coeff: 0.97999
norm(ch) = 0.62888
iter: 2689, Minibatch log likelihood (pre-update): -54.3377, error rate (pre-update): 0.082719

size_minibatch = 20000
Precon grad coeff: 0.023193, velocity coeff: 1.0158
norm(ch) = 0.64034
rho = 0.95555
New lambda: 4.9902e-058
iter: 2690, Minibatch log likelihood (pre-update): -54.3377, error rate (pre-update): 0.082705
iter: 2690, Minibatch log likelihood (post-update): -54.3376, error rate (post-update): 0.082691

size_minibatch = 20000
Precon grad coeff: 0.022903, velocity coeff: 0.98243
norm(ch) = 0.63063
iter: 2691, Minibatch log likelihood (pre-update): -54.3376, error rate (pre-update): 0.082691

size_minibatch = 20000
Precon grad coeff: 0.020948, velocity coeff: 0.97077
norm(ch) = 0.61362
iter: 2692, Minibatch log likelihood (pre-update): -54.3376, error rate (pre-update): 0.082682

size_minibatch = 20000
Precon grad coeff: 0.021627, velocity coeff: 1.0226
norm(ch) = 0.62892
iter: 2693, Minibatch log likelihood (pre-update): -54.3375, error rate (pre-update): 0.082672

size_minibatch = 20000
Precon grad coeff: 0.023995, velocity coeff: 1.0434
norm(ch) = 0.6578
iter: 2694, Minibatch log likelihood (pre-update): -54.3375, error rate (pre-update): 0.082668

size_minibatch = 20000
Precon grad coeff: 0.019345, velocity coeff: 0.86206
norm(ch) = 0.56838
rho = 1.0035
New lambda: 3.8613e-058
iter: 2695, Minibatch log likelihood (pre-update): -54.3374, error rate (pre-update): 0.082662
iter: 2695, Minibatch log likelihood (post-update): -54.3374, error rate (post-update): 0.082653

size_minibatch = 20000
Precon grad coeff: 0.023113, velocity coeff: 1.1624
norm(ch) = 0.66223
iter: 2696, Minibatch log likelihood (pre-update): -54.3374, error rate (pre-update): 0.082653

size_minibatch = 20000
Precon grad coeff: 0.026988, velocity coeff: 1.0579
norm(ch) = 0.7023
iter: 2697, Minibatch log likelihood (pre-update): -54.3373, error rate (pre-update): 0.08264

size_minibatch = 20000
Precon grad coeff: 0.024092, velocity coeff: 0.90939
norm(ch) = 0.64033
iter: 2698, Minibatch log likelihood (pre-update): -54.3373, error rate (pre-update): 0.082634

size_minibatch = 20000
Precon grad coeff: 0.025756, velocity coeff: 1.0487
norm(ch) = 0.6733
iter: 2699, Minibatch log likelihood (pre-update): -54.3372, error rate (pre-update): 0.082627

size_minibatch = 20000
Precon grad coeff: 0.024012, velocity coeff: 0.94322
New gamma: 0.0031623
norm(ch) = 0.63673
rho = 0.98995
New lambda: 2.9878e-058
iter: 2700, Minibatch log likelihood (pre-update): -54.3372, error rate (pre-update): 0.082614
iter: 2700, Minibatch log likelihood (post-update): -54.3371, error rate (post-update): 0.082609
---
Full log-likelihood: -54.3371, error rate: 0.082609
TEST log-likelihood: -55.0436, error rate: 0.33481
Error difference (test - train): 0.25221
---
Full log-likelihood (averaged params): -54.3579, error rate (averaged params): 0.09034
TEST log-likelihood (averaged params): -54.9885, error rate (averaged params): 0.32182
Error difference (test - train) (averaged params): 0.23148

size_minibatch = 20000
Precon grad coeff: 0.02288, velocity coeff: 0.94888
norm(ch) = 0.60582
iter: 2701, Minibatch log likelihood (pre-update): -54.3371, error rate (pre-update): 0.082609

size_minibatch = 20000
Precon grad coeff: 0.022839, velocity coeff: 1.0675
norm(ch) = 0.64826
iter: 2702, Minibatch log likelihood (pre-update): -54.3371, error rate (pre-update): 0.0826

size_minibatch = 20000
Precon grad coeff: 0.022132, velocity coeff: 0.94031
norm(ch) = 0.61113
iter: 2703, Minibatch log likelihood (pre-update): -54.337, error rate (pre-update): 0.082589

size_minibatch = 20000
Precon grad coeff: 0.021412, velocity coeff: 1.0447
norm(ch) = 0.63996
iter: 2704, Minibatch log likelihood (pre-update): -54.337, error rate (pre-update): 0.082583

size_minibatch = 20000
Precon grad coeff: 0.023802, velocity coeff: 1.0313
norm(ch) = 0.66164
rho = 1.0347
New lambda: 2.3119e-058
iter: 2705, Minibatch log likelihood (pre-update): -54.3369, error rate (pre-update): 0.082574
iter: 2705, Minibatch log likelihood (post-update): -54.3369, error rate (post-update): 0.082567

size_minibatch = 20000
Precon grad coeff: 0.020779, velocity coeff: 0.90544
norm(ch) = 0.60039
iter: 2706, Minibatch log likelihood (pre-update): -54.3369, error rate (pre-update): 0.082567

size_minibatch = 20000
Precon grad coeff: 0.021964, velocity coeff: 1.0761
norm(ch) = 0.64765
iter: 2707, Minibatch log likelihood (pre-update): -54.3368, error rate (pre-update): 0.082563

size_minibatch = 20000
Precon grad coeff: 0.02374, velocity coeff: 1.008
norm(ch) = 0.65422
iter: 2708, Minibatch log likelihood (pre-update): -54.3368, error rate (pre-update): 0.082552

size_minibatch = 20000
Precon grad coeff: 0.024238, velocity coeff: 0.96925
norm(ch) = 0.63574
iter: 2709, Minibatch log likelihood (pre-update): -54.3367, error rate (pre-update): 0.082539

size_minibatch = 20000
Precon grad coeff: 0.023929, velocity coeff: 1.0366
norm(ch) = 0.66074
rho = 1.037
New lambda: 1.7889e-058
iter: 2710, Minibatch log likelihood (pre-update): -54.3367, error rate (pre-update): 0.082534
iter: 2710, Minibatch log likelihood (post-update): -54.3366, error rate (post-update): 0.082523

size_minibatch = 20000
Precon grad coeff: 0.025266, velocity coeff: 0.98052
norm(ch) = 0.64966
iter: 2711, Minibatch log likelihood (pre-update): -54.3366, error rate (pre-update): 0.082523

size_minibatch = 20000
Precon grad coeff: 0.024897, velocity coeff: 1.0258
norm(ch) = 0.66807
iter: 2712, Minibatch log likelihood (pre-update): -54.3366, error rate (pre-update): 0.082519

size_minibatch = 20000
Precon grad coeff: 0.022439, velocity coeff: 0.93184
norm(ch) = 0.62405
iter: 2713, Minibatch log likelihood (pre-update): -54.3365, error rate (pre-update): 0.082505

size_minibatch = 20000
Precon grad coeff: 0.021106, velocity coeff: 0.98015
norm(ch) = 0.61294
iter: 2714, Minibatch log likelihood (pre-update): -54.3365, error rate (pre-update): 0.082498

size_minibatch = 20000
Precon grad coeff: 0.023913, velocity coeff: 1.0843
norm(ch) = 0.66619
rho = 1.0524
New lambda: 1.3842e-058
iter: 2715, Minibatch log likelihood (pre-update): -54.3365, error rate (pre-update): 0.082493
iter: 2715, Minibatch log likelihood (post-update): -54.3364, error rate (post-update): 0.082478

size_minibatch = 20000
Precon grad coeff: 0.021952, velocity coeff: 0.92841
norm(ch) = 0.61985
iter: 2716, Minibatch log likelihood (pre-update): -54.3364, error rate (pre-update): 0.082478

size_minibatch = 20000
Precon grad coeff: 0.019931, velocity coeff: 0.95434
norm(ch) = 0.5928
iter: 2717, Minibatch log likelihood (pre-update): -54.3364, error rate (pre-update): 0.082475

size_minibatch = 20000
Precon grad coeff: 0.021944, velocity coeff: 1.0795
norm(ch) = 0.64127
iter: 2718, Minibatch log likelihood (pre-update): -54.3363, error rate (pre-update): 0.08247

size_minibatch = 20000
Precon grad coeff: 0.021192, velocity coeff: 0.9215
norm(ch) = 0.59232
iter: 2719, Minibatch log likelihood (pre-update): -54.3363, error rate (pre-update): 0.082455

size_minibatch = 20000
Precon grad coeff: 0.021613, velocity coeff: 1.0514
New gamma: 0.0031623
norm(ch) = 0.62428
rho = 1.0159
New lambda: 1.0711e-058
iter: 2720, Minibatch log likelihood (pre-update): -54.3362, error rate (pre-update): 0.082446
iter: 2720, Minibatch log likelihood (post-update): -54.3362, error rate (post-update): 0.082437

size_minibatch = 20000
Precon grad coeff: 0.025636, velocity coeff: 1.0583
norm(ch) = 0.66253
iter: 2721, Minibatch log likelihood (pre-update): -54.3362, error rate (pre-update): 0.082437

size_minibatch = 20000
Precon grad coeff: 0.025889, velocity coeff: 1.0168
norm(ch) = 0.67541
iter: 2722, Minibatch log likelihood (pre-update): -54.3361, error rate (pre-update): 0.082431

size_minibatch = 20000
Precon grad coeff: 0.028182, velocity coeff: 1.0567
norm(ch) = 0.71557
iter: 2723, Minibatch log likelihood (pre-update): -54.3361, error rate (pre-update): 0.082426

size_minibatch = 20000
Precon grad coeff: 0.024647, velocity coeff: 0.88753
norm(ch) = 0.63671
iter: 2724, Minibatch log likelihood (pre-update): -54.336, error rate (pre-update): 0.082415

size_minibatch = 20000
Precon grad coeff: 0.02061, velocity coeff: 0.97001
norm(ch) = 0.61901
rho = 1.026
New lambda: 8.2879e-059
iter: 2725, Minibatch log likelihood (pre-update): -54.336, error rate (pre-update): 0.082406
iter: 2725, Minibatch log likelihood (post-update): -54.3359, error rate (post-update): 0.082393

size_minibatch = 20000
Precon grad coeff: 0.020758, velocity coeff: 0.99861
norm(ch) = 0.61952
iter: 2726, Minibatch log likelihood (pre-update): -54.3359, error rate (pre-update): 0.082393

size_minibatch = 20000
Precon grad coeff: 0.024516, velocity coeff: 1.0689
norm(ch) = 0.66379
iter: 2727, Minibatch log likelihood (pre-update): -54.3359, error rate (pre-update): 0.082386

size_minibatch = 20000
Precon grad coeff: 0.021081, velocity coeff: 0.90644
norm(ch) = 0.60299
iter: 2728, Minibatch log likelihood (pre-update): -54.3358, error rate (pre-update): 0.082383

size_minibatch = 20000
Precon grad coeff: 0.020154, velocity coeff: 1.0016
norm(ch) = 0.60535
iter: 2729, Minibatch log likelihood (pre-update): -54.3358, error rate (pre-update): 0.082375

size_minibatch = 20000
Precon grad coeff: 0.023015, velocity coeff: 1.05
norm(ch) = 0.6371
rho = 1.0194
New lambda: 6.413e-059
iter: 2730, Minibatch log likelihood (pre-update): -54.3357, error rate (pre-update): 0.082363
iter: 2730, Minibatch log likelihood (post-update): -54.3357, error rate (post-update): 0.082354

size_minibatch = 20000
Precon grad coeff: 0.024955, velocity coeff: 1.0273
norm(ch) = 0.65602
iter: 2731, Minibatch log likelihood (pre-update): -54.3357, error rate (pre-update): 0.082354

size_minibatch = 20000
Precon grad coeff: 0.02309, velocity coeff: 0.96348
norm(ch) = 0.63352
iter: 2732, Minibatch log likelihood (pre-update): -54.3356, error rate (pre-update): 0.08235

size_minibatch = 20000
Precon grad coeff: 0.026578, velocity coeff: 1.0838
norm(ch) = 0.68828
iter: 2733, Minibatch log likelihood (pre-update): -54.3356, error rate (pre-update): 0.082335

size_minibatch = 20000
Precon grad coeff: 0.023936, velocity coeff: 0.91262
norm(ch) = 0.62974
iter: 2734, Minibatch log likelihood (pre-update): -54.3355, error rate (pre-update): 0.082331

size_minibatch = 20000
Precon grad coeff: 0.019909, velocity coeff: 0.94455
norm(ch) = 0.59613
rho = 1.0821
New lambda: 4.9623e-059
iter: 2735, Minibatch log likelihood (pre-update): -54.3355, error rate (pre-update): 0.08233
iter: 2735, Minibatch log likelihood (post-update): -54.3354, error rate (post-update): 0.082312

size_minibatch = 20000
Precon grad coeff: 0.020789, velocity coeff: 1.0206
norm(ch) = 0.60975
iter: 2736, Minibatch log likelihood (pre-update): -54.3354, error rate (pre-update): 0.082312

size_minibatch = 20000
Precon grad coeff: 0.022094, velocity coeff: 1.0254
norm(ch) = 0.6266
iter: 2737, Minibatch log likelihood (pre-update): -54.3354, error rate (pre-update): 0.082302

size_minibatch = 20000
Precon grad coeff: 0.020125, velocity coeff: 0.98685
norm(ch) = 0.61949
iter: 2738, Minibatch log likelihood (pre-update): -54.3353, error rate (pre-update): 0.0823

size_minibatch = 20000
Precon grad coeff: 0.02504, velocity coeff: 1.0532
norm(ch) = 0.65396
iter: 2739, Minibatch log likelihood (pre-update): -54.3353, error rate (pre-update): 0.082286

size_minibatch = 20000
Precon grad coeff: 0.023142, velocity coeff: 0.92873
New gamma: 0.0031623
norm(ch) = 0.60897
rho = 0.96731
New lambda: 3.8397e-059
iter: 2740, Minibatch log likelihood (pre-update): -54.3352, error rate (pre-update): 0.082279
iter: 2740, Minibatch log likelihood (post-update): -54.3352, error rate (post-update): 0.082275

size_minibatch = 20000
Precon grad coeff: 0.022841, velocity coeff: 1.0209
norm(ch) = 0.62333
iter: 2741, Minibatch log likelihood (pre-update): -54.3352, error rate (pre-update): 0.082275

size_minibatch = 20000
Precon grad coeff: 0.024713, velocity coeff: 1.0291
norm(ch) = 0.64317
iter: 2742, Minibatch log likelihood (pre-update): -54.3352, error rate (pre-update): 0.082267

size_minibatch = 20000
Precon grad coeff: 0.028138, velocity coeff: 1.1193
norm(ch) = 0.72168
iter: 2743, Minibatch log likelihood (pre-update): -54.3351, error rate (pre-update): 0.082257

size_minibatch = 20000
Precon grad coeff: 0.027936, velocity coeff: 0.94381
norm(ch) = 0.68313
iter: 2744, Minibatch log likelihood (pre-update): -54.3351, error rate (pre-update): 0.082249

size_minibatch = 20000
Precon grad coeff: 0.023465, velocity coeff: 0.95993
norm(ch) = 0.65733
rho = 0.96546
New lambda: 2.9711e-059
iter: 2745, Minibatch log likelihood (pre-update): -54.335, error rate (pre-update): 0.082242
iter: 2745, Minibatch log likelihood (post-update): -54.335, error rate (post-update): 0.082235

size_minibatch = 20000
Precon grad coeff: 0.023488, velocity coeff: 0.98135
norm(ch) = 0.6467
iter: 2746, Minibatch log likelihood (pre-update): -54.335, error rate (pre-update): 0.082235

size_minibatch = 20000
Precon grad coeff: 0.020773, velocity coeff: 0.92991
norm(ch) = 0.60277
iter: 2747, Minibatch log likelihood (pre-update): -54.3349, error rate (pre-update): 0.082229

size_minibatch = 20000
Precon grad coeff: 0.02114, velocity coeff: 1.0478
norm(ch) = 0.63304
iter: 2748, Minibatch log likelihood (pre-update): -54.3349, error rate (pre-update): 0.082215

size_minibatch = 20000
Precon grad coeff: 0.025489, velocity coeff: 1.0591
norm(ch) = 0.6722
iter: 2749, Minibatch log likelihood (pre-update): -54.3348, error rate (pre-update): 0.082203

size_minibatch = 20000
Precon grad coeff: 0.026087, velocity coeff: 0.99597
norm(ch) = 0.67104
rho = 1.0535
New lambda: 2.299e-059
iter: 2750, Minibatch log likelihood (pre-update): -54.3348, error rate (pre-update): 0.082201
iter: 2750, Minibatch log likelihood (post-update): -54.3347, error rate (post-update): 0.082191
---
Full log-likelihood: -54.3347, error rate: 0.082191
TEST log-likelihood: -55.0602, error rate: 0.33948
Error difference (test - train): 0.25729
---
Full log-likelihood (averaged params): -54.3553, error rate (averaged params): 0.089858
TEST log-likelihood (averaged params): -55.0051, error rate (averaged params): 0.32635
Error difference (test - train) (averaged params): 0.2365

size_minibatch = 20000
Precon grad coeff: 0.027655, velocity coeff: 0.99905
norm(ch) = 0.67223
iter: 2751, Minibatch log likelihood (pre-update): -54.3347, error rate (pre-update): 0.082191

size_minibatch = 20000
Precon grad coeff: 0.027748, velocity coeff: 1.0501
norm(ch) = 0.70783
iter: 2752, Minibatch log likelihood (pre-update): -54.3347, error rate (pre-update): 0.082186

size_minibatch = 20000
Precon grad coeff: 0.026549, velocity coeff: 0.91253
norm(ch) = 0.64767
iter: 2753, Minibatch log likelihood (pre-update): -54.3346, error rate (pre-update): 0.082178

size_minibatch = 20000
Precon grad coeff: 0.018471, velocity coeff: 0.87927
norm(ch) = 0.57064
iter: 2754, Minibatch log likelihood (pre-update): -54.3346, error rate (pre-update): 0.082167

size_minibatch = 20000
Precon grad coeff: 0.022133, velocity coeff: 1.1339
norm(ch) = 0.64857
rho = 1.089
New lambda: 1.7789e-059
iter: 2755, Minibatch log likelihood (pre-update): -54.3345, error rate (pre-update): 0.08216
iter: 2755, Minibatch log likelihood (post-update): -54.3345, error rate (post-update): 0.082152

size_minibatch = 20000
Precon grad coeff: 0.02412, velocity coeff: 1.0208
norm(ch) = 0.66362
iter: 2756, Minibatch log likelihood (pre-update): -54.3345, error rate (pre-update): 0.082152

size_minibatch = 20000
Precon grad coeff: 0.026091, velocity coeff: 1.0241
norm(ch) = 0.68126
iter: 2757, Minibatch log likelihood (pre-update): -54.3344, error rate (pre-update): 0.082145

size_minibatch = 20000
Precon grad coeff: 0.022458, velocity coeff: 0.90363
norm(ch) = 0.61698
iter: 2758, Minibatch log likelihood (pre-update): -54.3344, error rate (pre-update): 0.082139

size_minibatch = 20000
Precon grad coeff: 0.023952, velocity coeff: 1.0604
norm(ch) = 0.65566
iter: 2759, Minibatch log likelihood (pre-update): -54.3343, error rate (pre-update): 0.08213

size_minibatch = 20000
Precon grad coeff: 0.023535, velocity coeff: 0.92766
New gamma: 0.0031623
norm(ch) = 0.60994
rho = 0.96772
New lambda: 1.3765e-059
iter: 2760, Minibatch log likelihood (pre-update): -54.3343, error rate (pre-update): 0.082121
iter: 2760, Minibatch log likelihood (post-update): -54.3342, error rate (post-update): 0.082112

size_minibatch = 20000
Precon grad coeff: 0.023664, velocity coeff: 1.0476
norm(ch) = 0.64058
iter: 2761, Minibatch log likelihood (pre-update): -54.3342, error rate (pre-update): 0.082112

size_minibatch = 20000
Precon grad coeff: 0.021687, velocity coeff: 0.92306
norm(ch) = 0.59268
iter: 2762, Minibatch log likelihood (pre-update): -54.3342, error rate (pre-update): 0.082106

size_minibatch = 20000
Precon grad coeff: 0.019678, velocity coeff: 0.9841
norm(ch) = 0.58457
iter: 2763, Minibatch log likelihood (pre-update): -54.3341, error rate (pre-update): 0.082104

size_minibatch = 20000
Precon grad coeff: 0.022647, velocity coeff: 1.1601
norm(ch) = 0.6798
iter: 2764, Minibatch log likelihood (pre-update): -54.3341, error rate (pre-update): 0.082093

size_minibatch = 20000
Precon grad coeff: 0.024002, velocity coeff: 0.93446
norm(ch) = 0.63677
rho = 1.016
New lambda: 1.0651e-059
iter: 2765, Minibatch log likelihood (pre-update): -54.334, error rate (pre-update): 0.082082
iter: 2765, Minibatch log likelihood (post-update): -54.334, error rate (post-update): 0.082077

size_minibatch = 20000
Precon grad coeff: 0.023496, velocity coeff: 1.0462
norm(ch) = 0.66767
iter: 2766, Minibatch log likelihood (pre-update): -54.334, error rate (pre-update): 0.082077

size_minibatch = 20000
Precon grad coeff: 0.024331, velocity coeff: 0.94983
norm(ch) = 0.63578
iter: 2767, Minibatch log likelihood (pre-update): -54.3339, error rate (pre-update): 0.082064

size_minibatch = 20000
Precon grad coeff: 0.023915, velocity coeff: 1.0178
norm(ch) = 0.64867
iter: 2768, Minibatch log likelihood (pre-update): -54.3339, error rate (pre-update): 0.08206

size_minibatch = 20000
Precon grad coeff: 0.021301, velocity coeff: 0.90271
norm(ch) = 0.58686
iter: 2769, Minibatch log likelihood (pre-update): -54.3338, error rate (pre-update): 0.082055

size_minibatch = 20000
Precon grad coeff: 0.019071, velocity coeff: 0.98592
norm(ch) = 0.57985
rho = 0.93837
New lambda: 8.2415e-060
iter: 2770, Minibatch log likelihood (pre-update): -54.3338, error rate (pre-update): 0.082046
iter: 2770, Minibatch log likelihood (post-update): -54.3338, error rate (post-update): 0.082038

size_minibatch = 20000
Precon grad coeff: 0.021661, velocity coeff: 1.0526
norm(ch) = 0.61168
iter: 2771, Minibatch log likelihood (pre-update): -54.3338, error rate (pre-update): 0.082038

size_minibatch = 20000
Precon grad coeff: 0.023844, velocity coeff: 1.0754
norm(ch) = 0.65941
iter: 2772, Minibatch log likelihood (pre-update): -54.3337, error rate (pre-update): 0.08203

size_minibatch = 20000
Precon grad coeff: 0.022653, velocity coeff: 0.95138
norm(ch) = 0.62892
iter: 2773, Minibatch log likelihood (pre-update): -54.3337, error rate (pre-update): 0.082022

size_minibatch = 20000
Precon grad coeff: 0.024356, velocity coeff: 1.0441
norm(ch) = 0.65803
iter: 2774, Minibatch log likelihood (pre-update): -54.3336, error rate (pre-update): 0.082013

size_minibatch = 20000
Precon grad coeff: 0.02234, velocity coeff: 0.92133
norm(ch) = 0.60769
rho = 0.99081
New lambda: 6.3771e-060
iter: 2775, Minibatch log likelihood (pre-update): -54.3336, error rate (pre-update): 0.082005
iter: 2775, Minibatch log likelihood (post-update): -54.3335, error rate (post-update): 0.081996

size_minibatch = 20000
Precon grad coeff: 0.021069, velocity coeff: 0.98409
norm(ch) = 0.59934
iter: 2776, Minibatch log likelihood (pre-update): -54.3335, error rate (pre-update): 0.081996

size_minibatch = 20000
Precon grad coeff: 0.019466, velocity coeff: 0.9775
norm(ch) = 0.58706
iter: 2777, Minibatch log likelihood (pre-update): -54.3335, error rate (pre-update): 0.081988

size_minibatch = 20000
Precon grad coeff: 0.020382, velocity coeff: 0.98465
norm(ch) = 0.57936
iter: 2778, Minibatch log likelihood (pre-update): -54.3334, error rate (pre-update): 0.081984

size_minibatch = 20000
Precon grad coeff: 0.022455, velocity coeff: 1.1371
norm(ch) = 0.66019
iter: 2779, Minibatch log likelihood (pre-update): -54.3334, error rate (pre-update): 0.081982

size_minibatch = 20000
Precon grad coeff: 0.026554, velocity coeff: 0.96774
New gamma: 0.0031623
norm(ch) = 0.64068
rho = 1.0128
New lambda: 4.9345e-060
iter: 2780, Minibatch log likelihood (pre-update): -54.3333, error rate (pre-update): 0.081966
iter: 2780, Minibatch log likelihood (post-update): -54.3333, error rate (post-update): 0.081957

size_minibatch = 20000
Precon grad coeff: 0.024957, velocity coeff: 0.99802
norm(ch) = 0.64111
iter: 2781, Minibatch log likelihood (pre-update): -54.3333, error rate (pre-update): 0.081957

size_minibatch = 20000
Precon grad coeff: 0.025507, velocity coeff: 1.0101
norm(ch) = 0.6494
iter: 2782, Minibatch log likelihood (pre-update): -54.3332, error rate (pre-update): 0.08195

size_minibatch = 20000
Precon grad coeff: 0.024221, velocity coeff: 0.96921
norm(ch) = 0.63135
iter: 2783, Minibatch log likelihood (pre-update): -54.3332, error rate (pre-update): 0.081949

size_minibatch = 20000
Precon grad coeff: 0.023443, velocity coeff: 1.0309
norm(ch) = 0.65249
iter: 2784, Minibatch log likelihood (pre-update): -54.3331, error rate (pre-update): 0.081938

size_minibatch = 20000
Precon grad coeff: 0.023416, velocity coeff: 0.99499
norm(ch) = 0.65084
rho = 1.0123
New lambda: 3.8182e-060
iter: 2785, Minibatch log likelihood (pre-update): -54.3331, error rate (pre-update): 0.081925
iter: 2785, Minibatch log likelihood (post-update): -54.3331, error rate (post-update): 0.081922

size_minibatch = 20000
Precon grad coeff: 0.026767, velocity coeff: 1.052
norm(ch) = 0.68644
iter: 2786, Minibatch log likelihood (pre-update): -54.333, error rate (pre-update): 0.081922

size_minibatch = 20000
Precon grad coeff: 0.026173, velocity coeff: 1.0041
norm(ch) = 0.6911
iter: 2787, Minibatch log likelihood (pre-update): -54.333, error rate (pre-update): 0.081912

size_minibatch = 20000
Precon grad coeff: 0.025447, velocity coeff: 0.91224
norm(ch) = 0.63223
iter: 2788, Minibatch log likelihood (pre-update): -54.3329, error rate (pre-update): 0.081901

size_minibatch = 20000
Precon grad coeff: 0.022127, velocity coeff: 0.99473
norm(ch) = 0.63026
iter: 2789, Minibatch log likelihood (pre-update): -54.3329, error rate (pre-update): 0.081896

size_minibatch = 20000
Precon grad coeff: 0.025904, velocity coeff: 1.0405
norm(ch) = 0.65752
rho = 0.98314
New lambda: 2.9545e-060
iter: 2790, Minibatch log likelihood (pre-update): -54.3329, error rate (pre-update): 0.081883
iter: 2790, Minibatch log likelihood (post-update): -54.3328, error rate (post-update): 0.081883

size_minibatch = 20000
Precon grad coeff: 0.02472, velocity coeff: 0.97327
norm(ch) = 0.64148
iter: 2791, Minibatch log likelihood (pre-update): -54.3328, error rate (pre-update): 0.081883

size_minibatch = 20000
Precon grad coeff: 0.022021, velocity coeff: 0.92788
norm(ch) = 0.59672
iter: 2792, Minibatch log likelihood (pre-update): -54.3328, error rate (pre-update): 0.081872

size_minibatch = 20000
Precon grad coeff: 0.021854, velocity coeff: 1.0412
norm(ch) = 0.62277
iter: 2793, Minibatch log likelihood (pre-update): -54.3327, error rate (pre-update): 0.081859

size_minibatch = 20000
Precon grad coeff: 0.022471, velocity coeff: 0.98365
norm(ch) = 0.61414
iter: 2794, Minibatch log likelihood (pre-update): -54.3327, error rate (pre-update): 0.08186

size_minibatch = 20000
Precon grad coeff: 0.020655, velocity coeff: 0.95468
norm(ch) = 0.58765
rho = 1.0255
New lambda: 2.2861e-060
iter: 2795, Minibatch log likelihood (pre-update): -54.3326, error rate (pre-update): 0.08185
iter: 2795, Minibatch log likelihood (post-update): -54.3326, error rate (post-update): 0.081838

size_minibatch = 20000
Precon grad coeff: 0.020987, velocity coeff: 1.0428
norm(ch) = 0.61417
iter: 2796, Minibatch log likelihood (pre-update): -54.3326, error rate (pre-update): 0.081838

size_minibatch = 20000
Precon grad coeff: 0.024152, velocity coeff: 1.0724
norm(ch) = 0.66025
iter: 2797, Minibatch log likelihood (pre-update): -54.3325, error rate (pre-update): 0.081833

size_minibatch = 20000
Precon grad coeff: 0.023885, velocity coeff: 0.94323
norm(ch) = 0.6242
iter: 2798, Minibatch log likelihood (pre-update): -54.3325, error rate (pre-update): 0.08183

size_minibatch = 20000
Precon grad coeff: 0.023604, velocity coeff: 1.0203
norm(ch) = 0.63835
iter: 2799, Minibatch log likelihood (pre-update): -54.3324, error rate (pre-update): 0.081821

size_minibatch = 20000
Precon grad coeff: 0.025511, velocity coeff: 0.99996
New gamma: 0.0031623
norm(ch) = 0.64006
rho = 1.0799
New lambda: 1.7689e-060
iter: 2800, Minibatch log likelihood (pre-update): -54.3324, error rate (pre-update): 0.081806
iter: 2800, Minibatch log likelihood (post-update): -54.3323, error rate (post-update): 0.081801
---
Full log-likelihood: -54.3323, error rate: 0.081801
TEST log-likelihood: -55.0782, error rate: 0.34428
Error difference (test - train): 0.26248
---
Full log-likelihood (averaged params): -54.353, error rate (averaged params): 0.089488
TEST log-likelihood (averaged params): -55.022, error rate (averaged params): 0.3309
Error difference (test - train) (averaged params): 0.24141

size_minibatch = 20000
Precon grad coeff: 0.024625, velocity coeff: 0.97872
norm(ch) = 0.62814
iter: 2801, Minibatch log likelihood (pre-update): -54.3323, error rate (pre-update): 0.081801

size_minibatch = 20000
Precon grad coeff: 0.024435, velocity coeff: 0.99738
norm(ch) = 0.62823
iter: 2802, Minibatch log likelihood (pre-update): -54.3323, error rate (pre-update): 0.081793

size_minibatch = 20000
Precon grad coeff: 0.022474, velocity coeff: 0.98333
norm(ch) = 0.61923
iter: 2803, Minibatch log likelihood (pre-update): -54.3322, error rate (pre-update): 0.081788

size_minibatch = 20000
Precon grad coeff: 0.019396, velocity coeff: 0.91709
norm(ch) = 0.56916
iter: 2804, Minibatch log likelihood (pre-update): -54.3322, error rate (pre-update): 0.081779

size_minibatch = 20000
Precon grad coeff: 0.020506, velocity coeff: 1.0824
norm(ch) = 0.6175
rho = 1.0083
New lambda: 1.3688e-060
iter: 2805, Minibatch log likelihood (pre-update): -54.3322, error rate (pre-update): 0.08177
iter: 2805, Minibatch log likelihood (post-update): -54.3321, error rate (post-update): 0.081764

size_minibatch = 20000
Precon grad coeff: 0.024147, velocity coeff: 1.0747
norm(ch) = 0.66527
iter: 2806, Minibatch log likelihood (pre-update): -54.3321, error rate (pre-update): 0.081764

size_minibatch = 20000
Precon grad coeff: 0.02492, velocity coeff: 0.9643
norm(ch) = 0.64324
iter: 2807, Minibatch log likelihood (pre-update): -54.3321, error rate (pre-update): 0.081763

size_minibatch = 20000
Precon grad coeff: 0.023308, velocity coeff: 0.97393
norm(ch) = 0.6279
iter: 2808, Minibatch log likelihood (pre-update): -54.332, error rate (pre-update): 0.081744

size_minibatch = 20000
Precon grad coeff: 0.025289, velocity coeff: 1.0483
norm(ch) = 0.65995
iter: 2809, Minibatch log likelihood (pre-update): -54.332, error rate (pre-update): 0.081739

size_minibatch = 20000
Precon grad coeff: 0.024606, velocity coeff: 0.91868
norm(ch) = 0.60787
rho = 1.0627
New lambda: 1.0591e-060
iter: 2810, Minibatch log likelihood (pre-update): -54.3319, error rate (pre-update): 0.081732
iter: 2810, Minibatch log likelihood (post-update): -54.3319, error rate (post-update): 0.081724

size_minibatch = 20000
Precon grad coeff: 0.02396, velocity coeff: 1.0582
norm(ch) = 0.64483
iter: 2811, Minibatch log likelihood (pre-update): -54.3319, error rate (pre-update): 0.081724

size_minibatch = 20000
Precon grad coeff: 0.024053, velocity coeff: 0.96777
norm(ch) = 0.62579
iter: 2812, Minibatch log likelihood (pre-update): -54.3318, error rate (pre-update): 0.081721

size_minibatch = 20000
Precon grad coeff: 0.021188, velocity coeff: 0.95848
norm(ch) = 0.60102
iter: 2813, Minibatch log likelihood (pre-update): -54.3318, error rate (pre-update): 0.081711

size_minibatch = 20000
Precon grad coeff: 0.018684, velocity coeff: 0.92976
norm(ch) = 0.55993
iter: 2814, Minibatch log likelihood (pre-update): -54.3317, error rate (pre-update): 0.081701

size_minibatch = 20000
Precon grad coeff: 0.020746, velocity coeff: 1.0775
norm(ch) = 0.60468
rho = 1.0668
New lambda: 8.1954e-061
iter: 2815, Minibatch log likelihood (pre-update): -54.3317, error rate (pre-update): 0.081692
iter: 2815, Minibatch log likelihood (post-update): -54.3317, error rate (post-update): 0.081689

size_minibatch = 20000
Precon grad coeff: 0.02306, velocity coeff: 1.0492
norm(ch) = 0.63586
iter: 2816, Minibatch log likelihood (pre-update): -54.3317, error rate (pre-update): 0.081689

size_minibatch = 20000
Precon grad coeff: 0.024697, velocity coeff: 1.0114
norm(ch) = 0.64469
iter: 2817, Minibatch log likelihood (pre-update): -54.3316, error rate (pre-update): 0.081683

size_minibatch = 20000
Precon grad coeff: 0.024243, velocity coeff: 0.97902
norm(ch) = 0.63271
iter: 2818, Minibatch log likelihood (pre-update): -54.3316, error rate (pre-update): 0.081674

size_minibatch = 20000
Precon grad coeff: 0.022931, velocity coeff: 0.95676
norm(ch) = 0.60684
iter: 2819, Minibatch log likelihood (pre-update): -54.3315, error rate (pre-update): 0.081666

size_minibatch = 20000
Precon grad coeff: 0.025194, velocity coeff: 1.0509
New gamma: 0.0031623
norm(ch) = 0.63936
rho = 1.1051
New lambda: 6.3414e-061
iter: 2820, Minibatch log likelihood (pre-update): -54.3315, error rate (pre-update): 0.081657
iter: 2820, Minibatch log likelihood (post-update): -54.3314, error rate (post-update): 0.081655

size_minibatch = 20000
Precon grad coeff: 0.023436, velocity coeff: 0.93649
norm(ch) = 0.60024
iter: 2821, Minibatch log likelihood (pre-update): -54.3314, error rate (pre-update): 0.081655

size_minibatch = 20000
Precon grad coeff: 0.020639, velocity coeff: 0.97762
norm(ch) = 0.58831
iter: 2822, Minibatch log likelihood (pre-update): -54.3314, error rate (pre-update): 0.081644

size_minibatch = 20000
Precon grad coeff: 0.019758, velocity coeff: 0.99776
norm(ch) = 0.58829
iter: 2823, Minibatch log likelihood (pre-update): -54.3313, error rate (pre-update): 0.081637

size_minibatch = 20000
Precon grad coeff: 0.019927, velocity coeff: 1.0064
norm(ch) = 0.59342
iter: 2824, Minibatch log likelihood (pre-update): -54.3313, error rate (pre-update): 0.081634

size_minibatch = 20000
Precon grad coeff: 0.024973, velocity coeff: 1.126
norm(ch) = 0.66991
rho = 1.0011
New lambda: 4.9069e-061
iter: 2825, Minibatch log likelihood (pre-update): -54.3312, error rate (pre-update): 0.081627
iter: 2825, Minibatch log likelihood (post-update): -54.3312, error rate (post-update): 0.081618

size_minibatch = 20000
Precon grad coeff: 0.023982, velocity coeff: 0.94898
norm(ch) = 0.63725
iter: 2826, Minibatch log likelihood (pre-update): -54.3312, error rate (pre-update): 0.081618

size_minibatch = 20000
Precon grad coeff: 0.022504, velocity coeff: 0.94477
norm(ch) = 0.60346
iter: 2827, Minibatch log likelihood (pre-update): -54.3312, error rate (pre-update): 0.081613

size_minibatch = 20000
Precon grad coeff: 0.024721, velocity coeff: 1.0657
norm(ch) = 0.6448
iter: 2828, Minibatch log likelihood (pre-update): -54.3311, error rate (pre-update): 0.081602

size_minibatch = 20000
Precon grad coeff: 0.024046, velocity coeff: 0.95563
norm(ch) = 0.61769
iter: 2829, Minibatch log likelihood (pre-update): -54.3311, error rate (pre-update): 0.081598

size_minibatch = 20000
Precon grad coeff: 0.022529, velocity coeff: 0.97089
norm(ch) = 0.60119
rho = 1.0498
New lambda: 3.7968e-061
iter: 2830, Minibatch log likelihood (pre-update): -54.331, error rate (pre-update): 0.081587
iter: 2830, Minibatch log likelihood (post-update): -54.331, error rate (post-update): 0.08158

size_minibatch = 20000
Precon grad coeff: 0.020313, velocity coeff: 0.94556
norm(ch) = 0.56984
iter: 2831, Minibatch log likelihood (pre-update): -54.331, error rate (pre-update): 0.08158

size_minibatch = 20000
Precon grad coeff: 0.018411, velocity coeff: 0.9953
norm(ch) = 0.56828
iter: 2832, Minibatch log likelihood (pre-update): -54.3309, error rate (pre-update): 0.081575

size_minibatch = 20000
Precon grad coeff: 0.021204, velocity coeff: 1.0809
norm(ch) = 0.61567
iter: 2833, Minibatch log likelihood (pre-update): -54.3309, error rate (pre-update): 0.081567

size_minibatch = 20000
Precon grad coeff: 0.026945, velocity coeff: 1.0997
norm(ch) = 0.67863
iter: 2834, Minibatch log likelihood (pre-update): -54.3308, error rate (pre-update): 0.081563

size_minibatch = 20000
Precon grad coeff: 0.0222, velocity coeff: 0.87086
norm(ch) = 0.59241
rho = 1.0238
New lambda: 2.9379e-061
iter: 2835, Minibatch log likelihood (pre-update): -54.3308, error rate (pre-update): 0.081558
iter: 2835, Minibatch log likelihood (post-update): -54.3307, error rate (post-update): 0.081555

size_minibatch = 20000
Precon grad coeff: 0.022816, velocity coeff: 1.0285
norm(ch) = 0.6108
iter: 2836, Minibatch log likelihood (pre-update): -54.3307, error rate (pre-update): 0.081555

size_minibatch = 20000
Precon grad coeff: 0.022718, velocity coeff: 1.0364
norm(ch) = 0.6344
iter: 2837, Minibatch log likelihood (pre-update): -54.3307, error rate (pre-update): 0.081543

size_minibatch = 20000
Precon grad coeff: 0.02243, velocity coeff: 0.89882
norm(ch) = 0.57164
iter: 2838, Minibatch log likelihood (pre-update): -54.3307, error rate (pre-update): 0.081532

size_minibatch = 20000
Precon grad coeff: 0.01716, velocity coeff: 0.95046
norm(ch) = 0.54431
iter: 2839, Minibatch log likelihood (pre-update): -54.3306, error rate (pre-update): 0.081529

size_minibatch = 20000
Precon grad coeff: 0.021834, velocity coeff: 1.0773
New gamma: 0.0031623
norm(ch) = 0.58809
rho = 0.97512
New lambda: 2.2733e-061
iter: 2840, Minibatch log likelihood (pre-update): -54.3306, error rate (pre-update): 0.081521
iter: 2840, Minibatch log likelihood (post-update): -54.3305, error rate (post-update): 0.081516

size_minibatch = 20000
Precon grad coeff: 0.024292, velocity coeff: 1.0308
norm(ch) = 0.60774
iter: 2841, Minibatch log likelihood (pre-update): -54.3305, error rate (pre-update): 0.081516

size_minibatch = 20000
Precon grad coeff: 0.025301, velocity coeff: 1.0255
norm(ch) = 0.625
iter: 2842, Minibatch log likelihood (pre-update): -54.3305, error rate (pre-update): 0.081513

size_minibatch = 20000
Precon grad coeff: 0.024944, velocity coeff: 0.98576
norm(ch) = 0.61797
iter: 2843, Minibatch log likelihood (pre-update): -54.3304, error rate (pre-update): 0.081503

size_minibatch = 20000
Precon grad coeff: 0.021869, velocity coeff: 0.94897
norm(ch) = 0.58799
iter: 2844, Minibatch log likelihood (pre-update): -54.3304, error rate (pre-update): 0.0815

size_minibatch = 20000
Precon grad coeff: 0.019736, velocity coeff: 1.0268
norm(ch) = 0.60519
rho = 1.0868
New lambda: 1.759e-061
iter: 2845, Minibatch log likelihood (pre-update): -54.3304, error rate (pre-update): 0.081489
iter: 2845, Minibatch log likelihood (post-update): -54.3303, error rate (post-update): 0.081481

size_minibatch = 20000
Precon grad coeff: 0.021521, velocity coeff: 1.0023
norm(ch) = 0.60806
iter: 2846, Minibatch log likelihood (pre-update): -54.3303, error rate (pre-update): 0.081481

size_minibatch = 20000
Precon grad coeff: 0.023666, velocity coeff: 1.1086
norm(ch) = 0.67576
iter: 2847, Minibatch log likelihood (pre-update): -54.3303, error rate (pre-update): 0.081479

size_minibatch = 20000
Precon grad coeff: 0.026089, velocity coeff: 0.94624
norm(ch) = 0.64115
iter: 2848, Minibatch log likelihood (pre-update): -54.3302, error rate (pre-update): 0.081473

size_minibatch = 20000
Precon grad coeff: 0.024135, velocity coeff: 0.97378
norm(ch) = 0.62599
iter: 2849, Minibatch log likelihood (pre-update): -54.3302, error rate (pre-update): 0.081469

size_minibatch = 20000
Precon grad coeff: 0.019739, velocity coeff: 0.87821
norm(ch) = 0.55102
rho = 0.99946
New lambda: 1.3611e-061
iter: 2850, Minibatch log likelihood (pre-update): -54.3301, error rate (pre-update): 0.081456
iter: 2850, Minibatch log likelihood (post-update): -54.3301, error rate (post-update): 0.081447
---
Full log-likelihood: -54.3301, error rate: 0.081447
TEST log-likelihood: -55.0993, error rate: 0.34994
Error difference (test - train): 0.26849
---
Full log-likelihood (averaged params): -54.3507, error rate (averaged params): 0.089123
TEST log-likelihood (averaged params): -55.0408, error rate (averaged params): 0.33588
Error difference (test - train) (averaged params): 0.24676

size_minibatch = 20000
Precon grad coeff: 0.020035, velocity coeff: 1.0416
norm(ch) = 0.57524
iter: 2851, Minibatch log likelihood (pre-update): -54.3301, error rate (pre-update): 0.081447

size_minibatch = 20000
Precon grad coeff: 0.022063, velocity coeff: 1.0453
norm(ch) = 0.60277
iter: 2852, Minibatch log likelihood (pre-update): -54.33, error rate (pre-update): 0.081441

size_minibatch = 20000
Precon grad coeff: 0.023779, velocity coeff: 1.0339
norm(ch) = 0.62496
iter: 2853, Minibatch log likelihood (pre-update): -54.33, error rate (pre-update): 0.081438

size_minibatch = 20000
Precon grad coeff: 0.02465, velocity coeff: 1.0331
norm(ch) = 0.64717
iter: 2854, Minibatch log likelihood (pre-update): -54.3299, error rate (pre-update): 0.081433

size_minibatch = 20000
Precon grad coeff: 0.024048, velocity coeff: 0.96505
norm(ch) = 0.62595
rho = 1.006
New lambda: 1.0532e-061
iter: 2855, Minibatch log likelihood (pre-update): -54.3299, error rate (pre-update): 0.081421
iter: 2855, Minibatch log likelihood (post-update): -54.3298, error rate (post-update): 0.081419

size_minibatch = 20000
Precon grad coeff: 0.021025, velocity coeff: 0.92626
norm(ch) = 0.58109
iter: 2856, Minibatch log likelihood (pre-update): -54.3298, error rate (pre-update): 0.081419

size_minibatch = 20000
Precon grad coeff: 0.019782, velocity coeff: 0.97521
norm(ch) = 0.56808
iter: 2857, Minibatch log likelihood (pre-update): -54.3298, error rate (pre-update): 0.08141

size_minibatch = 20000
Precon grad coeff: 0.019728, velocity coeff: 1.036
norm(ch) = 0.58977
iter: 2858, Minibatch log likelihood (pre-update): -54.3298, error rate (pre-update): 0.081403

size_minibatch = 20000
Precon grad coeff: 0.024804, velocity coeff: 1.072
norm(ch) = 0.63376
iter: 2859, Minibatch log likelihood (pre-update): -54.3297, error rate (pre-update): 0.081401

size_minibatch = 20000
Precon grad coeff: 0.024793, velocity coeff: 0.99011
New gamma: 0.0031623
norm(ch) = 0.62917
rho = 1.0318
New lambda: 8.1495e-062
iter: 2860, Minibatch log likelihood (pre-update): -54.3297, error rate (pre-update): 0.08139
iter: 2860, Minibatch log likelihood (post-update): -54.3296, error rate (post-update): 0.081385

size_minibatch = 20000
Precon grad coeff: 0.025734, velocity coeff: 0.98472
norm(ch) = 0.62126
iter: 2861, Minibatch log likelihood (pre-update): -54.3296, error rate (pre-update): 0.081385

size_minibatch = 20000
Precon grad coeff: 0.023465, velocity coeff: 0.98969
norm(ch) = 0.61651
iter: 2862, Minibatch log likelihood (pre-update): -54.3296, error rate (pre-update): 0.081382

size_minibatch = 20000
Precon grad coeff: 0.022163, velocity coeff: 0.96183
norm(ch) = 0.59447
iter: 2863, Minibatch log likelihood (pre-update): -54.3295, error rate (pre-update): 0.081371

size_minibatch = 20000
Precon grad coeff: 0.020132, velocity coeff: 0.97881
norm(ch) = 0.58319
iter: 2864, Minibatch log likelihood (pre-update): -54.3295, error rate (pre-update): 0.081362

size_minibatch = 20000
Precon grad coeff: 0.024263, velocity coeff: 1.1272
norm(ch) = 0.6591
rho = 1.0072
New lambda: 6.3059e-062
iter: 2865, Minibatch log likelihood (pre-update): -54.3294, error rate (pre-update): 0.08136
iter: 2865, Minibatch log likelihood (post-update): -54.3294, error rate (post-update): 0.081354

size_minibatch = 20000
Precon grad coeff: 0.026699, velocity coeff: 1.0238
norm(ch) = 0.67667
iter: 2866, Minibatch log likelihood (pre-update): -54.3294, error rate (pre-update): 0.081354

size_minibatch = 20000
Precon grad coeff: 0.027008, velocity coeff: 0.96398
norm(ch) = 0.65408
iter: 2867, Minibatch log likelihood (pre-update): -54.3293, error rate (pre-update): 0.081341

size_minibatch = 20000
Precon grad coeff: 0.021793, velocity coeff: 0.85861
norm(ch) = 0.56293
iter: 2868, Minibatch log likelihood (pre-update): -54.3293, error rate (pre-update): 0.081337

size_minibatch = 20000
Precon grad coeff: 0.021017, velocity coeff: 1.0782
norm(ch) = 0.60839
iter: 2869, Minibatch log likelihood (pre-update): -54.3293, error rate (pre-update): 0.08133

size_minibatch = 20000
Precon grad coeff: 0.024236, velocity coeff: 1.0042
norm(ch) = 0.61255
rho = 1.0179
New lambda: 4.8794e-062
iter: 2870, Minibatch log likelihood (pre-update): -54.3292, error rate (pre-update): 0.081323
iter: 2870, Minibatch log likelihood (post-update): -54.3292, error rate (post-update): 0.081322

size_minibatch = 20000
Precon grad coeff: 0.020471, velocity coeff: 0.94343
norm(ch) = 0.57921
iter: 2871, Minibatch log likelihood (pre-update): -54.3292, error rate (pre-update): 0.081322

size_minibatch = 20000
Precon grad coeff: 0.023991, velocity coeff: 1.1014
norm(ch) = 0.63959
iter: 2872, Minibatch log likelihood (pre-update): -54.3291, error rate (pre-update): 0.081317

size_minibatch = 20000
Precon grad coeff: 0.022278, velocity coeff: 0.91209
norm(ch) = 0.58479
iter: 2873, Minibatch log likelihood (pre-update): -54.3291, error rate (pre-update): 0.081301

size_minibatch = 20000
Precon grad coeff: 0.022545, velocity coeff: 1.0707
norm(ch) = 0.62761
iter: 2874, Minibatch log likelihood (pre-update): -54.329, error rate (pre-update): 0.081292

size_minibatch = 20000
Precon grad coeff: 0.025014, velocity coeff: 1.0101
norm(ch) = 0.63556
rho = 0.98676
New lambda: 3.7756e-062
iter: 2875, Minibatch log likelihood (pre-update): -54.329, error rate (pre-update): 0.081288
iter: 2875, Minibatch log likelihood (post-update): -54.3289, error rate (post-update): 0.081279

size_minibatch = 20000
Precon grad coeff: 0.024723, velocity coeff: 0.96731
norm(ch) = 0.6163
iter: 2876, Minibatch log likelihood (pre-update): -54.3289, error rate (pre-update): 0.081279

size_minibatch = 20000
Precon grad coeff: 0.022456, velocity coeff: 0.95961
norm(ch) = 0.59282
iter: 2877, Minibatch log likelihood (pre-update): -54.3289, error rate (pre-update): 0.08128

size_minibatch = 20000
Precon grad coeff: 0.019528, velocity coeff: 0.9408
norm(ch) = 0.55891
iter: 2878, Minibatch log likelihood (pre-update): -54.3289, error rate (pre-update): 0.081271

size_minibatch = 20000
Precon grad coeff: 0.021444, velocity coeff: 1.0855
norm(ch) = 0.60803
iter: 2879, Minibatch log likelihood (pre-update): -54.3288, error rate (pre-update): 0.081261

size_minibatch = 20000
Precon grad coeff: 0.025371, velocity coeff: 1.0291
New gamma: 0.0031623
norm(ch) = 0.62752
rho = 1.0593
New lambda: 2.9215e-062
iter: 2880, Minibatch log likelihood (pre-update): -54.3288, error rate (pre-update): 0.081256
iter: 2880, Minibatch log likelihood (post-update): -54.3287, error rate (post-update): 0.081245

size_minibatch = 20000
Precon grad coeff: 0.026344, velocity coeff: 1.023
norm(ch) = 0.6438
iter: 2881, Minibatch log likelihood (pre-update): -54.3287, error rate (pre-update): 0.081245

size_minibatch = 20000
Precon grad coeff: 0.027347, velocity coeff: 1.0172
norm(ch) = 0.65664
iter: 2882, Minibatch log likelihood (pre-update): -54.3287, error rate (pre-update): 0.081244

size_minibatch = 20000
Precon grad coeff: 0.023664, velocity coeff: 0.90703
norm(ch) = 0.59716
iter: 2883, Minibatch log likelihood (pre-update): -54.3286, error rate (pre-update): 0.081241

size_minibatch = 20000
Precon grad coeff: 0.020708, velocity coeff: 0.98247
norm(ch) = 0.58806
iter: 2884, Minibatch log likelihood (pre-update): -54.3286, error rate (pre-update): 0.081228

size_minibatch = 20000
Precon grad coeff: 0.019933, velocity coeff: 0.95667
norm(ch) = 0.56385
rho = 1.0353
New lambda: 2.2606e-062
iter: 2885, Minibatch log likelihood (pre-update): -54.3285, error rate (pre-update): 0.08122
iter: 2885, Minibatch log likelihood (post-update): -54.3285, error rate (post-update): 0.081215

size_minibatch = 20000
Precon grad coeff: 0.019756, velocity coeff: 1.063
norm(ch) = 0.60066
iter: 2886, Minibatch log likelihood (pre-update): -54.3285, error rate (pre-update): 0.081215

size_minibatch = 20000
Precon grad coeff: 0.026988, velocity coeff: 1.1155
norm(ch) = 0.67187
iter: 2887, Minibatch log likelihood (pre-update): -54.3285, error rate (pre-update): 0.081206

size_minibatch = 20000
Precon grad coeff: 0.025984, velocity coeff: 0.94701
norm(ch) = 0.63805
iter: 2888, Minibatch log likelihood (pre-update): -54.3284, error rate (pre-update): 0.081205

size_minibatch = 20000
Precon grad coeff: 0.023633, velocity coeff: 0.92706
norm(ch) = 0.59304
iter: 2889, Minibatch log likelihood (pre-update): -54.3284, error rate (pre-update): 0.081187

size_minibatch = 20000
Precon grad coeff: 0.020834, velocity coeff: 0.96391
norm(ch) = 0.57298
rho = 0.98192
New lambda: 1.7492e-062
iter: 2890, Minibatch log likelihood (pre-update): -54.3283, error rate (pre-update): 0.081186
iter: 2890, Minibatch log likelihood (post-update): -54.3283, error rate (post-update): 0.081184

size_minibatch = 20000
Precon grad coeff: 0.025326, velocity coeff: 1.1147
norm(ch) = 0.64024
iter: 2891, Minibatch log likelihood (pre-update): -54.3283, error rate (pre-update): 0.081184

size_minibatch = 20000
Precon grad coeff: 0.02386, velocity coeff: 0.94131
norm(ch) = 0.60417
iter: 2892, Minibatch log likelihood (pre-update): -54.3282, error rate (pre-update): 0.081172

size_minibatch = 20000
Precon grad coeff: 0.019928, velocity coeff: 0.88995
norm(ch) = 0.53892
iter: 2893, Minibatch log likelihood (pre-update): -54.3282, error rate (pre-update): 0.081164

size_minibatch = 20000
Precon grad coeff: 0.019003, velocity coeff: 1.0745
norm(ch) = 0.5802
iter: 2894, Minibatch log likelihood (pre-update): -54.3281, error rate (pre-update): 0.081163

size_minibatch = 20000
Precon grad coeff: 0.021953, velocity coeff: 1.0344
norm(ch) = 0.60158
rho = 1.0009
New lambda: 1.3535e-062
iter: 2895, Minibatch log likelihood (pre-update): -54.3281, error rate (pre-update): 0.081158
iter: 2895, Minibatch log likelihood (post-update): -54.3281, error rate (post-update): 0.081143

size_minibatch = 20000
Precon grad coeff: 0.024816, velocity coeff: 1.0399
norm(ch) = 0.62715
iter: 2896, Minibatch log likelihood (pre-update): -54.3281, error rate (pre-update): 0.081143

size_minibatch = 20000
Precon grad coeff: 0.024609, velocity coeff: 0.98795
norm(ch) = 0.62109
iter: 2897, Minibatch log likelihood (pre-update): -54.328, error rate (pre-update): 0.081143

size_minibatch = 20000
Precon grad coeff: 0.022161, velocity coeff: 0.94113
norm(ch) = 0.58588
iter: 2898, Minibatch log likelihood (pre-update): -54.328, error rate (pre-update): 0.081134

size_minibatch = 20000
Precon grad coeff: 0.02414, velocity coeff: 1.0609
norm(ch) = 0.62287
iter: 2899, Minibatch log likelihood (pre-update): -54.3279, error rate (pre-update): 0.081127

size_minibatch = 20000
Precon grad coeff: 0.025782, velocity coeff: 0.97963
New gamma: 0.0031623
norm(ch) = 0.61191
rho = 1.0897
New lambda: 1.0473e-062
iter: 2900, Minibatch log likelihood (pre-update): -54.3279, error rate (pre-update): 0.081127
iter: 2900, Minibatch log likelihood (post-update): -54.3278, error rate (post-update): 0.081111
---
Full log-likelihood: -54.3278, error rate: 0.081111
TEST log-likelihood: -55.119, error rate: 0.35507
Error difference (test - train): 0.27396
---
Full log-likelihood (averaged params): -54.3481, error rate (averaged params): 0.088681
TEST log-likelihood (averaged params): -55.0607, error rate (averaged params): 0.34106
Error difference (test - train) (averaged params): 0.25238

size_minibatch = 20000
Precon grad coeff: 0.021372, velocity coeff: 0.90913
norm(ch) = 0.55771
iter: 2901, Minibatch log likelihood (pre-update): -54.3278, error rate (pre-update): 0.081111

size_minibatch = 20000
Precon grad coeff: 0.022808, velocity coeff: 1.1028
norm(ch) = 0.61664
iter: 2902, Minibatch log likelihood (pre-update): -54.3278, error rate (pre-update): 0.081106

size_minibatch = 20000
Precon grad coeff: 0.022088, velocity coeff: 0.91504
norm(ch) = 0.56552
iter: 2903, Minibatch log likelihood (pre-update): -54.3278, error rate (pre-update): 0.081105

size_minibatch = 20000
Precon grad coeff: 0.019346, velocity coeff: 1.005
norm(ch) = 0.56961
iter: 2904, Minibatch log likelihood (pre-update): -54.3277, error rate (pre-update): 0.081097

size_minibatch = 20000
Precon grad coeff: 0.026288, velocity coeff: 1.165
norm(ch) = 0.66533
rho = 1.009
New lambda: 8.1039e-063
iter: 2905, Minibatch log likelihood (pre-update): -54.3277, error rate (pre-update): 0.081089
iter: 2905, Minibatch log likelihood (post-update): -54.3276, error rate (post-update): 0.081088

size_minibatch = 20000
Precon grad coeff: 0.021507, velocity coeff: 0.8491
norm(ch) = 0.56632
iter: 2906, Minibatch log likelihood (pre-update): -54.3276, error rate (pre-update): 0.081088

size_minibatch = 20000
Precon grad coeff: 0.021269, velocity coeff: 1.0325
norm(ch) = 0.5862
iter: 2907, Minibatch log likelihood (pre-update): -54.3276, error rate (pre-update): 0.081075

size_minibatch = 20000
Precon grad coeff: 0.020488, velocity coeff: 0.97165
norm(ch) = 0.57083
iter: 2908, Minibatch log likelihood (pre-update): -54.3275, error rate (pre-update): 0.081066

size_minibatch = 20000
Precon grad coeff: 0.021819, velocity coeff: 1.0224
norm(ch) = 0.58484
iter: 2909, Minibatch log likelihood (pre-update): -54.3275, error rate (pre-update): 0.081064

size_minibatch = 20000
Precon grad coeff: 0.02343, velocity coeff: 1.0396
norm(ch) = 0.60946
rho = 1.0221
New lambda: 6.2706e-063
iter: 2910, Minibatch log likelihood (pre-update): -54.3275, error rate (pre-update): 0.081058
iter: 2910, Minibatch log likelihood (post-update): -54.3274, error rate (post-update): 0.081054

size_minibatch = 20000
Precon grad coeff: 0.025676, velocity coeff: 1.0376
norm(ch) = 0.63392
iter: 2911, Minibatch log likelihood (pre-update): -54.3274, error rate (pre-update): 0.081054

size_minibatch = 20000
Precon grad coeff: 0.024521, velocity coeff: 0.94732
norm(ch) = 0.60207
iter: 2912, Minibatch log likelihood (pre-update): -54.3274, error rate (pre-update): 0.081038

size_minibatch = 20000
Precon grad coeff: 0.022179, velocity coeff: 0.96374
norm(ch) = 0.5817
iter: 2913, Minibatch log likelihood (pre-update): -54.3273, error rate (pre-update): 0.081035

size_minibatch = 20000
Precon grad coeff: 0.022967, velocity coeff: 1.0285
norm(ch) = 0.59984
iter: 2914, Minibatch log likelihood (pre-update): -54.3273, error rate (pre-update): 0.081035

size_minibatch = 20000
Precon grad coeff: 0.021012, velocity coeff: 0.94882
norm(ch) = 0.57039
rho = 0.97572
New lambda: 4.8521e-063
iter: 2915, Minibatch log likelihood (pre-update): -54.3272, error rate (pre-update): 0.081025
iter: 2915, Minibatch log likelihood (post-update): -54.3272, error rate (post-update): 0.081016

size_minibatch = 20000
Precon grad coeff: 0.019746, velocity coeff: 0.98424
norm(ch) = 0.56243
iter: 2916, Minibatch log likelihood (pre-update): -54.3272, error rate (pre-update): 0.081016

size_minibatch = 20000
Precon grad coeff: 0.020857, velocity coeff: 1.0237
norm(ch) = 0.57696
iter: 2917, Minibatch log likelihood (pre-update): -54.3272, error rate (pre-update): 0.081009

size_minibatch = 20000
Precon grad coeff: 0.022426, velocity coeff: 1.0524
norm(ch) = 0.60858
iter: 2918, Minibatch log likelihood (pre-update): -54.3271, error rate (pre-update): 0.081003

size_minibatch = 20000
Precon grad coeff: 0.02378, velocity coeff: 0.98465
norm(ch) = 0.6007
iter: 2919, Minibatch log likelihood (pre-update): -54.3271, error rate (pre-update): 0.080994

size_minibatch = 20000
Precon grad coeff: 0.024768, velocity coeff: 0.98679
New gamma: 0.0031623
norm(ch) = 0.59441
rho = 1.1021
New lambda: 3.7545e-063
iter: 2920, Minibatch log likelihood (pre-update): -54.327, error rate (pre-update): 0.080982
iter: 2920, Minibatch log likelihood (post-update): -54.327, error rate (post-update): 0.080986

size_minibatch = 20000
Precon grad coeff: 0.021107, velocity coeff: 0.93779
norm(ch) = 0.55874
iter: 2921, Minibatch log likelihood (pre-update): -54.327, error rate (pre-update): 0.080986

size_minibatch = 20000
Precon grad coeff: 0.023763, velocity coeff: 1.1053
norm(ch) = 0.61919
iter: 2922, Minibatch log likelihood (pre-update): -54.327, error rate (pre-update): 0.080979

size_minibatch = 20000
Precon grad coeff: 0.025578, velocity coeff: 1.0119
norm(ch) = 0.6281
iter: 2923, Minibatch log likelihood (pre-update): -54.3269, error rate (pre-update): 0.080968

size_minibatch = 20000
Precon grad coeff: 0.02104, velocity coeff: 0.8963
norm(ch) = 0.56424
iter: 2924, Minibatch log likelihood (pre-update): -54.3269, error rate (pre-update): 0.080962

size_minibatch = 20000
Precon grad coeff: 0.020443, velocity coeff: 1.032
norm(ch) = 0.58351
rho = 1.021
New lambda: 2.9051e-063
iter: 2925, Minibatch log likelihood (pre-update): -54.3268, error rate (pre-update): 0.080952
iter: 2925, Minibatch log likelihood (post-update): -54.3268, error rate (post-update): 0.080946

size_minibatch = 20000
Precon grad coeff: 0.023295, velocity coeff: 1.0615
norm(ch) = 0.62078
iter: 2926, Minibatch log likelihood (pre-update): -54.3268, error rate (pre-update): 0.080946

size_minibatch = 20000
Precon grad coeff: 0.025583, velocity coeff: 1.0146
norm(ch) = 0.63146
iter: 2927, Minibatch log likelihood (pre-update): -54.3267, error rate (pre-update): 0.080944

size_minibatch = 20000
Precon grad coeff: 0.023169, velocity coeff: 0.92979
norm(ch) = 0.58858
iter: 2928, Minibatch log likelihood (pre-update): -54.3267, error rate (pre-update): 0.080934

size_minibatch = 20000
Precon grad coeff: 0.021297, velocity coeff: 0.97685
norm(ch) = 0.5762
iter: 2929, Minibatch log likelihood (pre-update): -54.3266, error rate (pre-update): 0.080926

size_minibatch = 20000
Precon grad coeff: 0.02494, velocity coeff: 1.0659
norm(ch) = 0.61566
rho = 1.0657
New lambda: 2.2479e-063
iter: 2930, Minibatch log likelihood (pre-update): -54.3266, error rate (pre-update): 0.080912
iter: 2930, Minibatch log likelihood (post-update): -54.3266, error rate (post-update): 0.08091

size_minibatch = 20000
Precon grad coeff: 0.022847, velocity coeff: 0.93425
norm(ch) = 0.57653
iter: 2931, Minibatch log likelihood (pre-update): -54.3266, error rate (pre-update): 0.08091

size_minibatch = 20000
Precon grad coeff: 0.023489, velocity coeff: 1.0643
norm(ch) = 0.61497
iter: 2932, Minibatch log likelihood (pre-update): -54.3265, error rate (pre-update): 0.080906

size_minibatch = 20000
Precon grad coeff: 0.023203, velocity coeff: 0.94678
norm(ch) = 0.5836
iter: 2933, Minibatch log likelihood (pre-update): -54.3265, error rate (pre-update): 0.080897

size_minibatch = 20000
Precon grad coeff: 0.020161, velocity coeff: 0.95706
norm(ch) = 0.5598
iter: 2934, Minibatch log likelihood (pre-update): -54.3264, error rate (pre-update): 0.080889

size_minibatch = 20000
Precon grad coeff: 0.021893, velocity coeff: 1.0522
norm(ch) = 0.59034
rho = 1.0899
New lambda: 1.7394e-063
iter: 2935, Minibatch log likelihood (pre-update): -54.3264, error rate (pre-update): 0.080877
iter: 2935, Minibatch log likelihood (post-update): -54.3264, error rate (post-update): 0.080876

size_minibatch = 20000
Precon grad coeff: 0.021381, velocity coeff: 0.99147
norm(ch) = 0.58651
iter: 2936, Minibatch log likelihood (pre-update): -54.3264, error rate (pre-update): 0.080876

size_minibatch = 20000
Precon grad coeff: 0.023611, velocity coeff: 1.0249
norm(ch) = 0.60248
iter: 2937, Minibatch log likelihood (pre-update): -54.3263, error rate (pre-update): 0.080878

size_minibatch = 20000
Precon grad coeff: 0.022663, velocity coeff: 0.94952
norm(ch) = 0.57329
iter: 2938, Minibatch log likelihood (pre-update): -54.3263, error rate (pre-update): 0.080865

size_minibatch = 20000
Precon grad coeff: 0.021132, velocity coeff: 1.009
norm(ch) = 0.57972
iter: 2939, Minibatch log likelihood (pre-update): -54.3262, error rate (pre-update): 0.080855

size_minibatch = 20000
Precon grad coeff: 0.026833, velocity coeff: 1.0549
New gamma: 0.0031623
norm(ch) = 0.61331
rho = 0.97681
New lambda: 1.3459e-063
iter: 2940, Minibatch log likelihood (pre-update): -54.3262, error rate (pre-update): 0.080844
iter: 2940, Minibatch log likelihood (post-update): -54.3261, error rate (post-update): 0.080836

size_minibatch = 20000
Precon grad coeff: 0.024472, velocity coeff: 0.91875
norm(ch) = 0.56503
iter: 2941, Minibatch log likelihood (pre-update): -54.3261, error rate (pre-update): 0.080836

size_minibatch = 20000
Precon grad coeff: 0.022963, velocity coeff: 1.0431
norm(ch) = 0.59095
iter: 2942, Minibatch log likelihood (pre-update): -54.3261, error rate (pre-update): 0.080838

size_minibatch = 20000
Precon grad coeff: 0.022437, velocity coeff: 0.98497
norm(ch) = 0.58347
iter: 2943, Minibatch log likelihood (pre-update): -54.3261, error rate (pre-update): 0.080834

size_minibatch = 20000
Precon grad coeff: 0.022899, velocity coeff: 1.0172
norm(ch) = 0.59501
iter: 2944, Minibatch log likelihood (pre-update): -54.326, error rate (pre-update): 0.080819

size_minibatch = 20000
Precon grad coeff: 0.018837, velocity coeff: 0.91764
norm(ch) = 0.54735
rho = 1.0732
New lambda: 1.0414e-063
iter: 2945, Minibatch log likelihood (pre-update): -54.326, error rate (pre-update): 0.080813
iter: 2945, Minibatch log likelihood (post-update): -54.3259, error rate (post-update): 0.080808

size_minibatch = 20000
Precon grad coeff: 0.020343, velocity coeff: 1.0883
norm(ch) = 0.59693
iter: 2946, Minibatch log likelihood (pre-update): -54.3259, error rate (pre-update): 0.080808

size_minibatch = 20000
Precon grad coeff: 0.026226, velocity coeff: 1.0575
norm(ch) = 0.63292
iter: 2947, Minibatch log likelihood (pre-update): -54.3259, error rate (pre-update): 0.080803

size_minibatch = 20000
Precon grad coeff: 0.021943, velocity coeff: 0.90598
norm(ch) = 0.57469
iter: 2948, Minibatch log likelihood (pre-update): -54.3259, error rate (pre-update): 0.080793

size_minibatch = 20000
Precon grad coeff: 0.023599, velocity coeff: 1.034
norm(ch) = 0.59567
iter: 2949, Minibatch log likelihood (pre-update): -54.3258, error rate (pre-update): 0.080787

size_minibatch = 20000
Precon grad coeff: 0.023612, velocity coeff: 0.97247
norm(ch) = 0.58079
rho = 0.95587
New lambda: 8.0585e-064
iter: 2950, Minibatch log likelihood (pre-update): -54.3258, error rate (pre-update): 0.080782
iter: 2950, Minibatch log likelihood (post-update): -54.3257, error rate (post-update): 0.080778
---
Full log-likelihood: -54.3257, error rate: 0.080778
TEST log-likelihood: -55.138, error rate: 0.35991
Error difference (test - train): 0.27913
---
Full log-likelihood (averaged params): -54.3451, error rate (averaged params): 0.088088
TEST log-likelihood (averaged params): -55.0798, error rate (averaged params): 0.34601
Error difference (test - train) (averaged params): 0.25792

size_minibatch = 20000
Precon grad coeff: 0.023165, velocity coeff: 1.0052
norm(ch) = 0.5852
iter: 2951, Minibatch log likelihood (pre-update): -54.3257, error rate (pre-update): 0.080778

size_minibatch = 20000
Precon grad coeff: 0.023255, velocity coeff: 0.99484
norm(ch) = 0.5836
iter: 2952, Minibatch log likelihood (pre-update): -54.3257, error rate (pre-update): 0.080768

size_minibatch = 20000
Precon grad coeff: 0.020568, velocity coeff: 0.94513
norm(ch) = 0.55295
iter: 2953, Minibatch log likelihood (pre-update): -54.3256, error rate (pre-update): 0.080767

size_minibatch = 20000
Precon grad coeff: 0.018477, velocity coeff: 0.95939
norm(ch) = 0.53153
iter: 2954, Minibatch log likelihood (pre-update): -54.3256, error rate (pre-update): 0.080756

size_minibatch = 20000
Precon grad coeff: 0.022339, velocity coeff: 1.1314
norm(ch) = 0.60279
rho = 1.0532
New lambda: 6.2355e-064
iter: 2955, Minibatch log likelihood (pre-update): -54.3256, error rate (pre-update): 0.080745
iter: 2955, Minibatch log likelihood (post-update): -54.3255, error rate (post-update): 0.080742

size_minibatch = 20000
Precon grad coeff: 0.023269, velocity coeff: 0.98953
norm(ch) = 0.59792
iter: 2956, Minibatch log likelihood (pre-update): -54.3255, error rate (pre-update): 0.080742

size_minibatch = 20000
Precon grad coeff: 0.023601, velocity coeff: 1.0108
norm(ch) = 0.60572
iter: 2957, Minibatch log likelihood (pre-update): -54.3255, error rate (pre-update): 0.080738

size_minibatch = 20000
Precon grad coeff: 0.022607, velocity coeff: 0.93292
norm(ch) = 0.56647
iter: 2958, Minibatch log likelihood (pre-update): -54.3254, error rate (pre-update): 0.080731

size_minibatch = 20000
Precon grad coeff: 0.021628, velocity coeff: 1.0153
norm(ch) = 0.57644
iter: 2959, Minibatch log likelihood (pre-update): -54.3254, error rate (pre-update): 0.080728

size_minibatch = 20000
Precon grad coeff: 0.025045, velocity coeff: 1.0506
New gamma: 0.0031623
norm(ch) = 0.60707
rho = 1.0234
New lambda: 4.8249e-064
iter: 2960, Minibatch log likelihood (pre-update): -54.3254, error rate (pre-update): 0.080714
iter: 2960, Minibatch log likelihood (post-update): -54.3253, error rate (post-update): 0.080712

size_minibatch = 20000
Precon grad coeff: 0.025782, velocity coeff: 0.98353
norm(ch) = 0.5988
iter: 2961, Minibatch log likelihood (pre-update): -54.3253, error rate (pre-update): 0.080712

size_minibatch = 20000
Precon grad coeff: 0.020342, velocity coeff: 0.91015
norm(ch) = 0.5463
iter: 2962, Minibatch log likelihood (pre-update): -54.3253, error rate (pre-update): 0.080708

size_minibatch = 20000
Precon grad coeff: 0.02234, velocity coeff: 1.0669
norm(ch) = 0.58426
iter: 2963, Minibatch log likelihood (pre-update): -54.3252, error rate (pre-update): 0.080702

size_minibatch = 20000
Precon grad coeff: 0.021589, velocity coeff: 1.0055
norm(ch) = 0.58883
iter: 2964, Minibatch log likelihood (pre-update): -54.3252, error rate (pre-update): 0.080694

size_minibatch = 20000
Precon grad coeff: 0.021325, velocity coeff: 0.95156
norm(ch) = 0.56158
rho = 1.0285
New lambda: 3.7334e-064
iter: 2965, Minibatch log likelihood (pre-update): -54.3252, error rate (pre-update): 0.080681
iter: 2965, Minibatch log likelihood (post-update): -54.3251, error rate (post-update): 0.080677

size_minibatch = 20000
Precon grad coeff: 0.021719, velocity coeff: 1.0535
norm(ch) = 0.59308
iter: 2966, Minibatch log likelihood (pre-update): -54.3251, error rate (pre-update): 0.080677

size_minibatch = 20000
Precon grad coeff: 0.026772, velocity coeff: 1.0837
norm(ch) = 0.64443
iter: 2967, Minibatch log likelihood (pre-update): -54.3251, error rate (pre-update): 0.080677

size_minibatch = 20000
Precon grad coeff: 0.024118, velocity coeff: 0.90952
norm(ch) = 0.58742
iter: 2968, Minibatch log likelihood (pre-update): -54.325, error rate (pre-update): 0.080666

size_minibatch = 20000
Precon grad coeff: 0.022738, velocity coeff: 0.97782
norm(ch) = 0.57587
iter: 2969, Minibatch log likelihood (pre-update): -54.325, error rate (pre-update): 0.080661

size_minibatch = 20000
Precon grad coeff: 0.022448, velocity coeff: 1.0186
norm(ch) = 0.58803
rho = 1.0361
New lambda: 2.8889e-064
iter: 2970, Minibatch log likelihood (pre-update): -54.3249, error rate (pre-update): 0.080653
iter: 2970, Minibatch log likelihood (post-update): -54.3249, error rate (post-update): 0.080647

size_minibatch = 20000
Precon grad coeff: 0.024935, velocity coeff: 1.031
norm(ch) = 0.60786
iter: 2971, Minibatch log likelihood (pre-update): -54.3249, error rate (pre-update): 0.080647

size_minibatch = 20000
Precon grad coeff: 0.020722, velocity coeff: 0.91342
norm(ch) = 0.5565
iter: 2972, Minibatch log likelihood (pre-update): -54.3249, error rate (pre-update): 0.080641

size_minibatch = 20000
Precon grad coeff: 0.020568, velocity coeff: 1.0029
norm(ch) = 0.55934
iter: 2973, Minibatch log likelihood (pre-update): -54.3248, error rate (pre-update): 0.080637

size_minibatch = 20000
Precon grad coeff: 0.021528, velocity coeff: 1.0201
norm(ch) = 0.57187
iter: 2974, Minibatch log likelihood (pre-update): -54.3248, error rate (pre-update): 0.080632

size_minibatch = 20000
Precon grad coeff: 0.020589, velocity coeff: 0.97829
norm(ch) = 0.56074
rho = 1.0305
New lambda: 2.2353e-064
iter: 2975, Minibatch log likelihood (pre-update): -54.3247, error rate (pre-update): 0.080623
iter: 2975, Minibatch log likelihood (post-update): -54.3247, error rate (post-update): 0.080618

size_minibatch = 20000
Precon grad coeff: 0.02534, velocity coeff: 1.1329
norm(ch) = 0.63686
iter: 2976, Minibatch log likelihood (pre-update): -54.3247, error rate (pre-update): 0.080618

size_minibatch = 20000
Precon grad coeff: 0.023896, velocity coeff: 0.89112
norm(ch) = 0.56896
iter: 2977, Minibatch log likelihood (pre-update): -54.3247, error rate (pre-update): 0.08061

size_minibatch = 20000
Precon grad coeff: 0.021107, velocity coeff: 1.0106
norm(ch) = 0.57622
iter: 2978, Minibatch log likelihood (pre-update): -54.3246, error rate (pre-update): 0.080601

size_minibatch = 20000
Precon grad coeff: 0.024066, velocity coeff: 1.0306
norm(ch) = 0.59539
iter: 2979, Minibatch log likelihood (pre-update): -54.3246, error rate (pre-update): 0.080599

size_minibatch = 20000
Precon grad coeff: 0.026006, velocity coeff: 1.0408
New gamma: 0.0031623
norm(ch) = 0.62146
rho = 1.0263
New lambda: 1.7297e-064
iter: 2980, Minibatch log likelihood (pre-update): -54.3245, error rate (pre-update): 0.080592
iter: 2980, Minibatch log likelihood (post-update): -54.3245, error rate (post-update): 0.080584

size_minibatch = 20000
Precon grad coeff: 0.023374, velocity coeff: 0.88768
norm(ch) = 0.55302
iter: 2981, Minibatch log likelihood (pre-update): -54.3245, error rate (pre-update): 0.080584

size_minibatch = 20000
Precon grad coeff: 0.022078, velocity coeff: 1.0524
norm(ch) = 0.58354
iter: 2982, Minibatch log likelihood (pre-update): -54.3244, error rate (pre-update): 0.080579

size_minibatch = 20000
Precon grad coeff: 0.023228, velocity coeff: 1.0108
norm(ch) = 0.59138
iter: 2983, Minibatch log likelihood (pre-update): -54.3244, error rate (pre-update): 0.080571

size_minibatch = 20000
Precon grad coeff: 0.022377, velocity coeff: 0.97661
norm(ch) = 0.57898
iter: 2984, Minibatch log likelihood (pre-update): -54.3244, error rate (pre-update): 0.080563

size_minibatch = 20000
Precon grad coeff: 0.022991, velocity coeff: 1.0563
norm(ch) = 0.61312
rho = 1.0374
New lambda: 1.3384e-064
iter: 2985, Minibatch log likelihood (pre-update): -54.3243, error rate (pre-update): 0.080556
iter: 2985, Minibatch log likelihood (post-update): -54.3243, error rate (post-update): 0.080552

size_minibatch = 20000
Precon grad coeff: 0.025023, velocity coeff: 1.0021
norm(ch) = 0.61596
iter: 2986, Minibatch log likelihood (pre-update): -54.3243, error rate (pre-update): 0.080552

size_minibatch = 20000
Precon grad coeff: 0.025842, velocity coeff: 1.0055
norm(ch) = 0.62107
iter: 2987, Minibatch log likelihood (pre-update): -54.3242, error rate (pre-update): 0.080545

size_minibatch = 20000
Precon grad coeff: 0.024946, velocity coeff: 0.97527
norm(ch) = 0.60729
iter: 2988, Minibatch log likelihood (pre-update): -54.3242, error rate (pre-update): 0.08054

size_minibatch = 20000
Precon grad coeff: 0.02251, velocity coeff: 0.93865
norm(ch) = 0.57147
iter: 2989, Minibatch log likelihood (pre-update): -54.3242, error rate (pre-update): 0.080533

size_minibatch = 20000
Precon grad coeff: 0.025234, velocity coeff: 1.0775
norm(ch) = 0.61731
rho = 0.91963
New lambda: 1.0356e-064
iter: 2990, Minibatch log likelihood (pre-update): -54.3241, error rate (pre-update): 0.080522
iter: 2990, Minibatch log likelihood (post-update): -54.3241, error rate (post-update): 0.080523

size_minibatch = 20000
Precon grad coeff: 0.022705, velocity coeff: 0.8941
norm(ch) = 0.55338
iter: 2991, Minibatch log likelihood (pre-update): -54.3241, error rate (pre-update): 0.080523

size_minibatch = 20000
Precon grad coeff: 0.020771, velocity coeff: 1.0499
norm(ch) = 0.58226
iter: 2992, Minibatch log likelihood (pre-update): -54.324, error rate (pre-update): 0.080514

size_minibatch = 20000
Precon grad coeff: 0.02339, velocity coeff: 0.98505
norm(ch) = 0.57509
iter: 2993, Minibatch log likelihood (pre-update): -54.324, error rate (pre-update): 0.080504

size_minibatch = 20000
Precon grad coeff: 0.022059, velocity coeff: 1.0237
norm(ch) = 0.59008
iter: 2994, Minibatch log likelihood (pre-update): -54.324, error rate (pre-update): 0.080499

size_minibatch = 20000
Precon grad coeff: 0.024274, velocity coeff: 1.0133
norm(ch) = 0.59948
rho = 0.94336
New lambda: 8.0134e-065
iter: 2995, Minibatch log likelihood (pre-update): -54.3239, error rate (pre-update): 0.080494
iter: 2995, Minibatch log likelihood (post-update): -54.3239, error rate (post-update): 0.08049

size_minibatch = 20000
Precon grad coeff: 0.026137, velocity coeff: 1.0294
norm(ch) = 0.6186
iter: 2996, Minibatch log likelihood (pre-update): -54.3239, error rate (pre-update): 0.08049

size_minibatch = 20000
Precon grad coeff: 0.022259, velocity coeff: 0.90694
norm(ch) = 0.56233
iter: 2997, Minibatch log likelihood (pre-update): -54.3238, error rate (pre-update): 0.080477

size_minibatch = 20000
Precon grad coeff: 0.02462, velocity coeff: 1.0877
norm(ch) = 0.61313
iter: 2998, Minibatch log likelihood (pre-update): -54.3238, error rate (pre-update): 0.08047

size_minibatch = 20000
Precon grad coeff: 0.023327, velocity coeff: 0.92724
norm(ch) = 0.56993
iter: 2999, Minibatch log likelihood (pre-update): -54.3237, error rate (pre-update): 0.08047

size_minibatch = 20000
Precon grad coeff: 0.021274, velocity coeff: 0.98039
New gamma: 0.0031623
norm(ch) = 0.56022
rho = 1.0001
New lambda: 6.2006e-065
iter: 3000, Minibatch log likelihood (pre-update): -54.3237, error rate (pre-update): 0.080456
iter: 3000, Minibatch log likelihood (post-update): -54.3237, error rate (post-update): 0.080453
---
Full log-likelihood: -54.3237, error rate: 0.080453
TEST log-likelihood: -55.1559, error rate: 0.36459
Error difference (test - train): 0.28414
---
Full log-likelihood (averaged params): -54.342, error rate (averaged params): 0.087411
TEST log-likelihood (averaged params): -55.0986, error rate (averaged params): 0.35087
Error difference (test - train) (averaged params): 0.26346

size_minibatch = 20000
Precon grad coeff: 0.020702, velocity coeff: 0.97972
norm(ch) = 0.55011
iter: 3001, Minibatch log likelihood (pre-update): -54.3237, error rate (pre-update): 0.080453

size_minibatch = 20000
Precon grad coeff: 0.021438, velocity coeff: 1.0422
norm(ch) = 0.57462
iter: 3002, Minibatch log likelihood (pre-update): -54.3236, error rate (pre-update): 0.08045

size_minibatch = 20000
Precon grad coeff: 0.021417, velocity coeff: 1.0069
norm(ch) = 0.57984
iter: 3003, Minibatch log likelihood (pre-update): -54.3236, error rate (pre-update): 0.080438

size_minibatch = 20000
Precon grad coeff: 0.023898, velocity coeff: 1.003
norm(ch) = 0.58305
iter: 3004, Minibatch log likelihood (pre-update): -54.3235, error rate (pre-update): 0.080441

size_minibatch = 20000
Precon grad coeff: 0.020631, velocity coeff: 0.95638
norm(ch) = 0.5589
rho = 1.1014
New lambda: 4.7979e-065
iter: 3005, Minibatch log likelihood (pre-update): -54.3235, error rate (pre-update): 0.08043
iter: 3005, Minibatch log likelihood (post-update): -54.3235, error rate (post-update): 0.080418

size_minibatch = 20000
Precon grad coeff: 0.022039, velocity coeff: 1.0144
norm(ch) = 0.5682
iter: 3006, Minibatch log likelihood (pre-update): -54.3235, error rate (pre-update): 0.080418

size_minibatch = 20000
Precon grad coeff: 0.025695, velocity coeff: 1.1059
norm(ch) = 0.62989
iter: 3007, Minibatch log likelihood (pre-update): -54.3234, error rate (pre-update): 0.080414

size_minibatch = 20000
Precon grad coeff: 0.023315, velocity coeff: 0.8738
norm(ch) = 0.55175
iter: 3008, Minibatch log likelihood (pre-update): -54.3234, error rate (pre-update): 0.080408

size_minibatch = 20000
Precon grad coeff: 0.018675, velocity coeff: 0.9624
norm(ch) = 0.53206
iter: 3009, Minibatch log likelihood (pre-update): -54.3234, error rate (pre-update): 0.080404

size_minibatch = 20000
Precon grad coeff: 0.021503, velocity coeff: 1.0512
norm(ch) = 0.56057
rho = 0.96775
New lambda: 3.7125e-065
iter: 3010, Minibatch log likelihood (pre-update): -54.3233, error rate (pre-update): 0.080395
iter: 3010, Minibatch log likelihood (post-update): -54.3233, error rate (post-update): 0.08039

size_minibatch = 20000
Precon grad coeff: 0.020981, velocity coeff: 0.99873
norm(ch) = 0.56115
iter: 3011, Minibatch log likelihood (pre-update): -54.3233, error rate (pre-update): 0.08039

size_minibatch = 20000
Precon grad coeff: 0.022413, velocity coeff: 1.0335
norm(ch) = 0.58125
iter: 3012, Minibatch log likelihood (pre-update): -54.3232, error rate (pre-update): 0.080383

size_minibatch = 20000
Precon grad coeff: 0.023953, velocity coeff: 1.0146
norm(ch) = 0.59105
iter: 3013, Minibatch log likelihood (pre-update): -54.3232, error rate (pre-update): 0.080374

size_minibatch = 20000
Precon grad coeff: 0.023396, velocity coeff: 0.95409
norm(ch) = 0.56526
iter: 3014, Minibatch log likelihood (pre-update): -54.3232, error rate (pre-update): 0.08037

size_minibatch = 20000
Precon grad coeff: 0.02103, velocity coeff: 0.97822
norm(ch) = 0.55413
rho = 1.0207
New lambda: 2.8727e-065
iter: 3015, Minibatch log likelihood (pre-update): -54.3231, error rate (pre-update): 0.080364
iter: 3015, Minibatch log likelihood (post-update): -54.3231, error rate (post-update): 0.080361

size_minibatch = 20000
Precon grad coeff: 0.020456, velocity coeff: 0.95529
norm(ch) = 0.53057
iter: 3016, Minibatch log likelihood (pre-update): -54.3231, error rate (pre-update): 0.080361

size_minibatch = 20000
Precon grad coeff: 0.020734, velocity coeff: 1.0595
norm(ch) = 0.56334
iter: 3017, Minibatch log likelihood (pre-update): -54.3231, error rate (pre-update): 0.080352

size_minibatch = 20000
Precon grad coeff: 0.020636, velocity coeff: 0.95868
norm(ch) = 0.54124
iter: 3018, Minibatch log likelihood (pre-update): -54.323, error rate (pre-update): 0.080346

size_minibatch = 20000
Precon grad coeff: 0.02216, velocity coeff: 1.0516
norm(ch) = 0.57045
iter: 3019, Minibatch log likelihood (pre-update): -54.323, error rate (pre-update): 0.080337

size_minibatch = 20000
Precon grad coeff: 0.021751, velocity coeff: 0.96616
New gamma: 0.0031623
norm(ch) = 0.55236
rho = 1.0336
New lambda: 2.2228e-065
iter: 3020, Minibatch log likelihood (pre-update): -54.3229, error rate (pre-update): 0.080331
iter: 3020, Minibatch log likelihood (post-update): -54.3229, error rate (post-update): 0.080333

size_minibatch = 20000
Precon grad coeff: 0.022749, velocity coeff: 1.0461
norm(ch) = 0.57918
iter: 3021, Minibatch log likelihood (pre-update): -54.3229, error rate (pre-update): 0.080333

size_minibatch = 20000
Precon grad coeff: 0.023451, velocity coeff: 0.98673
norm(ch) = 0.57293
iter: 3022, Minibatch log likelihood (pre-update): -54.3229, error rate (pre-update): 0.080321

size_minibatch = 20000
Precon grad coeff: 0.020027, velocity coeff: 0.94724
norm(ch) = 0.54392
iter: 3023, Minibatch log likelihood (pre-update): -54.3228, error rate (pre-update): 0.080311

size_minibatch = 20000
Precon grad coeff: 0.020654, velocity coeff: 1.0244
norm(ch) = 0.55839
iter: 3024, Minibatch log likelihood (pre-update): -54.3228, error rate (pre-update): 0.080308

size_minibatch = 20000
Precon grad coeff: 0.02189, velocity coeff: 1.0165
norm(ch) = 0.56887
rho = 1.0971
New lambda: 1.72e-065
iter: 3025, Minibatch log likelihood (pre-update): -54.3228, error rate (pre-update): 0.080304
iter: 3025, Minibatch log likelihood (post-update): -54.3227, error rate (post-update): 0.080299

size_minibatch = 20000
Precon grad coeff: 0.022468, velocity coeff: 1.0137
norm(ch) = 0.57786
iter: 3026, Minibatch log likelihood (pre-update): -54.3227, error rate (pre-update): 0.080299

size_minibatch = 20000
Precon grad coeff: 0.021487, velocity coeff: 0.94186
norm(ch) = 0.54556
iter: 3027, Minibatch log likelihood (pre-update): -54.3227, error rate (pre-update): 0.080294

size_minibatch = 20000
Precon grad coeff: 0.022377, velocity coeff: 1.0508
norm(ch) = 0.57447
iter: 3028, Minibatch log likelihood (pre-update): -54.3226, error rate (pre-update): 0.080285

size_minibatch = 20000
Precon grad coeff: 0.022367, velocity coeff: 0.95515
norm(ch) = 0.54999
iter: 3029, Minibatch log likelihood (pre-update): -54.3226, error rate (pre-update): 0.080282

size_minibatch = 20000
Precon grad coeff: 0.019456, velocity coeff: 0.94353
norm(ch) = 0.52004
rho = 1.0014
New lambda: 1.3309e-065
iter: 3030, Minibatch log likelihood (pre-update): -54.3226, error rate (pre-update): 0.080272
iter: 3030, Minibatch log likelihood (post-update): -54.3225, error rate (post-update): 0.080264

size_minibatch = 20000
Precon grad coeff: 0.02111, velocity coeff: 1.0777
norm(ch) = 0.56155
iter: 3031, Minibatch log likelihood (pre-update): -54.3225, error rate (pre-update): 0.080264

size_minibatch = 20000
Precon grad coeff: 0.023085, velocity coeff: 1.0129
norm(ch) = 0.57006
iter: 3032, Minibatch log likelihood (pre-update): -54.3225, error rate (pre-update): 0.080264

size_minibatch = 20000
Precon grad coeff: 0.021396, velocity coeff: 0.96236
norm(ch) = 0.54985
iter: 3033, Minibatch log likelihood (pre-update): -54.3224, error rate (pre-update): 0.080259

size_minibatch = 20000
Precon grad coeff: 0.021302, velocity coeff: 1.0255
norm(ch) = 0.56499
iter: 3034, Minibatch log likelihood (pre-update): -54.3224, error rate (pre-update): 0.08025

size_minibatch = 20000
Precon grad coeff: 0.023147, velocity coeff: 1.0013
norm(ch) = 0.56701
rho = 1.0344
New lambda: 1.0298e-065
iter: 3035, Minibatch log likelihood (pre-update): -54.3224, error rate (pre-update): 0.080247
iter: 3035, Minibatch log likelihood (post-update): -54.3223, error rate (post-update): 0.080241

size_minibatch = 20000
Precon grad coeff: 0.02006, velocity coeff: 0.94238
norm(ch) = 0.53542
iter: 3036, Minibatch log likelihood (pre-update): -54.3223, error rate (pre-update): 0.080241

size_minibatch = 20000
Precon grad coeff: 0.020557, velocity coeff: 1.0165
norm(ch) = 0.5453
iter: 3037, Minibatch log likelihood (pre-update): -54.3223, error rate (pre-update): 0.080234

size_minibatch = 20000
Precon grad coeff: 0.020534, velocity coeff: 1.0018
norm(ch) = 0.54743
iter: 3038, Minibatch log likelihood (pre-update): -54.3223, error rate (pre-update): 0.080226

size_minibatch = 20000
Precon grad coeff: 0.022779, velocity coeff: 1.0199
norm(ch) = 0.55965
iter: 3039, Minibatch log likelihood (pre-update): -54.3222, error rate (pre-update): 0.080218

size_minibatch = 20000
Precon grad coeff: 0.022533, velocity coeff: 1.0164
New gamma: 0.0031623
norm(ch) = 0.57012
rho = 1.0249
New lambda: 7.9685e-066
iter: 3040, Minibatch log likelihood (pre-update): -54.3222, error rate (pre-update): 0.080216
iter: 3040, Minibatch log likelihood (post-update): -54.3222, error rate (post-update): 0.080215

size_minibatch = 20000
Precon grad coeff: 0.024607, velocity coeff: 1.0082
norm(ch) = 0.57629
iter: 3041, Minibatch log likelihood (pre-update): -54.3222, error rate (pre-update): 0.080215

size_minibatch = 20000
Precon grad coeff: 0.023645, velocity coeff: 0.97705
norm(ch) = 0.56438
iter: 3042, Minibatch log likelihood (pre-update): -54.3221, error rate (pre-update): 0.080201

size_minibatch = 20000
Precon grad coeff: 0.020611, velocity coeff: 0.95927
norm(ch) = 0.54259
iter: 3043, Minibatch log likelihood (pre-update): -54.3221, error rate (pre-update): 0.0802

size_minibatch = 20000
Precon grad coeff: 0.021732, velocity coeff: 1.0392
norm(ch) = 0.56517
iter: 3044, Minibatch log likelihood (pre-update): -54.322, error rate (pre-update): 0.080195

size_minibatch = 20000
Precon grad coeff: 0.021618, velocity coeff: 0.98544
norm(ch) = 0.55818
rho = 1.0517
New lambda: 6.1659e-066
iter: 3045, Minibatch log likelihood (pre-update): -54.322, error rate (pre-update): 0.080186
iter: 3045, Minibatch log likelihood (post-update): -54.322, error rate (post-update): 0.080183

size_minibatch = 20000
Precon grad coeff: 0.022869, velocity coeff: 1.0412
norm(ch) = 0.58249
iter: 3046, Minibatch log likelihood (pre-update): -54.322, error rate (pre-update): 0.080183

size_minibatch = 20000
Precon grad coeff: 0.023354, velocity coeff: 1.0019
norm(ch) = 0.58483
iter: 3047, Minibatch log likelihood (pre-update): -54.3219, error rate (pre-update): 0.08018

size_minibatch = 20000
Precon grad coeff: 0.024534, velocity coeff: 0.99322
norm(ch) = 0.5822
iter: 3048, Minibatch log likelihood (pre-update): -54.3219, error rate (pre-update): 0.080171

size_minibatch = 20000
Precon grad coeff: 0.02157, velocity coeff: 0.92095
norm(ch) = 0.53741
iter: 3049, Minibatch log likelihood (pre-update): -54.3219, error rate (pre-update): 0.080167

size_minibatch = 20000
Precon grad coeff: 0.020925, velocity coeff: 1.0293
norm(ch) = 0.55417
rho = 0.97212
New lambda: 4.7711e-066
iter: 3050, Minibatch log likelihood (pre-update): -54.3218, error rate (pre-update): 0.080157
iter: 3050, Minibatch log likelihood (post-update): -54.3218, error rate (post-update): 0.080151
---
Full log-likelihood: -54.3218, error rate: 0.080151
TEST log-likelihood: -55.1675, error rate: 0.3677
Error difference (test - train): 0.28755
---
Full log-likelihood (averaged params): -54.3391, error rate (averaged params): 0.086769
TEST log-likelihood (averaged params): -55.1154, error rate (averaged params): 0.35521
Error difference (test - train) (averaged params): 0.26844

size_minibatch = 20000
Precon grad coeff: 0.021893, velocity coeff: 0.98845
norm(ch) = 0.54895
iter: 3051, Minibatch log likelihood (pre-update): -54.3218, error rate (pre-update): 0.080151

size_minibatch = 20000
Precon grad coeff: 0.020841, velocity coeff: 0.98608
norm(ch) = 0.54258
iter: 3052, Minibatch log likelihood (pre-update): -54.3217, error rate (pre-update): 0.080151

size_minibatch = 20000
Precon grad coeff: 0.022976, velocity coeff: 1.0648
norm(ch) = 0.57888
iter: 3053, Minibatch log likelihood (pre-update): -54.3217, error rate (pre-update): 0.080147

size_minibatch = 20000
Precon grad coeff: 0.023562, velocity coeff: 0.96086
norm(ch) = 0.55747
iter: 3054, Minibatch log likelihood (pre-update): -54.3217, error rate (pre-update): 0.08014

size_minibatch = 20000
Precon grad coeff: 0.023697, velocity coeff: 1.0418
norm(ch) = 0.58209
rho = 1.1085
New lambda: 3.6918e-066
iter: 3055, Minibatch log likelihood (pre-update): -54.3216, error rate (pre-update): 0.080135
iter: 3055, Minibatch log likelihood (post-update): -54.3216, error rate (post-update): 0.080127

size_minibatch = 20000
Precon grad coeff: 0.022192, velocity coeff: 0.92482
norm(ch) = 0.53947
iter: 3056, Minibatch log likelihood (pre-update): -54.3216, error rate (pre-update): 0.080127

size_minibatch = 20000
Precon grad coeff: 0.020694, velocity coeff: 1.0009
norm(ch) = 0.54105
iter: 3057, Minibatch log likelihood (pre-update): -54.3216, error rate (pre-update): 0.080121

size_minibatch = 20000
Precon grad coeff: 0.021387, velocity coeff: 1.0234
norm(ch) = 0.55482
iter: 3058, Minibatch log likelihood (pre-update): -54.3215, error rate (pre-update): 0.080117

size_minibatch = 20000
Precon grad coeff: 0.020771, velocity coeff: 0.98402
norm(ch) = 0.54707
iter: 3059, Minibatch log likelihood (pre-update): -54.3215, error rate (pre-update): 0.080112

size_minibatch = 20000
Precon grad coeff: 0.023107, velocity coeff: 1.0125
New gamma: 0.0031623
norm(ch) = 0.5553
rho = 1.022
New lambda: 2.8566e-066
iter: 3060, Minibatch log likelihood (pre-update): -54.3214, error rate (pre-update): 0.080104
iter: 3060, Minibatch log likelihood (post-update): -54.3214, error rate (post-update): 0.0801

size_minibatch = 20000
Precon grad coeff: 0.023845, velocity coeff: 1.0501
norm(ch) = 0.58433
iter: 3061, Minibatch log likelihood (pre-update): -54.3214, error rate (pre-update): 0.0801

size_minibatch = 20000
Precon grad coeff: 0.026483, velocity coeff: 1.0024
norm(ch) = 0.58712
iter: 3062, Minibatch log likelihood (pre-update): -54.3214, error rate (pre-update): 0.080093

size_minibatch = 20000
Precon grad coeff: 0.023616, velocity coeff: 0.94971
norm(ch) = 0.55891
iter: 3063, Minibatch log likelihood (pre-update): -54.3213, error rate (pre-update): 0.080086

size_minibatch = 20000
Precon grad coeff: 0.022831, velocity coeff: 1.0286
norm(ch) = 0.57619
iter: 3064, Minibatch log likelihood (pre-update): -54.3213, error rate (pre-update): 0.080086

size_minibatch = 20000
Precon grad coeff: 0.025045, velocity coeff: 1.0432
norm(ch) = 0.60257
rho = 1.0126
New lambda: 2.2104e-066
iter: 3065, Minibatch log likelihood (pre-update): -54.3213, error rate (pre-update): 0.080072
iter: 3065, Minibatch log likelihood (post-update): -54.3212, error rate (post-update): 0.080069

size_minibatch = 20000
Precon grad coeff: 0.025909, velocity coeff: 0.99318
norm(ch) = 0.59967
iter: 3066, Minibatch log likelihood (pre-update): -54.3212, error rate (pre-update): 0.080069

size_minibatch = 20000
Precon grad coeff: 0.02352, velocity coeff: 0.92855
norm(ch) = 0.55816
iter: 3067, Minibatch log likelihood (pre-update): -54.3212, error rate (pre-update): 0.080065

size_minibatch = 20000
Precon grad coeff: 0.021068, velocity coeff: 0.99415
norm(ch) = 0.55611
iter: 3068, Minibatch log likelihood (pre-update): -54.3211, error rate (pre-update): 0.080053

size_minibatch = 20000
Precon grad coeff: 0.0235, velocity coeff: 1.019
norm(ch) = 0.56792
iter: 3069, Minibatch log likelihood (pre-update): -54.3211, error rate (pre-update): 0.080052

size_minibatch = 20000
Precon grad coeff: 0.02258, velocity coeff: 0.96542
norm(ch) = 0.54945
rho = 0.98555
New lambda: 1.7104e-066
iter: 3070, Minibatch log likelihood (pre-update): -54.3211, error rate (pre-update): 0.080045
iter: 3070, Minibatch log likelihood (post-update): -54.321, error rate (post-update): 0.080037

size_minibatch = 20000
Precon grad coeff: 0.02157, velocity coeff: 0.99444
norm(ch) = 0.5475
iter: 3071, Minibatch log likelihood (pre-update): -54.321, error rate (pre-update): 0.080037

size_minibatch = 20000
Precon grad coeff: 0.023325, velocity coeff: 1.0333
norm(ch) = 0.56696
iter: 3072, Minibatch log likelihood (pre-update): -54.321, error rate (pre-update): 0.080036

size_minibatch = 20000
Precon grad coeff: 0.023091, velocity coeff: 0.98638
norm(ch) = 0.56047
iter: 3073, Minibatch log likelihood (pre-update): -54.321, error rate (pre-update): 0.080028

size_minibatch = 20000
Precon grad coeff: 0.023595, velocity coeff: 1.0135
norm(ch) = 0.56928
iter: 3074, Minibatch log likelihood (pre-update): -54.3209, error rate (pre-update): 0.080024

size_minibatch = 20000
Precon grad coeff: 0.02405, velocity coeff: 1.0241
norm(ch) = 0.58417
rho = 0.99118
New lambda: 1.3234e-066
iter: 3075, Minibatch log likelihood (pre-update): -54.3209, error rate (pre-update): 0.080011
iter: 3075, Minibatch log likelihood (post-update): -54.3208, error rate (post-update): 0.080008

size_minibatch = 20000
Precon grad coeff: 0.024464, velocity coeff: 0.97163
norm(ch) = 0.56893
iter: 3076, Minibatch log likelihood (pre-update): -54.3208, error rate (pre-update): 0.080008

size_minibatch = 20000
Precon grad coeff: 0.023417, velocity coeff: 0.9814
norm(ch) = 0.55946
iter: 3077, Minibatch log likelihood (pre-update): -54.3208, error rate (pre-update): 0.080007

size_minibatch = 20000
Precon grad coeff: 0.022018, velocity coeff: 0.98607
norm(ch) = 0.55284
iter: 3078, Minibatch log likelihood (pre-update): -54.3208, error rate (pre-update): 0.079995

size_minibatch = 20000
Precon grad coeff: 0.022797, velocity coeff: 1.0129
norm(ch) = 0.56107
iter: 3079, Minibatch log likelihood (pre-update): -54.3207, error rate (pre-update): 0.079995

size_minibatch = 20000
Precon grad coeff: 0.023746, velocity coeff: 0.97537
New gamma: 0.0031623
norm(ch) = 0.54855
rho = 1.1112
New lambda: 1.0241e-066
iter: 3080, Minibatch log likelihood (pre-update): -54.3207, error rate (pre-update): 0.079987
iter: 3080, Minibatch log likelihood (post-update): -54.3207, error rate (post-update): 0.07998

size_minibatch = 20000
Precon grad coeff: 0.020359, velocity coeff: 0.91864
norm(ch) = 0.50504
iter: 3081, Minibatch log likelihood (pre-update): -54.3207, error rate (pre-update): 0.07998

size_minibatch = 20000
Precon grad coeff: 0.021273, velocity coeff: 1.0945
norm(ch) = 0.55396
iter: 3082, Minibatch log likelihood (pre-update): -54.3206, error rate (pre-update): 0.079979

size_minibatch = 20000
Precon grad coeff: 0.02546, velocity coeff: 1.0574
norm(ch) = 0.58719
iter: 3083, Minibatch log likelihood (pre-update): -54.3206, error rate (pre-update): 0.079968

size_minibatch = 20000
Precon grad coeff: 0.02332, velocity coeff: 0.94113
norm(ch) = 0.55398
iter: 3084, Minibatch log likelihood (pre-update): -54.3206, error rate (pre-update): 0.079964

size_minibatch = 20000
Precon grad coeff: 0.022855, velocity coeff: 1.0161
norm(ch) = 0.56413
rho = 0.96812
New lambda: 7.9239e-067
iter: 3085, Minibatch log likelihood (pre-update): -54.3205, error rate (pre-update): 0.07996
iter: 3085, Minibatch log likelihood (post-update): -54.3205, error rate (post-update): 0.079953

size_minibatch = 20000
Precon grad coeff: 0.025014, velocity coeff: 1.0344
norm(ch) = 0.58492
iter: 3086, Minibatch log likelihood (pre-update): -54.3205, error rate (pre-update): 0.079953

size_minibatch = 20000
Precon grad coeff: 0.021968, velocity coeff: 0.93351
norm(ch) = 0.54722
iter: 3087, Minibatch log likelihood (pre-update): -54.3204, error rate (pre-update): 0.079949

size_minibatch = 20000
Precon grad coeff: 0.024379, velocity coeff: 1.067
norm(ch) = 0.58522
iter: 3088, Minibatch log likelihood (pre-update): -54.3204, error rate (pre-update): 0.079938

size_minibatch = 20000
Precon grad coeff: 0.021404, velocity coeff: 0.89746
norm(ch) = 0.52635
iter: 3089, Minibatch log likelihood (pre-update): -54.3204, error rate (pre-update): 0.079935

size_minibatch = 20000
Precon grad coeff: 0.021653, velocity coeff: 1.0224
norm(ch) = 0.53924
rho = 1.0499
New lambda: 6.1314e-067
iter: 3090, Minibatch log likelihood (pre-update): -54.3203, error rate (pre-update): 0.079927
iter: 3090, Minibatch log likelihood (post-update): -54.3203, error rate (post-update): 0.079926

size_minibatch = 20000
Precon grad coeff: 0.022403, velocity coeff: 0.99962
norm(ch) = 0.54032
iter: 3091, Minibatch log likelihood (pre-update): -54.3203, error rate (pre-update): 0.079926

size_minibatch = 20000
Precon grad coeff: 0.020144, velocity coeff: 0.96165
norm(ch) = 0.52065
iter: 3092, Minibatch log likelihood (pre-update): -54.3203, error rate (pre-update): 0.079923

size_minibatch = 20000
Precon grad coeff: 0.023453, velocity coeff: 1.0844
norm(ch) = 0.56585
iter: 3093, Minibatch log likelihood (pre-update): -54.3202, error rate (pre-update): 0.079913

size_minibatch = 20000
Precon grad coeff: 0.023714, velocity coeff: 0.97456
norm(ch) = 0.55276
iter: 3094, Minibatch log likelihood (pre-update): -54.3202, error rate (pre-update): 0.079911

size_minibatch = 20000
Precon grad coeff: 0.022889, velocity coeff: 1.0156
norm(ch) = 0.56253
rho = 1.0458
New lambda: 4.7444e-067
iter: 3095, Minibatch log likelihood (pre-update): -54.3202, error rate (pre-update): 0.079906
iter: 3095, Minibatch log likelihood (post-update): -54.3201, error rate (post-update): 0.079897

size_minibatch = 20000
Precon grad coeff: 0.025513, velocity coeff: 1.0217
norm(ch) = 0.57607
iter: 3096, Minibatch log likelihood (pre-update): -54.3201, error rate (pre-update): 0.079897

size_minibatch = 20000
Precon grad coeff: 0.02167, velocity coeff: 0.92895
norm(ch) = 0.53629
iter: 3097, Minibatch log likelihood (pre-update): -54.3201, error rate (pre-update): 0.079893

size_minibatch = 20000
Precon grad coeff: 0.021113, velocity coeff: 0.98325
norm(ch) = 0.52832
iter: 3098, Minibatch log likelihood (pre-update): -54.32, error rate (pre-update): 0.079878

size_minibatch = 20000
Precon grad coeff: 0.02259, velocity coeff: 1.0579
norm(ch) = 0.56006
iter: 3099, Minibatch log likelihood (pre-update): -54.32, error rate (pre-update): 0.07988

size_minibatch = 20000
Precon grad coeff: 0.023095, velocity coeff: 0.93676
New gamma: 0.0031623
norm(ch) = 0.52586
rho = 1.0597
New lambda: 3.6711e-067
iter: 3100, Minibatch log likelihood (pre-update): -54.32, error rate (pre-update): 0.079883
iter: 3100, Minibatch log likelihood (post-update): -54.3199, error rate (post-update): 0.079871
---
Full log-likelihood: -54.3199, error rate: 0.079871
TEST log-likelihood: -55.1779, error rate: 0.37026
Error difference (test - train): 0.29039
---
Full log-likelihood (averaged params): -54.3363, error rate (averaged params): 0.086136
TEST log-likelihood (averaged params): -55.1295, error rate (averaged params): 0.35878
Error difference (test - train) (averaged params): 0.27264

size_minibatch = 20000
Precon grad coeff: 0.019476, velocity coeff: 0.97089
norm(ch) = 0.51164
iter: 3101, Minibatch log likelihood (pre-update): -54.3199, error rate (pre-update): 0.079871

size_minibatch = 20000
Precon grad coeff: 0.023826, velocity coeff: 1.1079
norm(ch) = 0.56821
iter: 3102, Minibatch log likelihood (pre-update): -54.3199, error rate (pre-update): 0.079864

size_minibatch = 20000
Precon grad coeff: 0.024842, velocity coeff: 1.0113
norm(ch) = 0.57594
iter: 3103, Minibatch log likelihood (pre-update): -54.3199, error rate (pre-update): 0.079856

size_minibatch = 20000
Precon grad coeff: 0.020945, velocity coeff: 0.9084
norm(ch) = 0.52422
iter: 3104, Minibatch log likelihood (pre-update): -54.3198, error rate (pre-update): 0.079856

size_minibatch = 20000
Precon grad coeff: 0.023985, velocity coeff: 1.0706
norm(ch) = 0.56249
rho = 0.9591
New lambda: 2.8406e-067
iter: 3105, Minibatch log likelihood (pre-update): -54.3198, error rate (pre-update): 0.079853
iter: 3105, Minibatch log likelihood (post-update): -54.3198, error rate (post-update): 0.07984

size_minibatch = 20000
Precon grad coeff: 0.021799, velocity coeff: 0.96755
norm(ch) = 0.54541
iter: 3106, Minibatch log likelihood (pre-update): -54.3198, error rate (pre-update): 0.07984

size_minibatch = 20000
Precon grad coeff: 0.021297, velocity coeff: 0.96097
norm(ch) = 0.52523
iter: 3107, Minibatch log likelihood (pre-update): -54.3197, error rate (pre-update): 0.079834

size_minibatch = 20000
Precon grad coeff: 0.022156, velocity coeff: 1.0146
norm(ch) = 0.53401
iter: 3108, Minibatch log likelihood (pre-update): -54.3197, error rate (pre-update): 0.079829

size_minibatch = 20000
Precon grad coeff: 0.020585, velocity coeff: 0.96476
norm(ch) = 0.51623
iter: 3109, Minibatch log likelihood (pre-update): -54.3197, error rate (pre-update): 0.079826

size_minibatch = 20000
Precon grad coeff: 0.023336, velocity coeff: 1.0791
norm(ch) = 0.55825
rho = 0.96828
New lambda: 2.198e-067
iter: 3110, Minibatch log likelihood (pre-update): -54.3196, error rate (pre-update): 0.079819
iter: 3110, Minibatch log likelihood (post-update): -54.3196, error rate (post-update): 0.079815

size_minibatch = 20000
Precon grad coeff: 0.022829, velocity coeff: 0.96839
norm(ch) = 0.54187
iter: 3111, Minibatch log likelihood (pre-update): -54.3196, error rate (pre-update): 0.079815

size_minibatch = 20000
Precon grad coeff: 0.023654, velocity coeff: 1.0252
norm(ch) = 0.5568
iter: 3112, Minibatch log likelihood (pre-update): -54.3196, error rate (pre-update): 0.079811

size_minibatch = 20000
Precon grad coeff: 0.02098, velocity coeff: 0.92148
norm(ch) = 0.5142
iter: 3113, Minibatch log likelihood (pre-update): -54.3195, error rate (pre-update): 0.079801

size_minibatch = 20000
Precon grad coeff: 0.021146, velocity coeff: 1.044
norm(ch) = 0.53771
iter: 3114, Minibatch log likelihood (pre-update): -54.3195, error rate (pre-update): 0.079801

size_minibatch = 20000
Precon grad coeff: 0.02335, velocity coeff: 1.0158
norm(ch) = 0.54739
rho = 1.0288
New lambda: 1.7008e-067
iter: 3115, Minibatch log likelihood (pre-update): -54.3195, error rate (pre-update): 0.079792
iter: 3115, Minibatch log likelihood (post-update): -54.3194, error rate (post-update): 0.079784

size_minibatch = 20000
Precon grad coeff: 0.01973, velocity coeff: 0.93415
norm(ch) = 0.51235
iter: 3116, Minibatch log likelihood (pre-update): -54.3194, error rate (pre-update): 0.079784

size_minibatch = 20000
Precon grad coeff: 0.022557, velocity coeff: 1.0633
norm(ch) = 0.54592
iter: 3117, Minibatch log likelihood (pre-update): -54.3194, error rate (pre-update): 0.079782

size_minibatch = 20000
Precon grad coeff: 0.022096, velocity coeff: 0.98812
norm(ch) = 0.5407
iter: 3118, Minibatch log likelihood (pre-update): -54.3194, error rate (pre-update): 0.079774

size_minibatch = 20000
Precon grad coeff: 0.022308, velocity coeff: 0.98085
norm(ch) = 0.53131
iter: 3119, Minibatch log likelihood (pre-update): -54.3193, error rate (pre-update): 0.079771

size_minibatch = 20000
Precon grad coeff: 0.024021, velocity coeff: 1.0489
New gamma: 0.0031623
norm(ch) = 0.55855
rho = 1.0505
New lambda: 1.316e-067
iter: 3120, Minibatch log likelihood (pre-update): -54.3193, error rate (pre-update): 0.079766
iter: 3120, Minibatch log likelihood (post-update): -54.3192, error rate (post-update): 0.079758

size_minibatch = 20000
Precon grad coeff: 0.021924, velocity coeff: 0.88696
norm(ch) = 0.49664
iter: 3121, Minibatch log likelihood (pre-update): -54.3193, error rate (pre-update): 0.079758

size_minibatch = 20000
Precon grad coeff: 0.02063, velocity coeff: 1.0525
norm(ch) = 0.5237
iter: 3122, Minibatch log likelihood (pre-update): -54.3192, error rate (pre-update): 0.079756

size_minibatch = 20000
Precon grad coeff: 0.022047, velocity coeff: 1.0237
norm(ch) = 0.53737
iter: 3123, Minibatch log likelihood (pre-update): -54.3192, error rate (pre-update): 0.079748

size_minibatch = 20000
Precon grad coeff: 0.025287, velocity coeff: 1.0995
norm(ch) = 0.5923
iter: 3124, Minibatch log likelihood (pre-update): -54.3191, error rate (pre-update): 0.079738

size_minibatch = 20000
Precon grad coeff: 0.024055, velocity coeff: 0.92223
norm(ch) = 0.54748
rho = 1.1056
New lambda: 1.0183e-067
iter: 3125, Minibatch log likelihood (pre-update): -54.3191, error rate (pre-update): 0.079736
iter: 3125, Minibatch log likelihood (post-update): -54.3191, error rate (post-update): 0.079726

size_minibatch = 20000
Precon grad coeff: 0.023565, velocity coeff: 1.0193
norm(ch) = 0.55936
iter: 3126, Minibatch log likelihood (pre-update): -54.3191, error rate (pre-update): 0.079726

size_minibatch = 20000
Precon grad coeff: 0.022818, velocity coeff: 0.98574
norm(ch) = 0.55257
iter: 3127, Minibatch log likelihood (pre-update): -54.319, error rate (pre-update): 0.079724

size_minibatch = 20000
Precon grad coeff: 0.021406, velocity coeff: 0.92153
norm(ch) = 0.51023
iter: 3128, Minibatch log likelihood (pre-update): -54.319, error rate (pre-update): 0.079719

size_minibatch = 20000
Precon grad coeff: 0.020475, velocity coeff: 1.0055
norm(ch) = 0.51417
iter: 3129, Minibatch log likelihood (pre-update): -54.319, error rate (pre-update): 0.079712

size_minibatch = 20000
Precon grad coeff: 0.021553, velocity coeff: 1.0274
norm(ch) = 0.52935
rho = 1.0529
New lambda: 7.8796e-068
iter: 3130, Minibatch log likelihood (pre-update): -54.3189, error rate (pre-update): 0.079709
iter: 3130, Minibatch log likelihood (post-update): -54.3189, error rate (post-update): 0.079702

size_minibatch = 20000
Precon grad coeff: 0.025784, velocity coeff: 1.1037
norm(ch) = 0.58568
iter: 3131, Minibatch log likelihood (pre-update): -54.3189, error rate (pre-update): 0.079702

size_minibatch = 20000
Precon grad coeff: 0.024482, velocity coeff: 0.9121
norm(ch) = 0.53543
iter: 3132, Minibatch log likelihood (pre-update): -54.3189, error rate (pre-update): 0.079692

size_minibatch = 20000
Precon grad coeff: 0.022148, velocity coeff: 1.005
norm(ch) = 0.5392
iter: 3133, Minibatch log likelihood (pre-update): -54.3188, error rate (pre-update): 0.079687

size_minibatch = 20000
Precon grad coeff: 0.023856, velocity coeff: 1.025
norm(ch) = 0.55393
iter: 3134, Minibatch log likelihood (pre-update): -54.3188, error rate (pre-update): 0.079686

size_minibatch = 20000
Precon grad coeff: 0.02142, velocity coeff: 0.91597
norm(ch) = 0.50844
rho = 0.95192
New lambda: 6.0971e-068
iter: 3135, Minibatch log likelihood (pre-update): -54.3188, error rate (pre-update): 0.07968
iter: 3135, Minibatch log likelihood (post-update): -54.3187, error rate (post-update): 0.079671

size_minibatch = 20000
Precon grad coeff: 0.019712, velocity coeff: 0.97765
norm(ch) = 0.49805
iter: 3136, Minibatch log likelihood (pre-update): -54.3187, error rate (pre-update): 0.079671

size_minibatch = 20000
Precon grad coeff: 0.022228, velocity coeff: 1.1174
norm(ch) = 0.55765
iter: 3137, Minibatch log likelihood (pre-update): -54.3187, error rate (pre-update): 0.079666

size_minibatch = 20000
Precon grad coeff: 0.024461, velocity coeff: 0.97907
norm(ch) = 0.54711
iter: 3138, Minibatch log likelihood (pre-update): -54.3187, error rate (pre-update): 0.079663

size_minibatch = 20000
Precon grad coeff: 0.024829, velocity coeff: 1.0464
norm(ch) = 0.57372
iter: 3139, Minibatch log likelihood (pre-update): -54.3186, error rate (pre-update): 0.079657

size_minibatch = 20000
Precon grad coeff: 0.023677, velocity coeff: 0.92004
New gamma: 0.0031623
norm(ch) = 0.52903
rho = 0.98537
New lambda: 4.7178e-068
iter: 3140, Minibatch log likelihood (pre-update): -54.3186, error rate (pre-update): 0.07965
iter: 3140, Minibatch log likelihood (post-update): -54.3186, error rate (post-update): 0.079642

size_minibatch = 20000
Precon grad coeff: 0.023027, velocity coeff: 1.0395
norm(ch) = 0.55122
iter: 3141, Minibatch log likelihood (pre-update): -54.3186, error rate (pre-update): 0.079642

size_minibatch = 20000
Precon grad coeff: 0.023803, velocity coeff: 0.98476
norm(ch) = 0.54401
iter: 3142, Minibatch log likelihood (pre-update): -54.3185, error rate (pre-update): 0.079639

size_minibatch = 20000
Precon grad coeff: 0.022311, velocity coeff: 1.0011
norm(ch) = 0.54573
iter: 3143, Minibatch log likelihood (pre-update): -54.3185, error rate (pre-update): 0.07963

size_minibatch = 20000
Precon grad coeff: 0.023225, velocity coeff: 0.97267
norm(ch) = 0.532
iter: 3144, Minibatch log likelihood (pre-update): -54.3185, error rate (pre-update): 0.079627

size_minibatch = 20000
Precon grad coeff: 0.020587, velocity coeff: 1.0003
norm(ch) = 0.53319
rho = 1.0714
New lambda: 3.6505e-068
iter: 3145, Minibatch log likelihood (pre-update): -54.3184, error rate (pre-update): 0.079626
iter: 3145, Minibatch log likelihood (post-update): -54.3184, error rate (post-update): 0.079615

size_minibatch = 20000
Precon grad coeff: 0.024862, velocity coeff: 1.0611
norm(ch) = 0.567
iter: 3146, Minibatch log likelihood (pre-update): -54.3184, error rate (pre-update): 0.079615

size_minibatch = 20000
Precon grad coeff: 0.024662, velocity coeff: 0.96622
norm(ch) = 0.54912
iter: 3147, Minibatch log likelihood (pre-update): -54.3184, error rate (pre-update): 0.07961

size_minibatch = 20000
Precon grad coeff: 0.021145, velocity coeff: 0.92105
norm(ch) = 0.50679
iter: 3148, Minibatch log likelihood (pre-update): -54.3183, error rate (pre-update): 0.079605

size_minibatch = 20000
Precon grad coeff: 0.021369, velocity coeff: 1.0372
norm(ch) = 0.52671
iter: 3149, Minibatch log likelihood (pre-update): -54.3183, error rate (pre-update): 0.079597

size_minibatch = 20000
Precon grad coeff: 0.024792, velocity coeff: 1.0841
norm(ch) = 0.5723
rho = 0.99762
New lambda: 2.8247e-068
iter: 3150, Minibatch log likelihood (pre-update): -54.3183, error rate (pre-update): 0.079594
iter: 3150, Minibatch log likelihood (post-update): -54.3182, error rate (post-update): 0.079587
---
Full log-likelihood: -54.3182, error rate: 0.079587
TEST log-likelihood: -55.1824, error rate: 0.37157
Error difference (test - train): 0.29198
---
Full log-likelihood (averaged params): -54.3334, error rate (averaged params): 0.085403
TEST log-likelihood (averaged params): -55.1408, error rate (averaged params): 0.3616
Error difference (test - train) (averaged params): 0.2762

size_minibatch = 20000
Precon grad coeff: 0.029342, velocity coeff: 1.0417
norm(ch) = 0.59766
iter: 3151, Minibatch log likelihood (pre-update): -54.3182, error rate (pre-update): 0.079587

size_minibatch = 20000
Precon grad coeff: 0.023111, velocity coeff: 0.88142
norm(ch) = 0.52781
iter: 3152, Minibatch log likelihood (pre-update): -54.3182, error rate (pre-update): 0.079584

size_minibatch = 20000
Precon grad coeff: 0.022131, velocity coeff: 1.0043
norm(ch) = 0.53124
iter: 3153, Minibatch log likelihood (pre-update): -54.3182, error rate (pre-update): 0.079574

size_minibatch = 20000
Precon grad coeff: 0.024204, velocity coeff: 1.055
norm(ch) = 0.5618
iter: 3154, Minibatch log likelihood (pre-update): -54.3181, error rate (pre-update): 0.079569

size_minibatch = 20000
Precon grad coeff: 0.021599, velocity coeff: 0.88913
norm(ch) = 0.50054
rho = 1.0091
New lambda: 2.1857e-068
iter: 3155, Minibatch log likelihood (pre-update): -54.3181, error rate (pre-update): 0.079564
iter: 3155, Minibatch log likelihood (post-update): -54.3181, error rate (post-update): 0.079561

size_minibatch = 20000
Precon grad coeff: 0.02152, velocity coeff: 1.0756
norm(ch) = 0.53941
iter: 3156, Minibatch log likelihood (pre-update): -54.3181, error rate (pre-update): 0.079561

size_minibatch = 20000
Precon grad coeff: 0.021258, velocity coeff: 0.94545
norm(ch) = 0.51095
iter: 3157, Minibatch log likelihood (pre-update): -54.318, error rate (pre-update): 0.079555

size_minibatch = 20000
Precon grad coeff: 0.02464, velocity coeff: 1.1019
norm(ch) = 0.5642
iter: 3158, Minibatch log likelihood (pre-update): -54.318, error rate (pre-update): 0.079549

size_minibatch = 20000
Precon grad coeff: 0.022097, velocity coeff: 0.89253
norm(ch) = 0.50464
iter: 3159, Minibatch log likelihood (pre-update): -54.318, error rate (pre-update): 0.079545

size_minibatch = 20000
Precon grad coeff: 0.024402, velocity coeff: 1.0989
New gamma: 0.0031623
norm(ch) = 0.55581
rho = 1.0193
New lambda: 1.6913e-068
iter: 3160, Minibatch log likelihood (pre-update): -54.3179, error rate (pre-update): 0.079532
iter: 3160, Minibatch log likelihood (post-update): -54.3179, error rate (post-update): 0.079529

size_minibatch = 20000
Precon grad coeff: 0.023386, velocity coeff: 0.93695
norm(ch) = 0.52191
iter: 3161, Minibatch log likelihood (pre-update): -54.3179, error rate (pre-update): 0.079529

size_minibatch = 20000
Precon grad coeff: 0.022466, velocity coeff: 1.0173
norm(ch) = 0.53206
iter: 3162, Minibatch log likelihood (pre-update): -54.3179, error rate (pre-update): 0.07953

size_minibatch = 20000
Precon grad coeff: 0.023322, velocity coeff: 1.0311
norm(ch) = 0.54979
iter: 3163, Minibatch log likelihood (pre-update): -54.3178, error rate (pre-update): 0.079523

size_minibatch = 20000
Precon grad coeff: 0.025295, velocity coeff: 1.0302
norm(ch) = 0.56764
iter: 3164, Minibatch log likelihood (pre-update): -54.3178, error rate (pre-update): 0.079511

size_minibatch = 20000
Precon grad coeff: 0.024807, velocity coeff: 0.98162
norm(ch) = 0.5584
rho = 0.97717
New lambda: 1.3087e-068
iter: 3165, Minibatch log likelihood (pre-update): -54.3178, error rate (pre-update): 0.079505
iter: 3165, Minibatch log likelihood (post-update): -54.3177, error rate (post-update): 0.079505

size_minibatch = 20000
Precon grad coeff: 0.022781, velocity coeff: 0.93577
norm(ch) = 0.52361
iter: 3166, Minibatch log likelihood (pre-update): -54.3177, error rate (pre-update): 0.079505

size_minibatch = 20000
Precon grad coeff: 0.020503, velocity coeff: 0.96091
norm(ch) = 0.50414
iter: 3167, Minibatch log likelihood (pre-update): -54.3177, error rate (pre-update): 0.079495

size_minibatch = 20000
Precon grad coeff: 0.020842, velocity coeff: 1.0101
norm(ch) = 0.51019
iter: 3168, Minibatch log likelihood (pre-update): -54.3177, error rate (pre-update): 0.079491

size_minibatch = 20000
Precon grad coeff: 0.023719, velocity coeff: 1.066
norm(ch) = 0.54499
iter: 3169, Minibatch log likelihood (pre-update): -54.3176, error rate (pre-update): 0.079489

size_minibatch = 20000
Precon grad coeff: 0.023494, velocity coeff: 0.96966
norm(ch) = 0.52967
rho = 0.90523
New lambda: 1.0126e-068
iter: 3170, Minibatch log likelihood (pre-update): -54.3176, error rate (pre-update): 0.079478
iter: 3170, Minibatch log likelihood (post-update): -54.3176, error rate (post-update): 0.079471

size_minibatch = 20000
Precon grad coeff: 0.024017, velocity coeff: 1.022
norm(ch) = 0.54257
iter: 3171, Minibatch log likelihood (pre-update): -54.3176, error rate (pre-update): 0.079471

size_minibatch = 20000
Precon grad coeff: 0.023301, velocity coeff: 0.98664
norm(ch) = 0.53644
iter: 3172, Minibatch log likelihood (pre-update): -54.3175, error rate (pre-update): 0.079469

size_minibatch = 20000
Precon grad coeff: 0.02502, velocity coeff: 1.0156
norm(ch) = 0.54604
iter: 3173, Minibatch log likelihood (pre-update): -54.3175, error rate (pre-update): 0.079465

size_minibatch = 20000
Precon grad coeff: 0.020046, velocity coeff: 0.91855
norm(ch) = 0.50249
iter: 3174, Minibatch log likelihood (pre-update): -54.3175, error rate (pre-update): 0.079457

size_minibatch = 20000
Precon grad coeff: 0.022869, velocity coeff: 1.0536
norm(ch) = 0.53052
rho = 0.99237
New lambda: 7.8355e-069
iter: 3175, Minibatch log likelihood (pre-update): -54.3174, error rate (pre-update): 0.079453
iter: 3175, Minibatch log likelihood (post-update): -54.3174, error rate (post-update): 0.079442

size_minibatch = 20000
Precon grad coeff: 0.024948, velocity coeff: 1.0368
norm(ch) = 0.55123
iter: 3176, Minibatch log likelihood (pre-update): -54.3174, error rate (pre-update): 0.079442

size_minibatch = 20000
Precon grad coeff: 0.021297, velocity coeff: 0.9124
norm(ch) = 0.50392
iter: 3177, Minibatch log likelihood (pre-update): -54.3174, error rate (pre-update): 0.079436

size_minibatch = 20000
Precon grad coeff: 0.019694, velocity coeff: 0.96777
norm(ch) = 0.4886
iter: 3178, Minibatch log likelihood (pre-update): -54.3173, error rate (pre-update): 0.079437

size_minibatch = 20000
Precon grad coeff: 0.022472, velocity coeff: 1.1035
norm(ch) = 0.54028
iter: 3179, Minibatch log likelihood (pre-update): -54.3173, error rate (pre-update): 0.079434

size_minibatch = 20000
Precon grad coeff: 0.02477, velocity coeff: 0.98846
New gamma: 0.0031623
norm(ch) = 0.53531
rho = 1.0806
New lambda: 6.0629e-069
iter: 3180, Minibatch log likelihood (pre-update): -54.3173, error rate (pre-update): 0.079424
iter: 3180, Minibatch log likelihood (post-update): -54.3172, error rate (post-update): 0.079419

size_minibatch = 20000
Precon grad coeff: 0.024089, velocity coeff: 0.98609
norm(ch) = 0.52905
iter: 3181, Minibatch log likelihood (pre-update): -54.3172, error rate (pre-update): 0.079419

size_minibatch = 20000
Precon grad coeff: 0.023677, velocity coeff: 1.0428
norm(ch) = 0.55289
iter: 3182, Minibatch log likelihood (pre-update): -54.3172, error rate (pre-update): 0.079409

size_minibatch = 20000
Precon grad coeff: 0.024251, velocity coeff: 0.93771
norm(ch) = 0.51957
iter: 3183, Minibatch log likelihood (pre-update): -54.3172, error rate (pre-update): 0.079404

size_minibatch = 20000
Precon grad coeff: 0.020388, velocity coeff: 0.99152
norm(ch) = 0.51643
iter: 3184, Minibatch log likelihood (pre-update): -54.3171, error rate (pre-update): 0.079402

size_minibatch = 20000
Precon grad coeff: 0.022821, velocity coeff: 1.0267
norm(ch) = 0.53118
rho = 1.0277
New lambda: 4.6914e-069
iter: 3185, Minibatch log likelihood (pre-update): -54.3171, error rate (pre-update): 0.079396
iter: 3185, Minibatch log likelihood (post-update): -54.3171, error rate (post-update): 0.079393

size_minibatch = 20000
Precon grad coeff: 0.022933, velocity coeff: 1.0041
norm(ch) = 0.5344
iter: 3186, Minibatch log likelihood (pre-update): -54.3171, error rate (pre-update): 0.079393

size_minibatch = 20000
Precon grad coeff: 0.023877, velocity coeff: 0.98735
norm(ch) = 0.52874
iter: 3187, Minibatch log likelihood (pre-update): -54.3171, error rate (pre-update): 0.079383

size_minibatch = 20000
Precon grad coeff: 0.021693, velocity coeff: 0.98173
norm(ch) = 0.52004
iter: 3188, Minibatch log likelihood (pre-update): -54.317, error rate (pre-update): 0.079381

size_minibatch = 20000
Precon grad coeff: 0.023769, velocity coeff: 1.0146
norm(ch) = 0.52879
iter: 3189, Minibatch log likelihood (pre-update): -54.317, error rate (pre-update): 0.079368

size_minibatch = 20000
Precon grad coeff: 0.020576, velocity coeff: 0.92153
norm(ch) = 0.48822
rho = 1.0633
New lambda: 3.6301e-069
iter: 3190, Minibatch log likelihood (pre-update): -54.317, error rate (pre-update): 0.079364
iter: 3190, Minibatch log likelihood (post-update): -54.3169, error rate (post-update): 0.079364

size_minibatch = 20000
Precon grad coeff: 0.022107, velocity coeff: 1.0826
norm(ch) = 0.52968
iter: 3191, Minibatch log likelihood (pre-update): -54.3169, error rate (pre-update): 0.079364

size_minibatch = 20000
Precon grad coeff: 0.025405, velocity coeff: 1.0474
norm(ch) = 0.55597
iter: 3192, Minibatch log likelihood (pre-update): -54.3169, error rate (pre-update): 0.079361

size_minibatch = 20000
Precon grad coeff: 0.024219, velocity coeff: 0.95191
norm(ch) = 0.53038
iter: 3193, Minibatch log likelihood (pre-update): -54.3169, error rate (pre-update): 0.079351

size_minibatch = 20000
Precon grad coeff: 0.022614, velocity coeff: 0.98672
norm(ch) = 0.52436
iter: 3194, Minibatch log likelihood (pre-update): -54.3168, error rate (pre-update): 0.07934

size_minibatch = 20000
Precon grad coeff: 0.020154, velocity coeff: 0.93738
norm(ch) = 0.49268
rho = 1.0424
New lambda: 2.8089e-069
iter: 3195, Minibatch log likelihood (pre-update): -54.3168, error rate (pre-update): 0.079342
iter: 3195, Minibatch log likelihood (post-update): -54.3168, error rate (post-update): 0.079337

size_minibatch = 20000
Precon grad coeff: 0.021643, velocity coeff: 1.0357
norm(ch) = 0.51109
iter: 3196, Minibatch log likelihood (pre-update): -54.3168, error rate (pre-update): 0.079337

size_minibatch = 20000
Precon grad coeff: 0.021719, velocity coeff: 0.98385
norm(ch) = 0.5037
iter: 3197, Minibatch log likelihood (pre-update): -54.3167, error rate (pre-update): 0.079331

size_minibatch = 20000
Precon grad coeff: 0.023868, velocity coeff: 1.0966
norm(ch) = 0.55351
iter: 3198, Minibatch log likelihood (pre-update): -54.3167, error rate (pre-update): 0.079325

size_minibatch = 20000
Precon grad coeff: 0.025007, velocity coeff: 0.96382
norm(ch) = 0.53452
iter: 3199, Minibatch log likelihood (pre-update): -54.3167, error rate (pre-update): 0.079317

size_minibatch = 20000
Precon grad coeff: 0.02027, velocity coeff: 0.92257
New gamma: 0.0031623
norm(ch) = 0.49412
rho = 1.0439
New lambda: 2.1735e-069
iter: 3200, Minibatch log likelihood (pre-update): -54.3166, error rate (pre-update): 0.079309
iter: 3200, Minibatch log likelihood (post-update): -54.3166, error rate (post-update): 0.079308
---
Full log-likelihood: -54.3166, error rate: 0.079308
TEST log-likelihood: -55.1885, error rate: 0.37361
Error difference (test - train): 0.29431
---
Full log-likelihood (averaged params): -54.3305, error rate (averaged params): 0.084675
TEST log-likelihood (averaged params): -55.1502, error rate (averaged params): 0.36406
Error difference (test - train) (averaged params): 0.27939

size_minibatch = 20000
Precon grad coeff: 0.021464, velocity coeff: 1.0033
norm(ch) = 0.4967
iter: 3201, Minibatch log likelihood (pre-update): -54.3166, error rate (pre-update): 0.079308

size_minibatch = 20000
Precon grad coeff: 0.024457, velocity coeff: 1.1403
norm(ch) = 0.56766
iter: 3202, Minibatch log likelihood (pre-update): -54.3166, error rate (pre-update): 0.079304

size_minibatch = 20000
Precon grad coeff: 0.025748, velocity coeff: 0.95924
norm(ch) = 0.5456
iter: 3203, Minibatch log likelihood (pre-update): -54.3165, error rate (pre-update): 0.079298

size_minibatch = 20000
Precon grad coeff: 0.021765, velocity coeff: 0.9164
norm(ch) = 0.50109
iter: 3204, Minibatch log likelihood (pre-update): -54.3165, error rate (pre-update): 0.079295

size_minibatch = 20000
Precon grad coeff: 0.020477, velocity coeff: 1.0025
norm(ch) = 0.50324
rho = 1.0743
New lambda: 1.6818e-069
iter: 3205, Minibatch log likelihood (pre-update): -54.3165, error rate (pre-update): 0.079287
iter: 3205, Minibatch log likelihood (post-update): -54.3165, error rate (post-update): 0.079283

size_minibatch = 20000
Precon grad coeff: 0.021224, velocity coeff: 1.0093
norm(ch) = 0.50892
iter: 3206, Minibatch log likelihood (pre-update): -54.3165, error rate (pre-update): 0.079283

size_minibatch = 20000
Precon grad coeff: 0.025227, velocity coeff: 1.107
norm(ch) = 0.56439
iter: 3207, Minibatch log likelihood (pre-update): -54.3164, error rate (pre-update): 0.079274

size_minibatch = 20000
Precon grad coeff: 0.02336, velocity coeff: 0.89484
norm(ch) = 0.50611
iter: 3208, Minibatch log likelihood (pre-update): -54.3164, error rate (pre-update): 0.079271

size_minibatch = 20000
Precon grad coeff: 0.021102, velocity coeff: 0.99147
norm(ch) = 0.50267
iter: 3209, Minibatch log likelihood (pre-update): -54.3164, error rate (pre-update): 0.079267

size_minibatch = 20000
Precon grad coeff: 0.02103, velocity coeff: 0.97822
norm(ch) = 0.49272
rho = 1.0529
New lambda: 1.3013e-069
iter: 3210, Minibatch log likelihood (pre-update): -54.3163, error rate (pre-update): 0.079261
iter: 3210, Minibatch log likelihood (post-update): -54.3163, error rate (post-update): 0.079256

size_minibatch = 20000
Precon grad coeff: 0.022549, velocity coeff: 1.0583
norm(ch) = 0.5225
iter: 3211, Minibatch log likelihood (pre-update): -54.3163, error rate (pre-update): 0.079256

size_minibatch = 20000
Precon grad coeff: 0.022792, velocity coeff: 1.0097
norm(ch) = 0.5286
iter: 3212, Minibatch log likelihood (pre-update): -54.3163, error rate (pre-update): 0.079255

size_minibatch = 20000
Precon grad coeff: 0.023232, velocity coeff: 0.98331
norm(ch) = 0.52086
iter: 3213, Minibatch log likelihood (pre-update): -54.3162, error rate (pre-update): 0.079242

size_minibatch = 20000
Precon grad coeff: 0.021583, velocity coeff: 0.9689
norm(ch) = 0.50564
iter: 3214, Minibatch log likelihood (pre-update): -54.3162, error rate (pre-update): 0.079239

size_minibatch = 20000
Precon grad coeff: 0.020695, velocity coeff: 0.98389
norm(ch) = 0.49839
rho = 1.0239
New lambda: 1.007e-069
iter: 3215, Minibatch log likelihood (pre-update): -54.3162, error rate (pre-update): 0.079238
iter: 3215, Minibatch log likelihood (post-update): -54.3162, error rate (post-update): 0.079231

size_minibatch = 20000
Precon grad coeff: 0.022772, velocity coeff: 1.053
norm(ch) = 0.52576
iter: 3216, Minibatch log likelihood (pre-update): -54.3162, error rate (pre-update): 0.079231

size_minibatch = 20000
Precon grad coeff: 0.024066, velocity coeff: 0.99209
norm(ch) = 0.52261
iter: 3217, Minibatch log likelihood (pre-update): -54.3161, error rate (pre-update): 0.079227

size_minibatch = 20000
Precon grad coeff: 0.022371, velocity coeff: 0.97602
norm(ch) = 0.51107
iter: 3218, Minibatch log likelihood (pre-update): -54.3161, error rate (pre-update): 0.079225

size_minibatch = 20000
Precon grad coeff: 0.021751, velocity coeff: 0.97302
norm(ch) = 0.49818
iter: 3219, Minibatch log likelihood (pre-update): -54.3161, error rate (pre-update): 0.079217

size_minibatch = 20000
Precon grad coeff: 0.019432, velocity coeff: 0.95056
New gamma: 0.0031623
norm(ch) = 0.47438
rho = 1.0423
New lambda: 7.7916e-070
iter: 3220, Minibatch log likelihood (pre-update): -54.316, error rate (pre-update): 0.079206
iter: 3220, Minibatch log likelihood (post-update): -54.316, error rate (post-update): 0.07921

size_minibatch = 20000
Precon grad coeff: 0.019415, velocity coeff: 0.98475
norm(ch) = 0.46813
iter: 3221, Minibatch log likelihood (pre-update): -54.316, error rate (pre-update): 0.07921

size_minibatch = 20000
Precon grad coeff: 0.019653, velocity coeff: 1.0336
norm(ch) = 0.48474
iter: 3222, Minibatch log likelihood (pre-update): -54.316, error rate (pre-update): 0.079207

size_minibatch = 20000
Precon grad coeff: 0.020977, velocity coeff: 1.0499
norm(ch) = 0.50985
iter: 3223, Minibatch log likelihood (pre-update): -54.3159, error rate (pre-update): 0.079198

size_minibatch = 20000
Precon grad coeff: 0.022268, velocity coeff: 1.0165
norm(ch) = 0.51917
iter: 3224, Minibatch log likelihood (pre-update): -54.3159, error rate (pre-update): 0.079191

size_minibatch = 20000
Precon grad coeff: 0.020987, velocity coeff: 0.94733
norm(ch) = 0.49274
rho = 1.0504
New lambda: 6.029e-070
iter: 3225, Minibatch log likelihood (pre-update): -54.3159, error rate (pre-update): 0.079187
iter: 3225, Minibatch log likelihood (post-update): -54.3159, error rate (post-update): 0.079178

size_minibatch = 20000
Precon grad coeff: 0.020067, velocity coeff: 1.0191
norm(ch) = 0.50306
iter: 3226, Minibatch log likelihood (pre-update): -54.3159, error rate (pre-update): 0.079178

size_minibatch = 20000
Precon grad coeff: 0.020353, velocity coeff: 0.94479
norm(ch) = 0.47616
iter: 3227, Minibatch log likelihood (pre-update): -54.3158, error rate (pre-update): 0.07918

size_minibatch = 20000
Precon grad coeff: 0.016911, velocity coeff: 0.95099
norm(ch) = 0.45345
iter: 3228, Minibatch log likelihood (pre-update): -54.3158, error rate (pre-update): 0.079177

size_minibatch = 20000
Precon grad coeff: 0.022472, velocity coeff: 1.1543
norm(ch) = 0.52446
iter: 3229, Minibatch log likelihood (pre-update): -54.3158, error rate (pre-update): 0.079171

size_minibatch = 20000
Precon grad coeff: 0.023498, velocity coeff: 0.97304
norm(ch) = 0.51123
rho = 0.97774
New lambda: 4.6651e-070
iter: 3230, Minibatch log likelihood (pre-update): -54.3157, error rate (pre-update): 0.079166
iter: 3230, Minibatch log likelihood (post-update): -54.3157, error rate (post-update): 0.079164

size_minibatch = 20000
Precon grad coeff: 0.020172, velocity coeff: 0.93274
norm(ch) = 0.47783
iter: 3231, Minibatch log likelihood (pre-update): -54.3157, error rate (pre-update): 0.079164

size_minibatch = 20000
Precon grad coeff: 0.019385, velocity coeff: 0.97185
norm(ch) = 0.46522
iter: 3232, Minibatch log likelihood (pre-update): -54.3157, error rate (pre-update): 0.079154

size_minibatch = 20000
Precon grad coeff: 0.019161, velocity coeff: 1.0386
norm(ch) = 0.48408
iter: 3233, Minibatch log likelihood (pre-update): -54.3157, error rate (pre-update): 0.079151

size_minibatch = 20000
Precon grad coeff: 0.018609, velocity coeff: 0.95171
norm(ch) = 0.46151
iter: 3234, Minibatch log likelihood (pre-update): -54.3156, error rate (pre-update): 0.079146

size_minibatch = 20000
Precon grad coeff: 0.02047, velocity coeff: 1.0946
norm(ch) = 0.50605
rho = 0.92506
New lambda: 3.6098e-070
iter: 3235, Minibatch log likelihood (pre-update): -54.3156, error rate (pre-update): 0.079142
iter: 3235, Minibatch log likelihood (post-update): -54.3156, error rate (post-update): 0.079138

size_minibatch = 20000
Precon grad coeff: 0.021622, velocity coeff: 0.99366
norm(ch) = 0.50373
iter: 3236, Minibatch log likelihood (pre-update): -54.3156, error rate (pre-update): 0.079138

size_minibatch = 20000
Precon grad coeff: 0.021176, velocity coeff: 0.99982
norm(ch) = 0.50454
iter: 3237, Minibatch log likelihood (pre-update): -54.3155, error rate (pre-update): 0.079137

size_minibatch = 20000
Precon grad coeff: 0.019961, velocity coeff: 0.91828
norm(ch) = 0.46421
iter: 3238, Minibatch log likelihood (pre-update): -54.3155, error rate (pre-update): 0.079126

size_minibatch = 20000
Precon grad coeff: 0.016376, velocity coeff: 0.9663
norm(ch) = 0.4494
iter: 3239, Minibatch log likelihood (pre-update): -54.3155, error rate (pre-update): 0.079126

size_minibatch = 20000
Precon grad coeff: 0.021103, velocity coeff: 1.111
New gamma: 0.0031623
norm(ch) = 0.50008
rho = 0.93563
New lambda: 2.7932e-070
iter: 3240, Minibatch log likelihood (pre-update): -54.3155, error rate (pre-update): 0.079126
iter: 3240, Minibatch log likelihood (post-update): -54.3154, error rate (post-update): 0.079123

size_minibatch = 20000
Precon grad coeff: 0.02344, velocity coeff: 0.99957
norm(ch) = 0.50093
iter: 3241, Minibatch log likelihood (pre-update): -54.3154, error rate (pre-update): 0.079123

size_minibatch = 20000
Precon grad coeff: 0.021228, velocity coeff: 0.96059
norm(ch) = 0.48212
iter: 3242, Minibatch log likelihood (pre-update): -54.3154, error rate (pre-update): 0.079113

size_minibatch = 20000
Precon grad coeff: 0.022129, velocity coeff: 1.035
norm(ch) = 0.50024
iter: 3243, Minibatch log likelihood (pre-update): -54.3154, error rate (pre-update): 0.079106

size_minibatch = 20000
Precon grad coeff: 0.022453, velocity coeff: 1.0132
norm(ch) = 0.50787
iter: 3244, Minibatch log likelihood (pre-update): -54.3153, error rate (pre-update): 0.0791

size_minibatch = 20000
Precon grad coeff: 0.018738, velocity coeff: 0.89531
norm(ch) = 0.45558
rho = 1.151
New lambda: 2.1613e-070
iter: 3245, Minibatch log likelihood (pre-update): -54.3153, error rate (pre-update): 0.079098
iter: 3245, Minibatch log likelihood (post-update): -54.3153, error rate (post-update): 0.079095

size_minibatch = 20000
Precon grad coeff: 0.018027, velocity coeff: 1.0739
norm(ch) = 0.49003
iter: 3246, Minibatch log likelihood (pre-update): -54.3153, error rate (pre-update): 0.079095

size_minibatch = 20000
Precon grad coeff: 0.021733, velocity coeff: 1.0566
norm(ch) = 0.51888
iter: 3247, Minibatch log likelihood (pre-update): -54.3153, error rate (pre-update): 0.079094

size_minibatch = 20000
Precon grad coeff: 0.023927, velocity coeff: 1.0322
norm(ch) = 0.53661
iter: 3248, Minibatch log likelihood (pre-update): -54.3152, error rate (pre-update): 0.079083

size_minibatch = 20000
Precon grad coeff: 0.023919, velocity coeff: 0.96285
norm(ch) = 0.51781
iter: 3249, Minibatch log likelihood (pre-update): -54.3152, error rate (pre-update): 0.079076

size_minibatch = 20000
Precon grad coeff: 0.019065, velocity coeff: 0.878
norm(ch) = 0.45548
rho = 0.91379
New lambda: 1.6724e-070
iter: 3250, Minibatch log likelihood (pre-update): -54.3152, error rate (pre-update): 0.079074
iter: 3250, Minibatch log likelihood (post-update): -54.3151, error rate (post-update): 0.079075
---
Full log-likelihood: -54.3151, error rate: 0.079075
TEST log-likelihood: -55.1976, error rate: 0.37661
Error difference (test - train): 0.29753
---
Full log-likelihood (averaged params): -54.3277, error rate (averaged params): 0.083971
TEST log-likelihood (averaged params): -55.16, error rate (averaged params): 0.36686
Error difference (test - train) (averaged params): 0.28289

size_minibatch = 20000
Precon grad coeff: 0.017161, velocity coeff: 0.96784
norm(ch) = 0.44177
iter: 3251, Minibatch log likelihood (pre-update): -54.3151, error rate (pre-update): 0.079075

size_minibatch = 20000
Precon grad coeff: 0.020381, velocity coeff: 1.0982
norm(ch) = 0.48608
iter: 3252, Minibatch log likelihood (pre-update): -54.3151, error rate (pre-update): 0.07907

size_minibatch = 20000
Precon grad coeff: 0.022267, velocity coeff: 1.0385
norm(ch) = 0.50572
iter: 3253, Minibatch log likelihood (pre-update): -54.3151, error rate (pre-update): 0.079066

size_minibatch = 20000
Precon grad coeff: 0.021862, velocity coeff: 0.9917
norm(ch) = 0.50251
iter: 3254, Minibatch log likelihood (pre-update): -54.315, error rate (pre-update): 0.079057

size_minibatch = 20000
Precon grad coeff: 0.022711, velocity coeff: 1.0178
norm(ch) = 0.51249
rho = 1.0732
New lambda: 1.2941e-070
iter: 3255, Minibatch log likelihood (pre-update): -54.315, error rate (pre-update): 0.079054
iter: 3255, Minibatch log likelihood (post-update): -54.315, error rate (post-update): 0.079046

size_minibatch = 20000
Precon grad coeff: 0.018748, velocity coeff: 0.8865
norm(ch) = 0.4552
iter: 3256, Minibatch log likelihood (pre-update): -54.315, error rate (pre-update): 0.079046

size_minibatch = 20000
Precon grad coeff: 0.016857, velocity coeff: 1.0287
norm(ch) = 0.46903
iter: 3257, Minibatch log likelihood (pre-update): -54.315, error rate (pre-update): 0.079047

size_minibatch = 20000
Precon grad coeff: 0.021031, velocity coeff: 1.0767
norm(ch) = 0.50581
iter: 3258, Minibatch log likelihood (pre-update): -54.3149, error rate (pre-update): 0.079042

size_minibatch = 20000
Precon grad coeff: 0.022136, velocity coeff: 1.0174
norm(ch) = 0.51554
iter: 3259, Minibatch log likelihood (pre-update): -54.3149, error rate (pre-update): 0.079037

size_minibatch = 20000
Precon grad coeff: 0.020299, velocity coeff: 0.8992
New gamma: 0.0031623
norm(ch) = 0.46452
rho = 1.095
New lambda: 1.0013e-070
iter: 3260, Minibatch log likelihood (pre-update): -54.3149, error rate (pre-update): 0.079034
iter: 3260, Minibatch log likelihood (post-update): -54.3148, error rate (post-update): 0.07903

size_minibatch = 20000
Precon grad coeff: 0.021809, velocity coeff: 1.0789
norm(ch) = 0.50239
iter: 3261, Minibatch log likelihood (pre-update): -54.3149, error rate (pre-update): 0.07903

size_minibatch = 20000
Precon grad coeff: 0.019281, velocity coeff: 0.88608
norm(ch) = 0.44581
iter: 3262, Minibatch log likelihood (pre-update): -54.3148, error rate (pre-update): 0.079021

size_minibatch = 20000
Precon grad coeff: 0.017223, velocity coeff: 1.0136
norm(ch) = 0.45267
iter: 3263, Minibatch log likelihood (pre-update): -54.3148, error rate (pre-update): 0.079022

size_minibatch = 20000
Precon grad coeff: 0.022419, velocity coeff: 1.1283
norm(ch) = 0.51188
iter: 3264, Minibatch log likelihood (pre-update): -54.3148, error rate (pre-update): 0.079018

size_minibatch = 20000
Precon grad coeff: 0.022867, velocity coeff: 0.99302
norm(ch) = 0.50946
rho = 1.0912
New lambda: 7.748e-071
iter: 3265, Minibatch log likelihood (pre-update): -54.3147, error rate (pre-update): 0.079012
iter: 3265, Minibatch log likelihood (post-update): -54.3147, error rate (post-update): 0.079005

size_minibatch = 20000
Precon grad coeff: 0.019762, velocity coeff: 0.9676
norm(ch) = 0.49376
iter: 3266, Minibatch log likelihood (pre-update): -54.3147, error rate (pre-update): 0.079005

size_minibatch = 20000
Precon grad coeff: 0.021827, velocity coeff: 1.0206
norm(ch) = 0.50481
iter: 3267, Minibatch log likelihood (pre-update): -54.3147, error rate (pre-update): 0.079005

size_minibatch = 20000
Precon grad coeff: 0.01735, velocity coeff: 0.85172
norm(ch) = 0.43077
iter: 3268, Minibatch log likelihood (pre-update): -54.3147, error rate (pre-update): 0.079

size_minibatch = 20000
Precon grad coeff: 0.018711, velocity coeff: 1.1142
norm(ch) = 0.48091
iter: 3269, Minibatch log likelihood (pre-update): -54.3146, error rate (pre-update): 0.078998

size_minibatch = 20000
Precon grad coeff: 0.020832, velocity coeff: 1.0623
norm(ch) = 0.51171
rho = 0.87516
New lambda: 5.9953e-071
iter: 3270, Minibatch log likelihood (pre-update): -54.3146, error rate (pre-update): 0.078992
iter: 3270, Minibatch log likelihood (post-update): -54.3146, error rate (post-update): 0.078989

size_minibatch = 20000
Precon grad coeff: 0.023685, velocity coeff: 0.97453
norm(ch) = 0.49978
iter: 3271, Minibatch log likelihood (pre-update): -54.3146, error rate (pre-update): 0.078989

size_minibatch = 20000
Precon grad coeff: 0.02205, velocity coeff: 0.99115
norm(ch) = 0.4964
iter: 3272, Minibatch log likelihood (pre-update): -54.3145, error rate (pre-update): 0.078982

size_minibatch = 20000
Precon grad coeff: 0.018444, velocity coeff: 0.87074
norm(ch) = 0.43308
iter: 3273, Minibatch log likelihood (pre-update): -54.3145, error rate (pre-update): 0.078978

size_minibatch = 20000
Precon grad coeff: 0.016869, velocity coeff: 1.0468
norm(ch) = 0.45402
iter: 3274, Minibatch log likelihood (pre-update): -54.3145, error rate (pre-update): 0.078972

size_minibatch = 20000
Precon grad coeff: 0.02279, velocity coeff: 1.1432
norm(ch) = 0.52003
rho = 0.83044
New lambda: 4.639e-071
iter: 3275, Minibatch log likelihood (pre-update): -54.3145, error rate (pre-update): 0.078972
iter: 3275, Minibatch log likelihood (post-update): -54.3144, error rate (post-update): 0.078968

size_minibatch = 20000
Precon grad coeff: 0.024113, velocity coeff: 1.0095
norm(ch) = 0.52602
iter: 3276, Minibatch log likelihood (pre-update): -54.3144, error rate (pre-update): 0.078968

size_minibatch = 20000
Precon grad coeff: 0.02052, velocity coeff: 0.90469
norm(ch) = 0.47683
iter: 3277, Minibatch log likelihood (pre-update): -54.3144, error rate (pre-update): 0.078966

size_minibatch = 20000
Precon grad coeff: 0.017446, velocity coeff: 0.92753
norm(ch) = 0.4431
iter: 3278, Minibatch log likelihood (pre-update): -54.3144, error rate (pre-update): 0.078959

size_minibatch = 20000
Precon grad coeff: 0.018279, velocity coeff: 1.0751
norm(ch) = 0.47695
iter: 3279, Minibatch log likelihood (pre-update): -54.3143, error rate (pre-update): 0.078956

size_minibatch = 20000
Precon grad coeff: 0.02193, velocity coeff: 1.0193
New gamma: 0.0031623
norm(ch) = 0.48712
rho = 1.0545
New lambda: 3.5896e-071
iter: 3280, Minibatch log likelihood (pre-update): -54.3143, error rate (pre-update): 0.07895
iter: 3280, Minibatch log likelihood (post-update): -54.3143, error rate (post-update): 0.078949

size_minibatch = 20000
Precon grad coeff: 0.024119, velocity coeff: 0.99347
norm(ch) = 0.48509
iter: 3281, Minibatch log likelihood (pre-update): -54.3143, error rate (pre-update): 0.078949

size_minibatch = 20000
Precon grad coeff: 0.024536, velocity coeff: 1.0099
norm(ch) = 0.49119
iter: 3282, Minibatch log likelihood (pre-update): -54.3143, error rate (pre-update): 0.078941

size_minibatch = 20000
Precon grad coeff: 0.019977, velocity coeff: 0.88495
norm(ch) = 0.43572
iter: 3283, Minibatch log likelihood (pre-update): -54.3142, error rate (pre-update): 0.078934

size_minibatch = 20000
Precon grad coeff: 0.02303, velocity coeff: 1.2205
norm(ch) = 0.53303
iter: 3284, Minibatch log likelihood (pre-update): -54.3142, error rate (pre-update): 0.078931

size_minibatch = 20000
Precon grad coeff: 0.0234, velocity coeff: 0.9489
norm(ch) = 0.50695
rho = 1.0618
New lambda: 2.7776e-071
iter: 3285, Minibatch log likelihood (pre-update): -54.3142, error rate (pre-update): 0.078929
iter: 3285, Minibatch log likelihood (post-update): -54.3141, error rate (post-update): 0.078927

size_minibatch = 20000
Precon grad coeff: 0.020965, velocity coeff: 1.0059
norm(ch) = 0.51097
iter: 3286, Minibatch log likelihood (pre-update): -54.3141, error rate (pre-update): 0.078927

size_minibatch = 20000
Precon grad coeff: 0.023908, velocity coeff: 1.0552
norm(ch) = 0.54044
iter: 3287, Minibatch log likelihood (pre-update): -54.3141, error rate (pre-update): 0.078916

size_minibatch = 20000
Precon grad coeff: 0.021406, velocity coeff: 0.92392
norm(ch) = 0.50029
iter: 3288, Minibatch log likelihood (pre-update): -54.3141, error rate (pre-update): 0.078914

size_minibatch = 20000
Precon grad coeff: 0.021188, velocity coeff: 0.96994
norm(ch) = 0.48615
iter: 3289, Minibatch log likelihood (pre-update): -54.3141, error rate (pre-update): 0.07891

size_minibatch = 20000
Precon grad coeff: 0.020206, velocity coeff: 0.95726
norm(ch) = 0.46637
rho = 0.99427
New lambda: 2.1492e-071
iter: 3290, Minibatch log likelihood (pre-update): -54.314, error rate (pre-update): 0.078904
iter: 3290, Minibatch log likelihood (post-update): -54.314, error rate (post-update): 0.078901

size_minibatch = 20000
Precon grad coeff: 0.022616, velocity coeff: 1.0695
norm(ch) = 0.49985
iter: 3291, Minibatch log likelihood (pre-update): -54.314, error rate (pre-update): 0.078901

size_minibatch = 20000
Precon grad coeff: 0.024151, velocity coeff: 1.0185
norm(ch) = 0.51023
iter: 3292, Minibatch log likelihood (pre-update): -54.314, error rate (pre-update): 0.078894

size_minibatch = 20000
Precon grad coeff: 0.022313, velocity coeff: 0.93279
norm(ch) = 0.47694
iter: 3293, Minibatch log likelihood (pre-update): -54.3139, error rate (pre-update): 0.078892

size_minibatch = 20000
Precon grad coeff: 0.020234, velocity coeff: 0.99301
norm(ch) = 0.47462
iter: 3294, Minibatch log likelihood (pre-update): -54.3139, error rate (pre-update): 0.078888

size_minibatch = 20000
Precon grad coeff: 0.021925, velocity coeff: 1.0463
norm(ch) = 0.49759
rho = 1.0864
New lambda: 1.663e-071
iter: 3295, Minibatch log likelihood (pre-update): -54.3139, error rate (pre-update): 0.078879
iter: 3295, Minibatch log likelihood (post-update): -54.3139, error rate (post-update): 0.07888

size_minibatch = 20000
Precon grad coeff: 0.02204, velocity coeff: 1.024
norm(ch) = 0.5104
iter: 3296, Minibatch log likelihood (pre-update): -54.3139, error rate (pre-update): 0.07888

size_minibatch = 20000
Precon grad coeff: 0.021315, velocity coeff: 0.93641
norm(ch) = 0.47896
iter: 3297, Minibatch log likelihood (pre-update): -54.3138, error rate (pre-update): 0.078875

size_minibatch = 20000
Precon grad coeff: 0.021392, velocity coeff: 1.0395
norm(ch) = 0.49883
iter: 3298, Minibatch log likelihood (pre-update): -54.3138, error rate (pre-update): 0.078865

size_minibatch = 20000
Precon grad coeff: 0.022076, velocity coeff: 0.98098
norm(ch) = 0.49032
iter: 3299, Minibatch log likelihood (pre-update): -54.3138, error rate (pre-update): 0.078864

size_minibatch = 20000
Precon grad coeff: 0.022685, velocity coeff: 0.99631
New gamma: 0.0031623
norm(ch) = 0.48959
rho = 1.0248
New lambda: 1.2868e-071
iter: 3300, Minibatch log likelihood (pre-update): -54.3137, error rate (pre-update): 0.078859
iter: 3300, Minibatch log likelihood (post-update): -54.3137, error rate (post-update): 0.078855
---
Full log-likelihood: -54.3137, error rate: 0.078855
TEST log-likelihood: -55.2074, error rate: 0.37953
Error difference (test - train): 0.30067
---
Full log-likelihood (averaged params): -54.325, error rate (averaged params): 0.083303
TEST log-likelihood (averaged params): -55.1698, error rate (averaged params): 0.36979
Error difference (test - train) (averaged params): 0.28649

size_minibatch = 20000
Precon grad coeff: 0.018965, velocity coeff: 0.89567
norm(ch) = 0.43935
iter: 3301, Minibatch log likelihood (pre-update): -54.3137, error rate (pre-update): 0.078855

size_minibatch = 20000
Precon grad coeff: 0.021586, velocity coeff: 1.0971
norm(ch) = 0.48302
iter: 3302, Minibatch log likelihood (pre-update): -54.3137, error rate (pre-update): 0.07885

size_minibatch = 20000
Precon grad coeff: 0.022165, velocity coeff: 1.0433
norm(ch) = 0.50504
iter: 3303, Minibatch log likelihood (pre-update): -54.3137, error rate (pre-update): 0.078845

size_minibatch = 20000
Precon grad coeff: 0.024087, velocity coeff: 1.006
norm(ch) = 0.50924
iter: 3304, Minibatch log likelihood (pre-update): -54.3136, error rate (pre-update): 0.078839

size_minibatch = 20000
Precon grad coeff: 0.02293, velocity coeff: 0.98988
norm(ch) = 0.50513
rho = 1.0104
New lambda: 9.9571e-072
iter: 3305, Minibatch log likelihood (pre-update): -54.3136, error rate (pre-update): 0.078836
iter: 3305, Minibatch log likelihood (post-update): -54.3136, error rate (post-update): 0.07883

size_minibatch = 20000
Precon grad coeff: 0.020588, velocity coeff: 0.95148
norm(ch) = 0.48153
iter: 3306, Minibatch log likelihood (pre-update): -54.3136, error rate (pre-update): 0.07883

size_minibatch = 20000
Precon grad coeff: 0.021192, velocity coeff: 1.0386
norm(ch) = 0.50107
iter: 3307, Minibatch log likelihood (pre-update): -54.3135, error rate (pre-update): 0.078829

size_minibatch = 20000
Precon grad coeff: 0.021895, velocity coeff: 0.98759
norm(ch) = 0.4959
iter: 3308, Minibatch log likelihood (pre-update): -54.3135, error rate (pre-update): 0.078824

size_minibatch = 20000
Precon grad coeff: 0.021798, velocity coeff: 0.9699
norm(ch) = 0.48201
iter: 3309, Minibatch log likelihood (pre-update): -54.3135, error rate (pre-update): 0.078815

size_minibatch = 20000
Precon grad coeff: 0.020239, velocity coeff: 0.97899
norm(ch) = 0.47276
rho = 1.0094
New lambda: 7.7046e-072
iter: 3310, Minibatch log likelihood (pre-update): -54.3134, error rate (pre-update): 0.078813
iter: 3310, Minibatch log likelihood (post-update): -54.3134, error rate (post-update): 0.078811

size_minibatch = 20000
Precon grad coeff: 0.021616, velocity coeff: 1.0187
norm(ch) = 0.48255
iter: 3311, Minibatch log likelihood (pre-update): -54.3134, error rate (pre-update): 0.078811

size_minibatch = 20000
Precon grad coeff: 0.021072, velocity coeff: 0.96977
norm(ch) = 0.46895
iter: 3312, Minibatch log likelihood (pre-update): -54.3134, error rate (pre-update): 0.078808

size_minibatch = 20000
Precon grad coeff: 0.01942, velocity coeff: 0.99267
norm(ch) = 0.4664
iter: 3313, Minibatch log likelihood (pre-update): -54.3134, error rate (pre-update): 0.078799

size_minibatch = 20000
Precon grad coeff: 0.022517, velocity coeff: 1.0874
norm(ch) = 0.50812
iter: 3314, Minibatch log likelihood (pre-update): -54.3133, error rate (pre-update): 0.078795

size_minibatch = 20000
Precon grad coeff: 0.024981, velocity coeff: 1.0468
norm(ch) = 0.53292
rho = 1.0056
New lambda: 5.9617e-072
iter: 3315, Minibatch log likelihood (pre-update): -54.3133, error rate (pre-update): 0.078787
iter: 3315, Minibatch log likelihood (post-update): -54.3133, error rate (post-update): 0.078786

size_minibatch = 20000
Precon grad coeff: 0.024901, velocity coeff: 0.94444
norm(ch) = 0.50434
iter: 3316, Minibatch log likelihood (pre-update): -54.3133, error rate (pre-update): 0.078786

size_minibatch = 20000
Precon grad coeff: 0.020099, velocity coeff: 0.93141
norm(ch) = 0.47065
iter: 3317, Minibatch log likelihood (pre-update): -54.3132, error rate (pre-update): 0.078779

size_minibatch = 20000
Precon grad coeff: 0.018716, velocity coeff: 0.96342
norm(ch) = 0.45428
iter: 3318, Minibatch log likelihood (pre-update): -54.3132, error rate (pre-update): 0.078776

size_minibatch = 20000
Precon grad coeff: 0.021021, velocity coeff: 1.0612
norm(ch) = 0.48295
iter: 3319, Minibatch log likelihood (pre-update): -54.3132, error rate (pre-update): 0.078776

size_minibatch = 20000
Precon grad coeff: 0.022957, velocity coeff: 1.0031
New gamma: 0.0031623
norm(ch) = 0.4855
rho = 0.99649
New lambda: 4.6131e-072
iter: 3320, Minibatch log likelihood (pre-update): -54.3132, error rate (pre-update): 0.078764
iter: 3320, Minibatch log likelihood (post-update): -54.3131, error rate (post-update): 0.078764

size_minibatch = 20000
Precon grad coeff: 0.023387, velocity coeff: 1.0143
norm(ch) = 0.49351
iter: 3321, Minibatch log likelihood (pre-update): -54.3131, error rate (pre-update): 0.078764

size_minibatch = 20000
Precon grad coeff: 0.022437, velocity coeff: 0.95841
norm(ch) = 0.47395
iter: 3322, Minibatch log likelihood (pre-update): -54.3131, error rate (pre-update): 0.078762

size_minibatch = 20000
Precon grad coeff: 0.023123, velocity coeff: 1.0713
norm(ch) = 0.50891
iter: 3323, Minibatch log likelihood (pre-update): -54.3131, error rate (pre-update): 0.078753

size_minibatch = 20000
Precon grad coeff: 0.023295, velocity coeff: 0.98196
norm(ch) = 0.5008
iter: 3324, Minibatch log likelihood (pre-update): -54.313, error rate (pre-update): 0.07875

size_minibatch = 20000
Precon grad coeff: 0.023533, velocity coeff: 1.0396
norm(ch) = 0.52177
rho = 1.0152
New lambda: 3.5695e-072
iter: 3325, Minibatch log likelihood (pre-update): -54.313, error rate (pre-update): 0.078743
iter: 3325, Minibatch log likelihood (post-update): -54.313, error rate (post-update): 0.078741

size_minibatch = 20000
Precon grad coeff: 0.019834, velocity coeff: 0.89533
norm(ch) = 0.46807
iter: 3326, Minibatch log likelihood (pre-update): -54.313, error rate (pre-update): 0.078741

size_minibatch = 20000
Precon grad coeff: 0.021564, velocity coeff: 1.0446
norm(ch) = 0.48998
iter: 3327, Minibatch log likelihood (pre-update): -54.313, error rate (pre-update): 0.078738

size_minibatch = 20000
Precon grad coeff: 0.024068, velocity coeff: 1.0664
norm(ch) = 0.52354
iter: 3328, Minibatch log likelihood (pre-update): -54.3129, error rate (pre-update): 0.078735

size_minibatch = 20000
Precon grad coeff: 0.022767, velocity coeff: 0.92755
norm(ch) = 0.48659
iter: 3329, Minibatch log likelihood (pre-update): -54.3129, error rate (pre-update): 0.078726

size_minibatch = 20000
Precon grad coeff: 0.02029, velocity coeff: 0.95873
norm(ch) = 0.46739
rho = 1.0215
New lambda: 2.762e-072
iter: 3330, Minibatch log likelihood (pre-update): -54.3129, error rate (pre-update): 0.078725
iter: 3330, Minibatch log likelihood (post-update): -54.3128, error rate (post-update): 0.078722

size_minibatch = 20000
Precon grad coeff: 0.024429, velocity coeff: 1.118
norm(ch) = 0.5236
iter: 3331, Minibatch log likelihood (pre-update): -54.3128, error rate (pre-update): 0.078722

size_minibatch = 20000
Precon grad coeff: 0.02644, velocity coeff: 1.0249
norm(ch) = 0.53779
iter: 3332, Minibatch log likelihood (pre-update): -54.3128, error rate (pre-update): 0.078712

size_minibatch = 20000
Precon grad coeff: 0.022626, velocity coeff: 0.87259
norm(ch) = 0.47016
iter: 3333, Minibatch log likelihood (pre-update): -54.3128, error rate (pre-update): 0.078712

size_minibatch = 20000
Precon grad coeff: 0.019231, velocity coeff: 0.97963
norm(ch) = 0.46143
iter: 3334, Minibatch log likelihood (pre-update): -54.3128, error rate (pre-update): 0.078705

size_minibatch = 20000
Precon grad coeff: 0.021581, velocity coeff: 1.0764
norm(ch) = 0.49753
rho = 0.9555
New lambda: 2.1372e-072
iter: 3335, Minibatch log likelihood (pre-update): -54.3127, error rate (pre-update): 0.078702
iter: 3335, Minibatch log likelihood (post-update): -54.3127, error rate (post-update): 0.078699

size_minibatch = 20000
Precon grad coeff: 0.023496, velocity coeff: 1.0226
norm(ch) = 0.50979
iter: 3336, Minibatch log likelihood (pre-update): -54.3127, error rate (pre-update): 0.078699

size_minibatch = 20000
Precon grad coeff: 0.02388, velocity coeff: 1.0002
norm(ch) = 0.51093
iter: 3337, Minibatch log likelihood (pre-update): -54.3127, error rate (pre-update): 0.078696

size_minibatch = 20000
Precon grad coeff: 0.025259, velocity coeff: 1.0328
norm(ch) = 0.52873
iter: 3338, Minibatch log likelihood (pre-update): -54.3126, error rate (pre-update): 0.078689

size_minibatch = 20000
Precon grad coeff: 0.023522, velocity coeff: 0.93992
norm(ch) = 0.49779
iter: 3339, Minibatch log likelihood (pre-update): -54.3126, error rate (pre-update): 0.078687

size_minibatch = 20000
Precon grad coeff: 0.021323, velocity coeff: 0.93293
New gamma: 0.0031623
norm(ch) = 0.46536
rho = 1.0704
New lambda: 1.6537e-072
iter: 3340, Minibatch log likelihood (pre-update): -54.3126, error rate (pre-update): 0.078681
iter: 3340, Minibatch log likelihood (post-update): -54.3126, error rate (post-update): 0.078678

size_minibatch = 20000
Precon grad coeff: 0.021286, velocity coeff: 1.0297
norm(ch) = 0.48005
iter: 3341, Minibatch log likelihood (pre-update): -54.3126, error rate (pre-update): 0.078678

size_minibatch = 20000
Precon grad coeff: 0.022514, velocity coeff: 1.0457
norm(ch) = 0.50292
iter: 3342, Minibatch log likelihood (pre-update): -54.3125, error rate (pre-update): 0.078673

size_minibatch = 20000
Precon grad coeff: 0.023099, velocity coeff: 0.98608
norm(ch) = 0.49691
iter: 3343, Minibatch log likelihood (pre-update): -54.3125, error rate (pre-update): 0.078665

size_minibatch = 20000
Precon grad coeff: 0.022254, velocity coeff: 1.0177
norm(ch) = 0.50668
iter: 3344, Minibatch log likelihood (pre-update): -54.3125, error rate (pre-update): 0.07867

size_minibatch = 20000
Precon grad coeff: 0.023731, velocity coeff: 0.98375
norm(ch) = 0.49952
rho = 1.078
New lambda: 1.2796e-072
iter: 3345, Minibatch log likelihood (pre-update): -54.3124, error rate (pre-update): 0.078665
iter: 3345, Minibatch log likelihood (post-update): -54.3124, error rate (post-update): 0.07866

size_minibatch = 20000
Precon grad coeff: 0.020313, velocity coeff: 0.94784
norm(ch) = 0.47423
iter: 3346, Minibatch log likelihood (pre-update): -54.3124, error rate (pre-update): 0.07866

size_minibatch = 20000
Precon grad coeff: 0.021741, velocity coeff: 1.0364
norm(ch) = 0.49241
iter: 3347, Minibatch log likelihood (pre-update): -54.3124, error rate (pre-update): 0.078655

size_minibatch = 20000
Precon grad coeff: 0.022536, velocity coeff: 0.99032
norm(ch) = 0.48849
iter: 3348, Minibatch log likelihood (pre-update): -54.3124, error rate (pre-update): 0.07865

size_minibatch = 20000
Precon grad coeff: 0.023251, velocity coeff: 1.0266
norm(ch) = 0.50249
iter: 3349, Minibatch log likelihood (pre-update): -54.3123, error rate (pre-update): 0.078648

size_minibatch = 20000
Precon grad coeff: 0.022635, velocity coeff: 0.97789
norm(ch) = 0.49231
rho = 0.91376
New lambda: 9.9014e-073
iter: 3350, Minibatch log likelihood (pre-update): -54.3123, error rate (pre-update): 0.078645
iter: 3350, Minibatch log likelihood (post-update): -54.3123, error rate (post-update): 0.078639
---
Full log-likelihood: -54.3123, error rate: 0.078639
TEST log-likelihood: -55.2223, error rate: 0.38353
Error difference (test - train): 0.3049
---
Full log-likelihood (averaged params): -54.3227, error rate (averaged params): 0.082763
TEST log-likelihood (averaged params): -55.1804, error rate (averaged params): 0.37291
Error difference (test - train) (averaged params): 0.29015

size_minibatch = 20000
Precon grad coeff: 0.022324, velocity coeff: 0.99288
norm(ch) = 0.48972
iter: 3351, Minibatch log likelihood (pre-update): -54.3123, error rate (pre-update): 0.078639

size_minibatch = 20000
Precon grad coeff: 0.020426, velocity coeff: 0.93952
norm(ch) = 0.46091
iter: 3352, Minibatch log likelihood (pre-update): -54.3122, error rate (pre-update): 0.078634

size_minibatch = 20000
Precon grad coeff: 0.020277, velocity coeff: 1.0427
norm(ch) = 0.48144
iter: 3353, Minibatch log likelihood (pre-update): -54.3122, error rate (pre-update): 0.078633

size_minibatch = 20000
Precon grad coeff: 0.024341, velocity coeff: 1.0781
norm(ch) = 0.52005
iter: 3354, Minibatch log likelihood (pre-update): -54.3122, error rate (pre-update): 0.078627

size_minibatch = 20000
Precon grad coeff: 0.021698, velocity coeff: 0.92077
norm(ch) = 0.47967
rho = 1.1123
New lambda: 7.6615e-073
iter: 3355, Minibatch log likelihood (pre-update): -54.3122, error rate (pre-update): 0.078627
iter: 3355, Minibatch log likelihood (post-update): -54.3121, error rate (post-update): 0.078618

size_minibatch = 20000
Precon grad coeff: 0.021525, velocity coeff: 1.0059
norm(ch) = 0.48336
iter: 3356, Minibatch log likelihood (pre-update): -54.3121, error rate (pre-update): 0.078618

size_minibatch = 20000
Precon grad coeff: 0.022646, velocity coeff: 1.0303
norm(ch) = 0.49884
iter: 3357, Minibatch log likelihood (pre-update): -54.3121, error rate (pre-update): 0.078613

size_minibatch = 20000
Precon grad coeff: 0.021442, velocity coeff: 0.94256
norm(ch) = 0.47098
iter: 3358, Minibatch log likelihood (pre-update): -54.3121, error rate (pre-update): 0.078612

size_minibatch = 20000
Precon grad coeff: 0.020447, velocity coeff: 0.98991
norm(ch) = 0.46703
iter: 3359, Minibatch log likelihood (pre-update): -54.312, error rate (pre-update): 0.078608

size_minibatch = 20000
Precon grad coeff: 0.023872, velocity coeff: 1.1121
New gamma: 0.0031623
norm(ch) = 0.52041
rho = 0.93891
New lambda: 5.9283e-073
iter: 3360, Minibatch log likelihood (pre-update): -54.312, error rate (pre-update): 0.078604
iter: 3360, Minibatch log likelihood (post-update): -54.312, error rate (post-update): 0.078597

size_minibatch = 20000
Precon grad coeff: 0.023579, velocity coeff: 0.91963
norm(ch) = 0.47954
iter: 3361, Minibatch log likelihood (pre-update): -54.312, error rate (pre-update): 0.078597

size_minibatch = 20000
Precon grad coeff: 0.020599, velocity coeff: 0.98956
norm(ch) = 0.47539
iter: 3362, Minibatch log likelihood (pre-update): -54.312, error rate (pre-update): 0.078596

size_minibatch = 20000
Precon grad coeff: 0.019759, velocity coeff: 0.9655
norm(ch) = 0.45979
iter: 3363, Minibatch log likelihood (pre-update): -54.3119, error rate (pre-update): 0.078589

size_minibatch = 20000
Precon grad coeff: 0.018171, velocity coeff: 0.98802
norm(ch) = 0.45498
iter: 3364, Minibatch log likelihood (pre-update): -54.3119, error rate (pre-update): 0.078588

size_minibatch = 20000
Precon grad coeff: 0.020352, velocity coeff: 1.0726
norm(ch) = 0.48879
rho = 0.96489
New lambda: 4.5872e-073
iter: 3365, Minibatch log likelihood (pre-update): -54.3119, error rate (pre-update): 0.078587
iter: 3365, Minibatch log likelihood (post-update): -54.3119, error rate (post-update): 0.078582

size_minibatch = 20000
Precon grad coeff: 0.023068, velocity coeff: 1.0349
norm(ch) = 0.50678
iter: 3366, Minibatch log likelihood (pre-update): -54.3119, error rate (pre-update): 0.078582

size_minibatch = 20000
Precon grad coeff: 0.023518, velocity coeff: 0.98047
norm(ch) = 0.49781
iter: 3367, Minibatch log likelihood (pre-update): -54.3118, error rate (pre-update): 0.078573

size_minibatch = 20000
Precon grad coeff: 0.021412, velocity coeff: 0.95717
norm(ch) = 0.47727
iter: 3368, Minibatch log likelihood (pre-update): -54.3118, error rate (pre-update): 0.078572

size_minibatch = 20000
Precon grad coeff: 0.020615, velocity coeff: 0.96485
norm(ch) = 0.4613
iter: 3369, Minibatch log likelihood (pre-update): -54.3118, error rate (pre-update): 0.078563

size_minibatch = 20000
Precon grad coeff: 0.024055, velocity coeff: 1.1057
norm(ch) = 0.511
rho = 1.0651
New lambda: 3.5495e-073
iter: 3370, Minibatch log likelihood (pre-update): -54.3117, error rate (pre-update): 0.078562
iter: 3370, Minibatch log likelihood (post-update): -54.3117, error rate (post-update): 0.078562

size_minibatch = 20000
Precon grad coeff: 0.022899, velocity coeff: 0.97302
norm(ch) = 0.49809
iter: 3371, Minibatch log likelihood (pre-update): -54.3117, error rate (pre-update): 0.078562

size_minibatch = 20000
Precon grad coeff: 0.022756, velocity coeff: 0.97862
norm(ch) = 0.48837
iter: 3372, Minibatch log likelihood (pre-update): -54.3117, error rate (pre-update): 0.078557

size_minibatch = 20000
Precon grad coeff: 0.022855, velocity coeff: 1.0083
norm(ch) = 0.49338
iter: 3373, Minibatch log likelihood (pre-update): -54.3117, error rate (pre-update): 0.078553

size_minibatch = 20000
Precon grad coeff: 0.020171, velocity coeff: 0.93805
norm(ch) = 0.46369
iter: 3374, Minibatch log likelihood (pre-update): -54.3116, error rate (pre-update): 0.078547

size_minibatch = 20000
Precon grad coeff: 0.016793, velocity coeff: 0.92628
norm(ch) = 0.43015
rho = 1.028
New lambda: 2.7465e-073
iter: 3375, Minibatch log likelihood (pre-update): -54.3116, error rate (pre-update): 0.078547
iter: 3375, Minibatch log likelihood (post-update): -54.3116, error rate (post-update): 0.078542

size_minibatch = 20000
Precon grad coeff: 0.02073, velocity coeff: 1.116
norm(ch) = 0.48087
iter: 3376, Minibatch log likelihood (pre-update): -54.3116, error rate (pre-update): 0.078542

size_minibatch = 20000
Precon grad coeff: 0.019623, velocity coeff: 0.96409
norm(ch) = 0.46438
iter: 3377, Minibatch log likelihood (pre-update): -54.3116, error rate (pre-update): 0.078538

size_minibatch = 20000
Precon grad coeff: 0.021659, velocity coeff: 1.0477
norm(ch) = 0.48737
iter: 3378, Minibatch log likelihood (pre-update): -54.3115, error rate (pre-update): 0.078532

size_minibatch = 20000
Precon grad coeff: 0.02096, velocity coeff: 0.96675
norm(ch) = 0.47202
iter: 3379, Minibatch log likelihood (pre-update): -54.3115, error rate (pre-update): 0.078529

size_minibatch = 20000
Precon grad coeff: 0.021644, velocity coeff: 0.98861
New gamma: 0.0031623
norm(ch) = 0.46755
rho = 1.0864
New lambda: 2.1252e-073
iter: 3380, Minibatch log likelihood (pre-update): -54.3115, error rate (pre-update): 0.078529
iter: 3380, Minibatch log likelihood (post-update): -54.3114, error rate (post-update): 0.078524

size_minibatch = 20000
Precon grad coeff: 0.020579, velocity coeff: 0.96914
norm(ch) = 0.45394
iter: 3381, Minibatch log likelihood (pre-update): -54.3114, error rate (pre-update): 0.078524

size_minibatch = 20000
Precon grad coeff: 0.021003, velocity coeff: 1.0608
norm(ch) = 0.48245
iter: 3382, Minibatch log likelihood (pre-update): -54.3114, error rate (pre-update): 0.078519

size_minibatch = 20000
Precon grad coeff: 0.022529, velocity coeff: 1.0175
norm(ch) = 0.4919
iter: 3383, Minibatch log likelihood (pre-update): -54.3114, error rate (pre-update): 0.078514

size_minibatch = 20000
Precon grad coeff: 0.023264, velocity coeff: 1.0433
norm(ch) = 0.51418
iter: 3384, Minibatch log likelihood (pre-update): -54.3114, error rate (pre-update): 0.078506

size_minibatch = 20000
Precon grad coeff: 0.019798, velocity coeff: 0.86231
norm(ch) = 0.4442
rho = 1.0726
New lambda: 1.6445e-073
iter: 3385, Minibatch log likelihood (pre-update): -54.3113, error rate (pre-update): 0.078505
iter: 3385, Minibatch log likelihood (post-update): -54.3113, error rate (post-update): 0.078507

size_minibatch = 20000
Precon grad coeff: 0.01851, velocity coeff: 1.075
norm(ch) = 0.47833
iter: 3386, Minibatch log likelihood (pre-update): -54.3113, error rate (pre-update): 0.078507

size_minibatch = 20000
Precon grad coeff: 0.023169, velocity coeff: 1.0359
norm(ch) = 0.49651
iter: 3387, Minibatch log likelihood (pre-update): -54.3113, error rate (pre-update): 0.078502

size_minibatch = 20000
Precon grad coeff: 0.019292, velocity coeff: 0.90869
norm(ch) = 0.45194
iter: 3388, Minibatch log likelihood (pre-update): -54.3113, error rate (pre-update): 0.078498

size_minibatch = 20000
Precon grad coeff: 0.020752, velocity coeff: 1.0853
norm(ch) = 0.49136
iter: 3389, Minibatch log likelihood (pre-update): -54.3112, error rate (pre-update): 0.07849

size_minibatch = 20000
Precon grad coeff: 0.021554, velocity coeff: 0.93781
norm(ch) = 0.46175
rho = 1.1425
New lambda: 1.2725e-073
iter: 3390, Minibatch log likelihood (pre-update): -54.3112, error rate (pre-update): 0.078485
iter: 3390, Minibatch log likelihood (post-update): -54.3112, error rate (post-update): 0.07848

size_minibatch = 20000
Precon grad coeff: 0.019662, velocity coeff: 1.0163
norm(ch) = 0.47001
iter: 3391, Minibatch log likelihood (pre-update): -54.3112, error rate (pre-update): 0.07848

size_minibatch = 20000
Precon grad coeff: 0.020362, velocity coeff: 0.9965
norm(ch) = 0.46917
iter: 3392, Minibatch log likelihood (pre-update): -54.3112, error rate (pre-update): 0.078479

size_minibatch = 20000
Precon grad coeff: 0.023981, velocity coeff: 1.1089
norm(ch) = 0.52118
iter: 3393, Minibatch log likelihood (pre-update): -54.3111, error rate (pre-update): 0.078476

size_minibatch = 20000
Precon grad coeff: 0.022936, velocity coeff: 0.92012
norm(ch) = 0.48055
iter: 3394, Minibatch log likelihood (pre-update): -54.3111, error rate (pre-update): 0.078472

size_minibatch = 20000
Precon grad coeff: 0.018951, velocity coeff: 0.9326
norm(ch) = 0.44897
rho = 1.1071
New lambda: 9.846e-074
iter: 3395, Minibatch log likelihood (pre-update): -54.3111, error rate (pre-update): 0.078469
iter: 3395, Minibatch log likelihood (post-update): -54.311, error rate (post-update): 0.078463

size_minibatch = 20000
Precon grad coeff: 0.021455, velocity coeff: 1.1158
norm(ch) = 0.50186
iter: 3396, Minibatch log likelihood (pre-update): -54.311, error rate (pre-update): 0.078463

size_minibatch = 20000
Precon grad coeff: 0.021069, velocity coeff: 0.93571
norm(ch) = 0.47034
iter: 3397, Minibatch log likelihood (pre-update): -54.311, error rate (pre-update): 0.078458

size_minibatch = 20000
Precon grad coeff: 0.019916, velocity coeff: 0.98079
norm(ch) = 0.46209
iter: 3398, Minibatch log likelihood (pre-update): -54.311, error rate (pre-update): 0.078458

size_minibatch = 20000
Precon grad coeff: 0.021621, velocity coeff: 1.077
norm(ch) = 0.4985
iter: 3399, Minibatch log likelihood (pre-update): -54.311, error rate (pre-update): 0.07845

size_minibatch = 20000
Precon grad coeff: 0.020644, velocity coeff: 0.91218
New gamma: 0.0031623
norm(ch) = 0.45566
rho = 1.0166
New lambda: 7.6186e-074
iter: 3400, Minibatch log likelihood (pre-update): -54.3109, error rate (pre-update): 0.078445
iter: 3400, Minibatch log likelihood (post-update): -54.3109, error rate (post-update): 0.07844
---
Full log-likelihood: -54.3109, error rate: 0.07844
TEST log-likelihood: -55.2359, error rate: 0.38706
Error difference (test - train): 0.30862
---
Full log-likelihood (averaged params): -54.3207, error rate (averaged params): 0.082323
TEST log-likelihood (averaged params): -55.1924, error rate (averaged params): 0.3762
Error difference (test - train) (averaged params): 0.29388

size_minibatch = 20000
Precon grad coeff: 0.017014, velocity coeff: 0.91075
norm(ch) = 0.41568
iter: 3401, Minibatch log likelihood (pre-update): -54.3109, error rate (pre-update): 0.07844

size_minibatch = 20000
Precon grad coeff: 0.02131, velocity coeff: 1.1826
norm(ch) = 0.49241
iter: 3402, Minibatch log likelihood (pre-update): -54.3109, error rate (pre-update): 0.078438

size_minibatch = 20000
Precon grad coeff: 0.019356, velocity coeff: 0.92315
norm(ch) = 0.4554
iter: 3403, Minibatch log likelihood (pre-update): -54.3109, error rate (pre-update): 0.078434

size_minibatch = 20000
Precon grad coeff: 0.019783, velocity coeff: 1.0273
norm(ch) = 0.46862
iter: 3404, Minibatch log likelihood (pre-update): -54.3108, error rate (pre-update): 0.078433

size_minibatch = 20000
Precon grad coeff: 0.020498, velocity coeff: 1.0348
norm(ch) = 0.48576
rho = 1.0224
New lambda: 5.8952e-074
iter: 3405, Minibatch log likelihood (pre-update): -54.3108, error rate (pre-update): 0.078428
iter: 3405, Minibatch log likelihood (post-update): -54.3108, error rate (post-update): 0.078422

size_minibatch = 20000
Precon grad coeff: 0.020456, velocity coeff: 0.97165
norm(ch) = 0.4728
iter: 3406, Minibatch log likelihood (pre-update): -54.3108, error rate (pre-update): 0.078422

size_minibatch = 20000
Precon grad coeff: 0.020469, velocity coeff: 1.0081
norm(ch) = 0.47745
iter: 3407, Minibatch log likelihood (pre-update): -54.3108, error rate (pre-update): 0.078414

size_minibatch = 20000
Precon grad coeff: 0.018426, velocity coeff: 0.91267
norm(ch) = 0.43658
iter: 3408, Minibatch log likelihood (pre-update): -54.3107, error rate (pre-update): 0.078412

size_minibatch = 20000
Precon grad coeff: 0.01793, velocity coeff: 1.0137
norm(ch) = 0.44323
iter: 3409, Minibatch log likelihood (pre-update): -54.3107, error rate (pre-update): 0.07841

size_minibatch = 20000
Precon grad coeff: 0.019998, velocity coeff: 1.075
norm(ch) = 0.4772
rho = 1.0315
New lambda: 4.5616e-074
iter: 3410, Minibatch log likelihood (pre-update): -54.3107, error rate (pre-update): 0.078409
iter: 3410, Minibatch log likelihood (post-update): -54.3107, error rate (post-update): 0.078398

size_minibatch = 20000
Precon grad coeff: 0.022802, velocity coeff: 1.0187
norm(ch) = 0.48704
iter: 3411, Minibatch log likelihood (pre-update): -54.3107, error rate (pre-update): 0.078398

size_minibatch = 20000
Precon grad coeff: 0.019259, velocity coeff: 0.91956
norm(ch) = 0.44868
iter: 3412, Minibatch log likelihood (pre-update): -54.3106, error rate (pre-update): 0.078392

size_minibatch = 20000
Precon grad coeff: 0.019054, velocity coeff: 1.0127
norm(ch) = 0.45512
iter: 3413, Minibatch log likelihood (pre-update): -54.3106, error rate (pre-update): 0.078392

size_minibatch = 20000
Precon grad coeff: 0.019279, velocity coeff: 1.0181
norm(ch) = 0.46413
iter: 3414, Minibatch log likelihood (pre-update): -54.3106, error rate (pre-update): 0.078391

size_minibatch = 20000
Precon grad coeff: 0.018743, velocity coeff: 0.97546
norm(ch) = 0.45347
rho = 0.93842
New lambda: 3.5296e-074
iter: 3415, Minibatch log likelihood (pre-update): -54.3105, error rate (pre-update): 0.078381
iter: 3415, Minibatch log likelihood (post-update): -54.3105, error rate (post-update): 0.078379

size_minibatch = 20000
Precon grad coeff: 0.017789, velocity coeff: 0.98033
norm(ch) = 0.44528
iter: 3416, Minibatch log likelihood (pre-update): -54.3105, error rate (pre-update): 0.078379

size_minibatch = 20000
Precon grad coeff: 0.019834, velocity coeff: 1.0762
norm(ch) = 0.47994
iter: 3417, Minibatch log likelihood (pre-update): -54.3105, error rate (pre-update): 0.078376

size_minibatch = 20000
Precon grad coeff: 0.022399, velocity coeff: 1.0169
norm(ch) = 0.48888
iter: 3418, Minibatch log likelihood (pre-update): -54.3105, error rate (pre-update): 0.078373

size_minibatch = 20000
Precon grad coeff: 0.018865, velocity coeff: 0.9271
norm(ch) = 0.45398
iter: 3419, Minibatch log likelihood (pre-update): -54.3104, error rate (pre-update): 0.078366

size_minibatch = 20000
Precon grad coeff: 0.019098, velocity coeff: 0.97548
New gamma: 0.0031623
norm(ch) = 0.44367
rho = 1.0795
New lambda: 2.7312e-074
iter: 3420, Minibatch log likelihood (pre-update): -54.3104, error rate (pre-update): 0.078365
iter: 3420, Minibatch log likelihood (post-update): -54.3104, error rate (post-update): 0.078362

size_minibatch = 20000
Precon grad coeff: 0.018361, velocity coeff: 0.97602
norm(ch) = 0.43379
iter: 3421, Minibatch log likelihood (pre-update): -54.3104, error rate (pre-update): 0.078362

size_minibatch = 20000
Precon grad coeff: 0.019738, velocity coeff: 1.0906
norm(ch) = 0.47388
iter: 3422, Minibatch log likelihood (pre-update): -54.3104, error rate (pre-update): 0.078357

size_minibatch = 20000
Precon grad coeff: 0.02152, velocity coeff: 1.0018
norm(ch) = 0.47563
iter: 3423, Minibatch log likelihood (pre-update): -54.3103, error rate (pre-update): 0.078347

size_minibatch = 20000
Precon grad coeff: 0.021315, velocity coeff: 1.0109
norm(ch) = 0.48183
iter: 3424, Minibatch log likelihood (pre-update): -54.3103, error rate (pre-update): 0.078348

size_minibatch = 20000
Precon grad coeff: 0.018881, velocity coeff: 0.95824
norm(ch) = 0.46254
rho = 0.98559
New lambda: 2.1133e-074
iter: 3425, Minibatch log likelihood (pre-update): -54.3103, error rate (pre-update): 0.078341
iter: 3425, Minibatch log likelihood (post-update): -54.3103, error rate (post-update): 0.078337

size_minibatch = 20000
Precon grad coeff: 0.020541, velocity coeff: 1.0292
norm(ch) = 0.47692
iter: 3426, Minibatch log likelihood (pre-update): -54.3103, error rate (pre-update): 0.078337

size_minibatch = 20000
Precon grad coeff: 0.017573, velocity coeff: 0.91707
norm(ch) = 0.43805
iter: 3427, Minibatch log likelihood (pre-update): -54.3102, error rate (pre-update): 0.078335

size_minibatch = 20000
Precon grad coeff: 0.018853, velocity coeff: 1.085
norm(ch) = 0.47605
iter: 3428, Minibatch log likelihood (pre-update): -54.3102, error rate (pre-update): 0.078334

size_minibatch = 20000
Precon grad coeff: 0.022169, velocity coeff: 1.035
norm(ch) = 0.4936
iter: 3429, Minibatch log likelihood (pre-update): -54.3102, error rate (pre-update): 0.078327

size_minibatch = 20000
Precon grad coeff: 0.019877, velocity coeff: 0.94839
norm(ch) = 0.46899
rho = 1.1571
New lambda: 1.6353e-074
iter: 3430, Minibatch log likelihood (pre-update): -54.3102, error rate (pre-update): 0.078325
iter: 3430, Minibatch log likelihood (post-update): -54.3101, error rate (post-update): 0.078317

size_minibatch = 20000
Precon grad coeff: 0.019214, velocity coeff: 0.9392
norm(ch) = 0.4412
iter: 3431, Minibatch log likelihood (pre-update): -54.3101, error rate (pre-update): 0.078317

size_minibatch = 20000
Precon grad coeff: 0.018776, velocity coeff: 1.0467
norm(ch) = 0.46262
iter: 3432, Minibatch log likelihood (pre-update): -54.3101, error rate (pre-update): 0.078313

size_minibatch = 20000
Precon grad coeff: 0.018083, velocity coeff: 0.94415
norm(ch) = 0.43757
iter: 3433, Minibatch log likelihood (pre-update): -54.3101, error rate (pre-update): 0.078309

size_minibatch = 20000
Precon grad coeff: 0.018927, velocity coeff: 1.0467
norm(ch) = 0.45881
iter: 3434, Minibatch log likelihood (pre-update): -54.3101, error rate (pre-update): 0.078308

size_minibatch = 20000
Precon grad coeff: 0.021736, velocity coeff: 1.0822
norm(ch) = 0.49739
rho = 0.95551
New lambda: 1.2653e-074
iter: 3435, Minibatch log likelihood (pre-update): -54.31, error rate (pre-update): 0.078301
iter: 3435, Minibatch log likelihood (post-update): -54.31, error rate (post-update): 0.078299

size_minibatch = 20000
Precon grad coeff: 0.018899, velocity coeff: 0.89862
norm(ch) = 0.44774
iter: 3436, Minibatch log likelihood (pre-update): -54.31, error rate (pre-update): 0.078299

size_minibatch = 20000
Precon grad coeff: 0.019224, velocity coeff: 1.0314
norm(ch) = 0.46256
iter: 3437, Minibatch log likelihood (pre-update): -54.31, error rate (pre-update): 0.078295

size_minibatch = 20000
Precon grad coeff: 0.017575, velocity coeff: 0.96505
norm(ch) = 0.44714
iter: 3438, Minibatch log likelihood (pre-update): -54.31, error rate (pre-update): 0.07829

size_minibatch = 20000
Precon grad coeff: 0.018458, velocity coeff: 1.0115
norm(ch) = 0.45298
iter: 3439, Minibatch log likelihood (pre-update): -54.3099, error rate (pre-update): 0.078283

size_minibatch = 20000
Precon grad coeff: 0.020785, velocity coeff: 1.0349
New gamma: 0.0031623
norm(ch) = 0.46967
rho = 0.86125
New lambda: 9.7909e-075
iter: 3440, Minibatch log likelihood (pre-update): -54.3099, error rate (pre-update): 0.078284
iter: 3440, Minibatch log likelihood (post-update): -54.3099, error rate (post-update): 0.07828

size_minibatch = 20000
Precon grad coeff: 0.021197, velocity coeff: 0.98695
norm(ch) = 0.46443
iter: 3441, Minibatch log likelihood (pre-update): -54.3099, error rate (pre-update): 0.07828

size_minibatch = 20000
Precon grad coeff: 0.020218, velocity coeff: 0.96907
norm(ch) = 0.45098
iter: 3442, Minibatch log likelihood (pre-update): -54.3099, error rate (pre-update): 0.078279

size_minibatch = 20000
Precon grad coeff: 0.018186, velocity coeff: 0.98546
norm(ch) = 0.44514
iter: 3443, Minibatch log likelihood (pre-update): -54.3098, error rate (pre-update): 0.078273

size_minibatch = 20000
Precon grad coeff: 0.021023, velocity coeff: 1.0736
norm(ch) = 0.47885
iter: 3444, Minibatch log likelihood (pre-update): -54.3098, error rate (pre-update): 0.078269

size_minibatch = 20000
Precon grad coeff: 0.018528, velocity coeff: 0.9614
norm(ch) = 0.46115
rho = 1.0746
New lambda: 7.576e-075
iter: 3445, Minibatch log likelihood (pre-update): -54.3098, error rate (pre-update): 0.078261
iter: 3445, Minibatch log likelihood (post-update): -54.3098, error rate (post-update): 0.078261

size_minibatch = 20000
Precon grad coeff: 0.022916, velocity coeff: 1.1397
norm(ch) = 0.52656
iter: 3446, Minibatch log likelihood (pre-update): -54.3098, error rate (pre-update): 0.078261

size_minibatch = 20000
Precon grad coeff: 0.019452, velocity coeff: 0.84361
norm(ch) = 0.44498
iter: 3447, Minibatch log likelihood (pre-update): -54.3097, error rate (pre-update): 0.078254

size_minibatch = 20000
Precon grad coeff: 0.018453, velocity coeff: 1.0418
norm(ch) = 0.46438
iter: 3448, Minibatch log likelihood (pre-update): -54.3097, error rate (pre-update): 0.07825

size_minibatch = 20000
Precon grad coeff: 0.019499, velocity coeff: 1.0166
norm(ch) = 0.47285
iter: 3449, Minibatch log likelihood (pre-update): -54.3097, error rate (pre-update): 0.078247

size_minibatch = 20000
Precon grad coeff: 0.018493, velocity coeff: 0.93117
norm(ch) = 0.44102
rho = 1.1065
New lambda: 5.8622e-075
iter: 3450, Minibatch log likelihood (pre-update): -54.3097, error rate (pre-update): 0.078245
iter: 3450, Minibatch log likelihood (post-update): -54.3096, error rate (post-update): 0.078237
---
Full log-likelihood: -54.3096, error rate: 0.078237
TEST log-likelihood: -55.2505, error rate: 0.39067
Error difference (test - train): 0.31244
---
Full log-likelihood (averaged params): -54.3189, error rate (averaged params): 0.081908
TEST log-likelihood (averaged params): -55.2047, error rate (averaged params): 0.37946
Error difference (test - train) (averaged params): 0.29755

size_minibatch = 20000
Precon grad coeff: 0.021614, velocity coeff: 1.1234
norm(ch) = 0.49626
iter: 3451, Minibatch log likelihood (pre-update): -54.3096, error rate (pre-update): 0.078237

size_minibatch = 20000
Precon grad coeff: 0.020803, velocity coeff: 0.92019
norm(ch) = 0.45747
iter: 3452, Minibatch log likelihood (pre-update): -54.3096, error rate (pre-update): 0.078236

size_minibatch = 20000
Precon grad coeff: 0.017716, velocity coeff: 0.93318
norm(ch) = 0.4276
iter: 3453, Minibatch log likelihood (pre-update): -54.3096, error rate (pre-update): 0.078232

size_minibatch = 20000
Precon grad coeff: 0.018329, velocity coeff: 1.0645
norm(ch) = 0.45612
iter: 3454, Minibatch log likelihood (pre-update): -54.3096, error rate (pre-update): 0.078231

size_minibatch = 20000
Precon grad coeff: 0.021402, velocity coeff: 1.0682
norm(ch) = 0.48806
rho = 1.0906
New lambda: 4.536e-075
iter: 3455, Minibatch log likelihood (pre-update): -54.3095, error rate (pre-update): 0.078225
iter: 3455, Minibatch log likelihood (post-update): -54.3095, error rate (post-update): 0.07822

size_minibatch = 20000
Precon grad coeff: 0.020239, velocity coeff: 0.94141
norm(ch) = 0.46017
iter: 3456, Minibatch log likelihood (pre-update): -54.3095, error rate (pre-update): 0.07822

size_minibatch = 20000
Precon grad coeff: 0.018798, velocity coeff: 0.99147
norm(ch) = 0.45697
iter: 3457, Minibatch log likelihood (pre-update): -54.3095, error rate (pre-update): 0.078214

size_minibatch = 20000
Precon grad coeff: 0.019577, velocity coeff: 1.0138
norm(ch) = 0.46409
iter: 3458, Minibatch log likelihood (pre-update): -54.3095, error rate (pre-update): 0.078216

size_minibatch = 20000
Precon grad coeff: 0.017296, velocity coeff: 0.94537
norm(ch) = 0.43942
iter: 3459, Minibatch log likelihood (pre-update): -54.3094, error rate (pre-update): 0.078211

size_minibatch = 20000
Precon grad coeff: 0.019743, velocity coeff: 1.0909
New gamma: 0.0031623
norm(ch) = 0.48016
rho = 0.99994
New lambda: 3.5099e-075
iter: 3460, Minibatch log likelihood (pre-update): -54.3094, error rate (pre-update): 0.078208
iter: 3460, Minibatch log likelihood (post-update): -54.3094, error rate (post-update): 0.078204

size_minibatch = 20000
Precon grad coeff: 0.02207, velocity coeff: 1.0395
norm(ch) = 0.49992
iter: 3461, Minibatch log likelihood (pre-update): -54.3094, error rate (pre-update): 0.078204

size_minibatch = 20000
Precon grad coeff: 0.018625, velocity coeff: 0.8764
norm(ch) = 0.43892
iter: 3462, Minibatch log likelihood (pre-update): -54.3094, error rate (pre-update): 0.078198

size_minibatch = 20000
Precon grad coeff: 0.01734, velocity coeff: 1.0142
norm(ch) = 0.44582
iter: 3463, Minibatch log likelihood (pre-update): -54.3093, error rate (pre-update): 0.07819

size_minibatch = 20000
Precon grad coeff: 0.019105, velocity coeff: 1.0448
norm(ch) = 0.46658
iter: 3464, Minibatch log likelihood (pre-update): -54.3093, error rate (pre-update): 0.078191

size_minibatch = 20000
Precon grad coeff: 0.019696, velocity coeff: 0.99841
norm(ch) = 0.4665
rho = 1.0929
New lambda: 2.7159e-075
iter: 3465, Minibatch log likelihood (pre-update): -54.3093, error rate (pre-update): 0.07819
iter: 3465, Minibatch log likelihood (post-update): -54.3093, error rate (post-update): 0.078189

size_minibatch = 20000
Precon grad coeff: 0.019864, velocity coeff: 1.0012
norm(ch) = 0.46788
iter: 3466, Minibatch log likelihood (pre-update): -54.3093, error rate (pre-update): 0.078189

size_minibatch = 20000
Precon grad coeff: 0.018298, velocity coeff: 0.95245
norm(ch) = 0.44632
iter: 3467, Minibatch log likelihood (pre-update): -54.3092, error rate (pre-update): 0.078183

size_minibatch = 20000
Precon grad coeff: 0.01794, velocity coeff: 0.97528
norm(ch) = 0.43591
iter: 3468, Minibatch log likelihood (pre-update): -54.3092, error rate (pre-update): 0.078178

size_minibatch = 20000
Precon grad coeff: 0.018315, velocity coeff: 1.0615
norm(ch) = 0.46338
iter: 3469, Minibatch log likelihood (pre-update): -54.3092, error rate (pre-update): 0.078172

size_minibatch = 20000
Precon grad coeff: 0.019456, velocity coeff: 0.99303
norm(ch) = 0.46095
rho = 1.1022
New lambda: 2.1015e-075
iter: 3470, Minibatch log likelihood (pre-update): -54.3092, error rate (pre-update): 0.078173
iter: 3470, Minibatch log likelihood (post-update): -54.3091, error rate (post-update): 0.078168

size_minibatch = 20000
Precon grad coeff: 0.021221, velocity coeff: 1.0559
norm(ch) = 0.48761
iter: 3471, Minibatch log likelihood (pre-update): -54.3091, error rate (pre-update): 0.078168

size_minibatch = 20000
Precon grad coeff: 0.016877, velocity coeff: 0.83678
norm(ch) = 0.40872
iter: 3472, Minibatch log likelihood (pre-update): -54.3091, error rate (pre-update): 0.078164

size_minibatch = 20000
Precon grad coeff: 0.017568, velocity coeff: 1.1566
norm(ch) = 0.47327
iter: 3473, Minibatch log likelihood (pre-update): -54.3091, error rate (pre-update): 0.078161

size_minibatch = 20000
Precon grad coeff: 0.019589, velocity coeff: 0.96471
norm(ch) = 0.45729
iter: 3474, Minibatch log likelihood (pre-update): -54.3091, error rate (pre-update): 0.078158

size_minibatch = 20000
Precon grad coeff: 0.020393, velocity coeff: 1.0106
norm(ch) = 0.4629
rho = 0.97611
New lambda: 1.6261e-075
iter: 3475, Minibatch log likelihood (pre-update): -54.309, error rate (pre-update): 0.07815
iter: 3475, Minibatch log likelihood (post-update): -54.309, error rate (post-update): 0.078153

size_minibatch = 20000
Precon grad coeff: 0.017998, velocity coeff: 0.99123
norm(ch) = 0.45964
iter: 3476, Minibatch log likelihood (pre-update): -54.309, error rate (pre-update): 0.078153

size_minibatch = 20000
Precon grad coeff: 0.017861, velocity coeff: 0.90343
norm(ch) = 0.41591
iter: 3477, Minibatch log likelihood (pre-update): -54.309, error rate (pre-update): 0.078151

size_minibatch = 20000
Precon grad coeff: 0.017158, velocity coeff: 1.0679
norm(ch) = 0.44474
iter: 3478, Minibatch log likelihood (pre-update): -54.309, error rate (pre-update): 0.078148

size_minibatch = 20000
Precon grad coeff: 0.019401, velocity coeff: 1.0541
norm(ch) = 0.46946
iter: 3479, Minibatch log likelihood (pre-update): -54.3089, error rate (pre-update): 0.07814

size_minibatch = 20000
Precon grad coeff: 0.021065, velocity coeff: 0.9882
New gamma: 0.0031623
norm(ch) = 0.46482
rho = 1.0315
New lambda: 1.2582e-075
iter: 3480, Minibatch log likelihood (pre-update): -54.3089, error rate (pre-update): 0.078135
iter: 3480, Minibatch log likelihood (post-update): -54.3089, error rate (post-update): 0.078132

size_minibatch = 20000
Precon grad coeff: 0.018233, velocity coeff: 0.9371
norm(ch) = 0.43633
iter: 3481, Minibatch log likelihood (pre-update): -54.3089, error rate (pre-update): 0.078132

size_minibatch = 20000
Precon grad coeff: 0.018538, velocity coeff: 1.0562
norm(ch) = 0.46166
iter: 3482, Minibatch log likelihood (pre-update): -54.3089, error rate (pre-update): 0.078135

size_minibatch = 20000
Precon grad coeff: 0.018114, velocity coeff: 0.96627
norm(ch) = 0.44683
iter: 3483, Minibatch log likelihood (pre-update): -54.3088, error rate (pre-update): 0.078128

size_minibatch = 20000
Precon grad coeff: 0.019504, velocity coeff: 1.0762
norm(ch) = 0.48168
iter: 3484, Minibatch log likelihood (pre-update): -54.3088, error rate (pre-update): 0.078121

size_minibatch = 20000
Precon grad coeff: 0.02116, velocity coeff: 1.002
norm(ch) = 0.48345
rho = 1.1268
New lambda: 9.7361e-076
iter: 3485, Minibatch log likelihood (pre-update): -54.3088, error rate (pre-update): 0.078118
iter: 3485, Minibatch log likelihood (post-update): -54.3088, error rate (post-update): 0.078117

size_minibatch = 20000
Precon grad coeff: 0.017702, velocity coeff: 0.88505
norm(ch) = 0.42864
iter: 3486, Minibatch log likelihood (pre-update): -54.3088, error rate (pre-update): 0.078117

size_minibatch = 20000
Precon grad coeff: 0.017977, velocity coeff: 1.081
norm(ch) = 0.46402
iter: 3487, Minibatch log likelihood (pre-update): -54.3087, error rate (pre-update): 0.078112

size_minibatch = 20000
Precon grad coeff: 0.01798, velocity coeff: 0.96698
norm(ch) = 0.44945
iter: 3488, Minibatch log likelihood (pre-update): -54.3087, error rate (pre-update): 0.078111

size_minibatch = 20000
Precon grad coeff: 0.020583, velocity coeff: 1.0457
norm(ch) = 0.47077
iter: 3489, Minibatch log likelihood (pre-update): -54.3087, error rate (pre-update): 0.078107

size_minibatch = 20000
Precon grad coeff: 0.019261, velocity coeff: 0.95972
norm(ch) = 0.45252
rho = 1.1118
New lambda: 7.5336e-076
iter: 3490, Minibatch log likelihood (pre-update): -54.3087, error rate (pre-update): 0.078104
iter: 3490, Minibatch log likelihood (post-update): -54.3086, error rate (post-update): 0.078101

size_minibatch = 20000
Precon grad coeff: 0.017914, velocity coeff: 0.97092
norm(ch) = 0.44008
iter: 3491, Minibatch log likelihood (pre-update): -54.3086, error rate (pre-update): 0.078101

size_minibatch = 20000
Precon grad coeff: 0.016516, velocity coeff: 0.96327
norm(ch) = 0.42458
iter: 3492, Minibatch log likelihood (pre-update): -54.3086, error rate (pre-update): 0.078097

size_minibatch = 20000
Precon grad coeff: 0.020853, velocity coeff: 1.1656
norm(ch) = 0.49571
iter: 3493, Minibatch log likelihood (pre-update): -54.3086, error rate (pre-update): 0.078089

size_minibatch = 20000
Precon grad coeff: 0.02002, velocity coeff: 0.92293
norm(ch) = 0.45833
iter: 3494, Minibatch log likelihood (pre-update): -54.3086, error rate (pre-update): 0.078091

size_minibatch = 20000
Precon grad coeff: 0.017885, velocity coeff: 0.92654
norm(ch) = 0.42536
rho = 1.0918
New lambda: 5.8293e-076
iter: 3495, Minibatch log likelihood (pre-update): -54.3086, error rate (pre-update): 0.078086
iter: 3495, Minibatch log likelihood (post-update): -54.3085, error rate (post-update): 0.078085

size_minibatch = 20000
Precon grad coeff: 0.017242, velocity coeff: 1.0605
norm(ch) = 0.45174
iter: 3496, Minibatch log likelihood (pre-update): -54.3085, error rate (pre-update): 0.078085

size_minibatch = 20000
Precon grad coeff: 0.01849, velocity coeff: 1.0044
norm(ch) = 0.45443
iter: 3497, Minibatch log likelihood (pre-update): -54.3085, error rate (pre-update): 0.078083

size_minibatch = 20000
Precon grad coeff: 0.018537, velocity coeff: 1.0313
norm(ch) = 0.46941
iter: 3498, Minibatch log likelihood (pre-update): -54.3085, error rate (pre-update): 0.078082

size_minibatch = 20000
Precon grad coeff: 0.020505, velocity coeff: 0.97979
norm(ch) = 0.4607
iter: 3499, Minibatch log likelihood (pre-update): -54.3085, error rate (pre-update): 0.078072

size_minibatch = 20000
Precon grad coeff: 0.017868, velocity coeff: 0.89948
New gamma: 0.0031623
norm(ch) = 0.41527
rho = 0.95567
New lambda: 4.5106e-076
iter: 3500, Minibatch log likelihood (pre-update): -54.3084, error rate (pre-update): 0.078071
iter: 3500, Minibatch log likelihood (post-update): -54.3084, error rate (post-update): 0.078067
---
Full log-likelihood: -54.3084, error rate: 0.078067
TEST log-likelihood: -55.2631, error rate: 0.39371
Error difference (test - train): 0.31564
---
Full log-likelihood (averaged params): -54.3173, error rate (averaged params): 0.081575
TEST log-likelihood (averaged params): -55.2172, error rate (averaged params): 0.38272
Error difference (test - train) (averaged params): 0.30114

size_minibatch = 20000
Precon grad coeff: 0.022043, velocity coeff: 1.136
norm(ch) = 0.47258
iter: 3501, Minibatch log likelihood (pre-update): -54.3084, error rate (pre-update): 0.078067

size_minibatch = 20000
Precon grad coeff: 0.019999, velocity coeff: 0.93392
norm(ch) = 0.44227
iter: 3502, Minibatch log likelihood (pre-update): -54.3084, error rate (pre-update): 0.078061

size_minibatch = 20000
Precon grad coeff: 0.021546, velocity coeff: 1.0609
norm(ch) = 0.47021
iter: 3503, Minibatch log likelihood (pre-update): -54.3084, error rate (pre-update): 0.07806

size_minibatch = 20000
Precon grad coeff: 0.020999, velocity coeff: 1.0202
norm(ch) = 0.48075
iter: 3504, Minibatch log likelihood (pre-update): -54.3083, error rate (pre-update): 0.078061

size_minibatch = 20000
Precon grad coeff: 0.021039, velocity coeff: 1.0013
norm(ch) = 0.48235
rho = 1.0101
New lambda: 3.4902e-076
iter: 3505, Minibatch log likelihood (pre-update): -54.3083, error rate (pre-update): 0.078051
iter: 3505, Minibatch log likelihood (post-update): -54.3083, error rate (post-update): 0.07805

size_minibatch = 20000
Precon grad coeff: 0.019734, velocity coeff: 1.0144
norm(ch) = 0.49027
iter: 3506, Minibatch log likelihood (pre-update): -54.3083, error rate (pre-update): 0.07805

size_minibatch = 20000
Precon grad coeff: 0.019563, velocity coeff: 0.95733
norm(ch) = 0.47024
iter: 3507, Minibatch log likelihood (pre-update): -54.3083, error rate (pre-update): 0.078046

size_minibatch = 20000
Precon grad coeff: 0.021017, velocity coeff: 1.0617
norm(ch) = 0.50018
iter: 3508, Minibatch log likelihood (pre-update): -54.3082, error rate (pre-update): 0.078042

size_minibatch = 20000
Precon grad coeff: 0.019552, velocity coeff: 0.92435
norm(ch) = 0.46312
iter: 3509, Minibatch log likelihood (pre-update): -54.3082, error rate (pre-update): 0.078036

size_minibatch = 20000
Precon grad coeff: 0.020627, velocity coeff: 1.0245
norm(ch) = 0.47538
rho = 1.0621
New lambda: 2.7007e-076
iter: 3510, Minibatch log likelihood (pre-update): -54.3082, error rate (pre-update): 0.078033
iter: 3510, Minibatch log likelihood (post-update): -54.3081, error rate (post-update): 0.078029

size_minibatch = 20000
Precon grad coeff: 0.021541, velocity coeff: 0.99409
norm(ch) = 0.47345
iter: 3511, Minibatch log likelihood (pre-update): -54.3081, error rate (pre-update): 0.078029

size_minibatch = 20000
Precon grad coeff: 0.017635, velocity coeff: 0.89467
norm(ch) = 0.42429
iter: 3512, Minibatch log likelihood (pre-update): -54.3081, error rate (pre-update): 0.078029

size_minibatch = 20000
Precon grad coeff: 0.020937, velocity coeff: 1.138
norm(ch) = 0.48367
iter: 3513, Minibatch log likelihood (pre-update): -54.3081, error rate (pre-update): 0.078024

size_minibatch = 20000
Precon grad coeff: 0.020905, velocity coeff: 0.95737
norm(ch) = 0.46395
iter: 3514, Minibatch log likelihood (pre-update): -54.3081, error rate (pre-update): 0.078023

size_minibatch = 20000
Precon grad coeff: 0.020271, velocity coeff: 1.0231
norm(ch) = 0.47551
rho = 1.135
New lambda: 2.0897e-076
iter: 3515, Minibatch log likelihood (pre-update): -54.308, error rate (pre-update): 0.078015
iter: 3515, Minibatch log likelihood (post-update): -54.308, error rate (post-update): 0.078013

size_minibatch = 20000
Precon grad coeff: 0.020555, velocity coeff: 1.0053
norm(ch) = 0.47893
iter: 3516, Minibatch log likelihood (pre-update): -54.308, error rate (pre-update): 0.078013

size_minibatch = 20000
Precon grad coeff: 0.018759, velocity coeff: 0.93393
norm(ch) = 0.44794
iter: 3517, Minibatch log likelihood (pre-update): -54.308, error rate (pre-update): 0.078012

size_minibatch = 20000
Precon grad coeff: 0.019154, velocity coeff: 1.0724
norm(ch) = 0.48116
iter: 3518, Minibatch log likelihood (pre-update): -54.308, error rate (pre-update): 0.07801

size_minibatch = 20000
Precon grad coeff: 0.020868, velocity coeff: 0.97883
norm(ch) = 0.47175
iter: 3519, Minibatch log likelihood (pre-update): -54.3079, error rate (pre-update): 0.077998

size_minibatch = 20000
Precon grad coeff: 0.020546, velocity coeff: 1.0066
New gamma: 0.0031623
norm(ch) = 0.47572
rho = 0.93153
New lambda: 1.617e-076
iter: 3520, Minibatch log likelihood (pre-update): -54.3079, error rate (pre-update): 0.077997
iter: 3520, Minibatch log likelihood (post-update): -54.3079, error rate (post-update): 0.077992

size_minibatch = 20000
Precon grad coeff: 0.017791, velocity coeff: 0.89162
norm(ch) = 0.4249
iter: 3521, Minibatch log likelihood (pre-update): -54.3079, error rate (pre-update): 0.077992

size_minibatch = 20000
Precon grad coeff: 0.017901, velocity coeff: 1.0996
norm(ch) = 0.4679
iter: 3522, Minibatch log likelihood (pre-update): -54.3079, error rate (pre-update): 0.077991

size_minibatch = 20000
Precon grad coeff: 0.018463, velocity coeff: 0.94693
norm(ch) = 0.4437
iter: 3523, Minibatch log likelihood (pre-update): -54.3078, error rate (pre-update): 0.077988

size_minibatch = 20000
Precon grad coeff: 0.020651, velocity coeff: 1.1065
norm(ch) = 0.49182
iter: 3524, Minibatch log likelihood (pre-update): -54.3078, error rate (pre-update): 0.077987

size_minibatch = 20000
Precon grad coeff: 0.01995, velocity coeff: 0.93587
norm(ch) = 0.46106
rho = 1.1421
New lambda: 1.2512e-076
iter: 3525, Minibatch log likelihood (pre-update): -54.3078, error rate (pre-update): 0.077977
iter: 3525, Minibatch log likelihood (post-update): -54.3078, error rate (post-update): 0.077974

size_minibatch = 20000
Precon grad coeff: 0.016344, velocity coeff: 0.91611
norm(ch) = 0.4231
iter: 3526, Minibatch log likelihood (pre-update): -54.3078, error rate (pre-update): 0.077974

size_minibatch = 20000
Precon grad coeff: 0.018405, velocity coeff: 1.0478
norm(ch) = 0.44404
iter: 3527, Minibatch log likelihood (pre-update): -54.3077, error rate (pre-update): 0.077973

size_minibatch = 20000
Precon grad coeff: 0.019012, velocity coeff: 1.007
norm(ch) = 0.44789
iter: 3528, Minibatch log likelihood (pre-update): -54.3077, error rate (pre-update): 0.077972

size_minibatch = 20000
Precon grad coeff: 0.019734, velocity coeff: 1.0461
norm(ch) = 0.46927
iter: 3529, Minibatch log likelihood (pre-update): -54.3077, error rate (pre-update): 0.077962

size_minibatch = 20000
Precon grad coeff: 0.020347, velocity coeff: 0.96897
norm(ch) = 0.45553
rho = 1.0331
New lambda: 9.6816e-077
iter: 3530, Minibatch log likelihood (pre-update): -54.3077, error rate (pre-update): 0.077963
iter: 3530, Minibatch log likelihood (post-update): -54.3077, error rate (post-update): 0.077957

size_minibatch = 20000
Precon grad coeff: 0.015937, velocity coeff: 0.90165
norm(ch) = 0.41133
iter: 3531, Minibatch log likelihood (pre-update): -54.3077, error rate (pre-update): 0.077957

size_minibatch = 20000
Precon grad coeff: 0.017867, velocity coeff: 1.0855
norm(ch) = 0.44735
iter: 3532, Minibatch log likelihood (pre-update): -54.3076, error rate (pre-update): 0.077952

size_minibatch = 20000
Precon grad coeff: 0.0217, velocity coeff: 1.1436
norm(ch) = 0.51244
iter: 3533, Minibatch log likelihood (pre-update): -54.3076, error rate (pre-update): 0.077946

size_minibatch = 20000
Precon grad coeff: 0.020828, velocity coeff: 0.88091
norm(ch) = 0.45217
iter: 3534, Minibatch log likelihood (pre-update): -54.3076, error rate (pre-update): 0.077948

size_minibatch = 20000
Precon grad coeff: 0.015965, velocity coeff: 0.92486
norm(ch) = 0.41883
rho = 0.94863
New lambda: 7.4914e-077
iter: 3535, Minibatch log likelihood (pre-update): -54.3076, error rate (pre-update): 0.077943
iter: 3535, Minibatch log likelihood (post-update): -54.3075, error rate (post-update): 0.077942

size_minibatch = 20000
Precon grad coeff: 0.018254, velocity coeff: 1.1068
norm(ch) = 0.46439
iter: 3536, Minibatch log likelihood (pre-update): -54.3075, error rate (pre-update): 0.077942

size_minibatch = 20000
Precon grad coeff: 0.018029, velocity coeff: 0.93798
norm(ch) = 0.43616
iter: 3537, Minibatch log likelihood (pre-update): -54.3075, error rate (pre-update): 0.077937

size_minibatch = 20000
Precon grad coeff: 0.018909, velocity coeff: 1.0493
norm(ch) = 0.45842
iter: 3538, Minibatch log likelihood (pre-update): -54.3075, error rate (pre-update): 0.077933

size_minibatch = 20000
Precon grad coeff: 0.019865, velocity coeff: 1.0151
norm(ch) = 0.46613
iter: 3539, Minibatch log likelihood (pre-update): -54.3075, error rate (pre-update): 0.077927

size_minibatch = 20000
Precon grad coeff: 0.019776, velocity coeff: 0.92383
New gamma: 0.0031623
norm(ch) = 0.43148
rho = 0.91157
New lambda: 5.7967e-077
iter: 3540, Minibatch log likelihood (pre-update): -54.3074, error rate (pre-update): 0.077921
iter: 3540, Minibatch log likelihood (post-update): -54.3074, error rate (post-update): 0.077917

size_minibatch = 20000
Precon grad coeff: 0.017526, velocity coeff: 0.9939
norm(ch) = 0.42952
iter: 3541, Minibatch log likelihood (pre-update): -54.3074, error rate (pre-update): 0.077917

size_minibatch = 20000
Precon grad coeff: 0.021613, velocity coeff: 1.1014
norm(ch) = 0.47407
iter: 3542, Minibatch log likelihood (pre-update): -54.3074, error rate (pre-update): 0.077918

size_minibatch = 20000
Precon grad coeff: 0.022989, velocity coeff: 1.0442
norm(ch) = 0.49609
iter: 3543, Minibatch log likelihood (pre-update): -54.3074, error rate (pre-update): 0.077911

size_minibatch = 20000
Precon grad coeff: 0.022378, velocity coeff: 0.9921
norm(ch) = 0.49312
iter: 3544, Minibatch log likelihood (pre-update): -54.3073, error rate (pre-update): 0.077908

size_minibatch = 20000
Precon grad coeff: 0.020668, velocity coeff: 0.9546
norm(ch) = 0.4716
rho = 1.0389
New lambda: 4.4854e-077
iter: 3545, Minibatch log likelihood (pre-update): -54.3073, error rate (pre-update): 0.077905
iter: 3545, Minibatch log likelihood (post-update): -54.3073, error rate (post-update): 0.077899

size_minibatch = 20000
Precon grad coeff: 0.017886, velocity coeff: 0.95379
norm(ch) = 0.4506
iter: 3546, Minibatch log likelihood (pre-update): -54.3073, error rate (pre-update): 0.077899

size_minibatch = 20000
Precon grad coeff: 0.018198, velocity coeff: 1.0208
norm(ch) = 0.46069
iter: 3547, Minibatch log likelihood (pre-update): -54.3073, error rate (pre-update): 0.077889

size_minibatch = 20000
Precon grad coeff: 0.022209, velocity coeff: 1.1029
norm(ch) = 0.50911
iter: 3548, Minibatch log likelihood (pre-update): -54.3072, error rate (pre-update): 0.07789

size_minibatch = 20000
Precon grad coeff: 0.023282, velocity coeff: 0.95612
norm(ch) = 0.48776
iter: 3549, Minibatch log likelihood (pre-update): -54.3072, error rate (pre-update): 0.077889

size_minibatch = 20000
Precon grad coeff: 0.017919, velocity coeff: 0.88786
norm(ch) = 0.43385
rho = 1.036
New lambda: 3.4707e-077
iter: 3550, Minibatch log likelihood (pre-update): -54.3072, error rate (pre-update): 0.077884
iter: 3550, Minibatch log likelihood (post-update): -54.3072, error rate (post-update): 0.07788
---
Full log-likelihood: -54.3072, error rate: 0.07788
TEST log-likelihood: -55.2746, error rate: 0.39643
Error difference (test - train): 0.31855
---
Full log-likelihood (averaged params): -54.316, error rate (averaged params): 0.081366
TEST log-likelihood (averaged params): -55.2292, error rate (averaged params): 0.38578
Error difference (test - train) (averaged params): 0.30441

size_minibatch = 20000
Precon grad coeff: 0.020444, velocity coeff: 1.0711
norm(ch) = 0.46544
iter: 3551, Minibatch log likelihood (pre-update): -54.3072, error rate (pre-update): 0.07788

size_minibatch = 20000
Precon grad coeff: 0.0204, velocity coeff: 0.97541
norm(ch) = 0.4548
iter: 3552, Minibatch log likelihood (pre-update): -54.3071, error rate (pre-update): 0.077874

size_minibatch = 20000
Precon grad coeff: 0.017085, velocity coeff: 0.94864
norm(ch) = 0.43209
iter: 3553, Minibatch log likelihood (pre-update): -54.3071, error rate (pre-update): 0.077867

size_minibatch = 20000
Precon grad coeff: 0.019574, velocity coeff: 1.0568
norm(ch) = 0.4576
iter: 3554, Minibatch log likelihood (pre-update): -54.3071, error rate (pre-update): 0.077866

size_minibatch = 20000
Precon grad coeff: 0.021821, velocity coeff: 1.1001
norm(ch) = 0.50431
rho = 1.0507
New lambda: 2.6856e-077
iter: 3555, Minibatch log likelihood (pre-update): -54.3071, error rate (pre-update): 0.077859
iter: 3555, Minibatch log likelihood (post-update): -54.307, error rate (post-update): 0.077856

size_minibatch = 20000
Precon grad coeff: 0.025091, velocity coeff: 1.0277
norm(ch) = 0.51929
iter: 3556, Minibatch log likelihood (pre-update): -54.307, error rate (pre-update): 0.077856

size_minibatch = 20000
Precon grad coeff: 0.019342, velocity coeff: 0.84429
norm(ch) = 0.43911
iter: 3557, Minibatch log likelihood (pre-update): -54.307, error rate (pre-update): 0.077853

size_minibatch = 20000
Precon grad coeff: 0.016403, velocity coeff: 0.97779
norm(ch) = 0.43004
iter: 3558, Minibatch log likelihood (pre-update): -54.307, error rate (pre-update): 0.077851

size_minibatch = 20000
Precon grad coeff: 0.019091, velocity coeff: 1.1
norm(ch) = 0.47373
iter: 3559, Minibatch log likelihood (pre-update): -54.307, error rate (pre-update): 0.077842

size_minibatch = 20000
Precon grad coeff: 0.022077, velocity coeff: 0.99766
New gamma: 0.0031623
norm(ch) = 0.47359
rho = 1.0007
New lambda: 2.078e-077
iter: 3560, Minibatch log likelihood (pre-update): -54.3069, error rate (pre-update): 0.077839
iter: 3560, Minibatch log likelihood (post-update): -54.3069, error rate (post-update): 0.077837

size_minibatch = 20000
Precon grad coeff: 0.018899, velocity coeff: 0.92378
norm(ch) = 0.43829
iter: 3561, Minibatch log likelihood (pre-update): -54.3069, error rate (pre-update): 0.077837

size_minibatch = 20000
Precon grad coeff: 0.018434, velocity coeff: 1.05
norm(ch) = 0.46105
iter: 3562, Minibatch log likelihood (pre-update): -54.3069, error rate (pre-update): 0.077836

size_minibatch = 20000
Precon grad coeff: 0.018966, velocity coeff: 0.95407
norm(ch) = 0.44056
iter: 3563, Minibatch log likelihood (pre-update): -54.3069, error rate (pre-update): 0.077826

size_minibatch = 20000
Precon grad coeff: 0.015899, velocity coeff: 0.97558
norm(ch) = 0.43046
iter: 3564, Minibatch log likelihood (pre-update): -54.3069, error rate (pre-update): 0.077819

size_minibatch = 20000
Precon grad coeff: 0.01935, velocity coeff: 1.0776
norm(ch) = 0.46463
rho = 1.2127
New lambda: 1.6079e-077
iter: 3565, Minibatch log likelihood (pre-update): -54.3068, error rate (pre-update): 0.077814
iter: 3565, Minibatch log likelihood (post-update): -54.3068, error rate (post-update): 0.077817

size_minibatch = 20000
Precon grad coeff: 0.021926, velocity coeff: 1.0387
norm(ch) = 0.48349
iter: 3566, Minibatch log likelihood (pre-update): -54.3068, error rate (pre-update): 0.077817

size_minibatch = 20000
Precon grad coeff: 0.017917, velocity coeff: 0.86771
norm(ch) = 0.42022
iter: 3567, Minibatch log likelihood (pre-update): -54.3068, error rate (pre-update): 0.07781

size_minibatch = 20000
Precon grad coeff: 0.018324, velocity coeff: 1.066
norm(ch) = 0.4487
iter: 3568, Minibatch log likelihood (pre-update): -54.3068, error rate (pre-update): 0.077806

size_minibatch = 20000
Precon grad coeff: 0.017077, velocity coeff: 0.92607
norm(ch) = 0.41617
iter: 3569, Minibatch log likelihood (pre-update): -54.3067, error rate (pre-update): 0.077801

size_minibatch = 20000
Precon grad coeff: 0.017152, velocity coeff: 1.1013
norm(ch) = 0.45904
rho = 0.95832
New lambda: 1.2442e-077
iter: 3570, Minibatch log likelihood (pre-update): -54.3067, error rate (pre-update): 0.0778
iter: 3570, Minibatch log likelihood (post-update): -54.3067, error rate (post-update): 0.077794

size_minibatch = 20000
Precon grad coeff: 0.02111, velocity coeff: 1.0112
norm(ch) = 0.465
iter: 3571, Minibatch log likelihood (pre-update): -54.3067, error rate (pre-update): 0.077794

size_minibatch = 20000
Precon grad coeff: 0.020374, velocity coeff: 1.0074
norm(ch) = 0.46931
iter: 3572, Minibatch log likelihood (pre-update): -54.3067, error rate (pre-update): 0.077792

size_minibatch = 20000
Precon grad coeff: 0.016966, velocity coeff: 0.87765
norm(ch) = 0.41256
iter: 3573, Minibatch log likelihood (pre-update): -54.3066, error rate (pre-update): 0.077785

size_minibatch = 20000
Precon grad coeff: 0.015708, velocity coeff: 1.0216
norm(ch) = 0.42204
iter: 3574, Minibatch log likelihood (pre-update): -54.3066, error rate (pre-update): 0.077782

size_minibatch = 20000
Precon grad coeff: 0.019446, velocity coeff: 1.1135
norm(ch) = 0.47066
rho = 1.0976
New lambda: 9.6274e-078
iter: 3575, Minibatch log likelihood (pre-update): -54.3066, error rate (pre-update): 0.077775
iter: 3575, Minibatch log likelihood (post-update): -54.3066, error rate (post-update): 0.077771

size_minibatch = 20000
Precon grad coeff: 0.022969, velocity coeff: 1.05
norm(ch) = 0.49514
iter: 3576, Minibatch log likelihood (pre-update): -54.3066, error rate (pre-update): 0.077771

size_minibatch = 20000
Precon grad coeff: 0.016586, velocity coeff: 0.82011
norm(ch) = 0.4067
iter: 3577, Minibatch log likelihood (pre-update): -54.3065, error rate (pre-update): 0.077765

size_minibatch = 20000
Precon grad coeff: 0.015972, velocity coeff: 1.0226
norm(ch) = 0.41648
iter: 3578, Minibatch log likelihood (pre-update): -54.3065, error rate (pre-update): 0.077762

size_minibatch = 20000
Precon grad coeff: 0.018104, velocity coeff: 1.0888
norm(ch) = 0.45404
iter: 3579, Minibatch log likelihood (pre-update): -54.3065, error rate (pre-update): 0.077759

size_minibatch = 20000
Precon grad coeff: 0.020016, velocity coeff: 0.98017
New gamma: 0.0031623
norm(ch) = 0.44578
rho = 1.0018
New lambda: 7.4495e-078
iter: 3580, Minibatch log likelihood (pre-update): -54.3065, error rate (pre-update): 0.077763
iter: 3580, Minibatch log likelihood (post-update): -54.3065, error rate (post-update): 0.077754

size_minibatch = 20000
Precon grad coeff: 0.019296, velocity coeff: 0.9716
norm(ch) = 0.43395
iter: 3581, Minibatch log likelihood (pre-update): -54.3065, error rate (pre-update): 0.077754

size_minibatch = 20000
Precon grad coeff: 0.013608, velocity coeff: 0.87517
norm(ch) = 0.3805
iter: 3582, Minibatch log likelihood (pre-update): -54.3064, error rate (pre-update): 0.077748

size_minibatch = 20000
Precon grad coeff: 0.019032, velocity coeff: 1.1943
norm(ch) = 0.45513
iter: 3583, Minibatch log likelihood (pre-update): -54.3064, error rate (pre-update): 0.077742

size_minibatch = 20000
Precon grad coeff: 0.023331, velocity coeff: 1.0762
norm(ch) = 0.49068
iter: 3584, Minibatch log likelihood (pre-update): -54.3064, error rate (pre-update): 0.07774

size_minibatch = 20000
Precon grad coeff: 0.017833, velocity coeff: 0.83654
norm(ch) = 0.4112
rho = 0.93479
New lambda: 5.7643e-078
iter: 3585, Minibatch log likelihood (pre-update): -54.3064, error rate (pre-update): 0.077733
iter: 3585, Minibatch log likelihood (post-update): -54.3063, error rate (post-update): 0.077734

size_minibatch = 20000
Precon grad coeff: 0.014309, velocity coeff: 0.95637
norm(ch) = 0.39399
iter: 3586, Minibatch log likelihood (pre-update): -54.3063, error rate (pre-update): 0.077734

size_minibatch = 20000
Precon grad coeff: 0.018127, velocity coeff: 1.126
norm(ch) = 0.44442
iter: 3587, Minibatch log likelihood (pre-update): -54.3063, error rate (pre-update): 0.077729

size_minibatch = 20000
Precon grad coeff: 0.020201, velocity coeff: 1.0606
norm(ch) = 0.4721
iter: 3588, Minibatch log likelihood (pre-update): -54.3063, error rate (pre-update): 0.077722

size_minibatch = 20000
Precon grad coeff: 0.020432, velocity coeff: 0.99781
norm(ch) = 0.47181
iter: 3589, Minibatch log likelihood (pre-update): -54.3063, error rate (pre-update): 0.077718

size_minibatch = 20000
Precon grad coeff: 0.013381, velocity coeff: 0.7499
norm(ch) = 0.35437
rho = 1.1035
New lambda: 4.4603e-078
iter: 3590, Minibatch log likelihood (pre-update): -54.3063, error rate (pre-update): 0.077718
iter: 3590, Minibatch log likelihood (post-update): -54.3062, error rate (post-update): 0.07771

size_minibatch = 20000
Precon grad coeff: 0.017613, velocity coeff: 1.2851
norm(ch) = 0.45611
iter: 3591, Minibatch log likelihood (pre-update): -54.3062, error rate (pre-update): 0.07771

size_minibatch = 20000
Precon grad coeff: 0.021978, velocity coeff: 1.0915
norm(ch) = 0.4988
iter: 3592, Minibatch log likelihood (pre-update): -54.3062, error rate (pre-update): 0.077702

size_minibatch = 20000
Precon grad coeff: 0.019949, velocity coeff: 0.85788
norm(ch) = 0.42884
iter: 3593, Minibatch log likelihood (pre-update): -54.3062, error rate (pre-update): 0.077701

size_minibatch = 20000
Precon grad coeff: 0.01262, velocity coeff: 0.84842
norm(ch) = 0.36426
iter: 3594, Minibatch log likelihood (pre-update): -54.3062, error rate (pre-update): 0.077703

size_minibatch = 20000
Precon grad coeff: 0.017625, velocity coeff: 1.1889
norm(ch) = 0.43359
rho = 1.0949
New lambda: 3.4513e-078
iter: 3595, Minibatch log likelihood (pre-update): -54.3061, error rate (pre-update): 0.0777
iter: 3595, Minibatch log likelihood (post-update): -54.3061, error rate (post-update): 0.077695

size_minibatch = 20000
Precon grad coeff: 0.021466, velocity coeff: 1.1041
norm(ch) = 0.47959
iter: 3596, Minibatch log likelihood (pre-update): -54.3061, error rate (pre-update): 0.077695

size_minibatch = 20000
Precon grad coeff: 0.021016, velocity coeff: 0.93356
norm(ch) = 0.44856
iter: 3597, Minibatch log likelihood (pre-update): -54.3061, error rate (pre-update): 0.077684

size_minibatch = 20000
Precon grad coeff: 0.013045, velocity coeff: 0.7427
norm(ch) = 0.33386
iter: 3598, Minibatch log likelihood (pre-update): -54.3061, error rate (pre-update): 0.077679

size_minibatch = 20000
Precon grad coeff: 0.017727, velocity coeff: 1.3126
norm(ch) = 0.43888
iter: 3599, Minibatch log likelihood (pre-update): -54.3061, error rate (pre-update): 0.077675

size_minibatch = 20000
Precon grad coeff: 0.023771, velocity coeff: 1.1035
New gamma: 0.0031623
norm(ch) = 0.48525
rho = 1.0318
New lambda: 2.6705e-078
iter: 3600, Minibatch log likelihood (pre-update): -54.306, error rate (pre-update): 0.077676
iter: 3600, Minibatch log likelihood (post-update): -54.306, error rate (post-update): 0.077672
---
Full log-likelihood: -54.306, error rate: 0.077672
TEST log-likelihood: -55.2857, error rate: 0.39898
Error difference (test - train): 0.32131
---
Full log-likelihood (averaged params): -54.3149, error rate (averaged params): 0.081206
TEST log-likelihood (averaged params): -55.2413, error rate (averaged params): 0.38882
Error difference (test - train) (averaged params): 0.30761

size_minibatch = 20000
Precon grad coeff: 0.020297, velocity coeff: 0.91683
norm(ch) = 0.44575
iter: 3601, Minibatch log likelihood (pre-update): -54.306, error rate (pre-update): 0.077672

size_minibatch = 20000
Precon grad coeff: 0.016054, velocity coeff: 0.9033
norm(ch) = 0.40339
iter: 3602, Minibatch log likelihood (pre-update): -54.306, error rate (pre-update): 0.077669

size_minibatch = 20000
Precon grad coeff: 0.016822, velocity coeff: 1.0623
norm(ch) = 0.42928
iter: 3603, Minibatch log likelihood (pre-update): -54.306, error rate (pre-update): 0.077663

size_minibatch = 20000
Precon grad coeff: 0.017696, velocity coeff: 1.1062
norm(ch) = 0.47559
iter: 3604, Minibatch log likelihood (pre-update): -54.3059, error rate (pre-update): 0.07766

size_minibatch = 20000
Precon grad coeff: 0.02299, velocity coeff: 1.021
norm(ch) = 0.48654
rho = 1.1958
New lambda: 2.0664e-078
iter: 3605, Minibatch log likelihood (pre-update): -54.3059, error rate (pre-update): 0.077652
iter: 3605, Minibatch log likelihood (post-update): -54.3059, error rate (post-update): 0.077649

size_minibatch = 20000
Precon grad coeff: 0.017545, velocity coeff: 0.85433
norm(ch) = 0.41643
iter: 3606, Minibatch log likelihood (pre-update): -54.3059, error rate (pre-update): 0.077649

size_minibatch = 20000
Precon grad coeff: 0.014434, velocity coeff: 0.9167
norm(ch) = 0.38228
iter: 3607, Minibatch log likelihood (pre-update): -54.3059, error rate (pre-update): 0.077648

size_minibatch = 20000
Precon grad coeff: 0.019719, velocity coeff: 1.2006
norm(ch) = 0.45971
iter: 3608, Minibatch log likelihood (pre-update): -54.3059, error rate (pre-update): 0.077647

size_minibatch = 20000
Precon grad coeff: 0.02132, velocity coeff: 0.97638
norm(ch) = 0.44974
iter: 3609, Minibatch log likelihood (pre-update): -54.3058, error rate (pre-update): 0.077635

size_minibatch = 20000
Precon grad coeff: 0.01695, velocity coeff: 0.88719
norm(ch) = 0.39985
rho = 1.0659
New lambda: 1.5989e-078
iter: 3610, Minibatch log likelihood (pre-update): -54.3058, error rate (pre-update): 0.077634
iter: 3610, Minibatch log likelihood (post-update): -54.3058, error rate (post-update): 0.077633

size_minibatch = 20000
Precon grad coeff: 0.015848, velocity coeff: 0.98391
norm(ch) = 0.39399
iter: 3611, Minibatch log likelihood (pre-update): -54.3058, error rate (pre-update): 0.077633

size_minibatch = 20000
Precon grad coeff: 0.018453, velocity coeff: 1.0988
norm(ch) = 0.4336
iter: 3612, Minibatch log likelihood (pre-update): -54.3058, error rate (pre-update): 0.077631

size_minibatch = 20000
Precon grad coeff: 0.019274, velocity coeff: 1.0724
norm(ch) = 0.46576
iter: 3613, Minibatch log likelihood (pre-update): -54.3057, error rate (pre-update): 0.077621

size_minibatch = 20000
Precon grad coeff: 0.017838, velocity coeff: 0.88093
norm(ch) = 0.4112
iter: 3614, Minibatch log likelihood (pre-update): -54.3057, error rate (pre-update): 0.077619

size_minibatch = 20000
Precon grad coeff: 0.015991, velocity coeff: 1.0214
norm(ch) = 0.42068
rho = 0.99094
New lambda: 1.2372e-078
iter: 3615, Minibatch log likelihood (pre-update): -54.3057, error rate (pre-update): 0.077615
iter: 3615, Minibatch log likelihood (post-update): -54.3057, error rate (post-update): 0.077612

size_minibatch = 20000
Precon grad coeff: 0.017111, velocity coeff: 1.0444
norm(ch) = 0.43993
iter: 3616, Minibatch log likelihood (pre-update): -54.3057, error rate (pre-update): 0.077612

size_minibatch = 20000
Precon grad coeff: 0.019361, velocity coeff: 1.0251
norm(ch) = 0.45169
iter: 3617, Minibatch log likelihood (pre-update): -54.3056, error rate (pre-update): 0.077605

size_minibatch = 20000
Precon grad coeff: 0.016869, velocity coeff: 0.92402
norm(ch) = 0.41806
iter: 3618, Minibatch log likelihood (pre-update): -54.3056, error rate (pre-update): 0.077607

size_minibatch = 20000
Precon grad coeff: 0.014938, velocity coeff: 0.94027
norm(ch) = 0.39357
iter: 3619, Minibatch log likelihood (pre-update): -54.3056, error rate (pre-update): 0.077599

size_minibatch = 20000
Precon grad coeff: 0.020396, velocity coeff: 1.1409
New gamma: 0.0031623
norm(ch) = 0.44979
rho = 1.0976
New lambda: 9.5735e-079
iter: 3620, Minibatch log likelihood (pre-update): -54.3056, error rate (pre-update): 0.077593
iter: 3620, Minibatch log likelihood (post-update): -54.3056, error rate (post-update): 0.077588

size_minibatch = 20000
Precon grad coeff: 0.019604, velocity coeff: 0.93373
norm(ch) = 0.42084
iter: 3621, Minibatch log likelihood (pre-update): -54.3056, error rate (pre-update): 0.077588

size_minibatch = 20000
Precon grad coeff: 0.018743, velocity coeff: 0.98472
norm(ch) = 0.4153
iter: 3622, Minibatch log likelihood (pre-update): -54.3055, error rate (pre-update): 0.07759

size_minibatch = 20000
Precon grad coeff: 0.017641, velocity coeff: 0.99285
norm(ch) = 0.41295
iter: 3623, Minibatch log likelihood (pre-update): -54.3055, error rate (pre-update): 0.077584

size_minibatch = 20000
Precon grad coeff: 0.018032, velocity coeff: 0.97287
norm(ch) = 0.40246
iter: 3624, Minibatch log likelihood (pre-update): -54.3055, error rate (pre-update): 0.07758

size_minibatch = 20000
Precon grad coeff: 0.01934, velocity coeff: 1.1691
norm(ch) = 0.47132
rho = 1.0204
New lambda: 7.4078e-079
iter: 3625, Minibatch log likelihood (pre-update): -54.3055, error rate (pre-update): 0.077575
iter: 3625, Minibatch log likelihood (post-update): -54.3054, error rate (post-update): 0.077575

size_minibatch = 20000
Precon grad coeff: 0.019294, velocity coeff: 0.94962
norm(ch) = 0.44855
iter: 3626, Minibatch log likelihood (pre-update): -54.3054, error rate (pre-update): 0.077575

size_minibatch = 20000
Precon grad coeff: 0.019495, velocity coeff: 1.0153
norm(ch) = 0.45634
iter: 3627, Minibatch log likelihood (pre-update): -54.3054, error rate (pre-update): 0.07757

size_minibatch = 20000
Precon grad coeff: 0.016925, velocity coeff: 0.92464
norm(ch) = 0.42256
iter: 3628, Minibatch log likelihood (pre-update): -54.3054, error rate (pre-update): 0.077563

size_minibatch = 20000
Precon grad coeff: 0.016908, velocity coeff: 1.024
norm(ch) = 0.43324
iter: 3629, Minibatch log likelihood (pre-update): -54.3054, error rate (pre-update): 0.077556

size_minibatch = 20000
Precon grad coeff: 0.019382, velocity coeff: 1.0372
norm(ch) = 0.45008
rho = 0.97223
New lambda: 5.732e-079
iter: 3630, Minibatch log likelihood (pre-update): -54.3054, error rate (pre-update): 0.077555
iter: 3630, Minibatch log likelihood (post-update): -54.3053, error rate (post-update): 0.07755

size_minibatch = 20000
Precon grad coeff: 0.020551, velocity coeff: 1.034
norm(ch) = 0.46617
iter: 3631, Minibatch log likelihood (pre-update): -54.3053, error rate (pre-update): 0.07755

size_minibatch = 20000
Precon grad coeff: 0.017059, velocity coeff: 0.82705
norm(ch) = 0.38628
iter: 3632, Minibatch log likelihood (pre-update): -54.3053, error rate (pre-update): 0.077547

size_minibatch = 20000
Precon grad coeff: 0.016674, velocity coeff: 1.0717
norm(ch) = 0.41463
iter: 3633, Minibatch log likelihood (pre-update): -54.3053, error rate (pre-update): 0.077544

size_minibatch = 20000
Precon grad coeff: 0.020459, velocity coeff: 1.0946
norm(ch) = 0.45458
iter: 3634, Minibatch log likelihood (pre-update): -54.3053, error rate (pre-update): 0.077542

size_minibatch = 20000
Precon grad coeff: 0.017507, velocity coeff: 0.90827
norm(ch) = 0.41352
rho = 1.1955
New lambda: 4.4353e-079
iter: 3635, Minibatch log likelihood (pre-update): -54.3052, error rate (pre-update): 0.077535
iter: 3635, Minibatch log likelihood (post-update): -54.3052, error rate (post-update): 0.077533

size_minibatch = 20000
Precon grad coeff: 0.018317, velocity coeff: 1.1054
norm(ch) = 0.45781
iter: 3636, Minibatch log likelihood (pre-update): -54.3052, error rate (pre-update): 0.077533

size_minibatch = 20000
Precon grad coeff: 0.018748, velocity coeff: 0.94164
norm(ch) = 0.43181
iter: 3637, Minibatch log likelihood (pre-update): -54.3052, error rate (pre-update): 0.077527

size_minibatch = 20000
Precon grad coeff: 0.014464, velocity coeff: 0.91601
norm(ch) = 0.3961
iter: 3638, Minibatch log likelihood (pre-update): -54.3052, error rate (pre-update): 0.077526

size_minibatch = 20000
Precon grad coeff: 0.020816, velocity coeff: 1.2008
norm(ch) = 0.47622
iter: 3639, Minibatch log likelihood (pre-update): -54.3052, error rate (pre-update): 0.077521

size_minibatch = 20000
Precon grad coeff: 0.018978, velocity coeff: 0.8679
New gamma: 0.0031623
norm(ch) = 0.41398
rho = 0.97456
New lambda: 3.432e-079
iter: 3640, Minibatch log likelihood (pre-update): -54.3051, error rate (pre-update): 0.077515
iter: 3640, Minibatch log likelihood (post-update): -54.3051, error rate (post-update): 0.07751

size_minibatch = 20000
Precon grad coeff: 0.015563, velocity coeff: 0.9543
norm(ch) = 0.39571
iter: 3641, Minibatch log likelihood (pre-update): -54.3051, error rate (pre-update): 0.07751

size_minibatch = 20000
Precon grad coeff: 0.016257, velocity coeff: 1.0129
norm(ch) = 0.40147
iter: 3642, Minibatch log likelihood (pre-update): -54.3051, error rate (pre-update): 0.077512

size_minibatch = 20000
Precon grad coeff: 0.017423, velocity coeff: 1.0571
norm(ch) = 0.42501
iter: 3643, Minibatch log likelihood (pre-update): -54.3051, error rate (pre-update): 0.077509

size_minibatch = 20000
Precon grad coeff: 0.019151, velocity coeff: 1.1022
norm(ch) = 0.46907
iter: 3644, Minibatch log likelihood (pre-update): -54.305, error rate (pre-update): 0.077503

size_minibatch = 20000
Precon grad coeff: 0.017613, velocity coeff: 0.84654
norm(ch) = 0.39769
rho = 1.0903
New lambda: 2.6556e-079
iter: 3645, Minibatch log likelihood (pre-update): -54.305, error rate (pre-update): 0.077495
iter: 3645, Minibatch log likelihood (post-update): -54.305, error rate (post-update): 0.077495

size_minibatch = 20000
Precon grad coeff: 0.014028, velocity coeff: 0.99353
norm(ch) = 0.39561
iter: 3646, Minibatch log likelihood (pre-update): -54.305, error rate (pre-update): 0.077495

size_minibatch = 20000
Precon grad coeff: 0.018011, velocity coeff: 1.0894
norm(ch) = 0.4316
iter: 3647, Minibatch log likelihood (pre-update): -54.305, error rate (pre-update): 0.077491

size_minibatch = 20000
Precon grad coeff: 0.019364, velocity coeff: 1.0166
norm(ch) = 0.43948
iter: 3648, Minibatch log likelihood (pre-update): -54.305, error rate (pre-update): 0.077488

size_minibatch = 20000
Precon grad coeff: 0.017237, velocity coeff: 0.90902
norm(ch) = 0.40017
iter: 3649, Minibatch log likelihood (pre-update): -54.3049, error rate (pre-update): 0.077484

size_minibatch = 20000
Precon grad coeff: 0.014121, velocity coeff: 0.92232
norm(ch) = 0.36959
rho = 1.2084
New lambda: 2.0548e-079
iter: 3650, Minibatch log likelihood (pre-update): -54.3049, error rate (pre-update): 0.077483
iter: 3650, Minibatch log likelihood (post-update): -54.3049, error rate (post-update): 0.077478
---
Full log-likelihood: -54.3049, error rate: 0.077478
TEST log-likelihood: -55.2951, error rate: 0.40108
Error difference (test - train): 0.3236
---
Full log-likelihood (averaged params): -54.3136, error rate (averaged params): 0.080947
TEST log-likelihood (averaged params): -55.2528, error rate (averaged params): 0.39164
Error difference (test - train) (averaged params): 0.31069

size_minibatch = 20000
Precon grad coeff: 0.017693, velocity coeff: 1.1895
norm(ch) = 0.44019
iter: 3651, Minibatch log likelihood (pre-update): -54.3049, error rate (pre-update): 0.077478

size_minibatch = 20000
Precon grad coeff: 0.019461, velocity coeff: 0.98888
norm(ch) = 0.43596
iter: 3652, Minibatch log likelihood (pre-update): -54.3049, error rate (pre-update): 0.077475

size_minibatch = 20000
Precon grad coeff: 0.017587, velocity coeff: 0.95986
norm(ch) = 0.41918
iter: 3653, Minibatch log likelihood (pre-update): -54.3049, error rate (pre-update): 0.077468

size_minibatch = 20000
Precon grad coeff: 0.014393, velocity coeff: 0.89813
norm(ch) = 0.3771
iter: 3654, Minibatch log likelihood (pre-update): -54.3048, error rate (pre-update): 0.077466

size_minibatch = 20000
Precon grad coeff: 0.016061, velocity coeff: 1.1191
norm(ch) = 0.42252
rho = 0.99927
New lambda: 1.59e-079
iter: 3655, Minibatch log likelihood (pre-update): -54.3048, error rate (pre-update): 0.077464
iter: 3655, Minibatch log likelihood (post-update): -54.3048, error rate (post-update): 0.077462

size_minibatch = 20000
Precon grad coeff: 0.020091, velocity coeff: 1.0797
norm(ch) = 0.45687
iter: 3656, Minibatch log likelihood (pre-update): -54.3048, error rate (pre-update): 0.077462

size_minibatch = 20000
Precon grad coeff: 0.019296, velocity coeff: 0.92849
norm(ch) = 0.42487
iter: 3657, Minibatch log likelihood (pre-update): -54.3048, error rate (pre-update): 0.077454

size_minibatch = 20000
Precon grad coeff: 0.013789, velocity coeff: 0.84195
norm(ch) = 0.35829
iter: 3658, Minibatch log likelihood (pre-update): -54.3047, error rate (pre-update): 0.077454

size_minibatch = 20000
Precon grad coeff: 0.016357, velocity coeff: 1.1563
norm(ch) = 0.41496
iter: 3659, Minibatch log likelihood (pre-update): -54.3047, error rate (pre-update): 0.077452

size_minibatch = 20000
Precon grad coeff: 0.022092, velocity coeff: 1.1227
New gamma: 0.0031623
norm(ch) = 0.46666
rho = 1.0789
New lambda: 1.2303e-079
iter: 3660, Minibatch log likelihood (pre-update): -54.3047, error rate (pre-update): 0.077447
iter: 3660, Minibatch log likelihood (post-update): -54.3047, error rate (post-update): 0.077439

size_minibatch = 20000
Precon grad coeff: 0.021284, velocity coeff: 0.92018
norm(ch) = 0.43021
iter: 3661, Minibatch log likelihood (pre-update): -54.3047, error rate (pre-update): 0.077439

size_minibatch = 20000
Precon grad coeff: 0.018835, velocity coeff: 0.96871
norm(ch) = 0.4175
iter: 3662, Minibatch log likelihood (pre-update): -54.3047, error rate (pre-update): 0.07744

size_minibatch = 20000
Precon grad coeff: 0.016463, velocity coeff: 0.95204
norm(ch) = 0.39818
iter: 3663, Minibatch log likelihood (pre-update): -54.3046, error rate (pre-update): 0.077436

size_minibatch = 20000
Precon grad coeff: 0.018421, velocity coeff: 1.0975
norm(ch) = 0.43772
iter: 3664, Minibatch log likelihood (pre-update): -54.3046, error rate (pre-update): 0.077434

size_minibatch = 20000
Precon grad coeff: 0.019018, velocity coeff: 1.0621
norm(ch) = 0.46573
rho = 1.0692
New lambda: 9.5199e-080
iter: 3665, Minibatch log likelihood (pre-update): -54.3046, error rate (pre-update): 0.077428
iter: 3665, Minibatch log likelihood (post-update): -54.3046, error rate (post-update): 0.077425

size_minibatch = 20000
Precon grad coeff: 0.023917, velocity coeff: 1.0853
norm(ch) = 0.5065
iter: 3666, Minibatch log likelihood (pre-update): -54.3046, error rate (pre-update): 0.077425

size_minibatch = 20000
Precon grad coeff: 0.019106, velocity coeff: 0.87275
norm(ch) = 0.44278
iter: 3667, Minibatch log likelihood (pre-update): -54.3045, error rate (pre-update): 0.07742

size_minibatch = 20000
Precon grad coeff: 0.01551, velocity coeff: 0.88055
norm(ch) = 0.39042
iter: 3668, Minibatch log likelihood (pre-update): -54.3045, error rate (pre-update): 0.077418

size_minibatch = 20000
Precon grad coeff: 0.017739, velocity coeff: 1.1268
norm(ch) = 0.44049
iter: 3669, Minibatch log likelihood (pre-update): -54.3045, error rate (pre-update): 0.077409

size_minibatch = 20000
Precon grad coeff: 0.021176, velocity coeff: 1.0736
norm(ch) = 0.47367
rho = 0.96088
New lambda: 7.3663e-080
iter: 3670, Minibatch log likelihood (pre-update): -54.3045, error rate (pre-update): 0.077406
iter: 3670, Minibatch log likelihood (post-update): -54.3044, error rate (post-update): 0.077406

size_minibatch = 20000
Precon grad coeff: 0.020278, velocity coeff: 0.90984
norm(ch) = 0.43175
iter: 3671, Minibatch log likelihood (pre-update): -54.3044, error rate (pre-update): 0.077406

size_minibatch = 20000
Precon grad coeff: 0.018394, velocity coeff: 0.95941
norm(ch) = 0.41495
iter: 3672, Minibatch log likelihood (pre-update): -54.3044, error rate (pre-update): 0.077404

size_minibatch = 20000
Precon grad coeff: 0.016282, velocity coeff: 0.93822
norm(ch) = 0.38989
iter: 3673, Minibatch log likelihood (pre-update): -54.3044, error rate (pre-update): 0.077397

size_minibatch = 20000
Precon grad coeff: 0.017682, velocity coeff: 1.0874
norm(ch) = 0.42453
iter: 3674, Minibatch log likelihood (pre-update): -54.3044, error rate (pre-update): 0.077396

size_minibatch = 20000
Precon grad coeff: 0.019997, velocity coeff: 1.0659
norm(ch) = 0.4532
rho = 1.0452
New lambda: 5.6999e-080
iter: 3675, Minibatch log likelihood (pre-update): -54.3044, error rate (pre-update): 0.07739
iter: 3675, Minibatch log likelihood (post-update): -54.3043, error rate (post-update): 0.077386

size_minibatch = 20000
Precon grad coeff: 0.021092, velocity coeff: 1.0242
norm(ch) = 0.46499
iter: 3676, Minibatch log likelihood (pre-update): -54.3043, error rate (pre-update): 0.077386

size_minibatch = 20000
Precon grad coeff: 0.018164, velocity coeff: 0.88391
norm(ch) = 0.41178
iter: 3677, Minibatch log likelihood (pre-update): -54.3043, error rate (pre-update): 0.077384

size_minibatch = 20000
Precon grad coeff: 0.015342, velocity coeff: 0.98651
norm(ch) = 0.40675
iter: 3678, Minibatch log likelihood (pre-update): -54.3043, error rate (pre-update): 0.077382

size_minibatch = 20000
Precon grad coeff: 0.01827, velocity coeff: 1.1183
norm(ch) = 0.4555
iter: 3679, Minibatch log likelihood (pre-update): -54.3043, error rate (pre-update): 0.077375

size_minibatch = 20000
Precon grad coeff: 0.020887, velocity coeff: 0.96935
New gamma: 0.0031623
norm(ch) = 0.44225
rho = 0.97743
New lambda: 4.4105e-080
iter: 3680, Minibatch log likelihood (pre-update): -54.3042, error rate (pre-update): 0.077374
iter: 3680, Minibatch log likelihood (post-update): -54.3042, error rate (post-update): 0.077369

size_minibatch = 20000
Precon grad coeff: 0.020685, velocity coeff: 1.0017
norm(ch) = 0.4438
iter: 3681, Minibatch log likelihood (pre-update): -54.3042, error rate (pre-update): 0.077369

size_minibatch = 20000
Precon grad coeff: 0.018985, velocity coeff: 0.92004
norm(ch) = 0.40906
iter: 3682, Minibatch log likelihood (pre-update): -54.3042, error rate (pre-update): 0.077364

size_minibatch = 20000
Precon grad coeff: 0.017515, velocity coeff: 1.0386
norm(ch) = 0.42565
iter: 3683, Minibatch log likelihood (pre-update): -54.3042, error rate (pre-update): 0.07736

size_minibatch = 20000
Precon grad coeff: 0.019101, velocity coeff: 1.0232
norm(ch) = 0.43623
iter: 3684, Minibatch log likelihood (pre-update): -54.3042, error rate (pre-update): 0.077361

size_minibatch = 20000
Precon grad coeff: 0.020819, velocity coeff: 1.125
norm(ch) = 0.49151
rho = 1.0515
New lambda: 3.4128e-080
iter: 3685, Minibatch log likelihood (pre-update): -54.3041, error rate (pre-update): 0.077356
iter: 3685, Minibatch log likelihood (post-update): -54.3041, error rate (post-update): 0.077355

size_minibatch = 20000
Precon grad coeff: 0.020041, velocity coeff: 0.91428
norm(ch) = 0.4501
iter: 3686, Minibatch log likelihood (pre-update): -54.3041, error rate (pre-update): 0.077355

size_minibatch = 20000
Precon grad coeff: 0.017718, velocity coeff: 0.94931
norm(ch) = 0.42791
iter: 3687, Minibatch log likelihood (pre-update): -54.3041, error rate (pre-update): 0.07735

size_minibatch = 20000
Precon grad coeff: 0.016759, velocity coeff: 1.0066
norm(ch) = 0.4314
iter: 3688, Minibatch log likelihood (pre-update): -54.3041, error rate (pre-update): 0.077348

size_minibatch = 20000
Precon grad coeff: 0.020837, velocity coeff: 1.019
norm(ch) = 0.44041
iter: 3689, Minibatch log likelihood (pre-update): -54.304, error rate (pre-update): 0.077341

size_minibatch = 20000
Precon grad coeff: 0.019841, velocity coeff: 0.96423
norm(ch) = 0.42537
rho = 1.0134
New lambda: 2.6407e-080
iter: 3690, Minibatch log likelihood (pre-update): -54.304, error rate (pre-update): 0.077338
iter: 3690, Minibatch log likelihood (post-update): -54.304, error rate (post-update): 0.077335

size_minibatch = 20000
Precon grad coeff: 0.019025, velocity coeff: 0.99034
norm(ch) = 0.42196
iter: 3691, Minibatch log likelihood (pre-update): -54.304, error rate (pre-update): 0.077335

size_minibatch = 20000
Precon grad coeff: 0.017039, velocity coeff: 0.95449
norm(ch) = 0.40338
iter: 3692, Minibatch log likelihood (pre-update): -54.304, error rate (pre-update): 0.077335

size_minibatch = 20000
Precon grad coeff: 0.018991, velocity coeff: 1.1012
norm(ch) = 0.44498
iter: 3693, Minibatch log likelihood (pre-update): -54.304, error rate (pre-update): 0.077329

size_minibatch = 20000
Precon grad coeff: 0.019223, velocity coeff: 1.002
norm(ch) = 0.44661
iter: 3694, Minibatch log likelihood (pre-update): -54.3039, error rate (pre-update): 0.077327

size_minibatch = 20000
Precon grad coeff: 0.020299, velocity coeff: 1.0114
norm(ch) = 0.45246
rho = 1.0207
New lambda: 2.0433e-080
iter: 3695, Minibatch log likelihood (pre-update): -54.3039, error rate (pre-update): 0.077321
iter: 3695, Minibatch log likelihood (post-update): -54.3039, error rate (post-update): 0.077316

size_minibatch = 20000
Precon grad coeff: 0.018437, velocity coeff: 0.93846
norm(ch) = 0.42526
iter: 3696, Minibatch log likelihood (pre-update): -54.3039, error rate (pre-update): 0.077316

size_minibatch = 20000
Precon grad coeff: 0.015883, velocity coeff: 0.95742
norm(ch) = 0.40771
iter: 3697, Minibatch log likelihood (pre-update): -54.3039, error rate (pre-update): 0.077314

size_minibatch = 20000
Precon grad coeff: 0.020487, velocity coeff: 1.1135
norm(ch) = 0.45475
iter: 3698, Minibatch log likelihood (pre-update): -54.3038, error rate (pre-update): 0.077318

size_minibatch = 20000
Precon grad coeff: 0.02006, velocity coeff: 0.96027
norm(ch) = 0.43743
iter: 3699, Minibatch log likelihood (pre-update): -54.3038, error rate (pre-update): 0.07731

size_minibatch = 20000
Precon grad coeff: 0.018675, velocity coeff: 0.88857
New gamma: 0.0052816
norm(ch) = 0.38908
rho = 1.1512
New lambda: 1.5811e-080
iter: 3700, Minibatch log likelihood (pre-update): -54.3038, error rate (pre-update): 0.077306
iter: 3700, Minibatch log likelihood (post-update): -54.3038, error rate (post-update): 0.077302
---
Full log-likelihood: -54.3038, error rate: 0.077302
TEST log-likelihood: -55.3049, error rate: 0.40361
Error difference (test - train): 0.32631
---
Full log-likelihood (averaged params): -54.3121, error rate (averaged params): 0.080616
TEST log-likelihood (averaged params): -55.2637, error rate (averaged params): 0.39424
Error difference (test - train) (averaged params): 0.31362

size_minibatch = 20000
Precon grad coeff: 0.017789, velocity coeff: 1.0222
norm(ch) = 0.39808
iter: 3701, Minibatch log likelihood (pre-update): -54.3038, error rate (pre-update): 0.077302

size_minibatch = 20000
Precon grad coeff: 0.01937, velocity coeff: 0.96461
norm(ch) = 0.38422
iter: 3702, Minibatch log likelihood (pre-update): -54.3038, error rate (pre-update): 0.0773

size_minibatch = 20000
Precon grad coeff: 0.020861, velocity coeff: 1.0484
norm(ch) = 0.40318
iter: 3703, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077295

size_minibatch = 20000
Precon grad coeff: 0.021662, velocity coeff: 0.95046
norm(ch) = 0.38354
iter: 3704, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077297

size_minibatch = 20000
Precon grad coeff: 0.016283, velocity coeff: 0.83963
norm(ch) = 0.32237
rho = 0.96895
New lambda: 1.2234e-080
iter: 3705, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077292
iter: 3705, Minibatch log likelihood (post-update): -54.3037, error rate (post-update): 0.077288

size_minibatch = 20000
Precon grad coeff: 0.020348, velocity coeff: 1.2472
norm(ch) = 0.40227
iter: 3706, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077288

size_minibatch = 20000
Precon grad coeff: 0.022029, velocity coeff: 0.92205
norm(ch) = 0.37125
iter: 3707, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077284

size_minibatch = 20000
Precon grad coeff: 0.018537, velocity coeff: 0.99636
norm(ch) = 0.37014
iter: 3708, Minibatch log likelihood (pre-update): -54.3037, error rate (pre-update): 0.077286

size_minibatch = 20000
Precon grad coeff: 0.018798, velocity coeff: 0.96754
norm(ch) = 0.35843
iter: 3709, Minibatch log likelihood (pre-update): -54.3036, error rate (pre-update): 0.07728

size_minibatch = 20000
Precon grad coeff: 0.018061, velocity coeff: 1.029
norm(ch) = 0.36899
rho = 0.8953
New lambda: 9.4666e-081
iter: 3710, Minibatch log likelihood (pre-update): -54.3036, error rate (pre-update): 0.077276
iter: 3710, Minibatch log likelihood (post-update): -54.3036, error rate (post-update): 0.077273

size_minibatch = 20000
Precon grad coeff: 0.022104, velocity coeff: 1.1105
norm(ch) = 0.41011
iter: 3711, Minibatch log likelihood (pre-update): -54.3036, error rate (pre-update): 0.077273

size_minibatch = 20000
Precon grad coeff: 0.019075, velocity coeff: 0.89593
norm(ch) = 0.36765
iter: 3712, Minibatch log likelihood (pre-update): -54.3036, error rate (pre-update): 0.077274

size_minibatch = 20000
Precon grad coeff: 0.017745, velocity coeff: 0.95672
norm(ch) = 0.35199
iter: 3713, Minibatch log likelihood (pre-update): -54.3036, error rate (pre-update): 0.077268

size_minibatch = 20000
Precon grad coeff: 0.018812, velocity coeff: 1.0435
norm(ch) = 0.36749
iter: 3714, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077266

size_minibatch = 20000
Precon grad coeff: 0.021643, velocity coeff: 1.1029
norm(ch) = 0.40565
rho = 0.96909
New lambda: 7.3251e-081
iter: 3715, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077264
iter: 3715, Minibatch log likelihood (post-update): -54.3035, error rate (post-update): 0.077261

size_minibatch = 20000
Precon grad coeff: 0.018062, velocity coeff: 0.84646
norm(ch) = 0.34361
iter: 3716, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077261

size_minibatch = 20000
Precon grad coeff: 0.018503, velocity coeff: 1.0518
norm(ch) = 0.36167
iter: 3717, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077255

size_minibatch = 20000
Precon grad coeff: 0.019406, velocity coeff: 1.0414
norm(ch) = 0.37689
iter: 3718, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077254

size_minibatch = 20000
Precon grad coeff: 0.019757, velocity coeff: 0.96712
norm(ch) = 0.36483
iter: 3719, Minibatch log likelihood (pre-update): -54.3035, error rate (pre-update): 0.077248

size_minibatch = 20000
Precon grad coeff: 0.022132, velocity coeff: 1.0005
New gamma: 0.0088212
norm(ch) = 0.36524
rho = 1.1471
New lambda: 5.668e-081
iter: 3720, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.077246
iter: 3720, Minibatch log likelihood (post-update): -54.3034, error rate (post-update): 0.077245

size_minibatch = 20000
Precon grad coeff: 0.020989, velocity coeff: 0.9117
norm(ch) = 0.33319
iter: 3721, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.077245

size_minibatch = 20000
Precon grad coeff: 0.022194, velocity coeff: 1.1064
norm(ch) = 0.36872
iter: 3722, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.077247

size_minibatch = 20000
Precon grad coeff: 0.021019, velocity coeff: 0.8824
norm(ch) = 0.32556
iter: 3723, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.07724

size_minibatch = 20000
Precon grad coeff: 0.023279, velocity coeff: 1.0333
norm(ch) = 0.33657
iter: 3724, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.077234

size_minibatch = 20000
Precon grad coeff: 0.020138, velocity coeff: 0.90449
norm(ch) = 0.30465
rho = 0.86556
New lambda: 4.3858e-081
iter: 3725, Minibatch log likelihood (pre-update): -54.3034, error rate (pre-update): 0.077231
iter: 3725, Minibatch log likelihood (post-update): -54.3033, error rate (post-update): 0.077233

size_minibatch = 20000
Precon grad coeff: 0.022052, velocity coeff: 1.1084
norm(ch) = 0.33777
iter: 3726, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.077233

size_minibatch = 20000
Precon grad coeff: 0.022868, velocity coeff: 0.96375
norm(ch) = 0.32572
iter: 3727, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.07723

size_minibatch = 20000
Precon grad coeff: 0.020047, velocity coeff: 0.9367
norm(ch) = 0.30523
iter: 3728, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.077227

size_minibatch = 20000
Precon grad coeff: 0.02389, velocity coeff: 1.1087
norm(ch) = 0.33865
iter: 3729, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.077221

size_minibatch = 20000
Precon grad coeff: 0.01953, velocity coeff: 0.92111
norm(ch) = 0.31211
rho = 1.1734
New lambda: 3.3936e-081
iter: 3730, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.07722
iter: 3730, Minibatch log likelihood (post-update): -54.3033, error rate (post-update): 0.077217

size_minibatch = 20000
Precon grad coeff: 0.023748, velocity coeff: 1.1117
norm(ch) = 0.34718
iter: 3731, Minibatch log likelihood (pre-update): -54.3033, error rate (pre-update): 0.077217

size_minibatch = 20000
Precon grad coeff: 0.021929, velocity coeff: 0.93443
norm(ch) = 0.32452
iter: 3732, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.077214

size_minibatch = 20000
Precon grad coeff: 0.020782, velocity coeff: 0.98969
norm(ch) = 0.32137
iter: 3733, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.077209

size_minibatch = 20000
Precon grad coeff: 0.021193, velocity coeff: 1.0645
norm(ch) = 0.34226
iter: 3734, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.077211

size_minibatch = 20000
Precon grad coeff: 0.022276, velocity coeff: 0.9462
norm(ch) = 0.32403
rho = 1.1036
New lambda: 2.6259e-081
iter: 3735, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.077208
iter: 3735, Minibatch log likelihood (post-update): -54.3032, error rate (post-update): 0.077205

size_minibatch = 20000
Precon grad coeff: 0.022345, velocity coeff: 1.04
norm(ch) = 0.33711
iter: 3736, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.077205

size_minibatch = 20000
Precon grad coeff: 0.020188, velocity coeff: 0.90488
norm(ch) = 0.30527
iter: 3737, Minibatch log likelihood (pre-update): -54.3032, error rate (pre-update): 0.0772

size_minibatch = 20000
Precon grad coeff: 0.021674, velocity coeff: 1.1387
norm(ch) = 0.34775
iter: 3738, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.0772

size_minibatch = 20000
Precon grad coeff: 0.022585, velocity coeff: 0.94473
norm(ch) = 0.32876
iter: 3739, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.077194

size_minibatch = 20000
Precon grad coeff: 0.019482, velocity coeff: 0.9961
New gamma: 0.0052816
norm(ch) = 0.32785
rho = 1.1023
New lambda: 2.0319e-081
iter: 3740, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.077191
iter: 3740, Minibatch log likelihood (post-update): -54.3031, error rate (post-update): 0.07719

size_minibatch = 20000
Precon grad coeff: 0.022907, velocity coeff: 1.0986
norm(ch) = 0.36074
iter: 3741, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.07719

size_minibatch = 20000
Precon grad coeff: 0.018339, velocity coeff: 0.93704
norm(ch) = 0.33839
iter: 3742, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.07719

size_minibatch = 20000
Precon grad coeff: 0.021833, velocity coeff: 1.1766
norm(ch) = 0.39865
iter: 3743, Minibatch log likelihood (pre-update): -54.3031, error rate (pre-update): 0.077183

size_minibatch = 20000
Precon grad coeff: 0.021725, velocity coeff: 1.0598
norm(ch) = 0.42307
iter: 3744, Minibatch log likelihood (pre-update): -54.303, error rate (pre-update): 0.07718

size_minibatch = 20000
Precon grad coeff: 0.020561, velocity coeff: 0.95084
norm(ch) = 0.40288
rho = 0.96515
New lambda: 1.5722e-081
iter: 3745, Minibatch log likelihood (pre-update): -54.303, error rate (pre-update): 0.077176
iter: 3745, Minibatch log likelihood (post-update): -54.303, error rate (post-update): 0.077175

size_minibatch = 20000
Precon grad coeff: 0.019112, velocity coeff: 1.0583
norm(ch) = 0.4269
iter: 3746, Minibatch log likelihood (pre-update): -54.303, error rate (pre-update): 0.077175

size_minibatch = 20000
Precon grad coeff: 0.019988, velocity coeff: 0.94043
norm(ch) = 0.402
iter: 3747, Minibatch log likelihood (pre-update): -54.303, error rate (pre-update): 0.077171

size_minibatch = 20000
Precon grad coeff: 0.019776, velocity coeff: 1.0038
norm(ch) = 0.40405
iter: 3748, Minibatch log likelihood (pre-update): -54.303, error rate (pre-update): 0.077169

size_minibatch = 20000
Precon grad coeff: 0.021763, velocity coeff: 0.98267
norm(ch) = 0.39766
iter: 3749, Minibatch log likelihood (pre-update): -54.3029, error rate (pre-update): 0.077161

size_minibatch = 20000
Precon grad coeff: 0.017924, velocity coeff: 0.86695
norm(ch) = 0.34529
rho = 0.98312
New lambda: 1.2166e-081
iter: 3750, Minibatch log likelihood (pre-update): -54.3029, error rate (pre-update): 0.077159
iter: 3750, Minibatch log likelihood (post-update): -54.3029, error rate (post-update): 0.077156
---
Full log-likelihood: -54.3029, error rate: 0.077156
TEST log-likelihood: -55.3136, error rate: 0.40592
Error difference (test - train): 0.32877
---
Full log-likelihood (averaged params): -54.3103, error rate (averaged params): 0.080183
TEST log-likelihood (averaged params): -55.2743, error rate (averaged params): 0.39679
Error difference (test - train) (averaged params): 0.31661

size_minibatch = 20000
Precon grad coeff: 0.020585, velocity coeff: 1.1054
norm(ch) = 0.38237
iter: 3751, Minibatch log likelihood (pre-update): -54.3029, error rate (pre-update): 0.077156

size_minibatch = 20000
Precon grad coeff: 0.020381, velocity coeff: 0.97077
norm(ch) = 0.37192
iter: 3752, Minibatch log likelihood (pre-update): -54.3029, error rate (pre-update): 0.077156

size_minibatch = 20000
Precon grad coeff: 0.021216, velocity coeff: 1.0361
norm(ch) = 0.38594
iter: 3753, Minibatch log likelihood (pre-update): -54.3029, error rate (pre-update): 0.077149

size_minibatch = 20000
Precon grad coeff: 0.018391, velocity coeff: 0.94096
norm(ch) = 0.36374
iter: 3754, Minibatch log likelihood (pre-update): -54.3028, error rate (pre-update): 0.077146

size_minibatch = 20000
Precon grad coeff: 0.021837, velocity coeff: 1.1113
norm(ch) = 0.40497
rho = 1.0537
New lambda: 9.4136e-082
iter: 3755, Minibatch log likelihood (pre-update): -54.3028, error rate (pre-update): 0.077142
iter: 3755, Minibatch log likelihood (post-update): -54.3028, error rate (post-update): 0.077141

size_minibatch = 20000
Precon grad coeff: 0.018478, velocity coeff: 0.94555
norm(ch) = 0.38362
iter: 3756, Minibatch log likelihood (pre-update): -54.3028, error rate (pre-update): 0.077141

size_minibatch = 20000
Precon grad coeff: 0.021691, velocity coeff: 1.0552
norm(ch) = 0.40552
iter: 3757, Minibatch log likelihood (pre-update): -54.3028, error rate (pre-update): 0.077135

size_minibatch = 20000
Precon grad coeff: 0.018386, velocity coeff: 0.91433
norm(ch) = 0.37139
iter: 3758, Minibatch log likelihood (pre-update): -54.3028, error rate (pre-update): 0.077133

size_minibatch = 20000
Precon grad coeff: 0.020929, velocity coeff: 1.0671
norm(ch) = 0.39703
iter: 3759, Minibatch log likelihood (pre-update): -54.3027, error rate (pre-update): 0.077128

size_minibatch = 20000
Precon grad coeff: 0.017288, velocity coeff: 0.96905
New gamma: 0.0031623
norm(ch) = 0.38584
rho = 1.0925
New lambda: 7.2841e-082
iter: 3760, Minibatch log likelihood (pre-update): -54.3027, error rate (pre-update): 0.077127
iter: 3760, Minibatch log likelihood (post-update): -54.3027, error rate (post-update): 0.077122

size_minibatch = 20000
Precon grad coeff: 0.018628, velocity coeff: 1.0668
norm(ch) = 0.41286
iter: 3761, Minibatch log likelihood (pre-update): -54.3027, error rate (pre-update): 0.077122

size_minibatch = 20000
Precon grad coeff: 0.01611, velocity coeff: 0.96242
norm(ch) = 0.39864
iter: 3762, Minibatch log likelihood (pre-update): -54.3027, error rate (pre-update): 0.077121

size_minibatch = 20000
Precon grad coeff: 0.018562, velocity coeff: 1.1224
norm(ch) = 0.44849
iter: 3763, Minibatch log likelihood (pre-update): -54.3027, error rate (pre-update): 0.077117

size_minibatch = 20000
Precon grad coeff: 0.020691, velocity coeff: 1.0527
norm(ch) = 0.47342
iter: 3764, Minibatch log likelihood (pre-update): -54.3026, error rate (pre-update): 0.077111

size_minibatch = 20000
Precon grad coeff: 0.015878, velocity coeff: 0.90208
norm(ch) = 0.42802
rho = 0.9549
New lambda: 5.6363e-082
iter: 3765, Minibatch log likelihood (pre-update): -54.3026, error rate (pre-update): 0.077104
iter: 3765, Minibatch log likelihood (post-update): -54.3026, error rate (post-update): 0.077105

size_minibatch = 20000
Precon grad coeff: 0.016671, velocity coeff: 1.0561
norm(ch) = 0.45328
iter: 3766, Minibatch log likelihood (pre-update): -54.3026, error rate (pre-update): 0.077105

size_minibatch = 20000
Precon grad coeff: 0.018702, velocity coeff: 0.98829
norm(ch) = 0.44918
iter: 3767, Minibatch log likelihood (pre-update): -54.3026, error rate (pre-update): 0.0771

size_minibatch = 20000
Precon grad coeff: 0.016888, velocity coeff: 0.98832
norm(ch) = 0.44492
iter: 3768, Minibatch log likelihood (pre-update): -54.3025, error rate (pre-update): 0.077095

size_minibatch = 20000
Precon grad coeff: 0.018164, velocity coeff: 0.93401
norm(ch) = 0.41652
iter: 3769, Minibatch log likelihood (pre-update): -54.3025, error rate (pre-update): 0.07709

size_minibatch = 20000
Precon grad coeff: 0.014596, velocity coeff: 0.92367
norm(ch) = 0.38561
rho = 0.95043
New lambda: 4.3613e-082
iter: 3770, Minibatch log likelihood (pre-update): -54.3025, error rate (pre-update): 0.07709
iter: 3770, Minibatch log likelihood (post-update): -54.3025, error rate (post-update): 0.077084

size_minibatch = 20000
Precon grad coeff: 0.019914, velocity coeff: 1.1543
norm(ch) = 0.44627
iter: 3771, Minibatch log likelihood (pre-update): -54.3025, error rate (pre-update): 0.077084

size_minibatch = 20000
Precon grad coeff: 0.017656, velocity coeff: 0.89414
norm(ch) = 0.40019
iter: 3772, Minibatch log likelihood (pre-update): -54.3025, error rate (pre-update): 0.077081

size_minibatch = 20000
Precon grad coeff: 0.017634, velocity coeff: 1.0641
norm(ch) = 0.42686
iter: 3773, Minibatch log likelihood (pre-update): -54.3024, error rate (pre-update): 0.07708

size_minibatch = 20000
Precon grad coeff: 0.016249, velocity coeff: 0.94944
norm(ch) = 0.40617
iter: 3774, Minibatch log likelihood (pre-update): -54.3024, error rate (pre-update): 0.077078

size_minibatch = 20000
Precon grad coeff: 0.016983, velocity coeff: 1.0586
norm(ch) = 0.43079
rho = 0.97156
New lambda: 3.3747e-082
iter: 3775, Minibatch log likelihood (pre-update): -54.3024, error rate (pre-update): 0.077069
iter: 3775, Minibatch log likelihood (post-update): -54.3024, error rate (post-update): 0.077068

size_minibatch = 20000
Precon grad coeff: 0.020369, velocity coeff: 1.1281
norm(ch) = 0.48709
iter: 3776, Minibatch log likelihood (pre-update): -54.3024, error rate (pre-update): 0.077068

size_minibatch = 20000
Precon grad coeff: 0.016467, velocity coeff: 0.84558
norm(ch) = 0.41266
iter: 3777, Minibatch log likelihood (pre-update): -54.3024, error rate (pre-update): 0.077065

size_minibatch = 20000
Precon grad coeff: 0.014835, velocity coeff: 0.98206
norm(ch) = 0.40614
iter: 3778, Minibatch log likelihood (pre-update): -54.3023, error rate (pre-update): 0.077062

size_minibatch = 20000
Precon grad coeff: 0.018643, velocity coeff: 1.0562
norm(ch) = 0.42985
iter: 3779, Minibatch log likelihood (pre-update): -54.3023, error rate (pre-update): 0.077054

size_minibatch = 20000
Precon grad coeff: 0.018412, velocity coeff: 0.99306
New gamma: 0.0031623
norm(ch) = 0.4278
rho = 1.06
New lambda: 2.6112e-082
iter: 3780, Minibatch log likelihood (pre-update): -54.3023, error rate (pre-update): 0.077054
iter: 3780, Minibatch log likelihood (post-update): -54.3023, error rate (post-update): 0.077051

size_minibatch = 20000
Precon grad coeff: 0.015999, velocity coeff: 0.88909
norm(ch) = 0.38111
iter: 3781, Minibatch log likelihood (pre-update): -54.3023, error rate (pre-update): 0.077051

size_minibatch = 20000
Precon grad coeff: 0.015406, velocity coeff: 1.0477
norm(ch) = 0.40009
iter: 3782, Minibatch log likelihood (pre-update): -54.3022, error rate (pre-update): 0.07705

size_minibatch = 20000
Precon grad coeff: 0.017896, velocity coeff: 1.0903
norm(ch) = 0.43712
iter: 3783, Minibatch log likelihood (pre-update): -54.3022, error rate (pre-update): 0.077044

size_minibatch = 20000
Precon grad coeff: 0.018659, velocity coeff: 0.96526
norm(ch) = 0.42291
iter: 3784, Minibatch log likelihood (pre-update): -54.3022, error rate (pre-update): 0.077041

size_minibatch = 20000
Precon grad coeff: 0.01664, velocity coeff: 1.0125
norm(ch) = 0.42896
rho = 1.0394
New lambda: 2.0205e-082
iter: 3785, Minibatch log likelihood (pre-update): -54.3022, error rate (pre-update): 0.077035
iter: 3785, Minibatch log likelihood (post-update): -54.3022, error rate (post-update): 0.077033

size_minibatch = 20000
Precon grad coeff: 0.014802, velocity coeff: 0.89636
norm(ch) = 0.38514
iter: 3786, Minibatch log likelihood (pre-update): -54.3022, error rate (pre-update): 0.077033

size_minibatch = 20000
Precon grad coeff: 0.017363, velocity coeff: 1.1451
norm(ch) = 0.44185
iter: 3787, Minibatch log likelihood (pre-update): -54.3021, error rate (pre-update): 0.077031

size_minibatch = 20000
Precon grad coeff: 0.01918, velocity coeff: 1.0182
norm(ch) = 0.45078
iter: 3788, Minibatch log likelihood (pre-update): -54.3021, error rate (pre-update): 0.077031

size_minibatch = 20000
Precon grad coeff: 0.015923, velocity coeff: 0.87148
norm(ch) = 0.39358
iter: 3789, Minibatch log likelihood (pre-update): -54.3021, error rate (pre-update): 0.077023

size_minibatch = 20000
Precon grad coeff: 0.014607, velocity coeff: 0.9704
norm(ch) = 0.3826
rho = 1.0849
New lambda: 1.5634e-082
iter: 3790, Minibatch log likelihood (pre-update): -54.3021, error rate (pre-update): 0.077022
iter: 3790, Minibatch log likelihood (post-update): -54.3021, error rate (post-update): 0.07702

size_minibatch = 20000
Precon grad coeff: 0.017412, velocity coeff: 1.123
norm(ch) = 0.43037
iter: 3791, Minibatch log likelihood (pre-update): -54.3021, error rate (pre-update): 0.07702

size_minibatch = 20000
Precon grad coeff: 0.019009, velocity coeff: 0.98834
norm(ch) = 0.42622
iter: 3792, Minibatch log likelihood (pre-update): -54.302, error rate (pre-update): 0.077016

size_minibatch = 20000
Precon grad coeff: 0.016886, velocity coeff: 0.90543
norm(ch) = 0.38668
iter: 3793, Minibatch log likelihood (pre-update): -54.302, error rate (pre-update): 0.07701

size_minibatch = 20000
Precon grad coeff: 0.01402, velocity coeff: 0.99457
norm(ch) = 0.38522
iter: 3794, Minibatch log likelihood (pre-update): -54.302, error rate (pre-update): 0.077012

size_minibatch = 20000
Precon grad coeff: 0.017739, velocity coeff: 1.1114
norm(ch) = 0.42892
rho = 1.0513
New lambda: 1.2098e-082
iter: 3795, Minibatch log likelihood (pre-update): -54.302, error rate (pre-update): 0.077007
iter: 3795, Minibatch log likelihood (post-update): -54.302, error rate (post-update): 0.077002

size_minibatch = 20000
Precon grad coeff: 0.019368, velocity coeff: 1.0085
norm(ch) = 0.43349
iter: 3796, Minibatch log likelihood (pre-update): -54.302, error rate (pre-update): 0.077002

size_minibatch = 20000
Precon grad coeff: 0.016518, velocity coeff: 0.89966
norm(ch) = 0.39079
iter: 3797, Minibatch log likelihood (pre-update): -54.3019, error rate (pre-update): 0.077002

size_minibatch = 20000
Precon grad coeff: 0.014946, velocity coeff: 1.0102
norm(ch) = 0.39538
iter: 3798, Minibatch log likelihood (pre-update): -54.3019, error rate (pre-update): 0.077002

size_minibatch = 20000
Precon grad coeff: 0.015366, velocity coeff: 1.0341
norm(ch) = 0.40946
iter: 3799, Minibatch log likelihood (pre-update): -54.3019, error rate (pre-update): 0.076994

size_minibatch = 20000
Precon grad coeff: 0.020736, velocity coeff: 1.0969
New gamma: 0.0031623
norm(ch) = 0.45008
rho = 0.97911
New lambda: 9.3609e-083
iter: 3800, Minibatch log likelihood (pre-update): -54.3019, error rate (pre-update): 0.076991
iter: 3800, Minibatch log likelihood (post-update): -54.3019, error rate (post-update): 0.076988
---
Full log-likelihood: -54.3018, error rate: 0.076988
TEST log-likelihood: -55.3244, error rate: 0.40893
Error difference (test - train): 0.33194
---
Full log-likelihood (averaged params): -54.3087, error rate (averaged params): 0.079777
TEST log-likelihood (averaged params): -55.2842, error rate (averaged params): 0.39925
Error difference (test - train) (averaged params): 0.31947

size_minibatch = 20000
Precon grad coeff: 0.016389, velocity coeff: 0.88944
norm(ch) = 0.40116
iter: 3801, Minibatch log likelihood (pre-update): -54.3019, error rate (pre-update): 0.076988

size_minibatch = 20000
Precon grad coeff: 0.011918, velocity coeff: 0.87682
norm(ch) = 0.35235
iter: 3802, Minibatch log likelihood (pre-update): -54.3018, error rate (pre-update): 0.076987

size_minibatch = 20000
Precon grad coeff: 0.017877, velocity coeff: 1.2466
norm(ch) = 0.43979
iter: 3803, Minibatch log likelihood (pre-update): -54.3018, error rate (pre-update): 0.076984

size_minibatch = 20000
Precon grad coeff: 0.019861, velocity coeff: 0.94318
norm(ch) = 0.41563
iter: 3804, Minibatch log likelihood (pre-update): -54.3018, error rate (pre-update): 0.076983

size_minibatch = 20000
Precon grad coeff: 0.01731, velocity coeff: 0.95049
norm(ch) = 0.39578
rho = 0.96462
New lambda: 7.2433e-083
iter: 3805, Minibatch log likelihood (pre-update): -54.3018, error rate (pre-update): 0.076979
iter: 3805, Minibatch log likelihood (post-update): -54.3018, error rate (post-update): 0.076977

size_minibatch = 20000
Precon grad coeff: 0.013486, velocity coeff: 0.81894
norm(ch) = 0.32492
iter: 3806, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076977

size_minibatch = 20000
Precon grad coeff: 0.015526, velocity coeff: 1.1974
norm(ch) = 0.38972
iter: 3807, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076973

size_minibatch = 20000
Precon grad coeff: 0.022052, velocity coeff: 1.209
norm(ch) = 0.47205
iter: 3808, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076971

size_minibatch = 20000
Precon grad coeff: 0.017289, velocity coeff: 0.84774
norm(ch) = 0.40095
iter: 3809, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076966

size_minibatch = 20000
Precon grad coeff: 0.012535, velocity coeff: 0.8978
norm(ch) = 0.36059
rho = 1.0567
New lambda: 5.6047e-083
iter: 3810, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076964
iter: 3810, Minibatch log likelihood (post-update): -54.3017, error rate (post-update): 0.076959

size_minibatch = 20000
Precon grad coeff: 0.016681, velocity coeff: 1.2295
norm(ch) = 0.44403
iter: 3811, Minibatch log likelihood (pre-update): -54.3017, error rate (pre-update): 0.076959

size_minibatch = 20000
Precon grad coeff: 0.018233, velocity coeff: 1.0056
norm(ch) = 0.4472
iter: 3812, Minibatch log likelihood (pre-update): -54.3016, error rate (pre-update): 0.076957

size_minibatch = 20000
Precon grad coeff: 0.018914, velocity coeff: 0.93201
norm(ch) = 0.41759
iter: 3813, Minibatch log likelihood (pre-update): -54.3016, error rate (pre-update): 0.076954

size_minibatch = 20000
Precon grad coeff: 0.011264, velocity coeff: 0.75711
norm(ch) = 0.31671
iter: 3814, Minibatch log likelihood (pre-update): -54.3016, error rate (pre-update): 0.076952

size_minibatch = 20000
Precon grad coeff: 0.017483, velocity coeff: 1.3821
norm(ch) = 0.4383
rho = 1.0129
New lambda: 4.3368e-083
iter: 3815, Minibatch log likelihood (pre-update): -54.3016, error rate (pre-update): 0.076948
iter: 3815, Minibatch log likelihood (post-update): -54.3016, error rate (post-update): 0.076947

size_minibatch = 20000
Precon grad coeff: 0.020345, velocity coeff: 0.90303
norm(ch) = 0.39664
iter: 3816, Minibatch log likelihood (pre-update): -54.3016, error rate (pre-update): 0.076947

size_minibatch = 20000
Precon grad coeff: 0.017285, velocity coeff: 0.99229
norm(ch) = 0.39425
iter: 3817, Minibatch log likelihood (pre-update): -54.3015, error rate (pre-update): 0.076942

size_minibatch = 20000
Precon grad coeff: 0.014507, velocity coeff: 0.83722
norm(ch) = 0.33087
iter: 3818, Minibatch log likelihood (pre-update): -54.3015, error rate (pre-update): 0.076941

size_minibatch = 20000
Precon grad coeff: 0.014581, velocity coeff: 1.1641
norm(ch) = 0.38595
iter: 3819, Minibatch log likelihood (pre-update): -54.3015, error rate (pre-update): 0.076937

size_minibatch = 20000
Precon grad coeff: 0.02209, velocity coeff: 1.2075
New gamma: 0.0031623
norm(ch) = 0.46681
rho = 0.9761
New lambda: 3.3558e-083
iter: 3820, Minibatch log likelihood (pre-update): -54.3015, error rate (pre-update): 0.076936
iter: 3820, Minibatch log likelihood (post-update): -54.3015, error rate (post-update): 0.076935

size_minibatch = 20000
Precon grad coeff: 0.020734, velocity coeff: 0.9476
norm(ch) = 0.44326
iter: 3821, Minibatch log likelihood (pre-update): -54.3015, error rate (pre-update): 0.076935

size_minibatch = 20000
Precon grad coeff: 0.015766, velocity coeff: 0.87392
norm(ch) = 0.38816
iter: 3822, Minibatch log likelihood (pre-update): -54.3014, error rate (pre-update): 0.076932

size_minibatch = 20000
Precon grad coeff: 0.016245, velocity coeff: 1.0905
norm(ch) = 0.42404
iter: 3823, Minibatch log likelihood (pre-update): -54.3014, error rate (pre-update): 0.076925

size_minibatch = 20000
Precon grad coeff: 0.017489, velocity coeff: 1.0166
norm(ch) = 0.43181
iter: 3824, Minibatch log likelihood (pre-update): -54.3014, error rate (pre-update): 0.076925

size_minibatch = 20000
Precon grad coeff: 0.020972, velocity coeff: 1.0732
norm(ch) = 0.4642
rho = 0.92338
New lambda: 2.5966e-083
iter: 3825, Minibatch log likelihood (pre-update): -54.3014, error rate (pre-update): 0.076922
iter: 3825, Minibatch log likelihood (post-update): -54.3013, error rate (post-update): 0.076917

size_minibatch = 20000
Precon grad coeff: 0.01688, velocity coeff: 0.80669
norm(ch) = 0.37515
iter: 3826, Minibatch log likelihood (pre-update): -54.3013, error rate (pre-update): 0.076917

size_minibatch = 20000
Precon grad coeff: 0.015138, velocity coeff: 1.0095
norm(ch) = 0.37929
iter: 3827, Minibatch log likelihood (pre-update): -54.3013, error rate (pre-update): 0.076911

size_minibatch = 20000
Precon grad coeff: 0.018053, velocity coeff: 1.0938
norm(ch) = 0.41559
iter: 3828, Minibatch log likelihood (pre-update): -54.3013, error rate (pre-update): 0.076913

size_minibatch = 20000
Precon grad coeff: 0.020501, velocity coeff: 1.0131
norm(ch) = 0.42186
iter: 3829, Minibatch log likelihood (pre-update): -54.3013, error rate (pre-update): 0.076911

size_minibatch = 20000
Precon grad coeff: 0.016913, velocity coeff: 0.91336
norm(ch) = 0.38614
rho = 0.92544
New lambda: 2.0092e-083
iter: 3830, Minibatch log likelihood (pre-update): -54.3013, error rate (pre-update): 0.076907
iter: 3830, Minibatch log likelihood (post-update): -54.3012, error rate (post-update): 0.076903

size_minibatch = 20000
Precon grad coeff: 0.01549, velocity coeff: 0.96606
norm(ch) = 0.37364
iter: 3831, Minibatch log likelihood (pre-update): -54.3012, error rate (pre-update): 0.076903

size_minibatch = 20000
Precon grad coeff: 0.018158, velocity coeff: 1.1023
norm(ch) = 0.41251
iter: 3832, Minibatch log likelihood (pre-update): -54.3012, error rate (pre-update): 0.076904

size_minibatch = 20000
Precon grad coeff: 0.01921, velocity coeff: 1.0396
norm(ch) = 0.4296
iter: 3833, Minibatch log likelihood (pre-update): -54.3012, error rate (pre-update): 0.076897

size_minibatch = 20000
Precon grad coeff: 0.016779, velocity coeff: 0.89766
norm(ch) = 0.38632
iter: 3834, Minibatch log likelihood (pre-update): -54.3012, error rate (pre-update): 0.076893

size_minibatch = 20000
Precon grad coeff: 0.016988, velocity coeff: 1.0545
norm(ch) = 0.4081
rho = 1.0414
New lambda: 1.5547e-083
iter: 3835, Minibatch log likelihood (pre-update): -54.3012, error rate (pre-update): 0.076889
iter: 3835, Minibatch log likelihood (post-update): -54.3011, error rate (post-update): 0.076888

size_minibatch = 20000
Precon grad coeff: 0.015707, velocity coeff: 1.0027
norm(ch) = 0.40975
iter: 3836, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.076888

size_minibatch = 20000
Precon grad coeff: 0.01856, velocity coeff: 1.0428
norm(ch) = 0.42789
iter: 3837, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.076886

size_minibatch = 20000
Precon grad coeff: 0.017263, velocity coeff: 0.94494
norm(ch) = 0.40494
iter: 3838, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.076887

size_minibatch = 20000
Precon grad coeff: 0.015631, velocity coeff: 0.92073
norm(ch) = 0.37343
iter: 3839, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.076878

size_minibatch = 20000
Precon grad coeff: 0.019519, velocity coeff: 1.0705
New gamma: 0.0052816
norm(ch) = 0.4002
rho = 0.97485
New lambda: 1.203e-083
iter: 3840, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.076872
iter: 3840, Minibatch log likelihood (post-update): -54.3011, error rate (post-update): 0.07687

size_minibatch = 20000
Precon grad coeff: 0.02089, velocity coeff: 0.94314
norm(ch) = 0.37781
iter: 3841, Minibatch log likelihood (pre-update): -54.3011, error rate (pre-update): 0.07687

size_minibatch = 20000
Precon grad coeff: 0.020302, velocity coeff: 0.93872
norm(ch) = 0.35499
iter: 3842, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076871

size_minibatch = 20000
Precon grad coeff: 0.016879, velocity coeff: 0.94221
norm(ch) = 0.33481
iter: 3843, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076867

size_minibatch = 20000
Precon grad coeff: 0.020949, velocity coeff: 1.0771
norm(ch) = 0.36099
iter: 3844, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076866

size_minibatch = 20000
Precon grad coeff: 0.021287, velocity coeff: 0.98632
norm(ch) = 0.35647
rho = 0.77839
New lambda: 9.3085e-084
iter: 3845, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076863
iter: 3845, Minibatch log likelihood (post-update): -54.301, error rate (post-update): 0.076861

size_minibatch = 20000
Precon grad coeff: 0.019157, velocity coeff: 0.97627
norm(ch) = 0.34833
iter: 3846, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076861

size_minibatch = 20000
Precon grad coeff: 0.017925, velocity coeff: 0.98292
norm(ch) = 0.34268
iter: 3847, Minibatch log likelihood (pre-update): -54.301, error rate (pre-update): 0.076857

size_minibatch = 20000
Precon grad coeff: 0.020818, velocity coeff: 1.1045
norm(ch) = 0.3788
iter: 3848, Minibatch log likelihood (pre-update): -54.3009, error rate (pre-update): 0.076857

size_minibatch = 20000
Precon grad coeff: 0.021211, velocity coeff: 1.0029
norm(ch) = 0.3803
iter: 3849, Minibatch log likelihood (pre-update): -54.3009, error rate (pre-update): 0.076851

size_minibatch = 20000
Precon grad coeff: 0.018904, velocity coeff: 0.93969
norm(ch) = 0.35768
rho = 0.87422
New lambda: 7.2028e-084
iter: 3850, Minibatch log likelihood (pre-update): -54.3009, error rate (pre-update): 0.076849
iter: 3850, Minibatch log likelihood (post-update): -54.3009, error rate (post-update): 0.076846
---
Full log-likelihood: -54.3009, error rate: 0.076846
TEST log-likelihood: -55.3349, error rate: 0.41165
Error difference (test - train): 0.3348
---
Full log-likelihood (averaged params): -54.3073, error rate (averaged params): 0.07945
TEST log-likelihood (averaged params): -55.2944, error rate (averaged params): 0.40188
Error difference (test - train) (averaged params): 0.32243

size_minibatch = 20000
Precon grad coeff: 0.018163, velocity coeff: 1.0255
norm(ch) = 0.36715
iter: 3851, Minibatch log likelihood (pre-update): -54.3009, error rate (pre-update): 0.076846

size_minibatch = 20000
Precon grad coeff: 0.020607, velocity coeff: 1.0258
norm(ch) = 0.37686
iter: 3852, Minibatch log likelihood (pre-update): -54.3009, error rate (pre-update): 0.076845

size_minibatch = 20000
Precon grad coeff: 0.020082, velocity coeff: 0.97302
norm(ch) = 0.36696
iter: 3853, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.076839

size_minibatch = 20000
Precon grad coeff: 0.018068, velocity coeff: 0.95812
norm(ch) = 0.3518
iter: 3854, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.076839

size_minibatch = 20000
Precon grad coeff: 0.019242, velocity coeff: 1.0089
norm(ch) = 0.35527
rho = 0.86207
New lambda: 5.5734e-084
iter: 3855, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.076836
iter: 3855, Minibatch log likelihood (post-update): -54.3008, error rate (post-update): 0.076834

size_minibatch = 20000
Precon grad coeff: 0.018722, velocity coeff: 1.0131
norm(ch) = 0.36024
iter: 3856, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.076834

size_minibatch = 20000
Precon grad coeff: 0.020839, velocity coeff: 0.97694
norm(ch) = 0.35217
iter: 3857, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.07683

size_minibatch = 20000
Precon grad coeff: 0.017549, velocity coeff: 0.91595
norm(ch) = 0.32281
iter: 3858, Minibatch log likelihood (pre-update): -54.3008, error rate (pre-update): 0.07683

size_minibatch = 20000
Precon grad coeff: 0.019722, velocity coeff: 1.0977
norm(ch) = 0.35471
iter: 3859, Minibatch log likelihood (pre-update): -54.3007, error rate (pre-update): 0.076826

size_minibatch = 20000
Precon grad coeff: 0.019428, velocity coeff: 1.0224
New gamma: 0.0031623
norm(ch) = 0.36341
rho = 1.031
New lambda: 4.3126e-084
iter: 3860, Minibatch log likelihood (pre-update): -54.3007, error rate (pre-update): 0.076824
iter: 3860, Minibatch log likelihood (post-update): -54.3007, error rate (post-update): 0.076817

size_minibatch = 20000
Precon grad coeff: 0.019729, velocity coeff: 1.029
norm(ch) = 0.37489
iter: 3861, Minibatch log likelihood (pre-update): -54.3007, error rate (pre-update): 0.076817

size_minibatch = 20000
Precon grad coeff: 0.020359, velocity coeff: 1.1343
norm(ch) = 0.4262
iter: 3862, Minibatch log likelihood (pre-update): -54.3007, error rate (pre-update): 0.076813

size_minibatch = 20000
Precon grad coeff: 0.015638, velocity coeff: 0.88603
norm(ch) = 0.37836
iter: 3863, Minibatch log likelihood (pre-update): -54.3007, error rate (pre-update): 0.076811

size_minibatch = 20000
Precon grad coeff: 0.021255, velocity coeff: 1.3321
norm(ch) = 0.50506
iter: 3864, Minibatch log likelihood (pre-update): -54.3006, error rate (pre-update): 0.076813

size_minibatch = 20000
Precon grad coeff: 0.021515, velocity coeff: 0.96851
norm(ch) = 0.4903
rho = 1.0477
New lambda: 3.337e-084
iter: 3865, Minibatch log likelihood (pre-update): -54.3006, error rate (pre-update): 0.076807
iter: 3865, Minibatch log likelihood (post-update): -54.3006, error rate (post-update): 0.076801

size_minibatch = 20000
Precon grad coeff: 0.015515, velocity coeff: 0.82196
norm(ch) = 0.40379
iter: 3866, Minibatch log likelihood (pre-update): -54.3006, error rate (pre-update): 0.076801

size_minibatch = 20000
Precon grad coeff: 0.017227, velocity coeff: 1.0828
norm(ch) = 0.43796
iter: 3867, Minibatch log likelihood (pre-update): -54.3006, error rate (pre-update): 0.076797

size_minibatch = 20000
Precon grad coeff: 0.01896, velocity coeff: 0.95527
norm(ch) = 0.41928
iter: 3868, Minibatch log likelihood (pre-update): -54.3006, error rate (pre-update): 0.076797

size_minibatch = 20000
Precon grad coeff: 0.019399, velocity coeff: 0.98868
norm(ch) = 0.41551
iter: 3869, Minibatch log likelihood (pre-update): -54.3005, error rate (pre-update): 0.076792

size_minibatch = 20000
Precon grad coeff: 0.018737, velocity coeff: 0.91845
norm(ch) = 0.38262
rho = 1.1684
New lambda: 2.5821e-084
iter: 3870, Minibatch log likelihood (pre-update): -54.3005, error rate (pre-update): 0.07679
iter: 3870, Minibatch log likelihood (post-update): -54.3005, error rate (post-update): 0.076784

size_minibatch = 20000
Precon grad coeff: 0.01528, velocity coeff: 0.91306
norm(ch) = 0.35009
iter: 3871, Minibatch log likelihood (pre-update): -54.3005, error rate (pre-update): 0.076784

size_minibatch = 20000
Precon grad coeff: 0.02089, velocity coeff: 1.2496
norm(ch) = 0.43849
iter: 3872, Minibatch log likelihood (pre-update): -54.3005, error rate (pre-update): 0.076784

size_minibatch = 20000
Precon grad coeff: 0.020995, velocity coeff: 0.97429
norm(ch) = 0.4283
iter: 3873, Minibatch log likelihood (pre-update): -54.3005, error rate (pre-update): 0.076782

size_minibatch = 20000
Precon grad coeff: 0.016514, velocity coeff: 0.93537
norm(ch) = 0.4015
iter: 3874, Minibatch log likelihood (pre-update): -54.3004, error rate (pre-update): 0.076778

size_minibatch = 20000
Precon grad coeff: 0.017591, velocity coeff: 1.0277
norm(ch) = 0.41347
rho = 0.96422
New lambda: 1.998e-084
iter: 3875, Minibatch log likelihood (pre-update): -54.3004, error rate (pre-update): 0.076769
iter: 3875, Minibatch log likelihood (post-update): -54.3004, error rate (post-update): 0.076769

size_minibatch = 20000
Precon grad coeff: 0.017426, velocity coeff: 1.0299
norm(ch) = 0.4266
iter: 3876, Minibatch log likelihood (pre-update): -54.3004, error rate (pre-update): 0.076769

size_minibatch = 20000
Precon grad coeff: 0.021009, velocity coeff: 1.0759
norm(ch) = 0.45984
iter: 3877, Minibatch log likelihood (pre-update): -54.3004, error rate (pre-update): 0.076768

size_minibatch = 20000
Precon grad coeff: 0.017125, velocity coeff: 0.85641
norm(ch) = 0.39453
iter: 3878, Minibatch log likelihood (pre-update): -54.3004, error rate (pre-update): 0.076764

size_minibatch = 20000
Precon grad coeff: 0.015839, velocity coeff: 0.95417
norm(ch) = 0.37699
iter: 3879, Minibatch log likelihood (pre-update): -54.3003, error rate (pre-update): 0.076758

size_minibatch = 20000
Precon grad coeff: 0.01943, velocity coeff: 1.1395
New gamma: 0.0031623
norm(ch) = 0.43034
rho = 0.98029
New lambda: 1.546e-084
iter: 3880, Minibatch log likelihood (pre-update): -54.3003, error rate (pre-update): 0.076759
iter: 3880, Minibatch log likelihood (post-update): -54.3003, error rate (post-update): 0.076752

size_minibatch = 20000
Precon grad coeff: 0.018728, velocity coeff: 0.92
norm(ch) = 0.39667
iter: 3881, Minibatch log likelihood (pre-update): -54.3003, error rate (pre-update): 0.076752

size_minibatch = 20000
Precon grad coeff: 0.014775, velocity coeff: 0.91908
norm(ch) = 0.36533
iter: 3882, Minibatch log likelihood (pre-update): -54.3003, error rate (pre-update): 0.076748

size_minibatch = 20000
Precon grad coeff: 0.017389, velocity coeff: 1.0724
norm(ch) = 0.39226
iter: 3883, Minibatch log likelihood (pre-update): -54.3003, error rate (pre-update): 0.076745

size_minibatch = 20000
Precon grad coeff: 0.019123, velocity coeff: 0.99918
norm(ch) = 0.39266
iter: 3884, Minibatch log likelihood (pre-update): -54.3002, error rate (pre-update): 0.076746

size_minibatch = 20000
Precon grad coeff: 0.017991, velocity coeff: 1.0024
norm(ch) = 0.39432
rho = 1.0433
New lambda: 1.1963e-084
iter: 3885, Minibatch log likelihood (pre-update): -54.3002, error rate (pre-update): 0.07674
iter: 3885, Minibatch log likelihood (post-update): -54.3002, error rate (post-update): 0.076737

size_minibatch = 20000
Precon grad coeff: 0.018426, velocity coeff: 1.0069
norm(ch) = 0.398
iter: 3886, Minibatch log likelihood (pre-update): -54.3002, error rate (pre-update): 0.076737

size_minibatch = 20000
Precon grad coeff: 0.014962, velocity coeff: 0.91882
norm(ch) = 0.36642
iter: 3887, Minibatch log likelihood (pre-update): -54.3002, error rate (pre-update): 0.076733

size_minibatch = 20000
Precon grad coeff: 0.020006, velocity coeff: 1.2353
norm(ch) = 0.45334
iter: 3888, Minibatch log likelihood (pre-update): -54.3002, error rate (pre-update): 0.076733

size_minibatch = 20000
Precon grad coeff: 0.018228, velocity coeff: 0.95652
norm(ch) = 0.43427
iter: 3889, Minibatch log likelihood (pre-update): -54.3001, error rate (pre-update): 0.076727

size_minibatch = 20000
Precon grad coeff: 0.015586, velocity coeff: 0.93426
norm(ch) = 0.40634
rho = 1.014
New lambda: 9.2564e-085
iter: 3890, Minibatch log likelihood (pre-update): -54.3001, error rate (pre-update): 0.076725
iter: 3890, Minibatch log likelihood (post-update): -54.3001, error rate (post-update): 0.07672

size_minibatch = 20000
Precon grad coeff: 0.016665, velocity coeff: 1.0171
norm(ch) = 0.41388
iter: 3891, Minibatch log likelihood (pre-update): -54.3001, error rate (pre-update): 0.07672

size_minibatch = 20000
Precon grad coeff: 0.017581, velocity coeff: 0.99405
norm(ch) = 0.41212
iter: 3892, Minibatch log likelihood (pre-update): -54.3001, error rate (pre-update): 0.076718

size_minibatch = 20000
Precon grad coeff: 0.016813, velocity coeff: 0.96348
norm(ch) = 0.39765
iter: 3893, Minibatch log likelihood (pre-update): -54.3001, error rate (pre-update): 0.076715

size_minibatch = 20000
Precon grad coeff: 0.0171, velocity coeff: 0.92717
norm(ch) = 0.36926
iter: 3894, Minibatch log likelihood (pre-update): -54.3, error rate (pre-update): 0.076712

size_minibatch = 20000
Precon grad coeff: 0.01584, velocity coeff: 0.98053
norm(ch) = 0.36264
rho = 0.99475
New lambda: 7.1625e-085
iter: 3895, Minibatch log likelihood (pre-update): -54.3, error rate (pre-update): 0.076706
iter: 3895, Minibatch log likelihood (post-update): -54.3, error rate (post-update): 0.076704

size_minibatch = 20000
Precon grad coeff: 0.017674, velocity coeff: 1.1136
norm(ch) = 0.40458
iter: 3896, Minibatch log likelihood (pre-update): -54.3, error rate (pre-update): 0.076704

size_minibatch = 20000
Precon grad coeff: 0.018628, velocity coeff: 0.95986
norm(ch) = 0.38913
iter: 3897, Minibatch log likelihood (pre-update): -54.3, error rate (pre-update): 0.076702

size_minibatch = 20000
Precon grad coeff: 0.015029, velocity coeff: 0.94766
norm(ch) = 0.36935
iter: 3898, Minibatch log likelihood (pre-update): -54.3, error rate (pre-update): 0.0767

size_minibatch = 20000
Precon grad coeff: 0.017184, velocity coeff: 1.049
norm(ch) = 0.38802
iter: 3899, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076697

size_minibatch = 20000
Precon grad coeff: 0.016978, velocity coeff: 1.0289
New gamma: 0.0031623
norm(ch) = 0.39991
rho = 1.0019
New lambda: 5.5422e-085
iter: 3900, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076695
iter: 3900, Minibatch log likelihood (post-update): -54.2999, error rate (post-update): 0.076688
---
Full log-likelihood: -54.2999, error rate: 0.076688
TEST log-likelihood: -55.3453, error rate: 0.41409
Error difference (test - train): 0.3374
---
Full log-likelihood (averaged params): -54.3058, error rate (averaged params): 0.079115
TEST log-likelihood (averaged params): -55.3053, error rate (averaged params): 0.40458
Error difference (test - train) (averaged params): 0.32546

size_minibatch = 20000
Precon grad coeff: 0.0184, velocity coeff: 0.99332
norm(ch) = 0.39797
iter: 3901, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076688

size_minibatch = 20000
Precon grad coeff: 0.013696, velocity coeff: 0.86522
norm(ch) = 0.34496
iter: 3902, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076685

size_minibatch = 20000
Precon grad coeff: 0.017302, velocity coeff: 1.138
norm(ch) = 0.39328
iter: 3903, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076684

size_minibatch = 20000
Precon grad coeff: 0.01892, velocity coeff: 1.0649
norm(ch) = 0.41941
iter: 3904, Minibatch log likelihood (pre-update): -54.2999, error rate (pre-update): 0.076684

size_minibatch = 20000
Precon grad coeff: 0.015223, velocity coeff: 0.85493
norm(ch) = 0.35914
rho = 0.98742
New lambda: 4.2884e-085
iter: 3905, Minibatch log likelihood (pre-update): -54.2998, error rate (pre-update): 0.076677
iter: 3905, Minibatch log likelihood (post-update): -54.2998, error rate (post-update): 0.076674

size_minibatch = 20000
Precon grad coeff: 0.015352, velocity coeff: 1.1061
norm(ch) = 0.39782
iter: 3906, Minibatch log likelihood (pre-update): -54.2998, error rate (pre-update): 0.076674

size_minibatch = 20000
Precon grad coeff: 0.016938, velocity coeff: 0.9762
norm(ch) = 0.38907
iter: 3907, Minibatch log likelihood (pre-update): -54.2998, error rate (pre-update): 0.076669

size_minibatch = 20000
Precon grad coeff: 0.016422, velocity coeff: 1.0447
norm(ch) = 0.40695
iter: 3908, Minibatch log likelihood (pre-update): -54.2998, error rate (pre-update): 0.076667

size_minibatch = 20000
Precon grad coeff: 0.015959, velocity coeff: 0.85896
norm(ch) = 0.35008
iter: 3909, Minibatch log likelihood (pre-update): -54.2998, error rate (pre-update): 0.076663

size_minibatch = 20000
Precon grad coeff: 0.014817, velocity coeff: 1.0748
norm(ch) = 0.37674
rho = 1.1262
New lambda: 3.3183e-085
iter: 3910, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.076662
iter: 3910, Minibatch log likelihood (post-update): -54.2997, error rate (post-update): 0.076658

size_minibatch = 20000
Precon grad coeff: 0.017264, velocity coeff: 1.0097
norm(ch) = 0.38097
iter: 3911, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.076658

size_minibatch = 20000
Precon grad coeff: 0.016412, velocity coeff: 0.95797
norm(ch) = 0.36553
iter: 3912, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.076656

size_minibatch = 20000
Precon grad coeff: 0.01578, velocity coeff: 1.0006
norm(ch) = 0.3664
iter: 3913, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.076652

size_minibatch = 20000
Precon grad coeff: 0.015458, velocity coeff: 0.99322
norm(ch) = 0.36446
iter: 3914, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.07665

size_minibatch = 20000
Precon grad coeff: 0.016102, velocity coeff: 1.0785
norm(ch) = 0.39361
rho = 1.0976
New lambda: 2.5676e-085
iter: 3915, Minibatch log likelihood (pre-update): -54.2997, error rate (pre-update): 0.076648
iter: 3915, Minibatch log likelihood (post-update): -54.2996, error rate (post-update): 0.076646

size_minibatch = 20000
Precon grad coeff: 0.018412, velocity coeff: 1.0343
norm(ch) = 0.40772
iter: 3916, Minibatch log likelihood (pre-update): -54.2996, error rate (pre-update): 0.076646

size_minibatch = 20000
Precon grad coeff: 0.014412, velocity coeff: 0.88852
norm(ch) = 0.3628
iter: 3917, Minibatch log likelihood (pre-update): -54.2996, error rate (pre-update): 0.076636

size_minibatch = 20000
Precon grad coeff: 0.014965, velocity coeff: 0.99331
norm(ch) = 0.36091
iter: 3918, Minibatch log likelihood (pre-update): -54.2996, error rate (pre-update): 0.076635

size_minibatch = 20000
Precon grad coeff: 0.017449, velocity coeff: 1.1096
norm(ch) = 0.40104
iter: 3919, Minibatch log likelihood (pre-update): -54.2996, error rate (pre-update): 0.076635

size_minibatch = 20000
Precon grad coeff: 0.017133, velocity coeff: 0.95324
New gamma: 0.0031623
norm(ch) = 0.38282
rho = 0.95712
New lambda: 1.9868e-085
iter: 3920, Minibatch log likelihood (pre-update): -54.2996, error rate (pre-update): 0.076633
iter: 3920, Minibatch log likelihood (post-update): -54.2995, error rate (post-update): 0.076626

size_minibatch = 20000
Precon grad coeff: 0.014841, velocity coeff: 0.88427
norm(ch) = 0.33905
iter: 3921, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076626

size_minibatch = 20000
Precon grad coeff: 0.015083, velocity coeff: 1.1073
norm(ch) = 0.37597
iter: 3922, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076626

size_minibatch = 20000
Precon grad coeff: 0.017134, velocity coeff: 1.0359
norm(ch) = 0.39026
iter: 3923, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076623

size_minibatch = 20000
Precon grad coeff: 0.017259, velocity coeff: 0.98161
norm(ch) = 0.3838
iter: 3924, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076619

size_minibatch = 20000
Precon grad coeff: 0.014548, velocity coeff: 0.92806
norm(ch) = 0.35673
rho = 0.99564
New lambda: 1.5373e-085
iter: 3925, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076614
iter: 3925, Minibatch log likelihood (post-update): -54.2995, error rate (post-update): 0.076613

size_minibatch = 20000
Precon grad coeff: 0.016474, velocity coeff: 1.0671
norm(ch) = 0.38119
iter: 3926, Minibatch log likelihood (pre-update): -54.2995, error rate (pre-update): 0.076613

size_minibatch = 20000
Precon grad coeff: 0.015683, velocity coeff: 1.033
norm(ch) = 0.39436
iter: 3927, Minibatch log likelihood (pre-update): -54.2994, error rate (pre-update): 0.07661

size_minibatch = 20000
Precon grad coeff: 0.016818, velocity coeff: 0.94709
norm(ch) = 0.3742
iter: 3928, Minibatch log likelihood (pre-update): -54.2994, error rate (pre-update): 0.07661

size_minibatch = 20000
Precon grad coeff: 0.015177, velocity coeff: 0.9663
norm(ch) = 0.36219
iter: 3929, Minibatch log likelihood (pre-update): -54.2994, error rate (pre-update): 0.076603

size_minibatch = 20000
Precon grad coeff: 0.015962, velocity coeff: 1.0768
norm(ch) = 0.39044
rho = 0.98428
New lambda: 1.1896e-085
iter: 3930, Minibatch log likelihood (pre-update): -54.2994, error rate (pre-update): 0.076599
iter: 3930, Minibatch log likelihood (post-update): -54.2994, error rate (post-update): 0.076597

size_minibatch = 20000
Precon grad coeff: 0.015201, velocity coeff: 0.94666
norm(ch) = 0.37017
iter: 3931, Minibatch log likelihood (pre-update): -54.2994, error rate (pre-update): 0.076597

size_minibatch = 20000
Precon grad coeff: 0.016341, velocity coeff: 1.0424
norm(ch) = 0.38644
iter: 3932, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076601

size_minibatch = 20000
Precon grad coeff: 0.015729, velocity coeff: 0.95573
norm(ch) = 0.36993
iter: 3933, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076596

size_minibatch = 20000
Precon grad coeff: 0.013599, velocity coeff: 0.93643
norm(ch) = 0.34689
iter: 3934, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076591

size_minibatch = 20000
Precon grad coeff: 0.017638, velocity coeff: 1.1188
norm(ch) = 0.38875
rho = 1.0367
New lambda: 9.2046e-086
iter: 3935, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076587
iter: 3935, Minibatch log likelihood (post-update): -54.2993, error rate (post-update): 0.076587

size_minibatch = 20000
Precon grad coeff: 0.015899, velocity coeff: 0.90672
norm(ch) = 0.35294
iter: 3936, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076587

size_minibatch = 20000
Precon grad coeff: 0.014412, velocity coeff: 0.99491
norm(ch) = 0.35167
iter: 3937, Minibatch log likelihood (pre-update): -54.2993, error rate (pre-update): 0.076581

size_minibatch = 20000
Precon grad coeff: 0.015664, velocity coeff: 1.0089
norm(ch) = 0.35534
iter: 3938, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.076578

size_minibatch = 20000
Precon grad coeff: 0.016247, velocity coeff: 1.1116
norm(ch) = 0.39571
iter: 3939, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.076574

size_minibatch = 20000
Precon grad coeff: 0.018713, velocity coeff: 0.96371
New gamma: 0.0031623
norm(ch) = 0.38199
rho = 1.012
New lambda: 7.1224e-086
iter: 3940, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.076576
iter: 3940, Minibatch log likelihood (post-update): -54.2992, error rate (post-update): 0.076574

size_minibatch = 20000
Precon grad coeff: 0.015201, velocity coeff: 0.91007
norm(ch) = 0.34818
iter: 3941, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.076574

size_minibatch = 20000
Precon grad coeff: 0.017282, velocity coeff: 1.1643
norm(ch) = 0.40598
iter: 3942, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.07657

size_minibatch = 20000
Precon grad coeff: 0.019701, velocity coeff: 0.96853
norm(ch) = 0.39401
iter: 3943, Minibatch log likelihood (pre-update): -54.2992, error rate (pre-update): 0.076562

size_minibatch = 20000
Precon grad coeff: 0.015218, velocity coeff: 0.91046
norm(ch) = 0.35936
iter: 3944, Minibatch log likelihood (pre-update): -54.2991, error rate (pre-update): 0.076562

size_minibatch = 20000
Precon grad coeff: 0.01774, velocity coeff: 1.1251
norm(ch) = 0.40504
rho = 1.0375
New lambda: 5.5111e-086
iter: 3945, Minibatch log likelihood (pre-update): -54.2991, error rate (pre-update): 0.07656
iter: 3945, Minibatch log likelihood (post-update): -54.2991, error rate (post-update): 0.076556

size_minibatch = 20000
Precon grad coeff: 0.015652, velocity coeff: 0.90163
norm(ch) = 0.36578
iter: 3946, Minibatch log likelihood (pre-update): -54.2991, error rate (pre-update): 0.076556

size_minibatch = 20000
Precon grad coeff: 0.018073, velocity coeff: 1.1126
norm(ch) = 0.40763
iter: 3947, Minibatch log likelihood (pre-update): -54.2991, error rate (pre-update): 0.076551

size_minibatch = 20000
Precon grad coeff: 0.017734, velocity coeff: 0.97498
norm(ch) = 0.39804
iter: 3948, Minibatch log likelihood (pre-update): -54.2991, error rate (pre-update): 0.07655

size_minibatch = 20000
Precon grad coeff: 0.014775, velocity coeff: 0.88367
norm(ch) = 0.35227
iter: 3949, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076547

size_minibatch = 20000
Precon grad coeff: 0.01751, velocity coeff: 1.1692
norm(ch) = 0.41248
rho = 0.88895
New lambda: 4.2644e-086
iter: 3950, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076544
iter: 3950, Minibatch log likelihood (post-update): -54.299, error rate (post-update): 0.076539
---
Full log-likelihood: -54.299, error rate: 0.076539
TEST log-likelihood: -55.3564, error rate: 0.41674
Error difference (test - train): 0.3402
---
Full log-likelihood (averaged params): -54.3044, error rate (averaged params): 0.078812
TEST log-likelihood (averaged params): -55.3167, error rate (averaged params): 0.40731
Error difference (test - train) (averaged params): 0.3285

size_minibatch = 20000
Precon grad coeff: 0.017602, velocity coeff: 0.89666
norm(ch) = 0.3706
iter: 3951, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076539

size_minibatch = 20000
Precon grad coeff: 0.016029, velocity coeff: 1.0247
norm(ch) = 0.3802
iter: 3952, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076539

size_minibatch = 20000
Precon grad coeff: 0.016234, velocity coeff: 0.96303
norm(ch) = 0.36664
iter: 3953, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076536

size_minibatch = 20000
Precon grad coeff: 0.015748, velocity coeff: 1.0032
norm(ch) = 0.36833
iter: 3954, Minibatch log likelihood (pre-update): -54.299, error rate (pre-update): 0.076535

size_minibatch = 20000
Precon grad coeff: 0.018408, velocity coeff: 1.077
norm(ch) = 0.39737
rho = 1.256
New lambda: 3.2997e-086
iter: 3955, Minibatch log likelihood (pre-update): -54.2989, error rate (pre-update): 0.07653
iter: 3955, Minibatch log likelihood (post-update): -54.2989, error rate (post-update): 0.076528

size_minibatch = 20000
Precon grad coeff: 0.016484, velocity coeff: 0.87771
norm(ch) = 0.34943
iter: 3956, Minibatch log likelihood (pre-update): -54.2989, error rate (pre-update): 0.076528

size_minibatch = 20000
Precon grad coeff: 0.015505, velocity coeff: 1.077
norm(ch) = 0.37685
iter: 3957, Minibatch log likelihood (pre-update): -54.2989, error rate (pre-update): 0.076525

size_minibatch = 20000
Precon grad coeff: 0.01843, velocity coeff: 1.0003
norm(ch) = 0.37752
iter: 3958, Minibatch log likelihood (pre-update): -54.2989, error rate (pre-update): 0.076523

size_minibatch = 20000
Precon grad coeff: 0.016031, velocity coeff: 1.0209
norm(ch) = 0.38603
iter: 3959, Minibatch log likelihood (pre-update): -54.2989, error rate (pre-update): 0.076516

size_minibatch = 20000
Precon grad coeff: 0.01648, velocity coeff: 0.92066
New gamma: 0.0052816
norm(ch) = 0.35573
rho = 1.2631
New lambda: 2.5533e-086
iter: 3960, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.076517
iter: 3960, Minibatch log likelihood (post-update): -54.2988, error rate (post-update): 0.076517

size_minibatch = 20000
Precon grad coeff: 0.014756, velocity coeff: 0.99147
norm(ch) = 0.35295
iter: 3961, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.076517

size_minibatch = 20000
Precon grad coeff: 0.017083, velocity coeff: 1.1159
norm(ch) = 0.39397
iter: 3962, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.076515

size_minibatch = 20000
Precon grad coeff: 0.015948, velocity coeff: 0.86978
norm(ch) = 0.34292
iter: 3963, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.076506

size_minibatch = 20000
Precon grad coeff: 0.013637, velocity coeff: 0.92121
norm(ch) = 0.31603
iter: 3964, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.076502

size_minibatch = 20000
Precon grad coeff: 0.016346, velocity coeff: 1.0465
norm(ch) = 0.33088
rho = 1.1419
New lambda: 1.9757e-086
iter: 3965, Minibatch log likelihood (pre-update): -54.2988, error rate (pre-update): 0.0765
iter: 3965, Minibatch log likelihood (post-update): -54.2987, error rate (post-update): 0.076502

size_minibatch = 20000
Precon grad coeff: 0.015908, velocity coeff: 0.90668
norm(ch) = 0.30016
iter: 3966, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076502

size_minibatch = 20000
Precon grad coeff: 0.015254, velocity coeff: 0.93871
norm(ch) = 0.28199
iter: 3967, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076501

size_minibatch = 20000
Precon grad coeff: 0.015101, velocity coeff: 0.99079
norm(ch) = 0.2794
iter: 3968, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.0765

size_minibatch = 20000
Precon grad coeff: 0.01572, velocity coeff: 1.0675
norm(ch) = 0.29843
iter: 3969, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076496

size_minibatch = 20000
Precon grad coeff: 0.017867, velocity coeff: 1.051
norm(ch) = 0.31388
rho = 1.0198
New lambda: 1.5287e-086
iter: 3970, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076494
iter: 3970, Minibatch log likelihood (post-update): -54.2987, error rate (post-update): 0.076489

size_minibatch = 20000
Precon grad coeff: 0.015342, velocity coeff: 0.9526
norm(ch) = 0.29933
iter: 3971, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076489

size_minibatch = 20000
Precon grad coeff: 0.015052, velocity coeff: 1.104
norm(ch) = 0.33038
iter: 3972, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076488

size_minibatch = 20000
Precon grad coeff: 0.015606, velocity coeff: 0.98992
norm(ch) = 0.32718
iter: 3973, Minibatch log likelihood (pre-update): -54.2987, error rate (pre-update): 0.076485

size_minibatch = 20000
Precon grad coeff: 0.017075, velocity coeff: 1.0779
norm(ch) = 0.35281
iter: 3974, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076484

size_minibatch = 20000
Precon grad coeff: 0.015556, velocity coeff: 0.93516
norm(ch) = 0.33022
rho = 1.059
New lambda: 1.1829e-086
iter: 3975, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076479
iter: 3975, Minibatch log likelihood (post-update): -54.2986, error rate (post-update): 0.076476

size_minibatch = 20000
Precon grad coeff: 0.013119, velocity coeff: 0.95321
norm(ch) = 0.31478
iter: 3976, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076476

size_minibatch = 20000
Precon grad coeff: 0.018518, velocity coeff: 1.149
norm(ch) = 0.36181
iter: 3977, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076474

size_minibatch = 20000
Precon grad coeff: 0.014222, velocity coeff: 0.78778
norm(ch) = 0.28511
iter: 3978, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076475

size_minibatch = 20000
Precon grad coeff: 0.0151, velocity coeff: 1.0965
norm(ch) = 0.3128
iter: 3979, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076472

size_minibatch = 20000
Precon grad coeff: 0.017377, velocity coeff: 0.94594
New gamma: 0.0088212
norm(ch) = 0.29588
rho = 0.92559
New lambda: 9.1531e-087
iter: 3980, Minibatch log likelihood (pre-update): -54.2986, error rate (pre-update): 0.076469
iter: 3980, Minibatch log likelihood (post-update): -54.2985, error rate (post-update): 0.076464

size_minibatch = 20000
Precon grad coeff: 0.017631, velocity coeff: 1.0185
norm(ch) = 0.30144
iter: 3981, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076464

size_minibatch = 20000
Precon grad coeff: 0.015101, velocity coeff: 0.84662
norm(ch) = 0.25523
iter: 3982, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076463

size_minibatch = 20000
Precon grad coeff: 0.018288, velocity coeff: 1.1578
norm(ch) = 0.29559
iter: 3983, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076461

size_minibatch = 20000
Precon grad coeff: 0.017572, velocity coeff: 0.8978
norm(ch) = 0.26543
iter: 3984, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076459

size_minibatch = 20000
Precon grad coeff: 0.01616, velocity coeff: 0.98627
norm(ch) = 0.2619
rho = 0.9909
New lambda: 7.0825e-087
iter: 3985, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076455
iter: 3985, Minibatch log likelihood (post-update): -54.2985, error rate (post-update): 0.076454

size_minibatch = 20000
Precon grad coeff: 0.016371, velocity coeff: 1.0278
norm(ch) = 0.2692
iter: 3986, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076454

size_minibatch = 20000
Precon grad coeff: 0.018616, velocity coeff: 0.98717
norm(ch) = 0.26584
iter: 3987, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076453

size_minibatch = 20000
Precon grad coeff: 0.015919, velocity coeff: 0.99531
norm(ch) = 0.26464
iter: 3988, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.076454

size_minibatch = 20000
Precon grad coeff: 0.017126, velocity coeff: 1.0309
norm(ch) = 0.27294
iter: 3989, Minibatch log likelihood (pre-update): -54.2985, error rate (pre-update): 0.07645

size_minibatch = 20000
Precon grad coeff: 0.017701, velocity coeff: 1.0165
norm(ch) = 0.27745
rho = 1.1066
New lambda: 5.4803e-087
iter: 3990, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076447
iter: 3990, Minibatch log likelihood (post-update): -54.2984, error rate (post-update): 0.076443

size_minibatch = 20000
Precon grad coeff: 0.016315, velocity coeff: 0.98096
norm(ch) = 0.27224
iter: 3991, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076443

size_minibatch = 20000
Precon grad coeff: 0.01698, velocity coeff: 0.99458
norm(ch) = 0.27079
iter: 3992, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076442

size_minibatch = 20000
Precon grad coeff: 0.017503, velocity coeff: 1.1071
norm(ch) = 0.29993
iter: 3993, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.07644

size_minibatch = 20000
Precon grad coeff: 0.01615, velocity coeff: 0.86236
norm(ch) = 0.2587
iter: 3994, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076438

size_minibatch = 20000
Precon grad coeff: 0.017047, velocity coeff: 1.1111
norm(ch) = 0.28755
rho = 0.93377
New lambda: 4.2406e-087
iter: 3995, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076434
iter: 3995, Minibatch log likelihood (post-update): -54.2984, error rate (post-update): 0.076434

size_minibatch = 20000
Precon grad coeff: 0.017142, velocity coeff: 1.0129
norm(ch) = 0.29129
iter: 3996, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076434

size_minibatch = 20000
Precon grad coeff: 0.016108, velocity coeff: 0.87462
norm(ch) = 0.25484
iter: 3997, Minibatch log likelihood (pre-update): -54.2984, error rate (pre-update): 0.076431

size_minibatch = 20000
Precon grad coeff: 0.017357, velocity coeff: 1.1495
norm(ch) = 0.29295
iter: 3998, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076431

size_minibatch = 20000
Precon grad coeff: 0.016479, velocity coeff: 0.92421
norm(ch) = 0.27086
iter: 3999, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076426

size_minibatch = 20000
Precon grad coeff: 0.023539, velocity coeff: 1.0676
New gamma: 0.014733
norm(ch) = 0.28918
rho = 1.0192
New lambda: 3.2813e-087
iter: 4000, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076425
iter: 4000, Minibatch log likelihood (post-update): -54.2983, error rate (post-update): 0.076421
---
Full log-likelihood: -54.2983, error rate: 0.076421
TEST log-likelihood: -55.3647, error rate: 0.41876
Error difference (test - train): 0.34234
---
Full log-likelihood (averaged params): -54.303, error rate (averaged params): 0.07848
TEST log-likelihood (averaged params): -55.3282, error rate (averaged params): 0.41
Error difference (test - train) (averaged params): 0.33152

size_minibatch = 20000
Precon grad coeff: 0.024153, velocity coeff: 0.91761
norm(ch) = 0.26542
iter: 4001, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076421

size_minibatch = 20000
Precon grad coeff: 0.02309, velocity coeff: 0.93569
norm(ch) = 0.24838
iter: 4002, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.07642

size_minibatch = 20000
Precon grad coeff: 0.022706, velocity coeff: 0.98068
norm(ch) = 0.2437
iter: 4003, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076416

size_minibatch = 20000
Precon grad coeff: 0.024059, velocity coeff: 1.0176
norm(ch) = 0.24803
iter: 4004, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076418

size_minibatch = 20000
Precon grad coeff: 0.024773, velocity coeff: 0.98136
norm(ch) = 0.2435
rho = 0.73743
New lambda: 3.2813e-087
iter: 4005, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076417
iter: 4005, Minibatch log likelihood (post-update): -54.2983, error rate (post-update): 0.076415

size_minibatch = 20000
Precon grad coeff: 0.02259, velocity coeff: 1.0145
norm(ch) = 0.24708
iter: 4006, Minibatch log likelihood (pre-update): -54.2983, error rate (pre-update): 0.076415

size_minibatch = 20000
Precon grad coeff: 0.025073, velocity coeff: 1.0555
norm(ch) = 0.26089
iter: 4007, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076409

size_minibatch = 20000
Precon grad coeff: 0.023517, velocity coeff: 1.0181
norm(ch) = 0.26565
iter: 4008, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.07641

size_minibatch = 20000
Precon grad coeff: 0.024299, velocity coeff: 0.98718
norm(ch) = 0.26235
iter: 4009, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076406

size_minibatch = 20000
Precon grad coeff: 0.022804, velocity coeff: 1.0501
norm(ch) = 0.27553
rho = 0.97479
New lambda: 2.539e-087
iter: 4010, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076402
iter: 4010, Minibatch log likelihood (post-update): -54.2982, error rate (post-update): 0.076399

size_minibatch = 20000
Precon grad coeff: 0.024378, velocity coeff: 0.99048
norm(ch) = 0.273
iter: 4011, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076399

size_minibatch = 20000
Precon grad coeff: 0.023546, velocity coeff: 0.99256
norm(ch) = 0.27102
iter: 4012, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076403

size_minibatch = 20000
Precon grad coeff: 0.023019, velocity coeff: 0.99113
norm(ch) = 0.2687
iter: 4013, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076399

size_minibatch = 20000
Precon grad coeff: 0.023149, velocity coeff: 1.0013
norm(ch) = 0.26908
iter: 4014, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076395

size_minibatch = 20000
Precon grad coeff: 0.023374, velocity coeff: 0.96124
norm(ch) = 0.25874
rho = 1.0022
New lambda: 1.9646e-087
iter: 4015, Minibatch log likelihood (pre-update): -54.2982, error rate (pre-update): 0.076391
iter: 4015, Minibatch log likelihood (post-update): -54.2981, error rate (post-update): 0.076391

size_minibatch = 20000
Precon grad coeff: 0.024479, velocity coeff: 1.0627
norm(ch) = 0.27501
iter: 4016, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076391

size_minibatch = 20000
Precon grad coeff: 0.021768, velocity coeff: 0.91478
norm(ch) = 0.25164
iter: 4017, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076386

size_minibatch = 20000
Precon grad coeff: 0.024699, velocity coeff: 1.0599
norm(ch) = 0.26676
iter: 4018, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076385

size_minibatch = 20000
Precon grad coeff: 0.023234, velocity coeff: 0.98077
norm(ch) = 0.26173
iter: 4019, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076383

size_minibatch = 20000
Precon grad coeff: 0.020917, velocity coeff: 0.99459
New gamma: 0.0088212
norm(ch) = 0.26048
rho = 1.1043
New lambda: 1.5202e-087
iter: 4020, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076385
iter: 4020, Minibatch log likelihood (post-update): -54.2981, error rate (post-update): 0.076381

size_minibatch = 20000
Precon grad coeff: 0.025868, velocity coeff: 1.1193
norm(ch) = 0.29171
iter: 4021, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076381

size_minibatch = 20000
Precon grad coeff: 0.022685, velocity coeff: 0.95924
norm(ch) = 0.28003
iter: 4022, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076377

size_minibatch = 20000
Precon grad coeff: 0.022991, velocity coeff: 1.0851
norm(ch) = 0.30413
iter: 4023, Minibatch log likelihood (pre-update): -54.2981, error rate (pre-update): 0.076372

size_minibatch = 20000
Precon grad coeff: 0.022609, velocity coeff: 1.0433
norm(ch) = 0.3176
iter: 4024, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076372

size_minibatch = 20000
Precon grad coeff: 0.024515, velocity coeff: 1.128
norm(ch) = 0.35857
rho = 1.0476
New lambda: 1.1763e-087
iter: 4025, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076368
iter: 4025, Minibatch log likelihood (post-update): -54.298, error rate (post-update): 0.076367

size_minibatch = 20000
Precon grad coeff: 0.021601, velocity coeff: 0.9141
norm(ch) = 0.32802
iter: 4026, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076367

size_minibatch = 20000
Precon grad coeff: 0.024675, velocity coeff: 1.1496
norm(ch) = 0.37742
iter: 4027, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076363

size_minibatch = 20000
Precon grad coeff: 0.019699, velocity coeff: 0.83814
norm(ch) = 0.31657
iter: 4028, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076363

size_minibatch = 20000
Precon grad coeff: 0.024962, velocity coeff: 1.1498
norm(ch) = 0.36432
iter: 4029, Minibatch log likelihood (pre-update): -54.298, error rate (pre-update): 0.076358

size_minibatch = 20000
Precon grad coeff: 0.020236, velocity coeff: 0.89083
norm(ch) = 0.32483
rho = 0.79234
New lambda: 9.1019e-088
iter: 4030, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076356
iter: 4030, Minibatch log likelihood (post-update): -54.2979, error rate (post-update): 0.076354

size_minibatch = 20000
Precon grad coeff: 0.024394, velocity coeff: 1.0076
norm(ch) = 0.32761
iter: 4031, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076354

size_minibatch = 20000
Precon grad coeff: 0.01949, velocity coeff: 0.90053
norm(ch) = 0.29529
iter: 4032, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.07635

size_minibatch = 20000
Precon grad coeff: 0.023523, velocity coeff: 1.0744
norm(ch) = 0.31763
iter: 4033, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076343

size_minibatch = 20000
Precon grad coeff: 0.023585, velocity coeff: 1.0217
norm(ch) = 0.32493
iter: 4034, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076344

size_minibatch = 20000
Precon grad coeff: 0.022027, velocity coeff: 0.92596
norm(ch) = 0.30125
rho = 1.0646
New lambda: 7.0429e-088
iter: 4035, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076344
iter: 4035, Minibatch log likelihood (post-update): -54.2979, error rate (post-update): 0.076343

size_minibatch = 20000
Precon grad coeff: 0.020596, velocity coeff: 1.0226
norm(ch) = 0.3084
iter: 4036, Minibatch log likelihood (pre-update): -54.2979, error rate (pre-update): 0.076343

size_minibatch = 20000
Precon grad coeff: 0.023093, velocity coeff: 1.0689
norm(ch) = 0.33004
iter: 4037, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076338

size_minibatch = 20000
Precon grad coeff: 0.024003, velocity coeff: 1.012
norm(ch) = 0.33444
iter: 4038, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076336

size_minibatch = 20000
Precon grad coeff: 0.021206, velocity coeff: 0.94891
norm(ch) = 0.31776
iter: 4039, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076332

size_minibatch = 20000
Precon grad coeff: 0.019609, velocity coeff: 0.97613
New gamma: 0.0088212
norm(ch) = 0.31056
rho = 1.1
New lambda: 5.4496e-088
iter: 4040, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076332
iter: 4040, Minibatch log likelihood (post-update): -54.2978, error rate (post-update): 0.076328

size_minibatch = 20000
Precon grad coeff: 0.02063, velocity coeff: 1.0799
norm(ch) = 0.33573
iter: 4041, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076328

size_minibatch = 20000
Precon grad coeff: 0.021247, velocity coeff: 0.97226
norm(ch) = 0.32682
iter: 4042, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076325

size_minibatch = 20000
Precon grad coeff: 0.020582, velocity coeff: 0.98691
norm(ch) = 0.32292
iter: 4043, Minibatch log likelihood (pre-update): -54.2978, error rate (pre-update): 0.076323

size_minibatch = 20000
Precon grad coeff: 0.018657, velocity coeff: 0.95804
norm(ch) = 0.30976
iter: 4044, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076323

size_minibatch = 20000
Precon grad coeff: 0.021184, velocity coeff: 1.0742
norm(ch) = 0.33314
rho = 1.0234
New lambda: 4.2168e-088
iter: 4045, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076318
iter: 4045, Minibatch log likelihood (post-update): -54.2977, error rate (post-update): 0.076316

size_minibatch = 20000
Precon grad coeff: 0.020959, velocity coeff: 0.93333
norm(ch) = 0.31132
iter: 4046, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076316

size_minibatch = 20000
Precon grad coeff: 0.019714, velocity coeff: 0.96631
norm(ch) = 0.30118
iter: 4047, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076313

size_minibatch = 20000
Precon grad coeff: 0.019097, velocity coeff: 1.019
norm(ch) = 0.30725
iter: 4048, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076312

size_minibatch = 20000
Precon grad coeff: 0.021805, velocity coeff: 1.0155
norm(ch) = 0.31241
iter: 4049, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076307

size_minibatch = 20000
Precon grad coeff: 0.019897, velocity coeff: 0.97078
norm(ch) = 0.30373
rho = 1.1092
New lambda: 3.2629e-088
iter: 4050, Minibatch log likelihood (pre-update): -54.2977, error rate (pre-update): 0.076306
iter: 4050, Minibatch log likelihood (post-update): -54.2976, error rate (post-update): 0.076302
---
Full log-likelihood: -54.2976, error rate: 0.076303
TEST log-likelihood: -55.371, error rate: 0.42025
Error difference (test - train): 0.34395
---
Full log-likelihood (averaged params): -54.3015, error rate (averaged params): 0.078077
TEST log-likelihood (averaged params): -55.3384, error rate (averaged params): 0.41241
Error difference (test - train) (averaged params): 0.33433

size_minibatch = 20000
Precon grad coeff: 0.019839, velocity coeff: 1.0155
norm(ch) = 0.30881
iter: 4051, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076303

size_minibatch = 20000
Precon grad coeff: 0.02074, velocity coeff: 1.0007
norm(ch) = 0.30941
iter: 4052, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076301

size_minibatch = 20000
Precon grad coeff: 0.019186, velocity coeff: 0.98602
norm(ch) = 0.30544
iter: 4053, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076297

size_minibatch = 20000
Precon grad coeff: 0.021381, velocity coeff: 1.0399
norm(ch) = 0.3181
iter: 4054, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076296

size_minibatch = 20000
Precon grad coeff: 0.019957, velocity coeff: 1.0002
norm(ch) = 0.31851
rho = 0.94862
New lambda: 2.5248e-088
iter: 4055, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076292
iter: 4055, Minibatch log likelihood (post-update): -54.2976, error rate (post-update): 0.076292

size_minibatch = 20000
Precon grad coeff: 0.019721, velocity coeff: 0.98237
norm(ch) = 0.31324
iter: 4056, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076292

size_minibatch = 20000
Precon grad coeff: 0.01972, velocity coeff: 1.0102
norm(ch) = 0.31679
iter: 4057, Minibatch log likelihood (pre-update): -54.2976, error rate (pre-update): 0.076288

size_minibatch = 20000
Precon grad coeff: 0.020061, velocity coeff: 1.009
norm(ch) = 0.32006
iter: 4058, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076288

size_minibatch = 20000
Precon grad coeff: 0.020709, velocity coeff: 0.97684
norm(ch) = 0.31302
iter: 4059, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076286

size_minibatch = 20000
Precon grad coeff: 0.017145, velocity coeff: 0.92677
New gamma: 0.0088212
norm(ch) = 0.29041
rho = 0.91614
New lambda: 1.9536e-088
iter: 4060, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076285
iter: 4060, Minibatch log likelihood (post-update): -54.2975, error rate (post-update): 0.076279

size_minibatch = 20000
Precon grad coeff: 0.018781, velocity coeff: 1.1245
norm(ch) = 0.32688
iter: 4061, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076279

size_minibatch = 20000
Precon grad coeff: 0.020066, velocity coeff: 0.95468
norm(ch) = 0.31244
iter: 4062, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076276

size_minibatch = 20000
Precon grad coeff: 0.01728, velocity coeff: 0.9364
norm(ch) = 0.29283
iter: 4063, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076274

size_minibatch = 20000
Precon grad coeff: 0.01841, velocity coeff: 1.0477
norm(ch) = 0.30711
iter: 4064, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076274

size_minibatch = 20000
Precon grad coeff: 0.018968, velocity coeff: 1.0194
norm(ch) = 0.31335
rho = 0.96813
New lambda: 1.5117e-088
iter: 4065, Minibatch log likelihood (pre-update): -54.2975, error rate (pre-update): 0.076269
iter: 4065, Minibatch log likelihood (post-update): -54.2974, error rate (post-update): 0.076268

size_minibatch = 20000
Precon grad coeff: 0.018247, velocity coeff: 0.93356
norm(ch) = 0.29286
iter: 4066, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076268

size_minibatch = 20000
Precon grad coeff: 0.017703, velocity coeff: 1.0332
norm(ch) = 0.30279
iter: 4067, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076266

size_minibatch = 20000
Precon grad coeff: 0.01898, velocity coeff: 0.98625
norm(ch) = 0.29892
iter: 4068, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076267

size_minibatch = 20000
Precon grad coeff: 0.018641, velocity coeff: 0.98912
norm(ch) = 0.29595
iter: 4069, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076262

size_minibatch = 20000
Precon grad coeff: 0.016275, velocity coeff: 0.93588
norm(ch) = 0.27727
rho = 1.0572
New lambda: 1.1697e-088
iter: 4070, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076258
iter: 4070, Minibatch log likelihood (post-update): -54.2974, error rate (post-update): 0.076254

size_minibatch = 20000
Precon grad coeff: 0.020194, velocity coeff: 1.1187
norm(ch) = 0.3104
iter: 4071, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076254

size_minibatch = 20000
Precon grad coeff: 0.018712, velocity coeff: 0.91819
norm(ch) = 0.28531
iter: 4072, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076255

size_minibatch = 20000
Precon grad coeff: 0.016707, velocity coeff: 0.99772
norm(ch) = 0.28493
iter: 4073, Minibatch log likelihood (pre-update): -54.2974, error rate (pre-update): 0.076252

size_minibatch = 20000
Precon grad coeff: 0.018683, velocity coeff: 1.0396
norm(ch) = 0.29655
iter: 4074, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076249

size_minibatch = 20000
Precon grad coeff: 0.019128, velocity coeff: 1.0284
norm(ch) = 0.30518
rho = 0.98802
New lambda: 9.0509e-089
iter: 4075, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076246
iter: 4075, Minibatch log likelihood (post-update): -54.2973, error rate (post-update): 0.076246

size_minibatch = 20000
Precon grad coeff: 0.017275, velocity coeff: 0.91843
norm(ch) = 0.28054
iter: 4076, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076246

size_minibatch = 20000
Precon grad coeff: 0.018445, velocity coeff: 1.1183
norm(ch) = 0.31399
iter: 4077, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076241

size_minibatch = 20000
Precon grad coeff: 0.018071, velocity coeff: 0.9477
norm(ch) = 0.29787
iter: 4078, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076238

size_minibatch = 20000
Precon grad coeff: 0.018629, velocity coeff: 1.0038
norm(ch) = 0.29923
iter: 4079, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076237

size_minibatch = 20000
Precon grad coeff: 0.017898, velocity coeff: 0.96774
New gamma: 0.014733
norm(ch) = 0.28971
rho = 1.0359
New lambda: 7.0034e-089
iter: 4080, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.07624
iter: 4080, Minibatch log likelihood (post-update): -54.2973, error rate (post-update): 0.076237

size_minibatch = 20000
Precon grad coeff: 0.019564, velocity coeff: 0.96892
norm(ch) = 0.28083
iter: 4081, Minibatch log likelihood (pre-update): -54.2973, error rate (pre-update): 0.076237

size_minibatch = 20000
Precon grad coeff: 0.020644, velocity coeff: 1.0111
norm(ch) = 0.2841
iter: 4082, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076233

size_minibatch = 20000
Precon grad coeff: 0.018171, velocity coeff: 0.93594
norm(ch) = 0.26603
iter: 4083, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076226

size_minibatch = 20000
Precon grad coeff: 0.018065, velocity coeff: 0.96262
norm(ch) = 0.25619
iter: 4084, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076227

size_minibatch = 20000
Precon grad coeff: 0.020926, velocity coeff: 0.98133
norm(ch) = 0.25151
rho = 0.62401
New lambda: 7.0034e-089
iter: 4085, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076226
iter: 4085, Minibatch log likelihood (post-update): -54.2972, error rate (post-update): 0.076225

size_minibatch = 20000
Precon grad coeff: 0.017839, velocity coeff: 0.89297
norm(ch) = 0.22469
iter: 4086, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076225

size_minibatch = 20000
Precon grad coeff: 0.019979, velocity coeff: 1.1077
norm(ch) = 0.24901
iter: 4087, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.07622

size_minibatch = 20000
Precon grad coeff: 0.018819, velocity coeff: 0.85246
norm(ch) = 0.21236
iter: 4088, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076219

size_minibatch = 20000
Precon grad coeff: 0.019988, velocity coeff: 1.1079
norm(ch) = 0.23538
iter: 4089, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076219

size_minibatch = 20000
Precon grad coeff: 0.018831, velocity coeff: 0.99829
norm(ch) = 0.23508
rho = 1.0011
New lambda: 5.4191e-089
iter: 4090, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076219
iter: 4090, Minibatch log likelihood (post-update): -54.2972, error rate (post-update): 0.076214

size_minibatch = 20000
Precon grad coeff: 0.02066, velocity coeff: 1.0588
norm(ch) = 0.24901
iter: 4091, Minibatch log likelihood (pre-update): -54.2972, error rate (pre-update): 0.076214

size_minibatch = 20000
Precon grad coeff: 0.018264, velocity coeff: 0.9251
norm(ch) = 0.23047
iter: 4092, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076212

size_minibatch = 20000
Precon grad coeff: 0.020539, velocity coeff: 1.1549
norm(ch) = 0.2663
iter: 4093, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076209

size_minibatch = 20000
Precon grad coeff: 0.019209, velocity coeff: 0.94433
norm(ch) = 0.25157
iter: 4094, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076209

size_minibatch = 20000
Precon grad coeff: 0.018009, velocity coeff: 0.93088
norm(ch) = 0.23426
rho = 0.83094
New lambda: 4.1932e-089
iter: 4095, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076206
iter: 4095, Minibatch log likelihood (post-update): -54.2971, error rate (post-update): 0.076206

size_minibatch = 20000
Precon grad coeff: 0.021148, velocity coeff: 1.1688
norm(ch) = 0.27391
iter: 4096, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076206

size_minibatch = 20000
Precon grad coeff: 0.018907, velocity coeff: 0.93942
norm(ch) = 0.25741
iter: 4097, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076204

size_minibatch = 20000
Precon grad coeff: 0.018055, velocity coeff: 0.95786
norm(ch) = 0.24662
iter: 4098, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076203

size_minibatch = 20000
Precon grad coeff: 0.019009, velocity coeff: 1.0199
norm(ch) = 0.2516
iter: 4099, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076199

size_minibatch = 20000
Precon grad coeff: 0.019386, velocity coeff: 1.0843
New gamma: 0.0088212
norm(ch) = 0.27299
rho = 1.1526
New lambda: 3.2446e-089
iter: 4100, Minibatch log likelihood (pre-update): -54.2971, error rate (pre-update): 0.076198
iter: 4100, Minibatch log likelihood (post-update): -54.297, error rate (post-update): 0.076193
---
Full log-likelihood: -54.297, error rate: 0.076193
TEST log-likelihood: -55.3791, error rate: 0.42225
Error difference (test - train): 0.34606
---
Full log-likelihood (averaged params): -54.3003, error rate (averaged params): 0.07776
TEST log-likelihood (averaged params): -55.3474, error rate (averaged params): 0.41456
Error difference (test - train) (averaged params): 0.3368

size_minibatch = 20000
Precon grad coeff: 0.014749, velocity coeff: 0.85728
norm(ch) = 0.23421
iter: 4101, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076193

size_minibatch = 20000
Precon grad coeff: 0.017432, velocity coeff: 1.2097
norm(ch) = 0.2835
iter: 4102, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076192

size_minibatch = 20000
Precon grad coeff: 0.019286, velocity coeff: 1.0401
norm(ch) = 0.29504
iter: 4103, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.07619

size_minibatch = 20000
Precon grad coeff: 0.01527, velocity coeff: 0.93937
norm(ch) = 0.27733
iter: 4104, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076188

size_minibatch = 20000
Precon grad coeff: 0.017449, velocity coeff: 1.1391
norm(ch) = 0.31613
rho = 0.83574
New lambda: 2.5106e-089
iter: 4105, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076185
iter: 4105, Minibatch log likelihood (post-update): -54.297, error rate (post-update): 0.076184

size_minibatch = 20000
Precon grad coeff: 0.016639, velocity coeff: 0.90011
norm(ch) = 0.28478
iter: 4106, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076184

size_minibatch = 20000
Precon grad coeff: 0.017201, velocity coeff: 1.1129
norm(ch) = 0.31703
iter: 4107, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076183

size_minibatch = 20000
Precon grad coeff: 0.015895, velocity coeff: 0.95309
norm(ch) = 0.30233
iter: 4108, Minibatch log likelihood (pre-update): -54.297, error rate (pre-update): 0.076182

size_minibatch = 20000
Precon grad coeff: 0.016885, velocity coeff: 0.94133
norm(ch) = 0.28479
iter: 4109, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076177

size_minibatch = 20000
Precon grad coeff: 0.015621, velocity coeff: 0.95988
norm(ch) = 0.27363
rho = 1.0411
New lambda: 1.9427e-089
iter: 4110, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076174
iter: 4110, Minibatch log likelihood (post-update): -54.2969, error rate (post-update): 0.076171

size_minibatch = 20000
Precon grad coeff: 0.016865, velocity coeff: 1.1144
norm(ch) = 0.30512
iter: 4111, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076171

size_minibatch = 20000
Precon grad coeff: 0.018366, velocity coeff: 0.88794
norm(ch) = 0.27118
iter: 4112, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076171

size_minibatch = 20000
Precon grad coeff: 0.014555, velocity coeff: 0.99607
norm(ch) = 0.27033
iter: 4113, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076169

size_minibatch = 20000
Precon grad coeff: 0.017527, velocity coeff: 1.0358
norm(ch) = 0.28029
iter: 4114, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076168

size_minibatch = 20000
Precon grad coeff: 0.017401, velocity coeff: 1.0563
norm(ch) = 0.29631
rho = 1.1101
New lambda: 1.5032e-089
iter: 4115, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076164
iter: 4115, Minibatch log likelihood (post-update): -54.2969, error rate (post-update): 0.076161

size_minibatch = 20000
Precon grad coeff: 0.015509, velocity coeff: 0.89162
norm(ch) = 0.26442
iter: 4116, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076161

size_minibatch = 20000
Precon grad coeff: 0.016293, velocity coeff: 1.1094
norm(ch) = 0.29359
iter: 4117, Minibatch log likelihood (pre-update): -54.2969, error rate (pre-update): 0.076159

size_minibatch = 20000
Precon grad coeff: 0.01863, velocity coeff: 1.0458
norm(ch) = 0.3074
iter: 4118, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076159

size_minibatch = 20000
Precon grad coeff: 0.015331, velocity coeff: 0.87893
norm(ch) = 0.27046
iter: 4119, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076154

size_minibatch = 20000
Precon grad coeff: 0.017845, velocity coeff: 1.1671
New gamma: 0.0088212
norm(ch) = 0.31597
rho = 0.94917
New lambda: 1.1632e-089
iter: 4120, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076153
iter: 4120, Minibatch log likelihood (post-update): -54.2968, error rate (post-update): 0.076151

size_minibatch = 20000
Precon grad coeff: 0.020697, velocity coeff: 0.94758
norm(ch) = 0.29972
iter: 4121, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076151

size_minibatch = 20000
Precon grad coeff: 0.016579, velocity coeff: 0.90607
norm(ch) = 0.27188
iter: 4122, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076151

size_minibatch = 20000
Precon grad coeff: 0.018736, velocity coeff: 1.1058
norm(ch) = 0.30105
iter: 4123, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076145

size_minibatch = 20000
Precon grad coeff: 0.017792, velocity coeff: 0.93911
norm(ch) = 0.28313
iter: 4124, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076142

size_minibatch = 20000
Precon grad coeff: 0.020329, velocity coeff: 1.0893
norm(ch) = 0.30879
rho = 1.1163
New lambda: 9.0003e-090
iter: 4125, Minibatch log likelihood (pre-update): -54.2968, error rate (pre-update): 0.076141
iter: 4125, Minibatch log likelihood (post-update): -54.2967, error rate (post-update): 0.076143

size_minibatch = 20000
Precon grad coeff: 0.016193, velocity coeff: 0.88583
norm(ch) = 0.27386
iter: 4126, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076143

size_minibatch = 20000
Precon grad coeff: 0.019758, velocity coeff: 1.2006
norm(ch) = 0.32918
iter: 4127, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076139

size_minibatch = 20000
Precon grad coeff: 0.018864, velocity coeff: 0.90397
norm(ch) = 0.29799
iter: 4128, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076133

size_minibatch = 20000
Precon grad coeff: 0.017475, velocity coeff: 1.0125
norm(ch) = 0.30207
iter: 4129, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076129

size_minibatch = 20000
Precon grad coeff: 0.018103, velocity coeff: 0.984
norm(ch) = 0.29759
rho = 1.1516
New lambda: 6.9642e-090
iter: 4130, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.07613
iter: 4130, Minibatch log likelihood (post-update): -54.2967, error rate (post-update): 0.076131

size_minibatch = 20000
Precon grad coeff: 0.018336, velocity coeff: 1.0338
norm(ch) = 0.30803
iter: 4131, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076131

size_minibatch = 20000
Precon grad coeff: 0.018934, velocity coeff: 0.99102
norm(ch) = 0.30568
iter: 4132, Minibatch log likelihood (pre-update): -54.2967, error rate (pre-update): 0.076132

size_minibatch = 20000
Precon grad coeff: 0.016453, velocity coeff: 0.95304
norm(ch) = 0.29167
iter: 4133, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076126

size_minibatch = 20000
Precon grad coeff: 0.019434, velocity coeff: 1.0587
norm(ch) = 0.3092
iter: 4134, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076122

size_minibatch = 20000
Precon grad coeff: 0.017902, velocity coeff: 0.96718
norm(ch) = 0.2994
rho = 1.1367
New lambda: 5.3888e-090
iter: 4135, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076119
iter: 4135, Minibatch log likelihood (post-update): -54.2966, error rate (post-update): 0.076119

size_minibatch = 20000
Precon grad coeff: 0.017742, velocity coeff: 0.97481
norm(ch) = 0.2922
iter: 4136, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076119

size_minibatch = 20000
Precon grad coeff: 0.01776, velocity coeff: 1.0184
norm(ch) = 0.29796
iter: 4137, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076115

size_minibatch = 20000
Precon grad coeff: 0.017539, velocity coeff: 0.96999
norm(ch) = 0.28945
iter: 4138, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076112

size_minibatch = 20000
Precon grad coeff: 0.019006, velocity coeff: 1.0549
norm(ch) = 0.30564
iter: 4139, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076109

size_minibatch = 20000
Precon grad coeff: 0.015602, velocity coeff: 0.91462
New gamma: 0.0052816
norm(ch) = 0.2802
rho = 0.81547
New lambda: 4.1697e-090
iter: 4140, Minibatch log likelihood (pre-update): -54.2966, error rate (pre-update): 0.076109
iter: 4140, Minibatch log likelihood (post-update): -54.2965, error rate (post-update): 0.076108

size_minibatch = 20000
Precon grad coeff: 0.016321, velocity coeff: 1.1016
norm(ch) = 0.3094
iter: 4141, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076108

size_minibatch = 20000
Precon grad coeff: 0.013858, velocity coeff: 0.92063
norm(ch) = 0.28557
iter: 4142, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076107

size_minibatch = 20000
Precon grad coeff: 0.01738, velocity coeff: 1.227
norm(ch) = 0.35106
iter: 4143, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076101

size_minibatch = 20000
Precon grad coeff: 0.016037, velocity coeff: 0.96423
norm(ch) = 0.33922
iter: 4144, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076099

size_minibatch = 20000
Precon grad coeff: 0.015359, velocity coeff: 0.99577
norm(ch) = 0.33846
rho = 0.89549
New lambda: 3.2265e-090
iter: 4145, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.0761
iter: 4145, Minibatch log likelihood (post-update): -54.2965, error rate (post-update): 0.076101

size_minibatch = 20000
Precon grad coeff: 0.014214, velocity coeff: 1.0483
norm(ch) = 0.35543
iter: 4146, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076101

size_minibatch = 20000
Precon grad coeff: 0.017381, velocity coeff: 1.0822
norm(ch) = 0.38534
iter: 4147, Minibatch log likelihood (pre-update): -54.2965, error rate (pre-update): 0.076094

size_minibatch = 20000
Precon grad coeff: 0.014078, velocity coeff: 0.84154
norm(ch) = 0.32496
iter: 4148, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076092

size_minibatch = 20000
Precon grad coeff: 0.015469, velocity coeff: 1.0674
norm(ch) = 0.34749
iter: 4149, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076091

size_minibatch = 20000
Precon grad coeff: 0.015987, velocity coeff: 0.99675
norm(ch) = 0.34695
rho = 1.1836
New lambda: 2.4966e-090
iter: 4150, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076089
iter: 4150, Minibatch log likelihood (post-update): -54.2964, error rate (post-update): 0.076083
---
Full log-likelihood: -54.2964, error rate: 0.076083
TEST log-likelihood: -55.3912, error rate: 0.42518
Error difference (test - train): 0.3491
---
Full log-likelihood (averaged params): -54.2993, error rate (averaged params): 0.077481
TEST log-likelihood (averaged params): -55.3564, error rate (averaged params): 0.41673
Error difference (test - train) (averaged params): 0.33925

size_minibatch = 20000
Precon grad coeff: 0.013858, velocity coeff: 0.88732
norm(ch) = 0.30839
iter: 4151, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076083

size_minibatch = 20000
Precon grad coeff: 0.01638, velocity coeff: 1.1517
norm(ch) = 0.35591
iter: 4152, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076083

size_minibatch = 20000
Precon grad coeff: 0.015289, velocity coeff: 0.87953
norm(ch) = 0.3137
iter: 4153, Minibatch log likelihood (pre-update): -54.2964, error rate (pre-update): 0.076083

size_minibatch = 20000
Precon grad coeff: 0.014471, velocity coeff: 1.0216
norm(ch) = 0.32101
iter: 4154, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076081

size_minibatch = 20000
Precon grad coeff: 0.015269, velocity coeff: 1.0365
norm(ch) = 0.33326
rho = 1.1047
New lambda: 1.9318e-090
iter: 4155, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076076
iter: 4155, Minibatch log likelihood (post-update): -54.2963, error rate (post-update): 0.076073

size_minibatch = 20000
Precon grad coeff: 0.014792, velocity coeff: 0.96739
norm(ch) = 0.32301
iter: 4156, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076073

size_minibatch = 20000
Precon grad coeff: 0.017721, velocity coeff: 1.1061
norm(ch) = 0.35796
iter: 4157, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076071

size_minibatch = 20000
Precon grad coeff: 0.011452, velocity coeff: 0.76771
norm(ch) = 0.27535
iter: 4158, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076073

size_minibatch = 20000
Precon grad coeff: 0.018534, velocity coeff: 1.2927
norm(ch) = 0.35658
iter: 4159, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076071

size_minibatch = 20000
Precon grad coeff: 0.016156, velocity coeff: 0.93614
New gamma: 0.0031623
norm(ch) = 0.335
rho = 0.83241
New lambda: 1.4948e-090
iter: 4160, Minibatch log likelihood (pre-update): -54.2963, error rate (pre-update): 0.076067
iter: 4160, Minibatch log likelihood (post-update): -54.2962, error rate (post-update): 0.076066

size_minibatch = 20000
Precon grad coeff: 0.014139, velocity coeff: 0.98971
norm(ch) = 0.33262
iter: 4161, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076066

size_minibatch = 20000
Precon grad coeff: 0.010921, velocity coeff: 0.97194
norm(ch) = 0.32426
iter: 4162, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076068

size_minibatch = 20000
Precon grad coeff: 0.017811, velocity coeff: 1.3088
norm(ch) = 0.42559
iter: 4163, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076066

size_minibatch = 20000
Precon grad coeff: 0.017231, velocity coeff: 0.98232
norm(ch) = 0.41952
iter: 4164, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076058

size_minibatch = 20000
Precon grad coeff: 0.012799, velocity coeff: 0.82473
norm(ch) = 0.34703
rho = 0.99959
New lambda: 1.1566e-090
iter: 4165, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076058
iter: 4165, Minibatch log likelihood (post-update): -54.2962, error rate (post-update): 0.076058

size_minibatch = 20000
Precon grad coeff: 0.011731, velocity coeff: 1.1944
norm(ch) = 0.41532
iter: 4166, Minibatch log likelihood (pre-update): -54.2962, error rate (pre-update): 0.076058

size_minibatch = 20000
Precon grad coeff: 0.02016, velocity coeff: 1.1076
norm(ch) = 0.46143
iter: 4167, Minibatch log likelihood (pre-update): -54.2961, error rate (pre-update): 0.076054

size_minibatch = 20000
Precon grad coeff: 0.011609, velocity coeff: 0.69324
norm(ch) = 0.32098
iter: 4168, Minibatch log likelihood (pre-update): -54.2961, error rate (pre-update): 0.076048

size_minibatch = 20000
Precon grad coeff: 0.013567, velocity coeff: 1.1512
norm(ch) = 0.3703
iter: 4169, Minibatch log likelihood (pre-update): -54.2961, error rate (pre-update): 0.076047

size_minibatch = 20000
Precon grad coeff: 0.014294, velocity coeff: 0.99593
norm(ch) = 0.36979
rho = 0.8729
New lambda: 8.9499e-091
iter: 4170, Minibatch log likelihood (pre-update): -54.2961, error rate (pre-update): 0.07605
iter: 4170, Minibatch log likelihood (post-update): -54.2961, error rate (post-update): 0.076046

size_minibatch = 20000
Precon grad coeff: 0.015042, velocity coeff: 0.92958
norm(ch) = 0.34488
iter: 4171, Minibatch log likelihood (pre-update): -54.2961, error rate (pre-update): 0.076046

size_minibatch = 20000
Precon grad coeff: 0.011686, velocity coeff: 0.95837
norm(ch) = 0.3315
iter: 4172, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076042

size_minibatch = 20000
Precon grad coeff: 0.013807, velocity coeff: 1.0972
norm(ch) = 0.36456
iter: 4173, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076039

size_minibatch = 20000
Precon grad coeff: 0.018731, velocity coeff: 1.1465
norm(ch) = 0.41931
iter: 4174, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076039

size_minibatch = 20000
Precon grad coeff: 0.012445, velocity coeff: 0.73736
norm(ch) = 0.31013
rho = 1.1636
New lambda: 6.9252e-091
iter: 4175, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076036
iter: 4175, Minibatch log likelihood (post-update): -54.296, error rate (post-update): 0.076035

size_minibatch = 20000
Precon grad coeff: 0.012087, velocity coeff: 1.2337
norm(ch) = 0.38335
iter: 4176, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076035

size_minibatch = 20000
Precon grad coeff: 0.016643, velocity coeff: 1.0594
norm(ch) = 0.4071
iter: 4177, Minibatch log likelihood (pre-update): -54.296, error rate (pre-update): 0.076033

size_minibatch = 20000
Precon grad coeff: 0.014093, velocity coeff: 0.86148
norm(ch) = 0.35171
iter: 4178, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.076032

size_minibatch = 20000
Precon grad coeff: 0.012946, velocity coeff: 0.96844
norm(ch) = 0.3413
iter: 4179, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.07603

size_minibatch = 20000
Precon grad coeff: 0.012412, velocity coeff: 1.0036
New gamma: 0.0031623
norm(ch) = 0.34311
rho = 1.1232
New lambda: 5.3586e-091
iter: 4180, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.076028
iter: 4180, Minibatch log likelihood (post-update): -54.2959, error rate (post-update): 0.076024

size_minibatch = 20000
Precon grad coeff: 0.015439, velocity coeff: 1.1542
norm(ch) = 0.39686
iter: 4181, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.076024

size_minibatch = 20000
Precon grad coeff: 0.011947, velocity coeff: 0.76642
norm(ch) = 0.30509
iter: 4182, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.076025

size_minibatch = 20000
Precon grad coeff: 0.014746, velocity coeff: 1.2787
norm(ch) = 0.39068
iter: 4183, Minibatch log likelihood (pre-update): -54.2959, error rate (pre-update): 0.076025

size_minibatch = 20000
Precon grad coeff: 0.01425, velocity coeff: 0.88699
norm(ch) = 0.3472
iter: 4184, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.076021

size_minibatch = 20000
Precon grad coeff: 0.012665, velocity coeff: 1.0102
norm(ch) = 0.35139
rho = 0.90821
New lambda: 4.1464e-091
iter: 4185, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.076018
iter: 4185, Minibatch log likelihood (post-update): -54.2958, error rate (post-update): 0.076018

size_minibatch = 20000
Precon grad coeff: 0.0127, velocity coeff: 1.0245
norm(ch) = 0.36072
iter: 4186, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.076018

size_minibatch = 20000
Precon grad coeff: 0.014471, velocity coeff: 1.0108
norm(ch) = 0.36531
iter: 4187, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.076015

size_minibatch = 20000
Precon grad coeff: 0.012935, velocity coeff: 0.95701
norm(ch) = 0.3502
iter: 4188, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.07601

size_minibatch = 20000
Precon grad coeff: 0.012056, velocity coeff: 0.93122
norm(ch) = 0.32663
iter: 4189, Minibatch log likelihood (pre-update): -54.2958, error rate (pre-update): 0.076007

size_minibatch = 20000
Precon grad coeff: 0.014549, velocity coeff: 1.146
norm(ch) = 0.37499
rho = 0.89293
New lambda: 3.2084e-091
iter: 4190, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.076009
iter: 4190, Minibatch log likelihood (post-update): -54.2957, error rate (post-update): 0.076007

size_minibatch = 20000
Precon grad coeff: 0.014128, velocity coeff: 0.9082
norm(ch) = 0.34129
iter: 4191, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.076007

size_minibatch = 20000
Precon grad coeff: 0.010352, velocity coeff: 0.89468
norm(ch) = 0.30588
iter: 4192, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.076006

size_minibatch = 20000
Precon grad coeff: 0.015117, velocity coeff: 1.1973
norm(ch) = 0.36672
iter: 4193, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.076005

size_minibatch = 20000
Precon grad coeff: 0.015518, velocity coeff: 0.88573
norm(ch) = 0.32564
iter: 4194, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.076003

size_minibatch = 20000
Precon grad coeff: 0.011972, velocity coeff: 1.0077
norm(ch) = 0.32877
rho = 0.92219
New lambda: 2.4826e-091
iter: 4195, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.075997
iter: 4195, Minibatch log likelihood (post-update): -54.2957, error rate (post-update): 0.075995

size_minibatch = 20000
Precon grad coeff: 0.012127, velocity coeff: 0.96741
norm(ch) = 0.31875
iter: 4196, Minibatch log likelihood (pre-update): -54.2957, error rate (pre-update): 0.075995

size_minibatch = 20000
Precon grad coeff: 0.01547, velocity coeff: 1.1994
norm(ch) = 0.38309
iter: 4197, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075998

size_minibatch = 20000
Precon grad coeff: 0.014766, velocity coeff: 0.89425
norm(ch) = 0.34339
iter: 4198, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075998

size_minibatch = 20000
Precon grad coeff: 0.011247, velocity coeff: 0.96214
norm(ch) = 0.33086
iter: 4199, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075991

size_minibatch = 20000
Precon grad coeff: 0.015263, velocity coeff: 1.2288
New gamma: 0.0031623
norm(ch) = 0.40726
rho = 0.79589
New lambda: 1.921e-091
iter: 4200, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075986
iter: 4200, Minibatch log likelihood (post-update): -54.2956, error rate (post-update): 0.075985
---
Full log-likelihood: -54.2956, error rate: 0.075985
TEST log-likelihood: -55.4087, error rate: 0.42949
Error difference (test - train): 0.3535
---
Full log-likelihood (averaged params): -54.2985, error rate (averaged params): 0.077336
TEST log-likelihood (averaged params): -55.3668, error rate (averaged params): 0.41925
Error difference (test - train) (averaged params): 0.34192

size_minibatch = 20000
Precon grad coeff: 0.015918, velocity coeff: 0.87769
norm(ch) = 0.35835
iter: 4201, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075985

size_minibatch = 20000
Precon grad coeff: 0.0097933, velocity coeff: 0.86201
norm(ch) = 0.30949
iter: 4202, Minibatch log likelihood (pre-update): -54.2956, error rate (pre-update): 0.075988

size_minibatch = 20000
Precon grad coeff: 0.015521, velocity coeff: 1.236
norm(ch) = 0.38297
iter: 4203, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075988

size_minibatch = 20000
Precon grad coeff: 0.016526, velocity coeff: 0.90739
norm(ch) = 0.34828
iter: 4204, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075982

size_minibatch = 20000
Precon grad coeff: 0.012102, velocity coeff: 0.85525
norm(ch) = 0.29855
rho = 1.0012
New lambda: 1.4864e-091
iter: 4205, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075981
iter: 4205, Minibatch log likelihood (post-update): -54.2955, error rate (post-update): 0.075984

size_minibatch = 20000
Precon grad coeff: 0.011371, velocity coeff: 1.0358
norm(ch) = 0.30995
iter: 4206, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075984

size_minibatch = 20000
Precon grad coeff: 0.015599, velocity coeff: 1.1311
norm(ch) = 0.35123
iter: 4207, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075983

size_minibatch = 20000
Precon grad coeff: 0.018927, velocity coeff: 1.097
norm(ch) = 0.38622
iter: 4208, Minibatch log likelihood (pre-update): -54.2955, error rate (pre-update): 0.075974

size_minibatch = 20000
Precon grad coeff: 0.012316, velocity coeff: 0.73063
norm(ch) = 0.2829
iter: 4209, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075972

size_minibatch = 20000
Precon grad coeff: 0.011065, velocity coeff: 1.2141
norm(ch) = 0.34393
rho = 0.94938
New lambda: 1.1502e-091
iter: 4210, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075975
iter: 4210, Minibatch log likelihood (post-update): -54.2954, error rate (post-update): 0.075975

size_minibatch = 20000
Precon grad coeff: 0.019277, velocity coeff: 1.2249
norm(ch) = 0.42212
iter: 4211, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075975

size_minibatch = 20000
Precon grad coeff: 0.017155, velocity coeff: 0.84725
norm(ch) = 0.35857
iter: 4212, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075966

size_minibatch = 20000
Precon grad coeff: 0.011229, velocity coeff: 0.84654
norm(ch) = 0.3042
iter: 4213, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075963

size_minibatch = 20000
Precon grad coeff: 0.013165, velocity coeff: 1.1936
norm(ch) = 0.36346
iter: 4214, Minibatch log likelihood (pre-update): -54.2954, error rate (pre-update): 0.075965

size_minibatch = 20000
Precon grad coeff: 0.01571, velocity coeff: 1.0671
norm(ch) = 0.38855
rho = 0.97948
New lambda: 8.8998e-092
iter: 4215, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075964
iter: 4215, Minibatch log likelihood (post-update): -54.2953, error rate (post-update): 0.075961

size_minibatch = 20000
Precon grad coeff: 0.014315, velocity coeff: 0.90293
norm(ch) = 0.35149
iter: 4216, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075961

size_minibatch = 20000
Precon grad coeff: 0.011955, velocity coeff: 0.92166
norm(ch) = 0.32457
iter: 4217, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075955

size_minibatch = 20000
Precon grad coeff: 0.012638, velocity coeff: 1.1418
norm(ch) = 0.37094
iter: 4218, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075954

size_minibatch = 20000
Precon grad coeff: 0.016246, velocity coeff: 0.98022
norm(ch) = 0.36421
iter: 4219, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075955

size_minibatch = 20000
Precon grad coeff: 0.014195, velocity coeff: 0.81756
New gamma: 0.0052816
norm(ch) = 0.29802
rho = 1.0456
New lambda: 6.8865e-092
iter: 4220, Minibatch log likelihood (pre-update): -54.2953, error rate (pre-update): 0.075953
iter: 4220, Minibatch log likelihood (post-update): -54.2952, error rate (post-update): 0.075948

size_minibatch = 20000
Precon grad coeff: 0.01506, velocity coeff: 1.0059
norm(ch) = 0.3001
iter: 4221, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075948

size_minibatch = 20000
Precon grad coeff: 0.020793, velocity coeff: 1.16
norm(ch) = 0.34853
iter: 4222, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075948

size_minibatch = 20000
Precon grad coeff: 0.020107, velocity coeff: 0.84157
norm(ch) = 0.29384
iter: 4223, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075946

size_minibatch = 20000
Precon grad coeff: 0.013023, velocity coeff: 0.85612
norm(ch) = 0.25187
iter: 4224, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075945

size_minibatch = 20000
Precon grad coeff: 0.018493, velocity coeff: 1.2451
norm(ch) = 0.31403
rho = 1.2584
New lambda: 5.3286e-092
iter: 4225, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075942
iter: 4225, Minibatch log likelihood (post-update): -54.2952, error rate (post-update): 0.075942

size_minibatch = 20000
Precon grad coeff: 0.020999, velocity coeff: 1.1146
norm(ch) = 0.35049
iter: 4226, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075942

size_minibatch = 20000
Precon grad coeff: 0.020062, velocity coeff: 0.87365
norm(ch) = 0.30675
iter: 4227, Minibatch log likelihood (pre-update): -54.2952, error rate (pre-update): 0.075938

size_minibatch = 20000
Precon grad coeff: 0.013041, velocity coeff: 0.97766
norm(ch) = 0.30018
iter: 4228, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075936

size_minibatch = 20000
Precon grad coeff: 0.019091, velocity coeff: 1.1582
norm(ch) = 0.34814
iter: 4229, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075934

size_minibatch = 20000
Precon grad coeff: 0.021535, velocity coeff: 1.0359
norm(ch) = 0.36106
rho = 0.97631
New lambda: 4.1232e-092
iter: 4230, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075936
iter: 4230, Minibatch log likelihood (post-update): -54.2951, error rate (post-update): 0.075933

size_minibatch = 20000
Precon grad coeff: 0.01687, velocity coeff: 0.87082
norm(ch) = 0.31485
iter: 4231, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075933

size_minibatch = 20000
Precon grad coeff: 0.013882, velocity coeff: 0.9593
norm(ch) = 0.30226
iter: 4232, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.07593

size_minibatch = 20000
Precon grad coeff: 0.018072, velocity coeff: 1.1553
norm(ch) = 0.34961
iter: 4233, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075926

size_minibatch = 20000
Precon grad coeff: 0.020426, velocity coeff: 0.96773
norm(ch) = 0.33867
iter: 4234, Minibatch log likelihood (pre-update): -54.2951, error rate (pre-update): 0.075925

size_minibatch = 20000
Precon grad coeff: 0.017495, velocity coeff: 0.91325
norm(ch) = 0.3097
rho = 0.93537
New lambda: 3.1904e-092
iter: 4235, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.075919
iter: 4235, Minibatch log likelihood (post-update): -54.295, error rate (post-update): 0.07592

size_minibatch = 20000
Precon grad coeff: 0.013225, velocity coeff: 0.8967
norm(ch) = 0.27794
iter: 4236, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.07592

size_minibatch = 20000
Precon grad coeff: 0.019551, velocity coeff: 1.217
norm(ch) = 0.33878
iter: 4237, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.075919

size_minibatch = 20000
Precon grad coeff: 0.020814, velocity coeff: 1.002
norm(ch) = 0.33981
iter: 4238, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.075917

size_minibatch = 20000
Precon grad coeff: 0.016036, velocity coeff: 0.84297
norm(ch) = 0.2868
iter: 4239, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.075913

size_minibatch = 20000
Precon grad coeff: 0.01398, velocity coeff: 1.0871
New gamma: 0.0031623
norm(ch) = 0.31226
rho = 1.3713
New lambda: 2.4687e-092
iter: 4240, Minibatch log likelihood (pre-update): -54.295, error rate (pre-update): 0.075912
iter: 4240, Minibatch log likelihood (post-update): -54.2949, error rate (post-update): 0.07591

size_minibatch = 20000
Precon grad coeff: 0.017131, velocity coeff: 1.1532
norm(ch) = 0.36096
iter: 4241, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.07591

size_minibatch = 20000
Precon grad coeff: 0.015306, velocity coeff: 0.91021
norm(ch) = 0.32936
iter: 4242, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.075909

size_minibatch = 20000
Precon grad coeff: 0.014677, velocity coeff: 1.0607
norm(ch) = 0.34992
iter: 4243, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.075906

size_minibatch = 20000
Precon grad coeff: 0.015404, velocity coeff: 1.0087
norm(ch) = 0.35367
iter: 4244, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.075905

size_minibatch = 20000
Precon grad coeff: 0.015192, velocity coeff: 1.0518
norm(ch) = 0.37277
rho = 1.0754
New lambda: 1.9102e-092
iter: 4245, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.075903
iter: 4245, Minibatch log likelihood (post-update): -54.2949, error rate (post-update): 0.075903

size_minibatch = 20000
Precon grad coeff: 0.014497, velocity coeff: 0.95584
norm(ch) = 0.35716
iter: 4246, Minibatch log likelihood (pre-update): -54.2949, error rate (pre-update): 0.075903

size_minibatch = 20000
Precon grad coeff: 0.015167, velocity coeff: 1.0018
norm(ch) = 0.35857
iter: 4247, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.0759

size_minibatch = 20000
Precon grad coeff: 0.015041, velocity coeff: 1.0106
norm(ch) = 0.36306
iter: 4248, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.075899

size_minibatch = 20000
Precon grad coeff: 0.014608, velocity coeff: 0.92022
norm(ch) = 0.33486
iter: 4249, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.075897

size_minibatch = 20000
Precon grad coeff: 0.013931, velocity coeff: 1.0472
norm(ch) = 0.3514
rho = 1.1769
New lambda: 1.4781e-092
iter: 4250, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.075894
iter: 4250, Minibatch log likelihood (post-update): -54.2948, error rate (post-update): 0.075888
---
Full log-likelihood: -54.2948, error rate: 0.075888
TEST log-likelihood: -55.4224, error rate: 0.43298
Error difference (test - train): 0.35709
---
Full log-likelihood (averaged params): -54.2977, error rate (averaged params): 0.077234
TEST log-likelihood (averaged params): -55.3787, error rate (averaged params): 0.42221
Error difference (test - train) (averaged params): 0.34497

size_minibatch = 20000
Precon grad coeff: 0.015509, velocity coeff: 1.0163
norm(ch) = 0.3579
iter: 4251, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.075888

size_minibatch = 20000
Precon grad coeff: 0.014238, velocity coeff: 0.92321
norm(ch) = 0.33123
iter: 4252, Minibatch log likelihood (pre-update): -54.2948, error rate (pre-update): 0.07589

size_minibatch = 20000
Precon grad coeff: 0.015313, velocity coeff: 1.039
norm(ch) = 0.34502
iter: 4253, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.07589

size_minibatch = 20000
Precon grad coeff: 0.014975, velocity coeff: 0.99576
norm(ch) = 0.34423
iter: 4254, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.075886

size_minibatch = 20000
Precon grad coeff: 0.013122, velocity coeff: 0.95473
norm(ch) = 0.32922
rho = 1.1185
New lambda: 1.1437e-092
iter: 4255, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.075879
iter: 4255, Minibatch log likelihood (post-update): -54.2947, error rate (post-update): 0.07588

size_minibatch = 20000
Precon grad coeff: 0.017147, velocity coeff: 1.1026
norm(ch) = 0.36389
iter: 4256, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.07588

size_minibatch = 20000
Precon grad coeff: 0.014698, velocity coeff: 0.91501
norm(ch) = 0.33378
iter: 4257, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.07588

size_minibatch = 20000
Precon grad coeff: 0.014544, velocity coeff: 1.0725
norm(ch) = 0.35848
iter: 4258, Minibatch log likelihood (pre-update): -54.2947, error rate (pre-update): 0.075876

size_minibatch = 20000
Precon grad coeff: 0.013112, velocity coeff: 0.94271
norm(ch) = 0.33836
iter: 4259, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075872

size_minibatch = 20000
Precon grad coeff: 0.016631, velocity coeff: 1.1158
New gamma: 0.0031623
norm(ch) = 0.3782
rho = 0.79427
New lambda: 8.85e-093
iter: 4260, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075875
iter: 4260, Minibatch log likelihood (post-update): -54.2946, error rate (post-update): 0.075872

size_minibatch = 20000
Precon grad coeff: 0.01638, velocity coeff: 0.92063
norm(ch) = 0.3489
iter: 4261, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075872

size_minibatch = 20000
Precon grad coeff: 0.01015, velocity coeff: 0.81776
norm(ch) = 0.28585
iter: 4262, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075868

size_minibatch = 20000
Precon grad coeff: 0.016833, velocity coeff: 1.3072
norm(ch) = 0.37403
iter: 4263, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075865

size_minibatch = 20000
Precon grad coeff: 0.018793, velocity coeff: 0.96886
norm(ch) = 0.36305
iter: 4264, Minibatch log likelihood (pre-update): -54.2946, error rate (pre-update): 0.075865

size_minibatch = 20000
Precon grad coeff: 0.014254, velocity coeff: 0.80061
norm(ch) = 0.29126
rho = 0.98221
New lambda: 6.8479e-093
iter: 4265, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.07586
iter: 4265, Minibatch log likelihood (post-update): -54.2945, error rate (post-update): 0.075858

size_minibatch = 20000
Precon grad coeff: 0.011249, velocity coeff: 1.0481
norm(ch) = 0.30583
iter: 4266, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075858

size_minibatch = 20000
Precon grad coeff: 0.016676, velocity coeff: 1.1371
norm(ch) = 0.34843
iter: 4267, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075856

size_minibatch = 20000
Precon grad coeff: 0.016653, velocity coeff: 1.0562
norm(ch) = 0.36873
iter: 4268, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075856

size_minibatch = 20000
Precon grad coeff: 0.016888, velocity coeff: 0.92592
norm(ch) = 0.34209
iter: 4269, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075854

size_minibatch = 20000
Precon grad coeff: 0.010681, velocity coeff: 0.84831
norm(ch) = 0.29069
rho = 0.74204
New lambda: 6.8479e-093
iter: 4270, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075849
iter: 4270, Minibatch log likelihood (post-update): -54.2945, error rate (post-update): 0.075847

size_minibatch = 20000
Precon grad coeff: 0.014845, velocity coeff: 1.2544
norm(ch) = 0.36517
iter: 4271, Minibatch log likelihood (pre-update): -54.2945, error rate (pre-update): 0.075847

size_minibatch = 20000
Precon grad coeff: 0.021828, velocity coeff: 1.1431
norm(ch) = 0.41842
iter: 4272, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075851

size_minibatch = 20000
Precon grad coeff: 0.018179, velocity coeff: 0.82423
norm(ch) = 0.34568
iter: 4273, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075843

size_minibatch = 20000
Precon grad coeff: 0.010118, velocity coeff: 0.78353
norm(ch) = 0.2715
iter: 4274, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075837

size_minibatch = 20000
Precon grad coeff: 0.015101, velocity coeff: 1.278
norm(ch) = 0.34744
rho = 1.0362
New lambda: 5.2988e-093
iter: 4275, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075836
iter: 4275, Minibatch log likelihood (post-update): -54.2944, error rate (post-update): 0.075841

size_minibatch = 20000
Precon grad coeff: 0.016707, velocity coeff: 0.96659
norm(ch) = 0.33662
iter: 4276, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075841

size_minibatch = 20000
Precon grad coeff: 0.018653, velocity coeff: 1.1001
norm(ch) = 0.3713
iter: 4277, Minibatch log likelihood (pre-update): -54.2944, error rate (pre-update): 0.075834

size_minibatch = 20000
Precon grad coeff: 0.020092, velocity coeff: 0.98266
norm(ch) = 0.36578
iter: 4278, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075832

size_minibatch = 20000
Precon grad coeff: 0.019575, velocity coeff: 1.0524
norm(ch) = 0.38594
iter: 4279, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075831

size_minibatch = 20000
Precon grad coeff: 0.014992, velocity coeff: 0.72247
New gamma: 0.0052816
norm(ch) = 0.27936
rho = 0.9778
New lambda: 4.1001e-093
iter: 4280, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075826
iter: 4280, Minibatch log likelihood (post-update): -54.2943, error rate (post-update): 0.075822

size_minibatch = 20000
Precon grad coeff: 0.01181, velocity coeff: 1.0621
norm(ch) = 0.29699
iter: 4281, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075822

size_minibatch = 20000
Precon grad coeff: 0.016425, velocity coeff: 1.1141
norm(ch) = 0.33116
iter: 4282, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075821

size_minibatch = 20000
Precon grad coeff: 0.02085, velocity coeff: 1.152
norm(ch) = 0.38205
iter: 4283, Minibatch log likelihood (pre-update): -54.2943, error rate (pre-update): 0.075819

size_minibatch = 20000
Precon grad coeff: 0.012791, velocity coeff: 0.66425
norm(ch) = 0.25405
iter: 4284, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075819

size_minibatch = 20000
Precon grad coeff: 0.014131, velocity coeff: 1.2045
norm(ch) = 0.3064
rho = 0.87838
New lambda: 3.1726e-093
iter: 4285, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075815
iter: 4285, Minibatch log likelihood (post-update): -54.2942, error rate (post-update): 0.075813

size_minibatch = 20000
Precon grad coeff: 0.012573, velocity coeff: 0.9238
norm(ch) = 0.28324
iter: 4286, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075813

size_minibatch = 20000
Precon grad coeff: 0.019288, velocity coeff: 1.1608
norm(ch) = 0.32907
iter: 4287, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075811

size_minibatch = 20000
Precon grad coeff: 0.011764, velocity coeff: 0.72274
norm(ch) = 0.23803
iter: 4288, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.07581

size_minibatch = 20000
Precon grad coeff: 0.014183, velocity coeff: 1.2159
norm(ch) = 0.28965
iter: 4289, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075807

size_minibatch = 20000
Precon grad coeff: 0.016254, velocity coeff: 0.98434
norm(ch) = 0.28536
rho = 0.9319
New lambda: 2.4549e-093
iter: 4290, Minibatch log likelihood (pre-update): -54.2942, error rate (pre-update): 0.075806
iter: 4290, Minibatch log likelihood (post-update): -54.2941, error rate (post-update): 0.075804

size_minibatch = 20000
Precon grad coeff: 0.014698, velocity coeff: 0.93819
norm(ch) = 0.26795
iter: 4291, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075804

size_minibatch = 20000
Precon grad coeff: 0.012286, velocity coeff: 0.94601
norm(ch) = 0.25366
iter: 4292, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075803

size_minibatch = 20000
Precon grad coeff: 0.01461, velocity coeff: 1.1353
norm(ch) = 0.28815
iter: 4293, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075799

size_minibatch = 20000
Precon grad coeff: 0.017238, velocity coeff: 1.0311
norm(ch) = 0.29735
iter: 4294, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075799

size_minibatch = 20000
Precon grad coeff: 0.013882, velocity coeff: 0.88047
norm(ch) = 0.26205
rho = 0.97558
New lambda: 1.8995e-093
iter: 4295, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075796
iter: 4295, Minibatch log likelihood (post-update): -54.2941, error rate (post-update): 0.075796

size_minibatch = 20000
Precon grad coeff: 0.011528, velocity coeff: 1.0082
norm(ch) = 0.26447
iter: 4296, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075796

size_minibatch = 20000
Precon grad coeff: 0.017135, velocity coeff: 1.1525
norm(ch) = 0.30489
iter: 4297, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075793

size_minibatch = 20000
Precon grad coeff: 0.017562, velocity coeff: 0.93543
norm(ch) = 0.28539
iter: 4298, Minibatch log likelihood (pre-update): -54.2941, error rate (pre-update): 0.075789

size_minibatch = 20000
Precon grad coeff: 0.01171, velocity coeff: 0.79968
norm(ch) = 0.22843
iter: 4299, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.075786

size_minibatch = 20000
Precon grad coeff: 0.018466, velocity coeff: 1.3891
New gamma: 0.0088212
norm(ch) = 0.31755
rho = 0.84863
New lambda: 1.4698e-093
iter: 4300, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.075787
iter: 4300, Minibatch log likelihood (post-update): -54.294, error rate (post-update): 0.075783
---
Full log-likelihood: -54.294, error rate: 0.075783
TEST log-likelihood: -55.4325, error rate: 0.43552
Error difference (test - train): 0.35973
---
Full log-likelihood (averaged params): -54.297, error rate (averaged params): 0.077119
TEST log-likelihood (averaged params): -55.3907, error rate (averaged params): 0.42519
Error difference (test - train) (averaged params): 0.34807

size_minibatch = 20000
Precon grad coeff: 0.022, velocity coeff: 0.90711
norm(ch) = 0.28826
iter: 4301, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.075783

size_minibatch = 20000
Precon grad coeff: 0.022198, velocity coeff: 0.97468
norm(ch) = 0.28109
iter: 4302, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.07578

size_minibatch = 20000
Precon grad coeff: 0.013307, velocity coeff: 0.78555
norm(ch) = 0.22095
iter: 4303, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.07578

size_minibatch = 20000
Precon grad coeff: 0.016718, velocity coeff: 1.1292
norm(ch) = 0.24962
iter: 4304, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.07578

size_minibatch = 20000
Precon grad coeff: 0.022479, velocity coeff: 1.1828
norm(ch) = 0.2955
rho = 0.97013
New lambda: 1.1373e-093
iter: 4305, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.075774
iter: 4305, Minibatch log likelihood (post-update): -54.294, error rate (post-update): 0.07577

size_minibatch = 20000
Precon grad coeff: 0.022437, velocity coeff: 0.91876
norm(ch) = 0.27166
iter: 4306, Minibatch log likelihood (pre-update): -54.294, error rate (pre-update): 0.07577

size_minibatch = 20000
Precon grad coeff: 0.014207, velocity coeff: 0.76466
norm(ch) = 0.20789
iter: 4307, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.07577

size_minibatch = 20000
Precon grad coeff: 0.017022, velocity coeff: 1.3478
norm(ch) = 0.28031
iter: 4308, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.07577

size_minibatch = 20000
Precon grad coeff: 0.022901, velocity coeff: 1.0006
norm(ch) = 0.28069
iter: 4309, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075764

size_minibatch = 20000
Precon grad coeff: 0.019952, velocity coeff: 0.99033
norm(ch) = 0.27813
rho = 1.1298
New lambda: 8.8004e-094
iter: 4310, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075762
iter: 4310, Minibatch log likelihood (post-update): -54.2939, error rate (post-update): 0.075761

size_minibatch = 20000
Precon grad coeff: 0.014038, velocity coeff: 0.78515
norm(ch) = 0.21851
iter: 4311, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075761

size_minibatch = 20000
Precon grad coeff: 0.017502, velocity coeff: 1.2843
norm(ch) = 0.28072
iter: 4312, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075763

size_minibatch = 20000
Precon grad coeff: 0.022835, velocity coeff: 1.0444
norm(ch) = 0.2934
iter: 4313, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075762

size_minibatch = 20000
Precon grad coeff: 0.017543, velocity coeff: 0.8497
norm(ch) = 0.24948
iter: 4314, Minibatch log likelihood (pre-update): -54.2939, error rate (pre-update): 0.075757

size_minibatch = 20000
Precon grad coeff: 0.014607, velocity coeff: 0.93988
norm(ch) = 0.23455
rho = 0.94156
New lambda: 6.8096e-094
iter: 4315, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075753
iter: 4315, Minibatch log likelihood (post-update): -54.2938, error rate (post-update): 0.075754

size_minibatch = 20000
Precon grad coeff: 0.018023, velocity coeff: 1.1248
norm(ch) = 0.26395
iter: 4316, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075754

size_minibatch = 20000
Precon grad coeff: 0.022235, velocity coeff: 1.0604
norm(ch) = 0.28007
iter: 4317, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075752

size_minibatch = 20000
Precon grad coeff: 0.017223, velocity coeff: 0.84021
norm(ch) = 0.23549
iter: 4318, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.07575

size_minibatch = 20000
Precon grad coeff: 0.014378, velocity coeff: 0.96571
norm(ch) = 0.22752
iter: 4319, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075747

size_minibatch = 20000
Precon grad coeff: 0.017886, velocity coeff: 1.2377
New gamma: 0.0052816
norm(ch) = 0.28188
rho = 0.87002
New lambda: 5.2691e-094
iter: 4320, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075747
iter: 4320, Minibatch log likelihood (post-update): -54.2938, error rate (post-update): 0.075743

size_minibatch = 20000
Precon grad coeff: 0.017273, velocity coeff: 0.96406
norm(ch) = 0.27216
iter: 4321, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.075743

size_minibatch = 20000
Precon grad coeff: 0.0098951, velocity coeff: 0.84263
norm(ch) = 0.22964
iter: 4322, Minibatch log likelihood (pre-update): -54.2938, error rate (pre-update): 0.07574

size_minibatch = 20000
Precon grad coeff: 0.016198, velocity coeff: 1.3326
norm(ch) = 0.30616
iter: 4323, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075738

size_minibatch = 20000
Precon grad coeff: 0.020282, velocity coeff: 1.0728
norm(ch) = 0.32891
iter: 4324, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075738

size_minibatch = 20000
Precon grad coeff: 0.012845, velocity coeff: 0.79313
norm(ch) = 0.26123
rho = 0.9024
New lambda: 4.0772e-094
iter: 4325, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075734
iter: 4325, Minibatch log likelihood (post-update): -54.2937, error rate (post-update): 0.075732

size_minibatch = 20000
Precon grad coeff: 0.010692, velocity coeff: 1.023
norm(ch) = 0.26749
iter: 4326, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075732

size_minibatch = 20000
Precon grad coeff: 0.018718, velocity coeff: 1.3135
norm(ch) = 0.35165
iter: 4327, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.07573

size_minibatch = 20000
Precon grad coeff: 0.019071, velocity coeff: 0.87374
norm(ch) = 0.3078
iter: 4328, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075732

size_minibatch = 20000
Precon grad coeff: 0.011046, velocity coeff: 0.81725
norm(ch) = 0.25194
iter: 4329, Minibatch log likelihood (pre-update): -54.2937, error rate (pre-update): 0.075729

size_minibatch = 20000
Precon grad coeff: 0.012578, velocity coeff: 1.0857
norm(ch) = 0.27383
rho = 1.1096
New lambda: 3.1548e-094
iter: 4330, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075726
iter: 4330, Minibatch log likelihood (post-update): -54.2936, error rate (post-update): 0.075721

size_minibatch = 20000
Precon grad coeff: 0.018698, velocity coeff: 1.2761
norm(ch) = 0.34989
iter: 4331, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075721

size_minibatch = 20000
Precon grad coeff: 0.015023, velocity coeff: 0.74843
norm(ch) = 0.26234
iter: 4332, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.07572

size_minibatch = 20000
Precon grad coeff: 0.011848, velocity coeff: 1.056
norm(ch) = 0.27747
iter: 4333, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075717

size_minibatch = 20000
Precon grad coeff: 0.014213, velocity coeff: 1.1078
norm(ch) = 0.30776
iter: 4334, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075715

size_minibatch = 20000
Precon grad coeff: 0.01687, velocity coeff: 1.0163
norm(ch) = 0.31313
rho = 0.81012
New lambda: 2.4411e-094
iter: 4335, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075711
iter: 4335, Minibatch log likelihood (post-update): -54.2936, error rate (post-update): 0.075711

size_minibatch = 20000
Precon grad coeff: 0.011116, velocity coeff: 0.80036
norm(ch) = 0.25094
iter: 4336, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.075711

size_minibatch = 20000
Precon grad coeff: 0.014652, velocity coeff: 1.198
norm(ch) = 0.30104
iter: 4337, Minibatch log likelihood (pre-update): -54.2936, error rate (pre-update): 0.07571

size_minibatch = 20000
Precon grad coeff: 0.01488, velocity coeff: 0.94142
norm(ch) = 0.28389
iter: 4338, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075709

size_minibatch = 20000
Precon grad coeff: 0.013346, velocity coeff: 0.92013
norm(ch) = 0.26151
iter: 4339, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075704

size_minibatch = 20000
Precon grad coeff: 0.01393, velocity coeff: 1.035
New gamma: 0.0052816
norm(ch) = 0.27106
rho = 0.83107
New lambda: 1.8889e-094
iter: 4340, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075702
iter: 4340, Minibatch log likelihood (post-update): -54.2935, error rate (post-update): 0.0757

size_minibatch = 20000
Precon grad coeff: 0.01865, velocity coeff: 1.0822
norm(ch) = 0.29395
iter: 4341, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.0757

size_minibatch = 20000
Precon grad coeff: 0.015534, velocity coeff: 0.87684
norm(ch) = 0.2583
iter: 4342, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075699

size_minibatch = 20000
Precon grad coeff: 0.014269, velocity coeff: 1.0311
norm(ch) = 0.26674
iter: 4343, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075695

size_minibatch = 20000
Precon grad coeff: 0.016464, velocity coeff: 1.0564
norm(ch) = 0.28235
iter: 4344, Minibatch log likelihood (pre-update): -54.2935, error rate (pre-update): 0.075695

size_minibatch = 20000
Precon grad coeff: 0.017632, velocity coeff: 1.1355
norm(ch) = 0.3212
rho = 0.98433
New lambda: 1.4616e-094
iter: 4345, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075694
iter: 4345, Minibatch log likelihood (post-update): -54.2934, error rate (post-update): 0.075691

size_minibatch = 20000
Precon grad coeff: 0.014764, velocity coeff: 0.85981
norm(ch) = 0.27671
iter: 4346, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075691

size_minibatch = 20000
Precon grad coeff: 0.014696, velocity coeff: 1.1018
norm(ch) = 0.30528
iter: 4347, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075687

size_minibatch = 20000
Precon grad coeff: 0.018272, velocity coeff: 1.1119
norm(ch) = 0.34001
iter: 4348, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075687

size_minibatch = 20000
Precon grad coeff: 0.015463, velocity coeff: 0.89496
norm(ch) = 0.30479
iter: 4349, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075682

size_minibatch = 20000
Precon grad coeff: 0.013577, velocity coeff: 0.90295
norm(ch) = 0.27567
rho = 0.95781
New lambda: 1.131e-094
iter: 4350, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075678
iter: 4350, Minibatch log likelihood (post-update): -54.2934, error rate (post-update): 0.075676
---
Full log-likelihood: -54.2934, error rate: 0.075676
TEST log-likelihood: -55.4387, error rate: 0.43709
Error difference (test - train): 0.36142
---
Full log-likelihood (averaged params): -54.2961, error rate (averaged params): 0.076919
TEST log-likelihood (averaged params): -55.4019, error rate (averaged params): 0.42799
Error difference (test - train) (averaged params): 0.35107

size_minibatch = 20000
Precon grad coeff: 0.016322, velocity coeff: 1.1766
norm(ch) = 0.32466
iter: 4351, Minibatch log likelihood (pre-update): -54.2934, error rate (pre-update): 0.075676

size_minibatch = 20000
Precon grad coeff: 0.017521, velocity coeff: 0.93324
norm(ch) = 0.30346
iter: 4352, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075679

size_minibatch = 20000
Precon grad coeff: 0.015972, velocity coeff: 0.9473
norm(ch) = 0.28791
iter: 4353, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075674

size_minibatch = 20000
Precon grad coeff: 0.012742, velocity coeff: 0.92492
norm(ch) = 0.26674
iter: 4354, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075669

size_minibatch = 20000
Precon grad coeff: 0.017039, velocity coeff: 1.1436
norm(ch) = 0.30539
rho = 0.76248
New lambda: 8.7512e-095
iter: 4355, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075665
iter: 4355, Minibatch log likelihood (post-update): -54.2933, error rate (post-update): 0.075665

size_minibatch = 20000
Precon grad coeff: 0.019153, velocity coeff: 1.0083
norm(ch) = 0.30844
iter: 4356, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075665

size_minibatch = 20000
Precon grad coeff: 0.014916, velocity coeff: 0.89508
norm(ch) = 0.27649
iter: 4357, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075661

size_minibatch = 20000
Precon grad coeff: 0.012895, velocity coeff: 0.95856
norm(ch) = 0.2654
iter: 4358, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.07566

size_minibatch = 20000
Precon grad coeff: 0.018286, velocity coeff: 1.2301
norm(ch) = 0.32685
iter: 4359, Minibatch log likelihood (pre-update): -54.2933, error rate (pre-update): 0.075658

size_minibatch = 20000
Precon grad coeff: 0.017042, velocity coeff: 0.97394
New gamma: 0.0031623
norm(ch) = 0.31922
rho = 0.87564
New lambda: 6.7715e-095
iter: 4360, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.075659
iter: 4360, Minibatch log likelihood (post-update): -54.2932, error rate (post-update): 0.075654

size_minibatch = 20000
Precon grad coeff: 0.013491, velocity coeff: 0.89692
norm(ch) = 0.28703
iter: 4361, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.075654

size_minibatch = 20000
Precon grad coeff: 0.013152, velocity coeff: 1.1453
norm(ch) = 0.32946
iter: 4362, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.07565

size_minibatch = 20000
Precon grad coeff: 0.016947, velocity coeff: 1.124
norm(ch) = 0.37102
iter: 4363, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.075648

size_minibatch = 20000
Precon grad coeff: 0.016541, velocity coeff: 0.99555
norm(ch) = 0.37034
iter: 4364, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.07565

size_minibatch = 20000
Precon grad coeff: 0.012498, velocity coeff: 0.86472
norm(ch) = 0.32086
rho = 1.1639
New lambda: 5.2396e-095
iter: 4365, Minibatch log likelihood (pre-update): -54.2932, error rate (pre-update): 0.075646
iter: 4365, Minibatch log likelihood (post-update): -54.2931, error rate (post-update): 0.07564

size_minibatch = 20000
Precon grad coeff: 0.013926, velocity coeff: 1.1413
norm(ch) = 0.36706
iter: 4366, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.075641

size_minibatch = 20000
Precon grad coeff: 0.016286, velocity coeff: 1.0135
norm(ch) = 0.3728
iter: 4367, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.075634

size_minibatch = 20000
Precon grad coeff: 0.01549, velocity coeff: 0.94306
norm(ch) = 0.35249
iter: 4368, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.075633

size_minibatch = 20000
Precon grad coeff: 0.012138, velocity coeff: 0.85521
norm(ch) = 0.30199
iter: 4369, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.075631

size_minibatch = 20000
Precon grad coeff: 0.015313, velocity coeff: 1.2026
norm(ch) = 0.36398
rho = 1.0818
New lambda: 4.0543e-095
iter: 4370, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.07563
iter: 4370, Minibatch log likelihood (post-update): -54.2931, error rate (post-update): 0.075625

size_minibatch = 20000
Precon grad coeff: 0.015837, velocity coeff: 0.92677
norm(ch) = 0.33813
iter: 4371, Minibatch log likelihood (pre-update): -54.2931, error rate (pre-update): 0.075625

size_minibatch = 20000
Precon grad coeff: 0.013506, velocity coeff: 0.91791
norm(ch) = 0.31128
iter: 4372, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075623

size_minibatch = 20000
Precon grad coeff: 0.013417, velocity coeff: 1.0175
norm(ch) = 0.31733
iter: 4373, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075621

size_minibatch = 20000
Precon grad coeff: 0.016561, velocity coeff: 1.0976
norm(ch) = 0.34913
iter: 4374, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075621

size_minibatch = 20000
Precon grad coeff: 0.014551, velocity coeff: 0.93096
norm(ch) = 0.32575
rho = 1.0036
New lambda: 3.1372e-095
iter: 4375, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075617
iter: 4375, Minibatch log likelihood (post-update): -54.293, error rate (post-update): 0.075614

size_minibatch = 20000
Precon grad coeff: 0.012872, velocity coeff: 0.95253
norm(ch) = 0.31108
iter: 4376, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075614

size_minibatch = 20000
Precon grad coeff: 0.014686, velocity coeff: 1.0938
norm(ch) = 0.34085
iter: 4377, Minibatch log likelihood (pre-update): -54.293, error rate (pre-update): 0.075609

size_minibatch = 20000
Precon grad coeff: 0.017148, velocity coeff: 1.0453
norm(ch) = 0.35712
iter: 4378, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075608

size_minibatch = 20000
Precon grad coeff: 0.013141, velocity coeff: 0.89892
norm(ch) = 0.32157
iter: 4379, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075607

size_minibatch = 20000
Precon grad coeff: 0.013605, velocity coeff: 0.91399
New gamma: 0.0052816
norm(ch) = 0.29428
rho = 0.84627
New lambda: 2.4275e-095
iter: 4380, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075605
iter: 4380, Minibatch log likelihood (post-update): -54.2929, error rate (post-update): 0.0756

size_minibatch = 20000
Precon grad coeff: 0.016201, velocity coeff: 1.1775
norm(ch) = 0.34676
iter: 4381, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.0756

size_minibatch = 20000
Precon grad coeff: 0.017012, velocity coeff: 0.93539
norm(ch) = 0.32467
iter: 4382, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075598

size_minibatch = 20000
Precon grad coeff: 0.013742, velocity coeff: 0.89184
norm(ch) = 0.28982
iter: 4383, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075593

size_minibatch = 20000
Precon grad coeff: 0.012779, velocity coeff: 0.93464
norm(ch) = 0.27117
iter: 4384, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075593

size_minibatch = 20000
Precon grad coeff: 0.019127, velocity coeff: 1.2067
norm(ch) = 0.32741
rho = 1.0746
New lambda: 1.8783e-095
iter: 4385, Minibatch log likelihood (pre-update): -54.2929, error rate (pre-update): 0.075591
iter: 4385, Minibatch log likelihood (post-update): -54.2928, error rate (post-update): 0.075591

size_minibatch = 20000
Precon grad coeff: 0.014363, velocity coeff: 0.77146
norm(ch) = 0.2528
iter: 4386, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075591

size_minibatch = 20000
Precon grad coeff: 0.013998, velocity coeff: 1.0464
norm(ch) = 0.26473
iter: 4387, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075588

size_minibatch = 20000
Precon grad coeff: 0.014838, velocity coeff: 1.0272
norm(ch) = 0.27225
iter: 4388, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075587

size_minibatch = 20000
Precon grad coeff: 0.017951, velocity coeff: 1.0876
norm(ch) = 0.29625
iter: 4389, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075585

size_minibatch = 20000
Precon grad coeff: 0.014048, velocity coeff: 0.81161
norm(ch) = 0.24062
rho = 0.92945
New lambda: 1.4534e-095
iter: 4390, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075582
iter: 4390, Minibatch log likelihood (post-update): -54.2928, error rate (post-update): 0.075579

size_minibatch = 20000
Precon grad coeff: 0.014774, velocity coeff: 1.1992
norm(ch) = 0.28875
iter: 4391, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075579

size_minibatch = 20000
Precon grad coeff: 0.015847, velocity coeff: 1.0284
norm(ch) = 0.29722
iter: 4392, Minibatch log likelihood (pre-update): -54.2928, error rate (pre-update): 0.075579

size_minibatch = 20000
Precon grad coeff: 0.01721, velocity coeff: 0.95075
norm(ch) = 0.28281
iter: 4393, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075576

size_minibatch = 20000
Precon grad coeff: 0.012699, velocity coeff: 0.94379
norm(ch) = 0.2671
iter: 4394, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075574

size_minibatch = 20000
Precon grad coeff: 0.016071, velocity coeff: 1.1432
norm(ch) = 0.30559
rho = 0.92749
New lambda: 1.1246e-095
iter: 4395, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.07557
iter: 4395, Minibatch log likelihood (post-update): -54.2927, error rate (post-update): 0.075569

size_minibatch = 20000
Precon grad coeff: 0.016502, velocity coeff: 0.95925
norm(ch) = 0.29338
iter: 4396, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075569

size_minibatch = 20000
Precon grad coeff: 0.01495, velocity coeff: 0.92204
norm(ch) = 0.27073
iter: 4397, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075565

size_minibatch = 20000
Precon grad coeff: 0.012941, velocity coeff: 0.99028
norm(ch) = 0.2683
iter: 4398, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075564

size_minibatch = 20000
Precon grad coeff: 0.017813, velocity coeff: 1.1394
norm(ch) = 0.306
iter: 4399, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075561

size_minibatch = 20000
Precon grad coeff: 0.019352, velocity coeff: 0.96971
New gamma: 0.0088212
norm(ch) = 0.29689
rho = 0.81736
New lambda: 8.7022e-096
iter: 4400, Minibatch log likelihood (pre-update): -54.2927, error rate (pre-update): 0.075561
iter: 4400, Minibatch log likelihood (post-update): -54.2926, error rate (post-update): 0.075561
---
Full log-likelihood: -54.2926, error rate: 0.075561
TEST log-likelihood: -55.4439, error rate: 0.43829
Error difference (test - train): 0.36273
---
Full log-likelihood (averaged params): -54.2952, error rate (averaged params): 0.076737
TEST log-likelihood (averaged params): -55.4113, error rate (averaged params): 0.43026
Error difference (test - train) (averaged params): 0.35352

size_minibatch = 20000
Precon grad coeff: 0.016116, velocity coeff: 0.82721
norm(ch) = 0.2457
iter: 4401, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075561

size_minibatch = 20000
Precon grad coeff: 0.018796, velocity coeff: 1.118
norm(ch) = 0.27484
iter: 4402, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075561

size_minibatch = 20000
Precon grad coeff: 0.020179, velocity coeff: 0.99693
norm(ch) = 0.27422
iter: 4403, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075554

size_minibatch = 20000
Precon grad coeff: 0.017934, velocity coeff: 0.89555
norm(ch) = 0.24576
iter: 4404, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.07555

size_minibatch = 20000
Precon grad coeff: 0.016455, velocity coeff: 0.95306
norm(ch) = 0.23431
rho = 1.0592
New lambda: 6.7336e-096
iter: 4405, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075549
iter: 4405, Minibatch log likelihood (post-update): -54.2926, error rate (post-update): 0.075551

size_minibatch = 20000
Precon grad coeff: 0.0205, velocity coeff: 1.0909
norm(ch) = 0.25582
iter: 4406, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075551

size_minibatch = 20000
Precon grad coeff: 0.01962, velocity coeff: 1.0077
norm(ch) = 0.25797
iter: 4407, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075546

size_minibatch = 20000
Precon grad coeff: 0.017893, velocity coeff: 0.88035
norm(ch) = 0.22735
iter: 4408, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075544

size_minibatch = 20000
Precon grad coeff: 0.017358, velocity coeff: 1.1394
norm(ch) = 0.25914
iter: 4409, Minibatch log likelihood (pre-update): -54.2926, error rate (pre-update): 0.075542

size_minibatch = 20000
Precon grad coeff: 0.02246, velocity coeff: 1.0058
norm(ch) = 0.26085
rho = 1.0181
New lambda: 5.2103e-096
iter: 4410, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075541
iter: 4410, Minibatch log likelihood (post-update): -54.2925, error rate (post-update): 0.075536

size_minibatch = 20000
Precon grad coeff: 0.018243, velocity coeff: 0.9873
norm(ch) = 0.25772
iter: 4411, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075536

size_minibatch = 20000
Precon grad coeff: 0.017625, velocity coeff: 0.93743
norm(ch) = 0.24182
iter: 4412, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075537

size_minibatch = 20000
Precon grad coeff: 0.017974, velocity coeff: 1.1218
norm(ch) = 0.27144
iter: 4413, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075535

size_minibatch = 20000
Precon grad coeff: 0.022245, velocity coeff: 1.0237
norm(ch) = 0.27806
iter: 4414, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075534

size_minibatch = 20000
Precon grad coeff: 0.01854, velocity coeff: 0.92485
norm(ch) = 0.25737
rho = 0.75654
New lambda: 4.0316e-096
iter: 4415, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075532
iter: 4415, Minibatch log likelihood (post-update): -54.2925, error rate (post-update): 0.07553

size_minibatch = 20000
Precon grad coeff: 0.015859, velocity coeff: 0.96758
norm(ch) = 0.24921
iter: 4416, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.07553

size_minibatch = 20000
Precon grad coeff: 0.019111, velocity coeff: 1.062
norm(ch) = 0.26484
iter: 4417, Minibatch log likelihood (pre-update): -54.2925, error rate (pre-update): 0.075525

size_minibatch = 20000
Precon grad coeff: 0.022572, velocity coeff: 1.0677
norm(ch) = 0.28296
iter: 4418, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075524

size_minibatch = 20000
Precon grad coeff: 0.017681, velocity coeff: 0.89022
norm(ch) = 0.25212
iter: 4419, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075526

size_minibatch = 20000
Precon grad coeff: 0.016178, velocity coeff: 1.0388
New gamma: 0.0052816
norm(ch) = 0.26229
rho = 0.98604
New lambda: 3.1196e-096
iter: 4420, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075526
iter: 4420, Minibatch log likelihood (post-update): -54.2924, error rate (post-update): 0.075521

size_minibatch = 20000
Precon grad coeff: 0.018462, velocity coeff: 1.0544
norm(ch) = 0.27694
iter: 4421, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075521

size_minibatch = 20000
Precon grad coeff: 0.023072, velocity coeff: 1.1609
norm(ch) = 0.32208
iter: 4422, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075518

size_minibatch = 20000
Precon grad coeff: 0.023862, velocity coeff: 1.041
norm(ch) = 0.33596
iter: 4423, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075515

size_minibatch = 20000
Precon grad coeff: 0.018431, velocity coeff: 0.91393
norm(ch) = 0.30771
iter: 4424, Minibatch log likelihood (pre-update): -54.2924, error rate (pre-update): 0.075512

size_minibatch = 20000
Precon grad coeff: 0.016328, velocity coeff: 0.94896
norm(ch) = 0.29245
rho = 0.95542
New lambda: 2.4139e-096
iter: 4425, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075511
iter: 4425, Minibatch log likelihood (post-update): -54.2923, error rate (post-update): 0.075511

size_minibatch = 20000
Precon grad coeff: 0.019039, velocity coeff: 1.176
norm(ch) = 0.34441
iter: 4426, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075511

size_minibatch = 20000
Precon grad coeff: 0.019477, velocity coeff: 0.99154
norm(ch) = 0.34206
iter: 4427, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075506

size_minibatch = 20000
Precon grad coeff: 0.021288, velocity coeff: 1.0237
norm(ch) = 0.35089
iter: 4428, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075503

size_minibatch = 20000
Precon grad coeff: 0.02008, velocity coeff: 0.94971
norm(ch) = 0.3339
iter: 4429, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075498

size_minibatch = 20000
Precon grad coeff: 0.014694, velocity coeff: 0.82733
norm(ch) = 0.27677
rho = 0.86624
New lambda: 1.8678e-096
iter: 4430, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075497
iter: 4430, Minibatch log likelihood (post-update): -54.2923, error rate (post-update): 0.075495

size_minibatch = 20000
Precon grad coeff: 0.018232, velocity coeff: 1.1391
norm(ch) = 0.31569
iter: 4431, Minibatch log likelihood (pre-update): -54.2923, error rate (pre-update): 0.075495

size_minibatch = 20000
Precon grad coeff: 0.022056, velocity coeff: 1.0491
norm(ch) = 0.33186
iter: 4432, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075493

size_minibatch = 20000
Precon grad coeff: 0.021082, velocity coeff: 0.9524
norm(ch) = 0.31681
iter: 4433, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075491

size_minibatch = 20000
Precon grad coeff: 0.020069, velocity coeff: 1.0074
norm(ch) = 0.31982
iter: 4434, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075491

size_minibatch = 20000
Precon grad coeff: 0.017511, velocity coeff: 0.92409
norm(ch) = 0.29616
rho = 1.0685
New lambda: 1.4453e-096
iter: 4435, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075485
iter: 4435, Minibatch log likelihood (post-update): -54.2922, error rate (post-update): 0.075482

size_minibatch = 20000
Precon grad coeff: 0.015477, velocity coeff: 0.98571
norm(ch) = 0.29253
iter: 4436, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075482

size_minibatch = 20000
Precon grad coeff: 0.019364, velocity coeff: 1.1169
norm(ch) = 0.32719
iter: 4437, Minibatch log likelihood (pre-update): -54.2922, error rate (pre-update): 0.075481

size_minibatch = 20000
Precon grad coeff: 0.024068, velocity coeff: 1.0824
norm(ch) = 0.35488
iter: 4438, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.07548

size_minibatch = 20000
Precon grad coeff: 0.022164, velocity coeff: 0.93509
norm(ch) = 0.33256
iter: 4439, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.075475

size_minibatch = 20000
Precon grad coeff: 0.019722, velocity coeff: 0.98119
New gamma: 0.0031623
norm(ch) = 0.32748
rho = 1.0097
New lambda: 1.1183e-096
iter: 4440, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.075473
iter: 4440, Minibatch log likelihood (post-update): -54.2921, error rate (post-update): 0.07547

size_minibatch = 20000
Precon grad coeff: 0.016241, velocity coeff: 0.97636
norm(ch) = 0.32073
iter: 4441, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.07547

size_minibatch = 20000
Precon grad coeff: 0.012012, velocity coeff: 0.82722
norm(ch) = 0.26624
iter: 4442, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.075471

size_minibatch = 20000
Precon grad coeff: 0.013825, velocity coeff: 1.2452
norm(ch) = 0.33227
iter: 4443, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.075467

size_minibatch = 20000
Precon grad coeff: 0.020177, velocity coeff: 1.2818
norm(ch) = 0.42695
iter: 4444, Minibatch log likelihood (pre-update): -54.2921, error rate (pre-update): 0.075462

size_minibatch = 20000
Precon grad coeff: 0.021442, velocity coeff: 0.95467
norm(ch) = 0.40892
rho = 0.82775
New lambda: 8.6535e-097
iter: 4445, Minibatch log likelihood (pre-update): -54.292, error rate (pre-update): 0.07546
iter: 4445, Minibatch log likelihood (post-update): -54.292, error rate (post-update): 0.075458

size_minibatch = 20000
Precon grad coeff: 0.015796, velocity coeff: 0.86603
norm(ch) = 0.35513
iter: 4446, Minibatch log likelihood (pre-update): -54.292, error rate (pre-update): 0.075458

size_minibatch = 20000
Precon grad coeff: 0.011357, velocity coeff: 0.83553
norm(ch) = 0.29724
iter: 4447, Minibatch log likelihood (pre-update): -54.292, error rate (pre-update): 0.075456

size_minibatch = 20000
Precon grad coeff: 0.014951, velocity coeff: 1.2617
norm(ch) = 0.37567
iter: 4448, Minibatch log likelihood (pre-update): -54.292, error rate (pre-update): 0.075457

size_minibatch = 20000
Precon grad coeff: 0.018075, velocity coeff: 1.0116
norm(ch) = 0.3809
iter: 4449, Minibatch log likelihood (pre-update): -54.292, error rate (pre-update): 0.075453

size_minibatch = 20000
Precon grad coeff: 0.018091, velocity coeff: 0.95418
norm(ch) = 0.36441
rho = 1.0493
New lambda: 6.6959e-097
iter: 4450, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.07545
iter: 4450, Minibatch log likelihood (post-update): -54.2919, error rate (post-update): 0.075445
---
Full log-likelihood: -54.2919, error rate: 0.075445
TEST log-likelihood: -55.446, error rate: 0.43878
Error difference (test - train): 0.36333
---
Full log-likelihood (averaged params): -54.2943, error rate (averaged params): 0.076562
TEST log-likelihood (averaged params): -55.4185, error rate (averaged params): 0.432
Error difference (test - train) (averaged params): 0.35544

size_minibatch = 20000
Precon grad coeff: 0.011922, velocity coeff: 0.80665
norm(ch) = 0.29455
iter: 4451, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075445

size_minibatch = 20000
Precon grad coeff: 0.013209, velocity coeff: 1.1309
norm(ch) = 0.33361
iter: 4452, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075445

size_minibatch = 20000
Precon grad coeff: 0.016542, velocity coeff: 1.0995
norm(ch) = 0.36745
iter: 4453, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075443

size_minibatch = 20000
Precon grad coeff: 0.018934, velocity coeff: 0.99423
norm(ch) = 0.36627
iter: 4454, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075438

size_minibatch = 20000
Precon grad coeff: 0.012731, velocity coeff: 0.79039
norm(ch) = 0.29007
rho = 1.0712
New lambda: 5.1812e-097
iter: 4455, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075435
iter: 4455, Minibatch log likelihood (post-update): -54.2919, error rate (post-update): 0.075435

size_minibatch = 20000
Precon grad coeff: 0.012648, velocity coeff: 1.0979
norm(ch) = 0.3188
iter: 4456, Minibatch log likelihood (pre-update): -54.2919, error rate (pre-update): 0.075435

size_minibatch = 20000
Precon grad coeff: 0.017286, velocity coeff: 1.1598
norm(ch) = 0.37031
iter: 4457, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075432

size_minibatch = 20000
Precon grad coeff: 0.016771, velocity coeff: 0.92995
norm(ch) = 0.34513
iter: 4458, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.07543

size_minibatch = 20000
Precon grad coeff: 0.013148, velocity coeff: 0.83856
norm(ch) = 0.29001
iter: 4459, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075426

size_minibatch = 20000
Precon grad coeff: 0.012536, velocity coeff: 1.0556
New gamma: 0.0052816
norm(ch) = 0.30618
rho = 1.0931
New lambda: 4.0091e-097
iter: 4460, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075424
iter: 4460, Minibatch log likelihood (post-update): -54.2918, error rate (post-update): 0.075422

size_minibatch = 20000
Precon grad coeff: 0.015435, velocity coeff: 1.0674
norm(ch) = 0.32705
iter: 4461, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075422

size_minibatch = 20000
Precon grad coeff: 0.016163, velocity coeff: 0.94435
norm(ch) = 0.30913
iter: 4462, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075422

size_minibatch = 20000
Precon grad coeff: 0.012728, velocity coeff: 0.90625
norm(ch) = 0.28043
iter: 4463, Minibatch log likelihood (pre-update): -54.2918, error rate (pre-update): 0.075418

size_minibatch = 20000
Precon grad coeff: 0.013181, velocity coeff: 0.99742
norm(ch) = 0.27985
iter: 4464, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075417

size_minibatch = 20000
Precon grad coeff: 0.015047, velocity coeff: 1.0049
norm(ch) = 0.28144
rho = 1.229
New lambda: 3.1021e-097
iter: 4465, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075413
iter: 4465, Minibatch log likelihood (post-update): -54.2917, error rate (post-update): 0.075411

size_minibatch = 20000
Precon grad coeff: 0.016094, velocity coeff: 1.0076
norm(ch) = 0.28381
iter: 4466, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075411

size_minibatch = 20000
Precon grad coeff: 0.011461, velocity coeff: 0.81272
norm(ch) = 0.23083
iter: 4467, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075409

size_minibatch = 20000
Precon grad coeff: 0.017173, velocity coeff: 1.3186
norm(ch) = 0.30452
iter: 4468, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.07541

size_minibatch = 20000
Precon grad coeff: 0.014814, velocity coeff: 0.8724
norm(ch) = 0.26588
iter: 4469, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075405

size_minibatch = 20000
Precon grad coeff: 0.012357, velocity coeff: 0.91
norm(ch) = 0.24217
rho = 1.0974
New lambda: 2.4004e-097
iter: 4470, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075405
iter: 4470, Minibatch log likelihood (post-update): -54.2917, error rate (post-update): 0.075403

size_minibatch = 20000
Precon grad coeff: 0.015618, velocity coeff: 1.2037
norm(ch) = 0.29165
iter: 4471, Minibatch log likelihood (pre-update): -54.2917, error rate (pre-update): 0.075403

size_minibatch = 20000
Precon grad coeff: 0.015234, velocity coeff: 0.93663
norm(ch) = 0.27331
iter: 4472, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075403

size_minibatch = 20000
Precon grad coeff: 0.013797, velocity coeff: 0.94154
norm(ch) = 0.25753
iter: 4473, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075398

size_minibatch = 20000
Precon grad coeff: 0.012847, velocity coeff: 1.0363
norm(ch) = 0.26709
iter: 4474, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075397

size_minibatch = 20000
Precon grad coeff: 0.016492, velocity coeff: 1.0421
norm(ch) = 0.27858
rho = 0.71529
New lambda: 2.4004e-097
iter: 4475, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075395
iter: 4475, Minibatch log likelihood (post-update): -54.2916, error rate (post-update): 0.075396

size_minibatch = 20000
Precon grad coeff: 0.013872, velocity coeff: 0.95429
norm(ch) = 0.26601
iter: 4476, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075396

size_minibatch = 20000
Precon grad coeff: 0.013477, velocity coeff: 0.96163
norm(ch) = 0.25601
iter: 4477, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075395

size_minibatch = 20000
Precon grad coeff: 0.014114, velocity coeff: 1.104
norm(ch) = 0.28281
iter: 4478, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075395

size_minibatch = 20000
Precon grad coeff: 0.016892, velocity coeff: 1.0126
norm(ch) = 0.28666
iter: 4479, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.07539

size_minibatch = 20000
Precon grad coeff: 0.016652, velocity coeff: 0.93322
New gamma: 0.0088212
norm(ch) = 0.26765
rho = 0.96928
New lambda: 1.8574e-097
iter: 4480, Minibatch log likelihood (pre-update): -54.2916, error rate (pre-update): 0.075388
iter: 4480, Minibatch log likelihood (post-update): -54.2915, error rate (post-update): 0.075385

size_minibatch = 20000
Precon grad coeff: 0.020037, velocity coeff: 1.0316
norm(ch) = 0.27622
iter: 4481, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075385

size_minibatch = 20000
Precon grad coeff: 0.022597, velocity coeff: 1.0291
norm(ch) = 0.28439
iter: 4482, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075384

size_minibatch = 20000
Precon grad coeff: 0.019062, velocity coeff: 0.83017
norm(ch) = 0.23629
iter: 4483, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075382

size_minibatch = 20000
Precon grad coeff: 0.017558, velocity coeff: 1.0361
norm(ch) = 0.24497
iter: 4484, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.07538

size_minibatch = 20000
Precon grad coeff: 0.021154, velocity coeff: 1.0595
norm(ch) = 0.25975
rho = 0.97612
New lambda: 1.4372e-097
iter: 4485, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075376
iter: 4485, Minibatch log likelihood (post-update): -54.2915, error rate (post-update): 0.075376

size_minibatch = 20000
Precon grad coeff: 0.022398, velocity coeff: 1.0402
norm(ch) = 0.27035
iter: 4486, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075376

size_minibatch = 20000
Precon grad coeff: 0.019462, velocity coeff: 0.94923
norm(ch) = 0.25681
iter: 4487, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075376

size_minibatch = 20000
Precon grad coeff: 0.017262, velocity coeff: 0.89143
norm(ch) = 0.2291
iter: 4488, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075376

size_minibatch = 20000
Precon grad coeff: 0.021616, velocity coeff: 1.262
norm(ch) = 0.28933
iter: 4489, Minibatch log likelihood (pre-update): -54.2915, error rate (pre-update): 0.075372

size_minibatch = 20000
Precon grad coeff: 0.02361, velocity coeff: 0.95008
norm(ch) = 0.2751
rho = 1.0931
New lambda: 1.1121e-097
iter: 4490, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075369
iter: 4490, Minibatch log likelihood (post-update): -54.2914, error rate (post-update): 0.075365

size_minibatch = 20000
Precon grad coeff: 0.020464, velocity coeff: 0.94372
norm(ch) = 0.2598
iter: 4491, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075365

size_minibatch = 20000
Precon grad coeff: 0.016159, velocity coeff: 0.92933
norm(ch) = 0.24162
iter: 4492, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075366

size_minibatch = 20000
Precon grad coeff: 0.022126, velocity coeff: 1.1366
norm(ch) = 0.27482
iter: 4493, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075365

size_minibatch = 20000
Precon grad coeff: 0.023513, velocity coeff: 0.98592
norm(ch) = 0.27109
iter: 4494, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075364

size_minibatch = 20000
Precon grad coeff: 0.020198, velocity coeff: 0.94603
norm(ch) = 0.25666
rho = 0.99658
New lambda: 8.605e-098
iter: 4495, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075361
iter: 4495, Minibatch log likelihood (post-update): -54.2914, error rate (post-update): 0.075358

size_minibatch = 20000
Precon grad coeff: 0.017614, velocity coeff: 0.93989
norm(ch) = 0.2414
iter: 4496, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075358

size_minibatch = 20000
Precon grad coeff: 0.019343, velocity coeff: 1.074
norm(ch) = 0.2595
iter: 4497, Minibatch log likelihood (pre-update): -54.2914, error rate (pre-update): 0.075354

size_minibatch = 20000
Precon grad coeff: 0.02519, velocity coeff: 1.1835
norm(ch) = 0.30727
iter: 4498, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075353

size_minibatch = 20000
Precon grad coeff: 0.022055, velocity coeff: 0.87718
norm(ch) = 0.26975
iter: 4499, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075352

size_minibatch = 20000
Precon grad coeff: 0.018789, velocity coeff: 0.91592
New gamma: 0.014733
norm(ch) = 0.24715
rho = 1.0083
New lambda: 6.6584e-098
iter: 4500, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075352
iter: 4500, Minibatch log likelihood (post-update): -54.2913, error rate (post-update): 0.07535
---
Full log-likelihood: -54.2913, error rate: 0.07535
TEST log-likelihood: -55.4488, error rate: 0.43933
Error difference (test - train): 0.36399
---
Full log-likelihood (averaged params): -54.2936, error rate (averaged params): 0.07643
TEST log-likelihood (averaged params): -55.424, error rate (averaged params): 0.43328
Error difference (test - train) (averaged params): 0.35685

size_minibatch = 20000
Precon grad coeff: 0.022513, velocity coeff: 1.0953
norm(ch) = 0.27084
iter: 4501, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.07535

size_minibatch = 20000
Precon grad coeff: 0.027056, velocity coeff: 1.0311
norm(ch) = 0.27935
iter: 4502, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075349

size_minibatch = 20000
Precon grad coeff: 0.022778, velocity coeff: 0.86214
norm(ch) = 0.24093
iter: 4503, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075342

size_minibatch = 20000
Precon grad coeff: 0.023029, velocity coeff: 0.96132
norm(ch) = 0.23169
iter: 4504, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075342

size_minibatch = 20000
Precon grad coeff: 0.01904, velocity coeff: 0.90036
norm(ch) = 0.20873
rho = 1.4574
New lambda: 5.1522e-098
iter: 4505, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.07534
iter: 4505, Minibatch log likelihood (post-update): -54.2913, error rate (post-update): 0.075341

size_minibatch = 20000
Precon grad coeff: 0.025107, velocity coeff: 1.1176
norm(ch) = 0.23332
iter: 4506, Minibatch log likelihood (pre-update): -54.2913, error rate (pre-update): 0.075341

size_minibatch = 20000
Precon grad coeff: 0.024017, velocity coeff: 0.9706
norm(ch) = 0.22655
iter: 4507, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.07534

size_minibatch = 20000
Precon grad coeff: 0.023936, velocity coeff: 1.0002
norm(ch) = 0.22669
iter: 4508, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075339

size_minibatch = 20000
Precon grad coeff: 0.021046, velocity coeff: 0.91171
norm(ch) = 0.20677
iter: 4509, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075335

size_minibatch = 20000
Precon grad coeff: 0.021852, velocity coeff: 1.0885
norm(ch) = 0.22512
rho = 1.0875
New lambda: 3.9866e-098
iter: 4510, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075336
iter: 4510, Minibatch log likelihood (post-update): -54.2912, error rate (post-update): 0.075335

size_minibatch = 20000
Precon grad coeff: 0.023505, velocity coeff: 1.0321
norm(ch) = 0.23243
iter: 4511, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075335

size_minibatch = 20000
Precon grad coeff: 0.028188, velocity coeff: 1.0658
norm(ch) = 0.24781
iter: 4512, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075335

size_minibatch = 20000
Precon grad coeff: 0.021033, velocity coeff: 0.84126
norm(ch) = 0.20856
iter: 4513, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075332

size_minibatch = 20000
Precon grad coeff: 0.020722, velocity coeff: 1.0582
norm(ch) = 0.22079
iter: 4514, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075331

size_minibatch = 20000
Precon grad coeff: 0.023858, velocity coeff: 1.0563
norm(ch) = 0.23333
rho = 1.1951
New lambda: 3.0848e-098
iter: 4515, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075326
iter: 4515, Minibatch log likelihood (post-update): -54.2912, error rate (post-update): 0.075326

size_minibatch = 20000
Precon grad coeff: 0.025808, velocity coeff: 1.0754
norm(ch) = 0.251
iter: 4516, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075326

size_minibatch = 20000
Precon grad coeff: 0.024124, velocity coeff: 0.92832
norm(ch) = 0.23311
iter: 4517, Minibatch log likelihood (pre-update): -54.2912, error rate (pre-update): 0.075323

size_minibatch = 20000
Precon grad coeff: 0.020257, velocity coeff: 0.92454
norm(ch) = 0.21558
iter: 4518, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075323

size_minibatch = 20000
Precon grad coeff: 0.022573, velocity coeff: 1.1056
norm(ch) = 0.23843
iter: 4519, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.07532

size_minibatch = 20000
Precon grad coeff: 0.022878, velocity coeff: 1.0902
New gamma: 0.0088212
norm(ch) = 0.26008
rho = 0.79608
New lambda: 2.3869e-098
iter: 4520, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075321
iter: 4520, Minibatch log likelihood (post-update): -54.2911, error rate (post-update): 0.075317

size_minibatch = 20000
Precon grad coeff: 0.019691, velocity coeff: 0.87995
norm(ch) = 0.22905
iter: 4521, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075317

size_minibatch = 20000
Precon grad coeff: 0.017827, velocity coeff: 1.111
norm(ch) = 0.25464
iter: 4522, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075317

size_minibatch = 20000
Precon grad coeff: 0.020456, velocity coeff: 1.0497
norm(ch) = 0.26746
iter: 4523, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075314

size_minibatch = 20000
Precon grad coeff: 0.022476, velocity coeff: 1.0843
norm(ch) = 0.2902
iter: 4524, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075315

size_minibatch = 20000
Precon grad coeff: 0.018413, velocity coeff: 0.90496
norm(ch) = 0.26281
rho = 0.6714
New lambda: 2.3869e-098
iter: 4525, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075311
iter: 4525, Minibatch log likelihood (post-update): -54.2911, error rate (post-update): 0.075309

size_minibatch = 20000
Precon grad coeff: 0.019213, velocity coeff: 1.0474
norm(ch) = 0.27549
iter: 4526, Minibatch log likelihood (pre-update): -54.2911, error rate (pre-update): 0.075309

size_minibatch = 20000
Precon grad coeff: 0.018476, velocity coeff: 1.0568
norm(ch) = 0.29132
iter: 4527, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075305

size_minibatch = 20000
Precon grad coeff: 0.024272, velocity coeff: 1.0037
norm(ch) = 0.29261
iter: 4528, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075306

size_minibatch = 20000
Precon grad coeff: 0.017935, velocity coeff: 0.87666
norm(ch) = 0.25673
iter: 4529, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075303

size_minibatch = 20000
Precon grad coeff: 0.017332, velocity coeff: 0.97664
norm(ch) = 0.25094
rho = 0.96376
New lambda: 1.847e-098
iter: 4530, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075302
iter: 4530, Minibatch log likelihood (post-update): -54.291, error rate (post-update): 0.075298

size_minibatch = 20000
Precon grad coeff: 0.02222, velocity coeff: 1.2025
norm(ch) = 0.30204
iter: 4531, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075298

size_minibatch = 20000
Precon grad coeff: 0.021285, velocity coeff: 0.8898
norm(ch) = 0.26902
iter: 4532, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075299

size_minibatch = 20000
Precon grad coeff: 0.01826, velocity coeff: 0.94839
norm(ch) = 0.25538
iter: 4533, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075298

size_minibatch = 20000
Precon grad coeff: 0.01819, velocity coeff: 1.0253
norm(ch) = 0.26206
iter: 4534, Minibatch log likelihood (pre-update): -54.291, error rate (pre-update): 0.075297

size_minibatch = 20000
Precon grad coeff: 0.021305, velocity coeff: 1.0788
norm(ch) = 0.28305
rho = 0.89612
New lambda: 1.4292e-098
iter: 4535, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075292
iter: 4535, Minibatch log likelihood (post-update): -54.2909, error rate (post-update): 0.075291

size_minibatch = 20000
Precon grad coeff: 0.020671, velocity coeff: 0.98483
norm(ch) = 0.27907
iter: 4536, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075291

size_minibatch = 20000
Precon grad coeff: 0.018687, velocity coeff: 0.90898
norm(ch) = 0.25398
iter: 4537, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075289

size_minibatch = 20000
Precon grad coeff: 0.018464, velocity coeff: 1.0729
norm(ch) = 0.27279
iter: 4538, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075288

size_minibatch = 20000
Precon grad coeff: 0.019951, velocity coeff: 1.0141
norm(ch) = 0.27695
iter: 4539, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075285

size_minibatch = 20000
Precon grad coeff: 0.020453, velocity coeff: 1.0422
New gamma: 0.0052816
norm(ch) = 0.28932
rho = 1.2519
New lambda: 1.1059e-098
iter: 4540, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075284
iter: 4540, Minibatch log likelihood (post-update): -54.2909, error rate (post-update): 0.075279

size_minibatch = 20000
Precon grad coeff: 0.013429, velocity coeff: 0.85259
norm(ch) = 0.24721
iter: 4541, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075279

size_minibatch = 20000
Precon grad coeff: 0.014173, velocity coeff: 1.0896
norm(ch) = 0.26994
iter: 4542, Minibatch log likelihood (pre-update): -54.2909, error rate (pre-update): 0.075278

size_minibatch = 20000
Precon grad coeff: 0.019544, velocity coeff: 1.2148
norm(ch) = 0.32858
iter: 4543, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075277

size_minibatch = 20000
Precon grad coeff: 0.019347, velocity coeff: 1.0168
norm(ch) = 0.33489
iter: 4544, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075276

size_minibatch = 20000
Precon grad coeff: 0.013032, velocity coeff: 0.79255
norm(ch) = 0.26598
rho = 0.94874
New lambda: 8.5569e-099
iter: 4545, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075273
iter: 4545, Minibatch log likelihood (post-update): -54.2908, error rate (post-update): 0.075273

size_minibatch = 20000
Precon grad coeff: 0.01526, velocity coeff: 1.2075
norm(ch) = 0.32177
iter: 4546, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075273

size_minibatch = 20000
Precon grad coeff: 0.0203, velocity coeff: 1.1406
norm(ch) = 0.36781
iter: 4547, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075269

size_minibatch = 20000
Precon grad coeff: 0.01537, velocity coeff: 0.77201
norm(ch) = 0.28465
iter: 4548, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075267

size_minibatch = 20000
Precon grad coeff: 0.014203, velocity coeff: 1.0592
norm(ch) = 0.30208
iter: 4549, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075264

size_minibatch = 20000
Precon grad coeff: 0.017136, velocity coeff: 1.0751
norm(ch) = 0.32539
rho = 0.94398
New lambda: 6.6211e-099
iter: 4550, Minibatch log likelihood (pre-update): -54.2908, error rate (pre-update): 0.075263
iter: 4550, Minibatch log likelihood (post-update): -54.2907, error rate (post-update): 0.075259
---
Full log-likelihood: -54.2907, error rate: 0.075259
TEST log-likelihood: -55.4527, error rate: 0.43995
Error difference (test - train): 0.36469
---
Full log-likelihood (averaged params): -54.2928, error rate (averaged params): 0.076261
TEST log-likelihood (averaged params): -55.4291, error rate (averaged params): 0.43438
Error difference (test - train) (averaged params): 0.35812

size_minibatch = 20000
Precon grad coeff: 0.016583, velocity coeff: 0.94109
norm(ch) = 0.30682
iter: 4551, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.075259

size_minibatch = 20000
Precon grad coeff: 0.0145, velocity coeff: 0.95611
norm(ch) = 0.29396
iter: 4552, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.07526

size_minibatch = 20000
Precon grad coeff: 0.015613, velocity coeff: 1.04
norm(ch) = 0.30638
iter: 4553, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.075256

size_minibatch = 20000
Precon grad coeff: 0.016833, velocity coeff: 1.0284
norm(ch) = 0.31572
iter: 4554, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.075254

size_minibatch = 20000
Precon grad coeff: 0.015432, velocity coeff: 0.95979
norm(ch) = 0.30344
rho = 1.0921
New lambda: 5.1233e-099
iter: 4555, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.07525
iter: 4555, Minibatch log likelihood (post-update): -54.2907, error rate (post-update): 0.07525

size_minibatch = 20000
Precon grad coeff: 0.014041, velocity coeff: 0.9023
norm(ch) = 0.27425
iter: 4556, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.07525

size_minibatch = 20000
Precon grad coeff: 0.018604, velocity coeff: 1.2344
norm(ch) = 0.33919
iter: 4557, Minibatch log likelihood (pre-update): -54.2907, error rate (pre-update): 0.075247

size_minibatch = 20000
Precon grad coeff: 0.013461, velocity coeff: 0.74377
norm(ch) = 0.25288
iter: 4558, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075247

size_minibatch = 20000
Precon grad coeff: 0.016525, velocity coeff: 1.1547
norm(ch) = 0.29237
iter: 4559, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075246

size_minibatch = 20000
Precon grad coeff: 0.014667, velocity coeff: 1.013
New gamma: 0.0031623
norm(ch) = 0.29705
rho = 0.76119
New lambda: 3.9643e-099
iter: 4560, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075244
iter: 4560, Minibatch log likelihood (post-update): -54.2906, error rate (post-update): 0.075239

size_minibatch = 20000
Precon grad coeff: 0.011959, velocity coeff: 0.92253
norm(ch) = 0.2748
iter: 4561, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075239

size_minibatch = 20000
Precon grad coeff: 0.011522, velocity coeff: 1.0454
norm(ch) = 0.28822
iter: 4562, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075238

size_minibatch = 20000
Precon grad coeff: 0.014951, velocity coeff: 1.2002
norm(ch) = 0.34657
iter: 4563, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075236

size_minibatch = 20000
Precon grad coeff: 0.013585, velocity coeff: 0.96825
norm(ch) = 0.33637
iter: 4564, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075235

size_minibatch = 20000
Precon grad coeff: 0.011983, velocity coeff: 0.92442
norm(ch) = 0.31158
rho = 0.86657
New lambda: 3.0675e-099
iter: 4565, Minibatch log likelihood (pre-update): -54.2906, error rate (pre-update): 0.075233
iter: 4565, Minibatch log likelihood (post-update): -54.2905, error rate (post-update): 0.075231

size_minibatch = 20000
Precon grad coeff: 0.010984, velocity coeff: 1.0492
norm(ch) = 0.32759
iter: 4566, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075231

size_minibatch = 20000
Precon grad coeff: 0.01791, velocity coeff: 1.2061
norm(ch) = 0.39598
iter: 4567, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075226

size_minibatch = 20000
Precon grad coeff: 0.0099174, velocity coeff: 0.69019
norm(ch) = 0.27397
iter: 4568, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075227

size_minibatch = 20000
Precon grad coeff: 0.013665, velocity coeff: 1.2408
norm(ch) = 0.34052
iter: 4569, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075226

size_minibatch = 20000
Precon grad coeff: 0.013084, velocity coeff: 0.92078
norm(ch) = 0.31422
rho = 0.40751
New lambda: 3.0675e-099
iter: 4570, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075223
iter: 4570, Minibatch log likelihood (post-update): -54.2905, error rate (post-update): 0.075219

size_minibatch = 20000
Precon grad coeff: 0.012966, velocity coeff: 0.98971
norm(ch) = 0.31153
iter: 4571, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.075219

size_minibatch = 20000
Precon grad coeff: 0.010967, velocity coeff: 1.0003
norm(ch) = 0.31223
iter: 4572, Minibatch log likelihood (pre-update): -54.2905, error rate (pre-update): 0.07522

size_minibatch = 20000
Precon grad coeff: 0.014758, velocity coeff: 0.97647
norm(ch) = 0.30574
iter: 4573, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075218

size_minibatch = 20000
Precon grad coeff: 0.011608, velocity coeff: 1.0092
norm(ch) = 0.30922
iter: 4574, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075213

size_minibatch = 20000
Precon grad coeff: 0.011957, velocity coeff: 0.91498
norm(ch) = 0.28331
rho = 0.80976
New lambda: 2.3736e-099
iter: 4575, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075208
iter: 4575, Minibatch log likelihood (post-update): -54.2904, error rate (post-update): 0.075209

size_minibatch = 20000
Precon grad coeff: 0.012771, velocity coeff: 1.0906
norm(ch) = 0.30958
iter: 4576, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075209

size_minibatch = 20000
Precon grad coeff: 0.015299, velocity coeff: 1.0229
norm(ch) = 0.3175
iter: 4577, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075208

size_minibatch = 20000
Precon grad coeff: 0.0096416, velocity coeff: 0.81061
norm(ch) = 0.25804
iter: 4578, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075208

size_minibatch = 20000
Precon grad coeff: 0.013651, velocity coeff: 1.174
norm(ch) = 0.30338
iter: 4579, Minibatch log likelihood (pre-update): -54.2904, error rate (pre-update): 0.075206

size_minibatch = 20000
Precon grad coeff: 0.01547, velocity coeff: 1.054
New gamma: 0.0031623
norm(ch) = 0.32061
rho = 0.88984
New lambda: 1.8366e-099
iter: 4580, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075204
iter: 4580, Minibatch log likelihood (post-update): -54.2903, error rate (post-update): 0.075203

size_minibatch = 20000
Precon grad coeff: 0.010056, velocity coeff: 0.76796
norm(ch) = 0.24686
iter: 4581, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075203

size_minibatch = 20000
Precon grad coeff: 0.011024, velocity coeff: 1.236
norm(ch) = 0.30583
iter: 4582, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075203

size_minibatch = 20000
Precon grad coeff: 0.014216, velocity coeff: 1.0613
norm(ch) = 0.32524
iter: 4583, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075199

size_minibatch = 20000
Precon grad coeff: 0.01321, velocity coeff: 0.94952
norm(ch) = 0.30957
iter: 4584, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075196

size_minibatch = 20000
Precon grad coeff: 0.010128, velocity coeff: 0.83555
norm(ch) = 0.25921
rho = 0.87697
New lambda: 1.4212e-099
iter: 4585, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075196
iter: 4585, Minibatch log likelihood (post-update): -54.2903, error rate (post-update): 0.075196

size_minibatch = 20000
Precon grad coeff: 0.01205, velocity coeff: 1.3117
norm(ch) = 0.3405
iter: 4586, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075196

size_minibatch = 20000
Precon grad coeff: 0.015698, velocity coeff: 0.99569
norm(ch) = 0.33985
iter: 4587, Minibatch log likelihood (pre-update): -54.2903, error rate (pre-update): 0.075191

size_minibatch = 20000
Precon grad coeff: 0.0088382, velocity coeff: 0.72409
norm(ch) = 0.2467
iter: 4588, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075189

size_minibatch = 20000
Precon grad coeff: 0.013061, velocity coeff: 1.2468
norm(ch) = 0.30797
iter: 4589, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.07519

size_minibatch = 20000
Precon grad coeff: 0.013852, velocity coeff: 0.98632
norm(ch) = 0.30429
rho = 1.1379
New lambda: 1.0997e-099
iter: 4590, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075191
iter: 4590, Minibatch log likelihood (post-update): -54.2902, error rate (post-update): 0.075185

size_minibatch = 20000
Precon grad coeff: 0.011186, velocity coeff: 0.88137
norm(ch) = 0.26874
iter: 4591, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075185

size_minibatch = 20000
Precon grad coeff: 0.0099706, velocity coeff: 0.98319
norm(ch) = 0.26492
iter: 4592, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075182

size_minibatch = 20000
Precon grad coeff: 0.013604, velocity coeff: 1.086
norm(ch) = 0.28836
iter: 4593, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075181

size_minibatch = 20000
Precon grad coeff: 0.015821, velocity coeff: 1.1102
norm(ch) = 0.3207
iter: 4594, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.075182

size_minibatch = 20000
Precon grad coeff: 0.0090881, velocity coeff: 0.70804
norm(ch) = 0.22749
rho = 1.119
New lambda: 8.509e-100
iter: 4595, Minibatch log likelihood (pre-update): -54.2902, error rate (pre-update): 0.07518
iter: 4595, Minibatch log likelihood (post-update): -54.2901, error rate (post-update): 0.075179

size_minibatch = 20000
Precon grad coeff: 0.013373, velocity coeff: 1.5064
norm(ch) = 0.34323
iter: 4596, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075179

size_minibatch = 20000
Precon grad coeff: 0.014993, velocity coeff: 0.90783
norm(ch) = 0.31241
iter: 4597, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075175

size_minibatch = 20000
Precon grad coeff: 0.010382, velocity coeff: 0.85045
norm(ch) = 0.2662
iter: 4598, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075174

size_minibatch = 20000
Precon grad coeff: 0.010508, velocity coeff: 1.0617
norm(ch) = 0.2829
iter: 4599, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075173

size_minibatch = 20000
Precon grad coeff: 0.015834, velocity coeff: 1.0927
New gamma: 0.0031623
norm(ch) = 0.30981
rho = 1.0889
New lambda: 6.5841e-100
iter: 4600, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075172
iter: 4600, Minibatch log likelihood (post-update): -54.2901, error rate (post-update): 0.075167
---
Full log-likelihood: -54.2901, error rate: 0.075167
TEST log-likelihood: -55.4625, error rate: 0.44183
Error difference (test - train): 0.36666
---
Full log-likelihood (averaged params): -54.2921, error rate (averaged params): 0.076147
TEST log-likelihood (averaged params): -55.4349, error rate (averaged params): 0.43551
Error difference (test - train) (averaged params): 0.35936

size_minibatch = 20000
Precon grad coeff: 0.015321, velocity coeff: 0.98163
norm(ch) = 0.30485
iter: 4601, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075167

size_minibatch = 20000
Precon grad coeff: 0.017897, velocity coeff: 0.97529
norm(ch) = 0.29823
iter: 4602, Minibatch log likelihood (pre-update): -54.2901, error rate (pre-update): 0.075167

size_minibatch = 20000
Precon grad coeff: 0.01279, velocity coeff: 0.89346
norm(ch) = 0.26724
iter: 4603, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075164

size_minibatch = 20000
Precon grad coeff: 0.01346, velocity coeff: 1.2004
norm(ch) = 0.32128
iter: 4604, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075163

size_minibatch = 20000
Precon grad coeff: 0.017001, velocity coeff: 1.0695
norm(ch) = 0.34441
rho = 0.89727
New lambda: 5.0946e-100
iter: 4605, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075163
iter: 4605, Minibatch log likelihood (post-update): -54.29, error rate (post-update): 0.075165

size_minibatch = 20000
Precon grad coeff: 0.015473, velocity coeff: 1.0003
norm(ch) = 0.34522
iter: 4606, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075165

size_minibatch = 20000
Precon grad coeff: 0.013914, velocity coeff: 0.92462
norm(ch) = 0.31989
iter: 4607, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075158

size_minibatch = 20000
Precon grad coeff: 0.011668, velocity coeff: 0.94754
norm(ch) = 0.30372
iter: 4608, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075156

size_minibatch = 20000
Precon grad coeff: 0.016216, velocity coeff: 1.0852
norm(ch) = 0.33026
iter: 4609, Minibatch log likelihood (pre-update): -54.29, error rate (pre-update): 0.075158

size_minibatch = 20000
Precon grad coeff: 0.016951, velocity coeff: 1.0297
norm(ch) = 0.34065
rho = 1.0407
New lambda: 3.9421e-100
iter: 4610, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075159
iter: 4610, Minibatch log likelihood (post-update): -54.2899, error rate (post-update): 0.075153

size_minibatch = 20000
Precon grad coeff: 0.014962, velocity coeff: 0.79691
norm(ch) = 0.27211
iter: 4611, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075153

size_minibatch = 20000
Precon grad coeff: 0.011419, velocity coeff: 1.0163
norm(ch) = 0.27705
iter: 4612, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075152

size_minibatch = 20000
Precon grad coeff: 0.016395, velocity coeff: 1.1514
norm(ch) = 0.31981
iter: 4613, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075149

size_minibatch = 20000
Precon grad coeff: 0.015999, velocity coeff: 0.98529
norm(ch) = 0.31584
iter: 4614, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075147

size_minibatch = 20000
Precon grad coeff: 0.016499, velocity coeff: 0.9863
norm(ch) = 0.31232
rho = 1.0166
New lambda: 3.0503e-100
iter: 4615, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075146
iter: 4615, Minibatch log likelihood (post-update): -54.2899, error rate (post-update): 0.075145

size_minibatch = 20000
Precon grad coeff: 0.012599, velocity coeff: 0.86361
norm(ch) = 0.27023
iter: 4616, Minibatch log likelihood (pre-update): -54.2899, error rate (pre-update): 0.075145

size_minibatch = 20000
Precon grad coeff: 0.013227, velocity coeff: 1.1604
norm(ch) = 0.31418
iter: 4617, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075142

size_minibatch = 20000
Precon grad coeff: 0.017404, velocity coeff: 1.104
norm(ch) = 0.34761
iter: 4618, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075143

size_minibatch = 20000
Precon grad coeff: 0.017853, velocity coeff: 0.97026
norm(ch) = 0.33807
iter: 4619, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.07514

size_minibatch = 20000
Precon grad coeff: 0.016571, velocity coeff: 0.88192
New gamma: 0.0052816
norm(ch) = 0.2986
rho = 1.2818
New lambda: 2.3603e-100
iter: 4620, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075138
iter: 4620, Minibatch log likelihood (post-update): -54.2898, error rate (post-update): 0.075137

size_minibatch = 20000
Precon grad coeff: 0.016959, velocity coeff: 0.94904
norm(ch) = 0.28376
iter: 4621, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075137

size_minibatch = 20000
Precon grad coeff: 0.019468, velocity coeff: 1.0651
norm(ch) = 0.30264
iter: 4622, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075137

size_minibatch = 20000
Precon grad coeff: 0.02204, velocity coeff: 0.97727
norm(ch) = 0.2963
iter: 4623, Minibatch log likelihood (pre-update): -54.2898, error rate (pre-update): 0.075133

size_minibatch = 20000
Precon grad coeff: 0.022896, velocity coeff: 1.0373
norm(ch) = 0.30793
iter: 4624, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.075134

size_minibatch = 20000
Precon grad coeff: 0.026526, velocity coeff: 1.0661
norm(ch) = 0.32897
rho = 0.99475
New lambda: 1.8264e-100
iter: 4625, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.07513
iter: 4625, Minibatch log likelihood (post-update): -54.2897, error rate (post-update): 0.075124

size_minibatch = 20000
Precon grad coeff: 0.022206, velocity coeff: 0.89446
norm(ch) = 0.29473
iter: 4626, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.075124

size_minibatch = 20000
Precon grad coeff: 0.019277, velocity coeff: 0.99785
norm(ch) = 0.29454
iter: 4627, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.075126

size_minibatch = 20000
Precon grad coeff: 0.019665, velocity coeff: 0.99672
norm(ch) = 0.29413
iter: 4628, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.075122

size_minibatch = 20000
Precon grad coeff: 0.01489, velocity coeff: 0.96295
norm(ch) = 0.28345
iter: 4629, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.07512

size_minibatch = 20000
Precon grad coeff: 0.020977, velocity coeff: 1.1147
norm(ch) = 0.31637
rho = 1.0141
New lambda: 1.4132e-100
iter: 4630, Minibatch log likelihood (pre-update): -54.2897, error rate (pre-update): 0.075118
iter: 4630, Minibatch log likelihood (post-update): -54.2896, error rate (post-update): 0.075117

size_minibatch = 20000
Precon grad coeff: 0.02176, velocity coeff: 0.99267
norm(ch) = 0.31445
iter: 4631, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075117

size_minibatch = 20000
Precon grad coeff: 0.021473, velocity coeff: 0.99987
norm(ch) = 0.31486
iter: 4632, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075115

size_minibatch = 20000
Precon grad coeff: 0.023689, velocity coeff: 1.0347
norm(ch) = 0.32635
iter: 4633, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075115

size_minibatch = 20000
Precon grad coeff: 0.023539, velocity coeff: 0.9557
norm(ch) = 0.31227
iter: 4634, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075114

size_minibatch = 20000
Precon grad coeff: 0.017204, velocity coeff: 0.82914
norm(ch) = 0.25923
rho = 0.78092
New lambda: 1.0935e-100
iter: 4635, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075109
iter: 4635, Minibatch log likelihood (post-update): -54.2896, error rate (post-update): 0.075109

size_minibatch = 20000
Precon grad coeff: 0.016726, velocity coeff: 1.1167
norm(ch) = 0.28982
iter: 4636, Minibatch log likelihood (pre-update): -54.2896, error rate (pre-update): 0.075109

size_minibatch = 20000
Precon grad coeff: 0.019988, velocity coeff: 1.0303
norm(ch) = 0.29917
iter: 4637, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075107

size_minibatch = 20000
Precon grad coeff: 0.022179, velocity coeff: 1.0723
norm(ch) = 0.32111
iter: 4638, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075106

size_minibatch = 20000
Precon grad coeff: 0.022716, velocity coeff: 1.0397
norm(ch) = 0.33419
iter: 4639, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075105

size_minibatch = 20000
Precon grad coeff: 0.019619, velocity coeff: 0.90136
New gamma: 0.0031623
norm(ch) = 0.3021
rho = 1.029
New lambda: 8.4613e-101
iter: 4640, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075104
iter: 4640, Minibatch log likelihood (post-update): -54.2895, error rate (post-update): 0.075097

size_minibatch = 20000
Precon grad coeff: 0.017432, velocity coeff: 1.0201
norm(ch) = 0.30892
iter: 4641, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075097

size_minibatch = 20000
Precon grad coeff: 0.017842, velocity coeff: 0.97635
norm(ch) = 0.30237
iter: 4642, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075096

size_minibatch = 20000
Precon grad coeff: 0.013014, velocity coeff: 0.87045
norm(ch) = 0.26377
iter: 4643, Minibatch log likelihood (pre-update): -54.2895, error rate (pre-update): 0.075097

size_minibatch = 20000
Precon grad coeff: 0.018539, velocity coeff: 1.3427
norm(ch) = 0.35513
iter: 4644, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075095

size_minibatch = 20000
Precon grad coeff: 0.019652, velocity coeff: 0.97998
norm(ch) = 0.34899
rho = 1.1714
New lambda: 6.5472e-101
iter: 4645, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075095
iter: 4645, Minibatch log likelihood (post-update): -54.2894, error rate (post-update): 0.075091

size_minibatch = 20000
Precon grad coeff: 0.017729, velocity coeff: 0.99303
norm(ch) = 0.34756
iter: 4646, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075091

size_minibatch = 20000
Precon grad coeff: 0.021366, velocity coeff: 1.1088
norm(ch) = 0.38648
iter: 4647, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075085

size_minibatch = 20000
Precon grad coeff: 0.017991, velocity coeff: 0.87709
norm(ch) = 0.33997
iter: 4648, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075089

size_minibatch = 20000
Precon grad coeff: 0.015222, velocity coeff: 0.92391
norm(ch) = 0.31496
iter: 4649, Minibatch log likelihood (pre-update): -54.2894, error rate (pre-update): 0.075084

size_minibatch = 20000
Precon grad coeff: 0.013423, velocity coeff: 0.9474
norm(ch) = 0.29917
rho = 0.95281
New lambda: 5.0661e-101
iter: 4650, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.07508
iter: 4650, Minibatch log likelihood (post-update): -54.2893, error rate (post-update): 0.075081
---
Full log-likelihood: -54.2893, error rate: 0.075081
TEST log-likelihood: -55.4749, error rate: 0.44426
Error difference (test - train): 0.36918
---
Full log-likelihood (averaged params): -54.2915, error rate (averaged params): 0.076069
TEST log-likelihood (averaged params): -55.443, error rate (averaged params): 0.43708
Error difference (test - train) (averaged params): 0.36101

size_minibatch = 20000
Precon grad coeff: 0.016894, velocity coeff: 1.0584
norm(ch) = 0.31737
iter: 4651, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075081

size_minibatch = 20000
Precon grad coeff: 0.01889, velocity coeff: 1.0131
norm(ch) = 0.32245
iter: 4652, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075081

size_minibatch = 20000
Precon grad coeff: 0.017385, velocity coeff: 0.93421
norm(ch) = 0.30223
iter: 4653, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075073

size_minibatch = 20000
Precon grad coeff: 0.015627, velocity coeff: 0.89684
norm(ch) = 0.27196
iter: 4654, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075072

size_minibatch = 20000
Precon grad coeff: 0.014557, velocity coeff: 1.083
norm(ch) = 0.29499
rho = 0.97035
New lambda: 3.9201e-101
iter: 4655, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075075
iter: 4655, Minibatch log likelihood (post-update): -54.2893, error rate (post-update): 0.075071

size_minibatch = 20000
Precon grad coeff: 0.017114, velocity coeff: 1.1232
norm(ch) = 0.33211
iter: 4656, Minibatch log likelihood (pre-update): -54.2893, error rate (pre-update): 0.075071

size_minibatch = 20000
Precon grad coeff: 0.020334, velocity coeff: 1.0958
norm(ch) = 0.36484
iter: 4657, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.075069

size_minibatch = 20000
Precon grad coeff: 0.018222, velocity coeff: 0.94413
norm(ch) = 0.34517
iter: 4658, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.075065

size_minibatch = 20000
Precon grad coeff: 0.017145, velocity coeff: 0.97397
norm(ch) = 0.33677
iter: 4659, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.075061

size_minibatch = 20000
Precon grad coeff: 0.012689, velocity coeff: 0.81905
New gamma: 0.0031623
norm(ch) = 0.27631
rho = 1.2588
New lambda: 3.0333e-101
iter: 4660, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.075063
iter: 4660, Minibatch log likelihood (post-update): -54.2892, error rate (post-update): 0.07506

size_minibatch = 20000
Precon grad coeff: 0.01383, velocity coeff: 1.1168
norm(ch) = 0.30919
iter: 4661, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.07506

size_minibatch = 20000
Precon grad coeff: 0.016178, velocity coeff: 1.1078
norm(ch) = 0.34308
iter: 4662, Minibatch log likelihood (pre-update): -54.2892, error rate (pre-update): 0.075059

size_minibatch = 20000
Precon grad coeff: 0.01682, velocity coeff: 0.91834
norm(ch) = 0.3155
iter: 4663, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075059

size_minibatch = 20000
Precon grad coeff: 0.017377, velocity coeff: 1.0904
norm(ch) = 0.34447
iter: 4664, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075058

size_minibatch = 20000
Precon grad coeff: 0.014, velocity coeff: 0.77168
norm(ch) = 0.26619
rho = 0.89711
New lambda: 2.3471e-101
iter: 4665, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075051
iter: 4665, Minibatch log likelihood (post-update): -54.2891, error rate (post-update): 0.07505

size_minibatch = 20000
Precon grad coeff: 0.012364, velocity coeff: 1.0999
norm(ch) = 0.29323
iter: 4666, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.07505

size_minibatch = 20000
Precon grad coeff: 0.01783, velocity coeff: 1.0902
norm(ch) = 0.32036
iter: 4667, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075048

size_minibatch = 20000
Precon grad coeff: 0.014641, velocity coeff: 0.92092
norm(ch) = 0.29549
iter: 4668, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075048

size_minibatch = 20000
Precon grad coeff: 0.017881, velocity coeff: 1.0795
norm(ch) = 0.31947
iter: 4669, Minibatch log likelihood (pre-update): -54.2891, error rate (pre-update): 0.075049

size_minibatch = 20000
Precon grad coeff: 0.014055, velocity coeff: 0.81767
norm(ch) = 0.26169
rho = 1.1371
New lambda: 1.8161e-101
iter: 4670, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075046
iter: 4670, Minibatch log likelihood (post-update): -54.289, error rate (post-update): 0.075041

size_minibatch = 20000
Precon grad coeff: 0.012987, velocity coeff: 1.1063
norm(ch) = 0.28995
iter: 4671, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075041

size_minibatch = 20000
Precon grad coeff: 0.01679, velocity coeff: 1.1149
norm(ch) = 0.32396
iter: 4672, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075042

size_minibatch = 20000
Precon grad coeff: 0.016562, velocity coeff: 0.93052
norm(ch) = 0.30226
iter: 4673, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075041

size_minibatch = 20000
Precon grad coeff: 0.015423, velocity coeff: 1.0572
norm(ch) = 0.32012
iter: 4674, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075035

size_minibatch = 20000
Precon grad coeff: 0.015063, velocity coeff: 0.87905
norm(ch) = 0.28192
rho = 0.96907
New lambda: 1.4053e-101
iter: 4675, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075032
iter: 4675, Minibatch log likelihood (post-update): -54.289, error rate (post-update): 0.075035

size_minibatch = 20000
Precon grad coeff: 0.012052, velocity coeff: 1.0019
norm(ch) = 0.28292
iter: 4676, Minibatch log likelihood (pre-update): -54.289, error rate (pre-update): 0.075035

size_minibatch = 20000
Precon grad coeff: 0.016852, velocity coeff: 1.0888
norm(ch) = 0.30866
iter: 4677, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075033

size_minibatch = 20000
Precon grad coeff: 0.016821, velocity coeff: 0.98955
norm(ch) = 0.30618
iter: 4678, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075029

size_minibatch = 20000
Precon grad coeff: 0.016005, velocity coeff: 0.98412
norm(ch) = 0.30214
iter: 4679, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075029

size_minibatch = 20000
Precon grad coeff: 0.016635, velocity coeff: 0.9208
New gamma: 0.0052816
norm(ch) = 0.27845
rho = 1.2397
New lambda: 1.0874e-101
iter: 4680, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075029
iter: 4680, Minibatch log likelihood (post-update): -54.2889, error rate (post-update): 0.075026

size_minibatch = 20000
Precon grad coeff: 0.013824, velocity coeff: 0.97429
norm(ch) = 0.27148
iter: 4681, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075026

size_minibatch = 20000
Precon grad coeff: 0.01976, velocity coeff: 1.1699
norm(ch) = 0.31803
iter: 4682, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075024

size_minibatch = 20000
Precon grad coeff: 0.018975, velocity coeff: 0.90275
norm(ch) = 0.28749
iter: 4683, Minibatch log likelihood (pre-update): -54.2889, error rate (pre-update): 0.075018

size_minibatch = 20000
Precon grad coeff: 0.016059, velocity coeff: 0.91943
norm(ch) = 0.26469
iter: 4684, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.07502

size_minibatch = 20000
Precon grad coeff: 0.017573, velocity coeff: 0.97677
norm(ch) = 0.25878
rho = 1.073
New lambda: 8.414e-102
iter: 4685, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075021
iter: 4685, Minibatch log likelihood (post-update): -54.2888, error rate (post-update): 0.075015

size_minibatch = 20000
Precon grad coeff: 0.013682, velocity coeff: 0.90202
norm(ch) = 0.23359
iter: 4686, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075015

size_minibatch = 20000
Precon grad coeff: 0.017957, velocity coeff: 1.1527
norm(ch) = 0.26952
iter: 4687, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.07501

size_minibatch = 20000
Precon grad coeff: 0.021158, velocity coeff: 1.0405
norm(ch) = 0.28077
iter: 4688, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075014

size_minibatch = 20000
Precon grad coeff: 0.016013, velocity coeff: 0.87382
norm(ch) = 0.24562
iter: 4689, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075014

size_minibatch = 20000
Precon grad coeff: 0.016971, velocity coeff: 1.0587
norm(ch) = 0.26037
rho = 1.2342
New lambda: 6.5106e-102
iter: 4690, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075009
iter: 4690, Minibatch log likelihood (post-update): -54.2888, error rate (post-update): 0.075005

size_minibatch = 20000
Precon grad coeff: 0.015174, velocity coeff: 0.93208
norm(ch) = 0.24293
iter: 4691, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075005

size_minibatch = 20000
Precon grad coeff: 0.017257, velocity coeff: 1.1301
norm(ch) = 0.27469
iter: 4692, Minibatch log likelihood (pre-update): -54.2888, error rate (pre-update): 0.075005

size_minibatch = 20000
Precon grad coeff: 0.019286, velocity coeff: 1.0397
norm(ch) = 0.28583
iter: 4693, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.075003

size_minibatch = 20000
Precon grad coeff: 0.018421, velocity coeff: 0.94674
norm(ch) = 0.27086
iter: 4694, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.075003

size_minibatch = 20000
Precon grad coeff: 0.015015, velocity coeff: 0.9349
norm(ch) = 0.25354
rho = 0.70674
New lambda: 6.5106e-102
iter: 4695, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.075
iter: 4695, Minibatch log likelihood (post-update): -54.2887, error rate (post-update): 0.074997

size_minibatch = 20000
Precon grad coeff: 0.016363, velocity coeff: 1.0613
norm(ch) = 0.26929
iter: 4696, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.074997

size_minibatch = 20000
Precon grad coeff: 0.016249, velocity coeff: 1.0059
norm(ch) = 0.27104
iter: 4697, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.074996

size_minibatch = 20000
Precon grad coeff: 0.017669, velocity coeff: 1.0444
norm(ch) = 0.28327
iter: 4698, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.074998

size_minibatch = 20000
Precon grad coeff: 0.020739, velocity coeff: 1.0462
norm(ch) = 0.2966
iter: 4699, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.074993

size_minibatch = 20000
Precon grad coeff: 0.019549, velocity coeff: 0.83619
New gamma: 0.0088212
norm(ch) = 0.24817
rho = 1.2549
New lambda: 5.0378e-102
iter: 4700, Minibatch log likelihood (pre-update): -54.2887, error rate (pre-update): 0.074991
iter: 4700, Minibatch log likelihood (post-update): -54.2886, error rate (post-update): 0.07499
---
Full log-likelihood: -54.2886, error rate: 0.07499
TEST log-likelihood: -55.4876, error rate: 0.44674
Error difference (test - train): 0.37175
---
Full log-likelihood (averaged params): -54.2909, error rate (averaged params): 0.076
TEST log-likelihood (averaged params): -55.4531, error rate (averaged params): 0.43909
Error difference (test - train) (averaged params): 0.36309

size_minibatch = 20000
Precon grad coeff: 0.020151, velocity coeff: 1.1077
norm(ch) = 0.27503
iter: 4701, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.07499

size_minibatch = 20000
Precon grad coeff: 0.024988, velocity coeff: 0.98097
norm(ch) = 0.26998
iter: 4702, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074986

size_minibatch = 20000
Precon grad coeff: 0.018351, velocity coeff: 0.83575
norm(ch) = 0.22576
iter: 4703, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074982

size_minibatch = 20000
Precon grad coeff: 0.021986, velocity coeff: 1.1292
norm(ch) = 0.25509
iter: 4704, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074985

size_minibatch = 20000
Precon grad coeff: 0.022062, velocity coeff: 0.94492
norm(ch) = 0.24118
rho = 1.2368
New lambda: 3.8981e-102
iter: 4705, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074984
iter: 4705, Minibatch log likelihood (post-update): -54.2886, error rate (post-update): 0.074981

size_minibatch = 20000
Precon grad coeff: 0.01991, velocity coeff: 0.91999
norm(ch) = 0.22201
iter: 4706, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074981

size_minibatch = 20000
Precon grad coeff: 0.021119, velocity coeff: 1.0929
norm(ch) = 0.24282
iter: 4707, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074977

size_minibatch = 20000
Precon grad coeff: 0.022084, velocity coeff: 1.004
norm(ch) = 0.24397
iter: 4708, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074976

size_minibatch = 20000
Precon grad coeff: 0.021527, velocity coeff: 0.96946
norm(ch) = 0.23667
iter: 4709, Minibatch log likelihood (pre-update): -54.2886, error rate (pre-update): 0.074975

size_minibatch = 20000
Precon grad coeff: 0.021075, velocity coeff: 1.0428
norm(ch) = 0.24694
rho = 1.0834
New lambda: 3.0163e-102
iter: 4710, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074974
iter: 4710, Minibatch log likelihood (post-update): -54.2885, error rate (post-update): 0.074967

size_minibatch = 20000
Precon grad coeff: 0.020476, velocity coeff: 0.95597
norm(ch) = 0.23622
iter: 4711, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074967

size_minibatch = 20000
Precon grad coeff: 0.022459, velocity coeff: 1.1066
norm(ch) = 0.26158
iter: 4712, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074968

size_minibatch = 20000
Precon grad coeff: 0.020818, velocity coeff: 0.91737
norm(ch) = 0.24012
iter: 4713, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074969

size_minibatch = 20000
Precon grad coeff: 0.019749, velocity coeff: 1.0513
norm(ch) = 0.25257
iter: 4714, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074966

size_minibatch = 20000
Precon grad coeff: 0.024728, velocity coeff: 1.0659
norm(ch) = 0.26941
rho = 0.88336
New lambda: 2.334e-102
iter: 4715, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074962
iter: 4715, Minibatch log likelihood (post-update): -54.2885, error rate (post-update): 0.074962

size_minibatch = 20000
Precon grad coeff: 0.019761, velocity coeff: 0.87036
norm(ch) = 0.23463
iter: 4716, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074962

size_minibatch = 20000
Precon grad coeff: 0.020754, velocity coeff: 1.0961
norm(ch) = 0.25733
iter: 4717, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074958

size_minibatch = 20000
Precon grad coeff: 0.021667, velocity coeff: 0.97834
norm(ch) = 0.25192
iter: 4718, Minibatch log likelihood (pre-update): -54.2885, error rate (pre-update): 0.074956

size_minibatch = 20000
Precon grad coeff: 0.023133, velocity coeff: 1.0071
norm(ch) = 0.25389
iter: 4719, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074953

size_minibatch = 20000
Precon grad coeff: 0.014732, velocity coeff: 0.91624
New gamma: 0.0052816
norm(ch) = 0.23288
rho = 1.1381
New lambda: 1.806e-102
iter: 4720, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074954
iter: 4720, Minibatch log likelihood (post-update): -54.2884, error rate (post-update): 0.074953

size_minibatch = 20000
Precon grad coeff: 0.015709, velocity coeff: 0.97257
norm(ch) = 0.22678
iter: 4721, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074953

size_minibatch = 20000
Precon grad coeff: 0.015386, velocity coeff: 1.1279
norm(ch) = 0.25603
iter: 4722, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074951

size_minibatch = 20000
Precon grad coeff: 0.019644, velocity coeff: 1.1761
norm(ch) = 0.30144
iter: 4723, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074945

size_minibatch = 20000
Precon grad coeff: 0.015999, velocity coeff: 0.82312
norm(ch) = 0.24847
iter: 4724, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074946

size_minibatch = 20000
Precon grad coeff: 0.015361, velocity coeff: 1.1139
norm(ch) = 0.27711
rho = 1.1196
New lambda: 1.3974e-102
iter: 4725, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074944
iter: 4725, Minibatch log likelihood (post-update): -54.2884, error rate (post-update): 0.07494

size_minibatch = 20000
Precon grad coeff: 0.015398, velocity coeff: 0.97292
norm(ch) = 0.26993
iter: 4726, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.07494

size_minibatch = 20000
Precon grad coeff: 0.017006, velocity coeff: 1.0499
norm(ch) = 0.28378
iter: 4727, Minibatch log likelihood (pre-update): -54.2884, error rate (pre-update): 0.074936

size_minibatch = 20000
Precon grad coeff: 0.016874, velocity coeff: 1.0368
norm(ch) = 0.29463
iter: 4728, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074939

size_minibatch = 20000
Precon grad coeff: 0.01503, velocity coeff: 0.8208
norm(ch) = 0.24219
iter: 4729, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074936

size_minibatch = 20000
Precon grad coeff: 0.01502, velocity coeff: 1.1625
norm(ch) = 0.28193
rho = 1.0894
New lambda: 1.0813e-102
iter: 4730, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074934
iter: 4730, Minibatch log likelihood (post-update): -54.2883, error rate (post-update): 0.07493

size_minibatch = 20000
Precon grad coeff: 0.017698, velocity coeff: 0.91697
norm(ch) = 0.25895
iter: 4731, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.07493

size_minibatch = 20000
Precon grad coeff: 0.015946, velocity coeff: 1.0758
norm(ch) = 0.27902
iter: 4732, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.07493

size_minibatch = 20000
Precon grad coeff: 0.01601, velocity coeff: 0.90099
norm(ch) = 0.25181
iter: 4733, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074926

size_minibatch = 20000
Precon grad coeff: 0.014473, velocity coeff: 0.96272
norm(ch) = 0.24283
iter: 4734, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074925

size_minibatch = 20000
Precon grad coeff: 0.016934, velocity coeff: 1.1331
norm(ch) = 0.2756
rho = 0.98073
New lambda: 8.3669e-103
iter: 4735, Minibatch log likelihood (pre-update): -54.2883, error rate (pre-update): 0.074924
iter: 4735, Minibatch log likelihood (post-update): -54.2882, error rate (post-update): 0.074923

size_minibatch = 20000
Precon grad coeff: 0.01771, velocity coeff: 0.98772
norm(ch) = 0.27275
iter: 4736, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074923

size_minibatch = 20000
Precon grad coeff: 0.014793, velocity coeff: 0.91758
norm(ch) = 0.25074
iter: 4737, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074917

size_minibatch = 20000
Precon grad coeff: 0.016212, velocity coeff: 1.0488
norm(ch) = 0.2634
iter: 4738, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074917

size_minibatch = 20000
Precon grad coeff: 0.014805, velocity coeff: 0.98949
norm(ch) = 0.26097
iter: 4739, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074915

size_minibatch = 20000
Precon grad coeff: 0.018483, velocity coeff: 1.1129
New gamma: 0.0031623
norm(ch) = 0.29149
rho = 1.0284
New lambda: 6.4741e-103
iter: 4740, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074914
iter: 4740, Minibatch log likelihood (post-update): -54.2882, error rate (post-update): 0.07491

size_minibatch = 20000
Precon grad coeff: 0.021038, velocity coeff: 1.0458
norm(ch) = 0.30614
iter: 4741, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.07491

size_minibatch = 20000
Precon grad coeff: 0.020306, velocity coeff: 1.0392
norm(ch) = 0.31938
iter: 4742, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074909

size_minibatch = 20000
Precon grad coeff: 0.017438, velocity coeff: 0.90945
norm(ch) = 0.2915
iter: 4743, Minibatch log likelihood (pre-update): -54.2882, error rate (pre-update): 0.074906

size_minibatch = 20000
Precon grad coeff: 0.016592, velocity coeff: 1.1356
norm(ch) = 0.33217
iter: 4744, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.074906

size_minibatch = 20000
Precon grad coeff: 0.017171, velocity coeff: 0.99024
norm(ch) = 0.32988
rho = 0.99606
New lambda: 5.0096e-103
iter: 4745, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.074902
iter: 4745, Minibatch log likelihood (post-update): -54.2881, error rate (post-update): 0.074901

size_minibatch = 20000
Precon grad coeff: 0.017552, velocity coeff: 1.0964
norm(ch) = 0.36274
iter: 4746, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.074901

size_minibatch = 20000
Precon grad coeff: 0.019338, velocity coeff: 1.01
norm(ch) = 0.36732
iter: 4747, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.074896

size_minibatch = 20000
Precon grad coeff: 0.020408, velocity coeff: 0.99358
norm(ch) = 0.36608
iter: 4748, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.074892

size_minibatch = 20000
Precon grad coeff: 0.016993, velocity coeff: 0.86899
norm(ch) = 0.31893
iter: 4749, Minibatch log likelihood (pre-update): -54.2881, error rate (pre-update): 0.07489

size_minibatch = 20000
Precon grad coeff: 0.015026, velocity coeff: 0.96622
norm(ch) = 0.30887
rho = 0.89446
New lambda: 3.8763e-103
iter: 4750, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.07489
iter: 4750, Minibatch log likelihood (post-update): -54.288, error rate (post-update): 0.074884
---
Full log-likelihood: -54.288, error rate: 0.074884
TEST log-likelihood: -55.4979, error rate: 0.44881
Error difference (test - train): 0.37392
---
Full log-likelihood (averaged params): -54.2902, error rate (averaged params): 0.075871
TEST log-likelihood (averaged params): -55.4642, error rate (averaged params): 0.44132
Error difference (test - train) (averaged params): 0.36545

size_minibatch = 20000
Precon grad coeff: 0.018115, velocity coeff: 1.0944
norm(ch) = 0.33878
iter: 4751, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.074884

size_minibatch = 20000
Precon grad coeff: 0.017349, velocity coeff: 0.92713
norm(ch) = 0.31487
iter: 4752, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.074884

size_minibatch = 20000
Precon grad coeff: 0.018383, velocity coeff: 1.0271
norm(ch) = 0.32405
iter: 4753, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.074882

size_minibatch = 20000
Precon grad coeff: 0.021197, velocity coeff: 1.0792
norm(ch) = 0.35063
iter: 4754, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.074877

size_minibatch = 20000
Precon grad coeff: 0.016947, velocity coeff: 0.8464
norm(ch) = 0.29745
rho = 1.0788
New lambda: 2.9994e-103
iter: 4755, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.07487
iter: 4755, Minibatch log likelihood (post-update): -54.288, error rate (post-update): 0.074871

size_minibatch = 20000
Precon grad coeff: 0.015972, velocity coeff: 0.99911
norm(ch) = 0.29781
iter: 4756, Minibatch log likelihood (pre-update): -54.288, error rate (pre-update): 0.074871

size_minibatch = 20000
Precon grad coeff: 0.016623, velocity coeff: 1.077
norm(ch) = 0.32132
iter: 4757, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.07487

size_minibatch = 20000
Precon grad coeff: 0.018747, velocity coeff: 1.0275
norm(ch) = 0.33089
iter: 4758, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.07487

size_minibatch = 20000
Precon grad coeff: 0.018904, velocity coeff: 0.99624
norm(ch) = 0.3303
iter: 4759, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.074865

size_minibatch = 20000
Precon grad coeff: 0.017926, velocity coeff: 0.95629
New gamma: 0.0031623
norm(ch) = 0.31667
rho = 0.81404
New lambda: 2.3209e-103
iter: 4760, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.074863
iter: 4760, Minibatch log likelihood (post-update): -54.2879, error rate (post-update): 0.07486

size_minibatch = 20000
Precon grad coeff: 0.017151, velocity coeff: 0.96825
norm(ch) = 0.30731
iter: 4761, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.07486

size_minibatch = 20000
Precon grad coeff: 0.013611, velocity coeff: 0.91265
norm(ch) = 0.28098
iter: 4762, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.074856

size_minibatch = 20000
Precon grad coeff: 0.018138, velocity coeff: 1.2313
norm(ch) = 0.34657
iter: 4763, Minibatch log likelihood (pre-update): -54.2879, error rate (pre-update): 0.074854

size_minibatch = 20000
Precon grad coeff: 0.01799, velocity coeff: 0.92658
norm(ch) = 0.32183
iter: 4764, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.074856

size_minibatch = 20000
Precon grad coeff: 0.018791, velocity coeff: 1.0384
norm(ch) = 0.33492
rho = 0.96871
New lambda: 1.7959e-103
iter: 4765, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.07485
iter: 4765, Minibatch log likelihood (post-update): -54.2878, error rate (post-update): 0.074848

size_minibatch = 20000
Precon grad coeff: 0.018822, velocity coeff: 0.97785
norm(ch) = 0.32826
iter: 4766, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.074848

size_minibatch = 20000
Precon grad coeff: 0.016885, velocity coeff: 0.90053
norm(ch) = 0.29628
iter: 4767, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.074846

size_minibatch = 20000
Precon grad coeff: 0.013359, velocity coeff: 0.97408
norm(ch) = 0.2892
iter: 4768, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.074842

size_minibatch = 20000
Precon grad coeff: 0.017833, velocity coeff: 1.1214
norm(ch) = 0.32485
iter: 4769, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.074839

size_minibatch = 20000
Precon grad coeff: 0.018364, velocity coeff: 0.93343
norm(ch) = 0.30398
rho = 0.91292
New lambda: 1.3896e-103
iter: 4770, Minibatch log likelihood (pre-update): -54.2878, error rate (pre-update): 0.07484
iter: 4770, Minibatch log likelihood (post-update): -54.2877, error rate (post-update): 0.074832

size_minibatch = 20000
Precon grad coeff: 0.018113, velocity coeff: 1.0286
norm(ch) = 0.31343
iter: 4771, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.074832

size_minibatch = 20000
Precon grad coeff: 0.021507, velocity coeff: 1.0762
norm(ch) = 0.33811
iter: 4772, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.07483

size_minibatch = 20000
Precon grad coeff: 0.022905, velocity coeff: 1.002
norm(ch) = 0.33977
iter: 4773, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.074831

size_minibatch = 20000
Precon grad coeff: 0.017507, velocity coeff: 0.87157
norm(ch) = 0.29689
iter: 4774, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.074825

size_minibatch = 20000
Precon grad coeff: 0.016758, velocity coeff: 1.0399
norm(ch) = 0.30938
rho = 1.0615
New lambda: 1.0752e-103
iter: 4775, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.074825
iter: 4775, Minibatch log likelihood (post-update): -54.2877, error rate (post-update): 0.074822

size_minibatch = 20000
Precon grad coeff: 0.016716, velocity coeff: 0.94142
norm(ch) = 0.292
iter: 4776, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.074822

size_minibatch = 20000
Precon grad coeff: 0.012508, velocity coeff: 0.98308
norm(ch) = 0.28756
iter: 4777, Minibatch log likelihood (pre-update): -54.2877, error rate (pre-update): 0.07482

size_minibatch = 20000
Precon grad coeff: 0.021625, velocity coeff: 1.2227
norm(ch) = 0.35231
iter: 4778, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074816

size_minibatch = 20000
Precon grad coeff: 0.01913, velocity coeff: 0.88672
norm(ch) = 0.31308
iter: 4779, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074811

size_minibatch = 20000
Precon grad coeff: 0.018798, velocity coeff: 0.97799
New gamma: 0.0031623
norm(ch) = 0.30698
rho = 1.0849
New lambda: 8.3201e-104
iter: 4780, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074812
iter: 4780, Minibatch log likelihood (post-update): -54.2876, error rate (post-update): 0.074812

size_minibatch = 20000
Precon grad coeff: 0.017846, velocity coeff: 0.93337
norm(ch) = 0.28723
iter: 4781, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074812

size_minibatch = 20000
Precon grad coeff: 0.016293, velocity coeff: 1.0076
norm(ch) = 0.29001
iter: 4782, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074804

size_minibatch = 20000
Precon grad coeff: 0.013331, velocity coeff: 0.9215
norm(ch) = 0.26769
iter: 4783, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074801

size_minibatch = 20000
Precon grad coeff: 0.019309, velocity coeff: 1.2342
norm(ch) = 0.33103
iter: 4784, Minibatch log likelihood (pre-update): -54.2876, error rate (pre-update): 0.074805

size_minibatch = 20000
Precon grad coeff: 0.02157, velocity coeff: 1.0102
norm(ch) = 0.33517
rho = 0.92055
New lambda: 6.4379e-104
iter: 4785, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074801
iter: 4785, Minibatch log likelihood (post-update): -54.2875, error rate (post-update): 0.074793

size_minibatch = 20000
Precon grad coeff: 0.018921, velocity coeff: 0.94732
norm(ch) = 0.31821
iter: 4786, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074793

size_minibatch = 20000
Precon grad coeff: 0.017713, velocity coeff: 0.95428
norm(ch) = 0.30424
iter: 4787, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074796

size_minibatch = 20000
Precon grad coeff: 0.014733, velocity coeff: 0.90532
norm(ch) = 0.27597
iter: 4788, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074793

size_minibatch = 20000
Precon grad coeff: 0.014666, velocity coeff: 1.0408
norm(ch) = 0.28774
iter: 4789, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074789

size_minibatch = 20000
Precon grad coeff: 0.017264, velocity coeff: 1.0573
norm(ch) = 0.30477
rho = 1.014
New lambda: 4.9815e-104
iter: 4790, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074784
iter: 4790, Minibatch log likelihood (post-update): -54.2875, error rate (post-update): 0.074785

size_minibatch = 20000
Precon grad coeff: 0.022134, velocity coeff: 1.1252
norm(ch) = 0.34362
iter: 4791, Minibatch log likelihood (pre-update): -54.2875, error rate (pre-update): 0.074785

size_minibatch = 20000
Precon grad coeff: 0.019554, velocity coeff: 0.87635
norm(ch) = 0.30182
iter: 4792, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074786

size_minibatch = 20000
Precon grad coeff: 0.015203, velocity coeff: 0.9205
norm(ch) = 0.27846
iter: 4793, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.07478

size_minibatch = 20000
Precon grad coeff: 0.014043, velocity coeff: 0.99447
norm(ch) = 0.27743
iter: 4794, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074778

size_minibatch = 20000
Precon grad coeff: 0.016383, velocity coeff: 1.0896
norm(ch) = 0.3028
rho = 1.0247
New lambda: 3.8546e-104
iter: 4795, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074777
iter: 4795, Minibatch log likelihood (post-update): -54.2874, error rate (post-update): 0.074777

size_minibatch = 20000
Precon grad coeff: 0.018641, velocity coeff: 1.0354
norm(ch) = 0.31415
iter: 4796, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074777

size_minibatch = 20000
Precon grad coeff: 0.020018, velocity coeff: 0.98602
norm(ch) = 0.3105
iter: 4797, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074769

size_minibatch = 20000
Precon grad coeff: 0.015378, velocity coeff: 0.85286
norm(ch) = 0.26541
iter: 4798, Minibatch log likelihood (pre-update): -54.2874, error rate (pre-update): 0.074768

size_minibatch = 20000
Precon grad coeff: 0.013811, velocity coeff: 1.0013
norm(ch) = 0.26618
iter: 4799, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.07477

size_minibatch = 20000
Precon grad coeff: 0.016776, velocity coeff: 1.144
New gamma: 0.0031623
norm(ch) = 0.30517
rho = 0.92924
New lambda: 2.9826e-104
iter: 4800, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074766
iter: 4800, Minibatch log likelihood (post-update): -54.2873, error rate (post-update): 0.074762
---
Full log-likelihood: -54.2873, error rate: 0.074762
TEST log-likelihood: -55.5117, error rate: 0.45174
Error difference (test - train): 0.37698
---
Full log-likelihood (averaged params): -54.2895, error rate (averaged params): 0.075773
TEST log-likelihood (averaged params): -55.4756, error rate (averaged params): 0.44359
Error difference (test - train) (averaged params): 0.36782

size_minibatch = 20000
Precon grad coeff: 0.019197, velocity coeff: 1.0567
norm(ch) = 0.32317
iter: 4801, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074762

size_minibatch = 20000
Precon grad coeff: 0.020413, velocity coeff: 1.0199
norm(ch) = 0.33033
iter: 4802, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074759

size_minibatch = 20000
Precon grad coeff: 0.019067, velocity coeff: 0.94853
norm(ch) = 0.31401
iter: 4803, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074759

size_minibatch = 20000
Precon grad coeff: 0.017383, velocity coeff: 0.98243
norm(ch) = 0.30915
iter: 4804, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.07476

size_minibatch = 20000
Precon grad coeff: 0.014327, velocity coeff: 0.83018
norm(ch) = 0.25715
rho = 0.93036
New lambda: 2.3079e-104
iter: 4805, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074756
iter: 4805, Minibatch log likelihood (post-update): -54.2873, error rate (post-update): 0.074751

size_minibatch = 20000
Precon grad coeff: 0.01346, velocity coeff: 1.0359
norm(ch) = 0.26679
iter: 4806, Minibatch log likelihood (pre-update): -54.2873, error rate (pre-update): 0.074751

size_minibatch = 20000
Precon grad coeff: 0.016998, velocity coeff: 1.1111
norm(ch) = 0.29694
iter: 4807, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074751

size_minibatch = 20000
Precon grad coeff: 0.019335, velocity coeff: 1.061
norm(ch) = 0.31573
iter: 4808, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074748

size_minibatch = 20000
Precon grad coeff: 0.020601, velocity coeff: 1.0073
norm(ch) = 0.31868
iter: 4809, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074744

size_minibatch = 20000
Precon grad coeff: 0.017557, velocity coeff: 0.91876
norm(ch) = 0.29341
rho = 0.66257
New lambda: 2.3079e-104
iter: 4810, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074744
iter: 4810, Minibatch log likelihood (post-update): -54.2872, error rate (post-update): 0.074745

size_minibatch = 20000
Precon grad coeff: 0.021104, velocity coeff: 1.1576
norm(ch) = 0.34036
iter: 4811, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074745

size_minibatch = 20000
Precon grad coeff: 0.019707, velocity coeff: 0.91412
norm(ch) = 0.31175
iter: 4812, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074743

size_minibatch = 20000
Precon grad coeff: 0.017327, velocity coeff: 0.94516
norm(ch) = 0.29514
iter: 4813, Minibatch log likelihood (pre-update): -54.2872, error rate (pre-update): 0.074738

size_minibatch = 20000
Precon grad coeff: 0.015643, velocity coeff: 0.93289
norm(ch) = 0.27579
iter: 4814, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074736

size_minibatch = 20000
Precon grad coeff: 0.012694, velocity coeff: 0.93525
norm(ch) = 0.25832
rho = 1.0931
New lambda: 1.7858e-104
iter: 4815, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074736
iter: 4815, Minibatch log likelihood (post-update): -54.2871, error rate (post-update): 0.074732

size_minibatch = 20000
Precon grad coeff: 0.015799, velocity coeff: 1.131
norm(ch) = 0.29261
iter: 4816, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074732

size_minibatch = 20000
Precon grad coeff: 0.020191, velocity coeff: 1.1092
norm(ch) = 0.32512
iter: 4817, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.07473

size_minibatch = 20000
Precon grad coeff: 0.018466, velocity coeff: 0.90801
norm(ch) = 0.29578
iter: 4818, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074732

size_minibatch = 20000
Precon grad coeff: 0.019341, velocity coeff: 1.0414
norm(ch) = 0.30858
iter: 4819, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074729

size_minibatch = 20000
Precon grad coeff: 0.01875, velocity coeff: 0.98249
New gamma: 0.0031623
norm(ch) = 0.30369
rho = 1.0157
New lambda: 1.3818e-104
iter: 4820, Minibatch log likelihood (pre-update): -54.2871, error rate (pre-update): 0.074723
iter: 4820, Minibatch log likelihood (post-update): -54.2871, error rate (post-update): 0.074721

size_minibatch = 20000
Precon grad coeff: 0.019876, velocity coeff: 1.0552
norm(ch) = 0.32106
iter: 4821, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074721

size_minibatch = 20000
Precon grad coeff: 0.015433, velocity coeff: 0.82435
norm(ch) = 0.26522
iter: 4822, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074722

size_minibatch = 20000
Precon grad coeff: 0.013786, velocity coeff: 1.0097
norm(ch) = 0.26823
iter: 4823, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074718

size_minibatch = 20000
Precon grad coeff: 0.014311, velocity coeff: 1.0407
norm(ch) = 0.27944
iter: 4824, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074716

size_minibatch = 20000
Precon grad coeff: 0.017278, velocity coeff: 1.0834
norm(ch) = 0.30324
rho = 1.0256
New lambda: 1.0692e-104
iter: 4825, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074712
iter: 4825, Minibatch log likelihood (post-update): -54.287, error rate (post-update): 0.074714

size_minibatch = 20000
Precon grad coeff: 0.019693, velocity coeff: 1.0669
norm(ch) = 0.32405
iter: 4826, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074714

size_minibatch = 20000
Precon grad coeff: 0.016427, velocity coeff: 0.88347
norm(ch) = 0.28675
iter: 4827, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074712

size_minibatch = 20000
Precon grad coeff: 0.016734, velocity coeff: 0.99656
norm(ch) = 0.28632
iter: 4828, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074711

size_minibatch = 20000
Precon grad coeff: 0.01322, velocity coeff: 0.8513
norm(ch) = 0.24419
iter: 4829, Minibatch log likelihood (pre-update): -54.287, error rate (pre-update): 0.074707

size_minibatch = 20000
Precon grad coeff: 0.015347, velocity coeff: 1.22
norm(ch) = 0.29821
rho = 1.2932
New lambda: 8.2735e-105
iter: 4830, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074707
iter: 4830, Minibatch log likelihood (post-update): -54.2869, error rate (post-update): 0.074706

size_minibatch = 20000
Precon grad coeff: 0.016788, velocity coeff: 0.94874
norm(ch) = 0.28336
iter: 4831, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074706

size_minibatch = 20000
Precon grad coeff: 0.017527, velocity coeff: 1.0725
norm(ch) = 0.3044
iter: 4832, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074705

size_minibatch = 20000
Precon grad coeff: 0.016454, velocity coeff: 0.91685
norm(ch) = 0.27962
iter: 4833, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.0747

size_minibatch = 20000
Precon grad coeff: 0.014114, velocity coeff: 0.94019
norm(ch) = 0.26333
iter: 4834, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.0747

size_minibatch = 20000
Precon grad coeff: 0.01378, velocity coeff: 0.9942
norm(ch) = 0.26211
rho = 0.97158
New lambda: 6.4019e-105
iter: 4835, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074697
iter: 4835, Minibatch log likelihood (post-update): -54.2869, error rate (post-update): 0.074694

size_minibatch = 20000
Precon grad coeff: 0.016652, velocity coeff: 1.1267
norm(ch) = 0.29571
iter: 4836, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074694

size_minibatch = 20000
Precon grad coeff: 0.019204, velocity coeff: 0.99226
norm(ch) = 0.29399
iter: 4837, Minibatch log likelihood (pre-update): -54.2869, error rate (pre-update): 0.074693

size_minibatch = 20000
Precon grad coeff: 0.015672, velocity coeff: 0.92899
norm(ch) = 0.27351
iter: 4838, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074696

size_minibatch = 20000
Precon grad coeff: 0.016047, velocity coeff: 1.0316
norm(ch) = 0.28269
iter: 4839, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074692

size_minibatch = 20000
Precon grad coeff: 0.013836, velocity coeff: 0.81061
New gamma: 0.0052816
norm(ch) = 0.2294
rho = 1.069
New lambda: 4.9536e-105
iter: 4840, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.07469
iter: 4840, Minibatch log likelihood (post-update): -54.2868, error rate (post-update): 0.074689

size_minibatch = 20000
Precon grad coeff: 0.017465, velocity coeff: 1.2463
norm(ch) = 0.28615
iter: 4841, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074689

size_minibatch = 20000
Precon grad coeff: 0.021245, velocity coeff: 0.94455
norm(ch) = 0.27051
iter: 4842, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074687

size_minibatch = 20000
Precon grad coeff: 0.017986, velocity coeff: 0.95346
norm(ch) = 0.25821
iter: 4843, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074682

size_minibatch = 20000
Precon grad coeff: 0.017638, velocity coeff: 0.92717
norm(ch) = 0.23958
iter: 4844, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074682

size_minibatch = 20000
Precon grad coeff: 0.014275, velocity coeff: 0.92999
norm(ch) = 0.22314
rho = 0.89193
New lambda: 3.833e-105
iter: 4845, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074679
iter: 4845, Minibatch log likelihood (post-update): -54.2868, error rate (post-update): 0.074679

size_minibatch = 20000
Precon grad coeff: 0.017939, velocity coeff: 1.2177
norm(ch) = 0.27185
iter: 4846, Minibatch log likelihood (pre-update): -54.2868, error rate (pre-update): 0.074679

size_minibatch = 20000
Precon grad coeff: 0.019206, velocity coeff: 0.96123
norm(ch) = 0.26146
iter: 4847, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074677

size_minibatch = 20000
Precon grad coeff: 0.018177, velocity coeff: 0.97081
norm(ch) = 0.25397
iter: 4848, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074675

size_minibatch = 20000
Precon grad coeff: 0.015334, velocity coeff: 0.90614
norm(ch) = 0.23033
iter: 4849, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074672

size_minibatch = 20000
Precon grad coeff: 0.014942, velocity coeff: 0.9986
norm(ch) = 0.23023
rho = 0.87677
New lambda: 2.9659e-105
iter: 4850, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074674
iter: 4850, Minibatch log likelihood (post-update): -54.2867, error rate (post-update): 0.074673
---
Full log-likelihood: -54.2867, error rate: 0.074673
TEST log-likelihood: -55.5262, error rate: 0.45499
Error difference (test - train): 0.38032
---
Full log-likelihood (averaged params): -54.2889, error rate (averaged params): 0.075678
TEST log-likelihood (averaged params): -55.4883, error rate (averaged params): 0.44622
Error difference (test - train) (averaged params): 0.37055

size_minibatch = 20000
Precon grad coeff: 0.019208, velocity coeff: 1.1209
norm(ch) = 0.25825
iter: 4851, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074673

size_minibatch = 20000
Precon grad coeff: 0.020915, velocity coeff: 0.98708
norm(ch) = 0.25502
iter: 4852, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074668

size_minibatch = 20000
Precon grad coeff: 0.017526, velocity coeff: 0.9079
norm(ch) = 0.23178
iter: 4853, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074666

size_minibatch = 20000
Precon grad coeff: 0.015093, velocity coeff: 1.0094
norm(ch) = 0.23414
iter: 4854, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074666

size_minibatch = 20000
Precon grad coeff: 0.015844, velocity coeff: 0.99986
norm(ch) = 0.23434
rho = 1.344
New lambda: 2.295e-105
iter: 4855, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074663
iter: 4855, Minibatch log likelihood (post-update): -54.2867, error rate (post-update): 0.074663

size_minibatch = 20000
Precon grad coeff: 0.020614, velocity coeff: 1.2304
norm(ch) = 0.28847
iter: 4856, Minibatch log likelihood (pre-update): -54.2867, error rate (pre-update): 0.074663

size_minibatch = 20000
Precon grad coeff: 0.019531, velocity coeff: 0.90866
norm(ch) = 0.26236
iter: 4857, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074662

size_minibatch = 20000
Precon grad coeff: 0.015187, velocity coeff: 0.89916
norm(ch) = 0.23605
iter: 4858, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074658

size_minibatch = 20000
Precon grad coeff: 0.015154, velocity coeff: 1.0234
norm(ch) = 0.24176
iter: 4859, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074655

size_minibatch = 20000
Precon grad coeff: 0.017535, velocity coeff: 1.0466
New gamma: 0.0052816
norm(ch) = 0.25323
rho = 0.97503
New lambda: 1.7758e-105
iter: 4860, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074655
iter: 4860, Minibatch log likelihood (post-update): -54.2866, error rate (post-update): 0.074652

size_minibatch = 20000
Precon grad coeff: 0.018228, velocity coeff: 1.0485
norm(ch) = 0.2658
iter: 4861, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074652

size_minibatch = 20000
Precon grad coeff: 0.015461, velocity coeff: 0.85022
norm(ch) = 0.2261
iter: 4862, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.07465

size_minibatch = 20000
Precon grad coeff: 0.013781, velocity coeff: 1.0311
norm(ch) = 0.23329
iter: 4863, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.07465

size_minibatch = 20000
Precon grad coeff: 0.018675, velocity coeff: 1.1276
norm(ch) = 0.26324
iter: 4864, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074651

size_minibatch = 20000
Precon grad coeff: 0.01708, velocity coeff: 0.95331
norm(ch) = 0.25121
rho = 1.0991
New lambda: 1.3741e-105
iter: 4865, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074645
iter: 4865, Minibatch log likelihood (post-update): -54.2866, error rate (post-update): 0.074643

size_minibatch = 20000
Precon grad coeff: 0.016408, velocity coeff: 0.92349
norm(ch) = 0.23219
iter: 4866, Minibatch log likelihood (pre-update): -54.2866, error rate (pre-update): 0.074643

size_minibatch = 20000
Precon grad coeff: 0.013603, velocity coeff: 0.97949
norm(ch) = 0.22766
iter: 4867, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074642

size_minibatch = 20000
Precon grad coeff: 0.01782, velocity coeff: 1.1138
norm(ch) = 0.25379
iter: 4868, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074642

size_minibatch = 20000
Precon grad coeff: 0.018422, velocity coeff: 1.0219
norm(ch) = 0.25964
iter: 4869, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074639

size_minibatch = 20000
Precon grad coeff: 0.015171, velocity coeff: 0.8583
norm(ch) = 0.22303
rho = 0.8685
New lambda: 1.0632e-105
iter: 4870, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074637
iter: 4870, Minibatch log likelihood (post-update): -54.2865, error rate (post-update): 0.074634

size_minibatch = 20000
Precon grad coeff: 0.014952, velocity coeff: 1.1056
norm(ch) = 0.24683
iter: 4871, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074634

size_minibatch = 20000
Precon grad coeff: 0.015257, velocity coeff: 0.96179
norm(ch) = 0.23767
iter: 4872, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074634

size_minibatch = 20000
Precon grad coeff: 0.020021, velocity coeff: 1.1447
norm(ch) = 0.27235
iter: 4873, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074632

size_minibatch = 20000
Precon grad coeff: 0.015835, velocity coeff: 0.83446
norm(ch) = 0.22745
iter: 4874, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074629

size_minibatch = 20000
Precon grad coeff: 0.014001, velocity coeff: 1.03
norm(ch) = 0.23453
rho = 1.0132
New lambda: 8.2272e-106
iter: 4875, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074627
iter: 4875, Minibatch log likelihood (post-update): -54.2865, error rate (post-update): 0.074628

size_minibatch = 20000
Precon grad coeff: 0.016069, velocity coeff: 1.015
norm(ch) = 0.23831
iter: 4876, Minibatch log likelihood (pre-update): -54.2865, error rate (pre-update): 0.074628

size_minibatch = 20000
Precon grad coeff: 0.018804, velocity coeff: 1.1233
norm(ch) = 0.26804
iter: 4877, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074625

size_minibatch = 20000
Precon grad coeff: 0.017095, velocity coeff: 0.93009
norm(ch) = 0.24954
iter: 4878, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074623

size_minibatch = 20000
Precon grad coeff: 0.013031, velocity coeff: 0.85852
norm(ch) = 0.21443
iter: 4879, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074622

size_minibatch = 20000
Precon grad coeff: 0.017922, velocity coeff: 1.2393
New gamma: 0.0031623
norm(ch) = 0.26633
rho = 1.148
New lambda: 6.366e-106
iter: 4880, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074622
iter: 4880, Minibatch log likelihood (post-update): -54.2864, error rate (post-update): 0.074617

size_minibatch = 20000
Precon grad coeff: 0.019624, velocity coeff: 0.97312
norm(ch) = 0.25997
iter: 4881, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074617

size_minibatch = 20000
Precon grad coeff: 0.017082, velocity coeff: 1
norm(ch) = 0.26074
iter: 4882, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074617

size_minibatch = 20000
Precon grad coeff: 0.019686, velocity coeff: 1.1279
norm(ch) = 0.29506
iter: 4883, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074614

size_minibatch = 20000
Precon grad coeff: 0.012267, velocity coeff: 0.79616
norm(ch) = 0.23556
iter: 4884, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.074612

size_minibatch = 20000
Precon grad coeff: 0.017481, velocity coeff: 1.3342
norm(ch) = 0.31492
rho = 0.862
New lambda: 4.9259e-106
iter: 4885, Minibatch log likelihood (pre-update): -54.2864, error rate (pre-update): 0.07461
iter: 4885, Minibatch log likelihood (post-update): -54.2863, error rate (post-update): 0.07461

size_minibatch = 20000
Precon grad coeff: 0.017851, velocity coeff: 0.99981
norm(ch) = 0.31562
iter: 4886, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.07461

size_minibatch = 20000
Precon grad coeff: 0.019269, velocity coeff: 1.0278
norm(ch) = 0.32525
iter: 4887, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074605

size_minibatch = 20000
Precon grad coeff: 0.018557, velocity coeff: 0.99656
norm(ch) = 0.325
iter: 4888, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074606

size_minibatch = 20000
Precon grad coeff: 0.019853, velocity coeff: 0.9781
norm(ch) = 0.31868
iter: 4889, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074604

size_minibatch = 20000
Precon grad coeff: 0.015875, velocity coeff: 0.85521
norm(ch) = 0.27331
rho = 0.8055
New lambda: 3.8116e-106
iter: 4890, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074599
iter: 4890, Minibatch log likelihood (post-update): -54.2863, error rate (post-update): 0.074598

size_minibatch = 20000
Precon grad coeff: 0.013639, velocity coeff: 0.93013
norm(ch) = 0.25469
iter: 4891, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074598

size_minibatch = 20000
Precon grad coeff: 0.017097, velocity coeff: 1.1671
norm(ch) = 0.29776
iter: 4892, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074598

size_minibatch = 20000
Precon grad coeff: 0.016698, velocity coeff: 0.94026
norm(ch) = 0.28052
iter: 4893, Minibatch log likelihood (pre-update): -54.2863, error rate (pre-update): 0.074594

size_minibatch = 20000
Precon grad coeff: 0.019025, velocity coeff: 1.1534
norm(ch) = 0.32425
iter: 4894, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074595

size_minibatch = 20000
Precon grad coeff: 0.019484, velocity coeff: 0.9061
norm(ch) = 0.29449
rho = 1.1521
New lambda: 2.9493e-106
iter: 4895, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074592
iter: 4895, Minibatch log likelihood (post-update): -54.2862, error rate (post-update): 0.074589

size_minibatch = 20000
Precon grad coeff: 0.013055, velocity coeff: 0.86584
norm(ch) = 0.25557
iter: 4896, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074589

size_minibatch = 20000
Precon grad coeff: 0.015368, velocity coeff: 1.0732
norm(ch) = 0.27453
iter: 4897, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074587

size_minibatch = 20000
Precon grad coeff: 0.015583, velocity coeff: 0.94007
norm(ch) = 0.25853
iter: 4898, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074586

size_minibatch = 20000
Precon grad coeff: 0.019479, velocity coeff: 1.1981
norm(ch) = 0.31037
iter: 4899, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074582

size_minibatch = 20000
Precon grad coeff: 0.019923, velocity coeff: 0.94926
New gamma: 0.0031623
norm(ch) = 0.29529
rho = 1.1726
New lambda: 2.2821e-106
iter: 4900, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.07458
iter: 4900, Minibatch log likelihood (post-update): -54.2861, error rate (post-update): 0.074577
---
Full log-likelihood: -54.2861, error rate: 0.074577
TEST log-likelihood: -55.5383, error rate: 0.45764
Error difference (test - train): 0.38306
---
Full log-likelihood (averaged params): -54.2882, error rate (averaged params): 0.075543
TEST log-likelihood (averaged params): -55.5014, error rate (averaged params): 0.44903
Error difference (test - train) (averaged params): 0.37349

size_minibatch = 20000
Precon grad coeff: 0.018558, velocity coeff: 1.0263
norm(ch) = 0.30365
iter: 4901, Minibatch log likelihood (pre-update): -54.2862, error rate (pre-update): 0.074577

size_minibatch = 20000
Precon grad coeff: 0.011666, velocity coeff: 0.73567
norm(ch) = 0.22399
iter: 4902, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074578

size_minibatch = 20000
Precon grad coeff: 0.011641, velocity coeff: 1.1207
norm(ch) = 0.25118
iter: 4903, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074578

size_minibatch = 20000
Precon grad coeff: 0.014966, velocity coeff: 1.0779
norm(ch) = 0.2712
iter: 4904, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074578

size_minibatch = 20000
Precon grad coeff: 0.016963, velocity coeff: 1.0609
norm(ch) = 0.28832
rho = 1.0407
New lambda: 1.7659e-106
iter: 4905, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074574
iter: 4905, Minibatch log likelihood (post-update): -54.2861, error rate (post-update): 0.074571

size_minibatch = 20000
Precon grad coeff: 0.018544, velocity coeff: 1.035
norm(ch) = 0.29903
iter: 4906, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074571

size_minibatch = 20000
Precon grad coeff: 0.016313, velocity coeff: 0.8805
norm(ch) = 0.26383
iter: 4907, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074567

size_minibatch = 20000
Precon grad coeff: 0.010867, velocity coeff: 0.83926
norm(ch) = 0.22183
iter: 4908, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.074569

size_minibatch = 20000
Precon grad coeff: 0.011842, velocity coeff: 1.1789
norm(ch) = 0.26191
iter: 4909, Minibatch log likelihood (pre-update): -54.2861, error rate (pre-update): 0.07457

size_minibatch = 20000
Precon grad coeff: 0.016257, velocity coeff: 1.1271
norm(ch) = 0.29569
rho = 1.1609
New lambda: 1.3664e-106
iter: 4910, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074565
iter: 4910, Minibatch log likelihood (post-update): -54.286, error rate (post-update): 0.074562

size_minibatch = 20000
Precon grad coeff: 0.018957, velocity coeff: 1.0167
norm(ch) = 0.30124
iter: 4911, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074562

size_minibatch = 20000
Precon grad coeff: 0.015475, velocity coeff: 0.90982
norm(ch) = 0.27456
iter: 4912, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074565

size_minibatch = 20000
Precon grad coeff: 0.018956, velocity coeff: 1.1253
norm(ch) = 0.30947
iter: 4913, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074559

size_minibatch = 20000
Precon grad coeff: 0.015593, velocity coeff: 0.79696
norm(ch) = 0.24732
iter: 4914, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074556

size_minibatch = 20000
Precon grad coeff: 0.010784, velocity coeff: 0.91646
norm(ch) = 0.22703
rho = 1.2275
New lambda: 1.0573e-106
iter: 4915, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074556
iter: 4915, Minibatch log likelihood (post-update): -54.286, error rate (post-update): 0.074557

size_minibatch = 20000
Precon grad coeff: 0.013686, velocity coeff: 1.1593
norm(ch) = 0.26341
iter: 4916, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074557

size_minibatch = 20000
Precon grad coeff: 0.016292, velocity coeff: 1.0892
norm(ch) = 0.28739
iter: 4917, Minibatch log likelihood (pre-update): -54.286, error rate (pre-update): 0.074553

size_minibatch = 20000
Precon grad coeff: 0.015239, velocity coeff: 1.015
norm(ch) = 0.29213
iter: 4918, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074554

size_minibatch = 20000
Precon grad coeff: 0.015199, velocity coeff: 0.89703
norm(ch) = 0.26258
iter: 4919, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074552

size_minibatch = 20000
Precon grad coeff: 0.010102, velocity coeff: 0.89555
New gamma: 0.0052816
norm(ch) = 0.23529
rho = 1.0277
New lambda: 8.1811e-107
iter: 4920, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074552
iter: 4920, Minibatch log likelihood (post-update): -54.2859, error rate (post-update): 0.074549

size_minibatch = 20000
Precon grad coeff: 0.017214, velocity coeff: 1.0919
norm(ch) = 0.25704
iter: 4921, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074549

size_minibatch = 20000
Precon grad coeff: 0.018439, velocity coeff: 0.98768
norm(ch) = 0.25417
iter: 4922, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074546

size_minibatch = 20000
Precon grad coeff: 0.018727, velocity coeff: 0.98394
norm(ch) = 0.2503
iter: 4923, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074543

size_minibatch = 20000
Precon grad coeff: 0.02216, velocity coeff: 0.99281
norm(ch) = 0.24878
iter: 4924, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074545

size_minibatch = 20000
Precon grad coeff: 0.014981, velocity coeff: 0.76809
norm(ch) = 0.19139
rho = 0.79953
New lambda: 6.3304e-107
iter: 4925, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074541
iter: 4925, Minibatch log likelihood (post-update): -54.2859, error rate (post-update): 0.07454

size_minibatch = 20000
Precon grad coeff: 0.012124, velocity coeff: 1.084
norm(ch) = 0.20755
iter: 4926, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.07454

size_minibatch = 20000
Precon grad coeff: 0.014603, velocity coeff: 1.0331
norm(ch) = 0.21456
iter: 4927, Minibatch log likelihood (pre-update): -54.2859, error rate (pre-update): 0.074538

size_minibatch = 20000
Precon grad coeff: 0.018751, velocity coeff: 1.1683
norm(ch) = 0.2509
iter: 4928, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074539

size_minibatch = 20000
Precon grad coeff: 0.021932, velocity coeff: 1.0621
norm(ch) = 0.26677
iter: 4929, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074539

size_minibatch = 20000
Precon grad coeff: 0.019696, velocity coeff: 0.91426
norm(ch) = 0.24418
rho = 0.86891
New lambda: 4.8983e-107
iter: 4930, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074536
iter: 4930, Minibatch log likelihood (post-update): -54.2858, error rate (post-update): 0.074535

size_minibatch = 20000
Precon grad coeff: 0.010033, velocity coeff: 0.7046
norm(ch) = 0.17216
iter: 4931, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074535

size_minibatch = 20000
Precon grad coeff: 0.017448, velocity coeff: 1.4881
norm(ch) = 0.25641
iter: 4932, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074534

size_minibatch = 20000
Precon grad coeff: 0.017701, velocity coeff: 0.93635
norm(ch) = 0.24029
iter: 4933, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074533

size_minibatch = 20000
Precon grad coeff: 0.019472, velocity coeff: 1.0899
norm(ch) = 0.2621
iter: 4934, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.07453

size_minibatch = 20000
Precon grad coeff: 0.018593, velocity coeff: 0.94027
norm(ch) = 0.24673
rho = 0.7119
New lambda: 4.8983e-107
iter: 4935, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074528
iter: 4935, Minibatch log likelihood (post-update): -54.2858, error rate (post-update): 0.074529

size_minibatch = 20000
Precon grad coeff: 0.012211, velocity coeff: 0.80174
norm(ch) = 0.19804
iter: 4936, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074529

size_minibatch = 20000
Precon grad coeff: 0.012806, velocity coeff: 1.0934
norm(ch) = 0.21664
iter: 4937, Minibatch log likelihood (pre-update): -54.2858, error rate (pre-update): 0.074527

size_minibatch = 20000
Precon grad coeff: 0.018432, velocity coeff: 1.1514
norm(ch) = 0.24964
iter: 4938, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074525

size_minibatch = 20000
Precon grad coeff: 0.022694, velocity coeff: 1.0534
norm(ch) = 0.2633
iter: 4939, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074521

size_minibatch = 20000
Precon grad coeff: 0.019172, velocity coeff: 0.84895
New gamma: 0.0088212
norm(ch) = 0.2237
rho = 1.2031
New lambda: 3.7902e-107
iter: 4940, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074523
iter: 4940, Minibatch log likelihood (post-update): -54.2857, error rate (post-update): 0.074523

size_minibatch = 20000
Precon grad coeff: 0.015667, velocity coeff: 0.85041
norm(ch) = 0.1903
iter: 4941, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074523

size_minibatch = 20000
Precon grad coeff: 0.01685, velocity coeff: 1.1251
norm(ch) = 0.21425
iter: 4942, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.07452

size_minibatch = 20000
Precon grad coeff: 0.022966, velocity coeff: 1.1255
norm(ch) = 0.24135
iter: 4943, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.07452

size_minibatch = 20000
Precon grad coeff: 0.022419, velocity coeff: 0.93385
norm(ch) = 0.22556
iter: 4944, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074516

size_minibatch = 20000
Precon grad coeff: 0.019176, velocity coeff: 0.9024
norm(ch) = 0.20369
rho = 1.1076
New lambda: 2.9328e-107
iter: 4945, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074512
iter: 4945, Minibatch log likelihood (post-update): -54.2857, error rate (post-update): 0.074515

size_minibatch = 20000
Precon grad coeff: 0.014197, velocity coeff: 0.88149
norm(ch) = 0.1797
iter: 4946, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074515

size_minibatch = 20000
Precon grad coeff: 0.019787, velocity coeff: 1.1405
norm(ch) = 0.2051
iter: 4947, Minibatch log likelihood (pre-update): -54.2857, error rate (pre-update): 0.074514

size_minibatch = 20000
Precon grad coeff: 0.025044, velocity coeff: 1.1569
norm(ch) = 0.23743
iter: 4948, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074511

size_minibatch = 20000
Precon grad coeff: 0.020639, velocity coeff: 0.84338
norm(ch) = 0.20043
iter: 4949, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.07451

size_minibatch = 20000
Precon grad coeff: 0.016477, velocity coeff: 0.91549
norm(ch) = 0.18363
rho = 0.79323
New lambda: 2.2694e-107
iter: 4950, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074509
iter: 4950, Minibatch log likelihood (post-update): -54.2856, error rate (post-update): 0.074508
---
Full log-likelihood: -54.2856, error rate: 0.074508
TEST log-likelihood: -55.5486, error rate: 0.45984
Error difference (test - train): 0.38534
---
Full log-likelihood (averaged params): -54.2876, error rate (averaged params): 0.075417
TEST log-likelihood (averaged params): -55.514, error rate (averaged params): 0.45177
Error difference (test - train) (averaged params): 0.37635

size_minibatch = 20000
Precon grad coeff: 0.016458, velocity coeff: 1.0902
norm(ch) = 0.20028
iter: 4951, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074508

size_minibatch = 20000
Precon grad coeff: 0.022185, velocity coeff: 1.1975
norm(ch) = 0.24004
iter: 4952, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074505

size_minibatch = 20000
Precon grad coeff: 0.024079, velocity coeff: 0.98754
norm(ch) = 0.23722
iter: 4953, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074506

size_minibatch = 20000
Precon grad coeff: 0.022113, velocity coeff: 0.9786
norm(ch) = 0.23231
iter: 4954, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074501

size_minibatch = 20000
Precon grad coeff: 0.014679, velocity coeff: 0.79565
norm(ch) = 0.18495
rho = 0.79276
New lambda: 1.756e-107
iter: 4955, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.0745
iter: 4955, Minibatch log likelihood (post-update): -54.2856, error rate (post-update): 0.074502

size_minibatch = 20000
Precon grad coeff: 0.018341, velocity coeff: 1.1757
norm(ch) = 0.21756
iter: 4956, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074502

size_minibatch = 20000
Precon grad coeff: 0.019618, velocity coeff: 1.0398
norm(ch) = 0.22636
iter: 4957, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.0745

size_minibatch = 20000
Precon grad coeff: 0.025969, velocity coeff: 1.0993
norm(ch) = 0.24905
iter: 4958, Minibatch log likelihood (pre-update): -54.2856, error rate (pre-update): 0.074497

size_minibatch = 20000
Precon grad coeff: 0.022107, velocity coeff: 0.92398
norm(ch) = 0.23022
iter: 4959, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074497

size_minibatch = 20000
Precon grad coeff: 0.016511, velocity coeff: 0.86129
New gamma: 0.0052816
norm(ch) = 0.19854
rho = 0.95008
New lambda: 1.3587e-107
iter: 4960, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074496
iter: 4960, Minibatch log likelihood (post-update): -54.2855, error rate (post-update): 0.074495

size_minibatch = 20000
Precon grad coeff: 0.016074, velocity coeff: 1.1031
norm(ch) = 0.2193
iter: 4961, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074495

size_minibatch = 20000
Precon grad coeff: 0.018241, velocity coeff: 1.0424
norm(ch) = 0.22888
iter: 4962, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.07449

size_minibatch = 20000
Precon grad coeff: 0.020353, velocity coeff: 1.1008
norm(ch) = 0.25237
iter: 4963, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074491

size_minibatch = 20000
Precon grad coeff: 0.020982, velocity coeff: 1.0059
norm(ch) = 0.25434
iter: 4964, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074492

size_minibatch = 20000
Precon grad coeff: 0.017086, velocity coeff: 0.92098
norm(ch) = 0.23458
rho = 0.71771
New lambda: 1.3587e-107
iter: 4965, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.07449
iter: 4965, Minibatch log likelihood (post-update): -54.2855, error rate (post-update): 0.074489

size_minibatch = 20000
Precon grad coeff: 0.015176, velocity coeff: 0.97144
norm(ch) = 0.22821
iter: 4966, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074489

size_minibatch = 20000
Precon grad coeff: 0.019202, velocity coeff: 1.1681
norm(ch) = 0.26703
iter: 4967, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074485

size_minibatch = 20000
Precon grad coeff: 0.020027, velocity coeff: 0.98996
norm(ch) = 0.26481
iter: 4968, Minibatch log likelihood (pre-update): -54.2855, error rate (pre-update): 0.074483

size_minibatch = 20000
Precon grad coeff: 0.020174, velocity coeff: 1.029
norm(ch) = 0.27299
iter: 4969, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074481

size_minibatch = 20000
Precon grad coeff: 0.017301, velocity coeff: 0.87428
norm(ch) = 0.23913
rho = 0.88106
New lambda: 1.0514e-107
iter: 4970, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074478
iter: 4970, Minibatch log likelihood (post-update): -54.2854, error rate (post-update): 0.074479

size_minibatch = 20000
Precon grad coeff: 0.015199, velocity coeff: 0.97463
norm(ch) = 0.23348
iter: 4971, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074479

size_minibatch = 20000
Precon grad coeff: 0.017768, velocity coeff: 1.0784
norm(ch) = 0.25223
iter: 4972, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074478

size_minibatch = 20000
Precon grad coeff: 0.020657, velocity coeff: 1.0548
norm(ch) = 0.26657
iter: 4973, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074478

size_minibatch = 20000
Precon grad coeff: 0.019391, velocity coeff: 0.92081
norm(ch) = 0.24598
iter: 4974, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074475

size_minibatch = 20000
Precon grad coeff: 0.016794, velocity coeff: 0.93081
norm(ch) = 0.22946
rho = 1.209
New lambda: 8.1353e-108
iter: 4975, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074473
iter: 4975, Minibatch log likelihood (post-update): -54.2854, error rate (post-update): 0.074473

size_minibatch = 20000
Precon grad coeff: 0.015321, velocity coeff: 0.99627
norm(ch) = 0.22899
iter: 4976, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074473

size_minibatch = 20000
Precon grad coeff: 0.018736, velocity coeff: 1.1294
norm(ch) = 0.25914
iter: 4977, Minibatch log likelihood (pre-update): -54.2854, error rate (pre-update): 0.074468

size_minibatch = 20000
Precon grad coeff: 0.020478, velocity coeff: 1.0336
norm(ch) = 0.26833
iter: 4978, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074467

size_minibatch = 20000
Precon grad coeff: 0.019139, velocity coeff: 0.94375
norm(ch) = 0.25371
iter: 4979, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074466

size_minibatch = 20000
Precon grad coeff: 0.015673, velocity coeff: 0.93191
New gamma: 0.0031623
norm(ch) = 0.23717
rho = 0.90947
New lambda: 6.295e-108
iter: 4980, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074465
iter: 4980, Minibatch log likelihood (post-update): -54.2853, error rate (post-update): 0.074466

size_minibatch = 20000
Precon grad coeff: 0.014163, velocity coeff: 1.0222
norm(ch) = 0.24311
iter: 4981, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074466

size_minibatch = 20000
Precon grad coeff: 0.018453, velocity coeff: 1.1804
norm(ch) = 0.28791
iter: 4982, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074461

size_minibatch = 20000
Precon grad coeff: 0.018099, velocity coeff: 0.98559
norm(ch) = 0.28463
iter: 4983, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074458

size_minibatch = 20000
Precon grad coeff: 0.017909, velocity coeff: 1.0457
norm(ch) = 0.29852
iter: 4984, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074459

size_minibatch = 20000
Precon grad coeff: 0.014702, velocity coeff: 0.90104
norm(ch) = 0.26975
rho = 1.2724
New lambda: 4.8709e-108
iter: 4985, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074456
iter: 4985, Minibatch log likelihood (post-update): -54.2853, error rate (post-update): 0.074456

size_minibatch = 20000
Precon grad coeff: 0.01419, velocity coeff: 0.98178
norm(ch) = 0.26554
iter: 4986, Minibatch log likelihood (pre-update): -54.2853, error rate (pre-update): 0.074456

size_minibatch = 20000
Precon grad coeff: 0.017796, velocity coeff: 1.1817
norm(ch) = 0.31459
iter: 4987, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074453

size_minibatch = 20000
Precon grad coeff: 0.019595, velocity coeff: 0.91009
norm(ch) = 0.28714
iter: 4988, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074449

size_minibatch = 20000
Precon grad coeff: 0.012934, velocity coeff: 0.85539
norm(ch) = 0.24625
iter: 4989, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074451

size_minibatch = 20000
Precon grad coeff: 0.014449, velocity coeff: 0.97316
norm(ch) = 0.24021
rho = 1.1737
New lambda: 3.769e-108
iter: 4990, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074449
iter: 4990, Minibatch log likelihood (post-update): -54.2852, error rate (post-update): 0.074446

size_minibatch = 20000
Precon grad coeff: 0.017335, velocity coeff: 1.1443
norm(ch) = 0.27568
iter: 4991, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074446

size_minibatch = 20000
Precon grad coeff: 0.016387, velocity coeff: 0.88879
norm(ch) = 0.24586
iter: 4992, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074444

size_minibatch = 20000
Precon grad coeff: 0.01392, velocity coeff: 0.92561
norm(ch) = 0.22812
iter: 4993, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074446

size_minibatch = 20000
Precon grad coeff: 0.01484, velocity coeff: 1.1073
norm(ch) = 0.25329
iter: 4994, Minibatch log likelihood (pre-update): -54.2852, error rate (pre-update): 0.074445

size_minibatch = 20000
Precon grad coeff: 0.016946, velocity coeff: 1.0301
norm(ch) = 0.26172
rho = 1.0147
New lambda: 2.9164e-108
iter: 4995, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074437
iter: 4995, Minibatch log likelihood (post-update): -54.2851, error rate (post-update): 0.074437

size_minibatch = 20000
Precon grad coeff: 0.017501, velocity coeff: 0.99737
norm(ch) = 0.26182
iter: 4996, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074437

size_minibatch = 20000
Precon grad coeff: 0.012064, velocity coeff: 0.87361
norm(ch) = 0.22926
iter: 4997, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074438

size_minibatch = 20000
Precon grad coeff: 0.018015, velocity coeff: 1.2963
norm(ch) = 0.29803
iter: 4998, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074434

size_minibatch = 20000
Precon grad coeff: 0.016535, velocity coeff: 0.85944
norm(ch) = 0.2568
iter: 4999, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074434

size_minibatch = 20000
Precon grad coeff: 0.015554, velocity coeff: 1.0802
New gamma: 0.0031623
norm(ch) = 0.27807
rho = 0.96586
New lambda: 2.2567e-108
iter: 5000, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074432
iter: 5000, Minibatch log likelihood (post-update): -54.2851, error rate (post-update): 0.074428
---
Full log-likelihood: -54.2851, error rate: 0.074428
TEST log-likelihood: -55.559, error rate: 0.46208
Error difference (test - train): 0.38765
---
Full log-likelihood (averaged params): -54.2869, error rate (averaged params): 0.075283
TEST log-likelihood (averaged params): -55.5259, error rate (averaged params): 0.45435
Error difference (test - train) (averaged params): 0.37907

size_minibatch = 20000
Precon grad coeff: 0.013695, velocity coeff: 0.80171
norm(ch) = 0.22362
iter: 5001, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074428

size_minibatch = 20000
Precon grad coeff: 0.014792, velocity coeff: 1.3498
norm(ch) = 0.3023
iter: 5002, Minibatch log likelihood (pre-update): -54.2851, error rate (pre-update): 0.074428

size_minibatch = 20000
Precon grad coeff: 0.020224, velocity coeff: 0.98516
norm(ch) = 0.29856
iter: 5003, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074425

size_minibatch = 20000
Precon grad coeff: 0.017118, velocity coeff: 0.9424
norm(ch) = 0.28202
iter: 5004, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074425

size_minibatch = 20000
Precon grad coeff: 0.013655, velocity coeff: 0.90228
norm(ch) = 0.25498
rho = 1.0379
New lambda: 1.7462e-108
iter: 5005, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074425
iter: 5005, Minibatch log likelihood (post-update): -54.285, error rate (post-update): 0.07442

size_minibatch = 20000
Precon grad coeff: 0.014318, velocity coeff: 0.96429
norm(ch) = 0.24636
iter: 5006, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.07442

size_minibatch = 20000
Precon grad coeff: 0.014652, velocity coeff: 1.069
norm(ch) = 0.26385
iter: 5007, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.07442

size_minibatch = 20000
Precon grad coeff: 0.019944, velocity coeff: 1.132
norm(ch) = 0.29942
iter: 5008, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074421

size_minibatch = 20000
Precon grad coeff: 0.017089, velocity coeff: 0.82492
norm(ch) = 0.24755
iter: 5009, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074418

size_minibatch = 20000
Precon grad coeff: 0.013412, velocity coeff: 0.95147
norm(ch) = 0.23603
rho = 0.92847
New lambda: 1.3511e-108
iter: 5010, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074414
iter: 5010, Minibatch log likelihood (post-update): -54.285, error rate (post-update): 0.074412

size_minibatch = 20000
Precon grad coeff: 0.014364, velocity coeff: 1.0701
norm(ch) = 0.25313
iter: 5011, Minibatch log likelihood (pre-update): -54.285, error rate (pre-update): 0.074412

size_minibatch = 20000
Precon grad coeff: 0.017275, velocity coeff: 1.0751
norm(ch) = 0.2727
iter: 5012, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074414

size_minibatch = 20000
Precon grad coeff: 0.016872, velocity coeff: 0.96989
norm(ch) = 0.26506
iter: 5013, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074412

size_minibatch = 20000
Precon grad coeff: 0.017889, velocity coeff: 1.0799
norm(ch) = 0.28692
iter: 5014, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074409

size_minibatch = 20000
Precon grad coeff: 0.011955, velocity coeff: 0.70367
norm(ch) = 0.20242
rho = 1.0157
New lambda: 1.0455e-108
iter: 5015, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074409
iter: 5015, Minibatch log likelihood (post-update): -54.2849, error rate (post-update): 0.074408

size_minibatch = 20000
Precon grad coeff: 0.01578, velocity coeff: 1.354
norm(ch) = 0.27447
iter: 5016, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074408

size_minibatch = 20000
Precon grad coeff: 0.017384, velocity coeff: 0.88925
norm(ch) = 0.24474
iter: 5017, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074406

size_minibatch = 20000
Precon grad coeff: 0.015463, velocity coeff: 1.0325
norm(ch) = 0.25327
iter: 5018, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074402

size_minibatch = 20000
Precon grad coeff: 0.014559, velocity coeff: 0.85929
norm(ch) = 0.21811
iter: 5019, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074402

size_minibatch = 20000
Precon grad coeff: 0.012676, velocity coeff: 1.0877
New gamma: 0.0031623
norm(ch) = 0.23773
rho = 1.2144
New lambda: 8.0898e-109
iter: 5020, Minibatch log likelihood (pre-update): -54.2849, error rate (pre-update): 0.074404
iter: 5020, Minibatch log likelihood (post-update): -54.2848, error rate (post-update): 0.0744

size_minibatch = 20000
Precon grad coeff: 0.02009, velocity coeff: 1.1837
norm(ch) = 0.28219
iter: 5021, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.0744

size_minibatch = 20000
Precon grad coeff: 0.015331, velocity coeff: 0.89408
norm(ch) = 0.25293
iter: 5022, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074397

size_minibatch = 20000
Precon grad coeff: 0.017115, velocity coeff: 1.0915
norm(ch) = 0.27671
iter: 5023, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.0744

size_minibatch = 20000
Precon grad coeff: 0.012658, velocity coeff: 0.83331
norm(ch) = 0.23118
iter: 5024, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074397

size_minibatch = 20000
Precon grad coeff: 0.01458, velocity coeff: 1.241
norm(ch) = 0.28734
rho = 1.1157
New lambda: 6.2597e-109
iter: 5025, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074396
iter: 5025, Minibatch log likelihood (post-update): -54.2848, error rate (post-update): 0.074395

size_minibatch = 20000
Precon grad coeff: 0.018498, velocity coeff: 1.0093
norm(ch) = 0.29049
iter: 5026, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074395

size_minibatch = 20000
Precon grad coeff: 0.015473, velocity coeff: 0.90672
norm(ch) = 0.26389
iter: 5027, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074394

size_minibatch = 20000
Precon grad coeff: 0.016683, velocity coeff: 0.9761
norm(ch) = 0.25812
iter: 5028, Minibatch log likelihood (pre-update): -54.2848, error rate (pre-update): 0.074389

size_minibatch = 20000
Precon grad coeff: 0.013512, velocity coeff: 0.85312
norm(ch) = 0.22052
iter: 5029, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074388

size_minibatch = 20000
Precon grad coeff: 0.013454, velocity coeff: 1.0596
norm(ch) = 0.23405
rho = 1.069
New lambda: 4.8437e-109
iter: 5030, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074388
iter: 5030, Minibatch log likelihood (post-update): -54.2847, error rate (post-update): 0.074385

size_minibatch = 20000
Precon grad coeff: 0.016769, velocity coeff: 1.0689
norm(ch) = 0.25071
iter: 5031, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074385

size_minibatch = 20000
Precon grad coeff: 0.019285, velocity coeff: 1.0607
norm(ch) = 0.26656
iter: 5032, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074385

size_minibatch = 20000
Precon grad coeff: 0.01484, velocity coeff: 0.87297
norm(ch) = 0.23311
iter: 5033, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074385

size_minibatch = 20000
Precon grad coeff: 0.015666, velocity coeff: 1.03
norm(ch) = 0.24073
iter: 5034, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.07438

size_minibatch = 20000
Precon grad coeff: 0.012156, velocity coeff: 0.9118
norm(ch) = 0.21995
rho = 1.0071
New lambda: 3.7479e-109
iter: 5035, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074381
iter: 5035, Minibatch log likelihood (post-update): -54.2847, error rate (post-update): 0.074382

size_minibatch = 20000
Precon grad coeff: 0.015789, velocity coeff: 1.2403
norm(ch) = 0.27313
iter: 5036, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074382

size_minibatch = 20000
Precon grad coeff: 0.018194, velocity coeff: 0.94337
norm(ch) = 0.25834
iter: 5037, Minibatch log likelihood (pre-update): -54.2847, error rate (pre-update): 0.074378

size_minibatch = 20000
Precon grad coeff: 0.014767, velocity coeff: 0.89547
norm(ch) = 0.23183
iter: 5038, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074374

size_minibatch = 20000
Precon grad coeff: 0.01302, velocity coeff: 0.96075
norm(ch) = 0.22306
iter: 5039, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074375

size_minibatch = 20000
Precon grad coeff: 0.01358, velocity coeff: 0.97164
New gamma: 0.0031623
norm(ch) = 0.2172
rho = 0.81345
New lambda: 2.9001e-109
iter: 5040, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074376
iter: 5040, Minibatch log likelihood (post-update): -54.2846, error rate (post-update): 0.074373

size_minibatch = 20000
Precon grad coeff: 0.016986, velocity coeff: 1.1776
norm(ch) = 0.2564
iter: 5041, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074373

size_minibatch = 20000
Precon grad coeff: 0.018264, velocity coeff: 0.95959
norm(ch) = 0.24673
iter: 5042, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074373

size_minibatch = 20000
Precon grad coeff: 0.012709, velocity coeff: 0.88785
norm(ch) = 0.21952
iter: 5043, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074373

size_minibatch = 20000
Precon grad coeff: 0.014519, velocity coeff: 1.076
norm(ch) = 0.23682
iter: 5044, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074369

size_minibatch = 20000
Precon grad coeff: 0.013285, velocity coeff: 1.0211
norm(ch) = 0.24232
rho = 1.2497
New lambda: 2.244e-109
iter: 5045, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.07437
iter: 5045, Minibatch log likelihood (post-update): -54.2846, error rate (post-update): 0.074368

size_minibatch = 20000
Precon grad coeff: 0.017976, velocity coeff: 1.1372
norm(ch) = 0.27599
iter: 5046, Minibatch log likelihood (pre-update): -54.2846, error rate (pre-update): 0.074368

size_minibatch = 20000
Precon grad coeff: 0.015835, velocity coeff: 0.91969
norm(ch) = 0.25442
iter: 5047, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.07436

size_minibatch = 20000
Precon grad coeff: 0.014876, velocity coeff: 0.92679
norm(ch) = 0.23636
iter: 5048, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.07436

size_minibatch = 20000
Precon grad coeff: 0.013969, velocity coeff: 0.92777
norm(ch) = 0.21966
iter: 5049, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074362

size_minibatch = 20000
Precon grad coeff: 0.012812, velocity coeff: 0.97805
norm(ch) = 0.21524
rho = 1.1589
New lambda: 1.7364e-109
iter: 5050, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.07436
iter: 5050, Minibatch log likelihood (post-update): -54.2845, error rate (post-update): 0.074357
---
Full log-likelihood: -54.2845, error rate: 0.074356
TEST log-likelihood: -55.5692, error rate: 0.46443
Error difference (test - train): 0.39008
---
Full log-likelihood (averaged params): -54.2863, error rate (averaged params): 0.075178
TEST log-likelihood (averaged params): -55.5371, error rate (averaged params): 0.45683
Error difference (test - train) (averaged params): 0.38165

size_minibatch = 20000
Precon grad coeff: 0.01665, velocity coeff: 1.18
norm(ch) = 0.25458
iter: 5051, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074356

size_minibatch = 20000
Precon grad coeff: 0.01588, velocity coeff: 0.91522
norm(ch) = 0.2335
iter: 5052, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074358

size_minibatch = 20000
Precon grad coeff: 0.015915, velocity coeff: 1.0672
norm(ch) = 0.24971
iter: 5053, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074356

size_minibatch = 20000
Precon grad coeff: 0.016095, velocity coeff: 0.92456
norm(ch) = 0.23143
iter: 5054, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074353

size_minibatch = 20000
Precon grad coeff: 0.011974, velocity coeff: 0.96343
norm(ch) = 0.22341
rho = 1.1542
New lambda: 1.3436e-109
iter: 5055, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074354
iter: 5055, Minibatch log likelihood (post-update): -54.2845, error rate (post-update): 0.074352

size_minibatch = 20000
Precon grad coeff: 0.015668, velocity coeff: 1.0714
norm(ch) = 0.23986
iter: 5056, Minibatch log likelihood (pre-update): -54.2845, error rate (pre-update): 0.074352

size_minibatch = 20000
Precon grad coeff: 0.014628, velocity coeff: 1.0127
norm(ch) = 0.24336
iter: 5057, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.07435

size_minibatch = 20000
Precon grad coeff: 0.017953, velocity coeff: 1.0459
norm(ch) = 0.25512
iter: 5058, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.074349

size_minibatch = 20000
Precon grad coeff: 0.015079, velocity coeff: 0.92964
norm(ch) = 0.2377
iter: 5059, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.074346

size_minibatch = 20000
Precon grad coeff: 0.01617, velocity coeff: 0.91674
New gamma: 0.0052816
norm(ch) = 0.21819
rho = 1.1372
New lambda: 1.0396e-109
iter: 5060, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.074345
iter: 5060, Minibatch log likelihood (post-update): -54.2844, error rate (post-update): 0.074345

size_minibatch = 20000
Precon grad coeff: 0.015593, velocity coeff: 0.97456
norm(ch) = 0.21288
iter: 5061, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.074345

size_minibatch = 20000
Precon grad coeff: 0.017559, velocity coeff: 1.0422
norm(ch) = 0.22218
iter: 5062, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.074344

size_minibatch = 20000
Precon grad coeff: 0.018724, velocity coeff: 0.9423
norm(ch) = 0.20968
iter: 5063, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.07434

size_minibatch = 20000
Precon grad coeff: 0.018503, velocity coeff: 1.0782
norm(ch) = 0.2264
iter: 5064, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.07434

size_minibatch = 20000
Precon grad coeff: 0.020189, velocity coeff: 0.91725
norm(ch) = 0.20799
rho = 0.83004
New lambda: 8.0445e-110
iter: 5065, Minibatch log likelihood (pre-update): -54.2844, error rate (pre-update): 0.07434
iter: 5065, Minibatch log likelihood (post-update): -54.2843, error rate (post-update): 0.074338

size_minibatch = 20000
Precon grad coeff: 0.014573, velocity coeff: 0.91421
norm(ch) = 0.19042
iter: 5066, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074338

size_minibatch = 20000
Precon grad coeff: 0.019213, velocity coeff: 1.1739
norm(ch) = 0.22387
iter: 5067, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074337

size_minibatch = 20000
Precon grad coeff: 0.015681, velocity coeff: 0.88872
norm(ch) = 0.1992
iter: 5068, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074335

size_minibatch = 20000
Precon grad coeff: 0.021088, velocity coeff: 1.2327
norm(ch) = 0.24582
iter: 5069, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074332

size_minibatch = 20000
Precon grad coeff: 0.020131, velocity coeff: 0.88464
norm(ch) = 0.21782
rho = 0.98904
New lambda: 6.2247e-110
iter: 5070, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074333
iter: 5070, Minibatch log likelihood (post-update): -54.2843, error rate (post-update): 0.074332

size_minibatch = 20000
Precon grad coeff: 0.015861, velocity coeff: 0.98633
norm(ch) = 0.21509
iter: 5071, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074332

size_minibatch = 20000
Precon grad coeff: 0.017637, velocity coeff: 0.98088
norm(ch) = 0.21119
iter: 5072, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074329

size_minibatch = 20000
Precon grad coeff: 0.015967, velocity coeff: 1.0277
norm(ch) = 0.21725
iter: 5073, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074328

size_minibatch = 20000
Precon grad coeff: 0.019475, velocity coeff: 1.103
norm(ch) = 0.23989
iter: 5074, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074329

size_minibatch = 20000
Precon grad coeff: 0.018641, velocity coeff: 0.90845
norm(ch) = 0.21821
rho = 0.9769
New lambda: 4.8165e-110
iter: 5075, Minibatch log likelihood (pre-update): -54.2843, error rate (pre-update): 0.074324
iter: 5075, Minibatch log likelihood (post-update): -54.2842, error rate (post-update): 0.074322

size_minibatch = 20000
Precon grad coeff: 0.019488, velocity coeff: 1.0855
norm(ch) = 0.23711
iter: 5076, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074322

size_minibatch = 20000
Precon grad coeff: 0.016608, velocity coeff: 0.88206
norm(ch) = 0.20943
iter: 5077, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074326

size_minibatch = 20000
Precon grad coeff: 0.017034, velocity coeff: 0.98756
norm(ch) = 0.20712
iter: 5078, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074322

size_minibatch = 20000
Precon grad coeff: 0.01756, velocity coeff: 1.0838
norm(ch) = 0.22465
iter: 5079, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074319

size_minibatch = 20000
Precon grad coeff: 0.016834, velocity coeff: 1.0195
New gamma: 0.0031623
norm(ch) = 0.22944
rho = 1.2695
New lambda: 3.727e-110
iter: 5080, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.07432
iter: 5080, Minibatch log likelihood (post-update): -54.2842, error rate (post-update): 0.07432

size_minibatch = 20000
Precon grad coeff: 0.017208, velocity coeff: 1.0589
norm(ch) = 0.24345
iter: 5081, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.07432

size_minibatch = 20000
Precon grad coeff: 0.019589, velocity coeff: 1.0768
norm(ch) = 0.26276
iter: 5082, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074314

size_minibatch = 20000
Precon grad coeff: 0.016159, velocity coeff: 0.91479
norm(ch) = 0.24089
iter: 5083, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074313

size_minibatch = 20000
Precon grad coeff: 0.018456, velocity coeff: 1.1251
norm(ch) = 0.27171
iter: 5084, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074314

size_minibatch = 20000
Precon grad coeff: 0.015012, velocity coeff: 0.90318
norm(ch) = 0.24595
rho = 0.93831
New lambda: 2.8838e-110
iter: 5085, Minibatch log likelihood (pre-update): -54.2842, error rate (pre-update): 0.074312
iter: 5085, Minibatch log likelihood (post-update): -54.2841, error rate (post-update): 0.07431

size_minibatch = 20000
Precon grad coeff: 0.014437, velocity coeff: 0.95203
norm(ch) = 0.2348
iter: 5086, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.07431

size_minibatch = 20000
Precon grad coeff: 0.015508, velocity coeff: 1.0748
norm(ch) = 0.25295
iter: 5087, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074308

size_minibatch = 20000
Precon grad coeff: 0.017542, velocity coeff: 0.9933
norm(ch) = 0.25178
iter: 5088, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074308

size_minibatch = 20000
Precon grad coeff: 0.016386, velocity coeff: 0.95523
norm(ch) = 0.2413
iter: 5089, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074305

size_minibatch = 20000
Precon grad coeff: 0.017399, velocity coeff: 1.012
norm(ch) = 0.24489
rho = 1.3557
New lambda: 2.2315e-110
iter: 5090, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074303
iter: 5090, Minibatch log likelihood (post-update): -54.2841, error rate (post-update): 0.074302

size_minibatch = 20000
Precon grad coeff: 0.014115, velocity coeff: 0.90002
norm(ch) = 0.22092
iter: 5091, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074302

size_minibatch = 20000
Precon grad coeff: 0.01527, velocity coeff: 1.0859
norm(ch) = 0.24057
iter: 5092, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.0743

size_minibatch = 20000
Precon grad coeff: 0.015425, velocity coeff: 0.985
norm(ch) = 0.23764
iter: 5093, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.0743

size_minibatch = 20000
Precon grad coeff: 0.0175, velocity coeff: 1.0663
norm(ch) = 0.254
iter: 5094, Minibatch log likelihood (pre-update): -54.2841, error rate (pre-update): 0.074297

size_minibatch = 20000
Precon grad coeff: 0.017652, velocity coeff: 0.98926
norm(ch) = 0.25184
rho = 0.91558
New lambda: 1.7267e-110
iter: 5095, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074294
iter: 5095, Minibatch log likelihood (post-update): -54.284, error rate (post-update): 0.074295

size_minibatch = 20000
Precon grad coeff: 0.014815, velocity coeff: 0.89346
norm(ch) = 0.22567
iter: 5096, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074295

size_minibatch = 20000
Precon grad coeff: 0.015195, velocity coeff: 1.018
norm(ch) = 0.23025
iter: 5097, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074293

size_minibatch = 20000
Precon grad coeff: 0.015341, velocity coeff: 1.026
norm(ch) = 0.2366
iter: 5098, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.07429

size_minibatch = 20000
Precon grad coeff: 0.016425, velocity coeff: 1.0367
norm(ch) = 0.24577
iter: 5099, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074286

size_minibatch = 20000
Precon grad coeff: 0.017249, velocity coeff: 1.0551
New gamma: 0.0031623
norm(ch) = 0.25991
rho = 1.0174
New lambda: 1.3361e-110
iter: 5100, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074288
iter: 5100, Minibatch log likelihood (post-update): -54.284, error rate (post-update): 0.074286
---
Full log-likelihood: -54.284, error rate: 0.074286
TEST log-likelihood: -55.5796, error rate: 0.4669
Error difference (test - train): 0.39261
---
Full log-likelihood (averaged params): -54.2857, error rate (averaged params): 0.075057
TEST log-likelihood (averaged params): -55.548, error rate (averaged params): 0.4593
Error difference (test - train) (averaged params): 0.38424

size_minibatch = 20000
Precon grad coeff: 0.017812, velocity coeff: 0.9688
norm(ch) = 0.25228
iter: 5101, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074286

size_minibatch = 20000
Precon grad coeff: 0.014174, velocity coeff: 0.92771
norm(ch) = 0.23444
iter: 5102, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074284

size_minibatch = 20000
Precon grad coeff: 0.014239, velocity coeff: 0.97602
norm(ch) = 0.22921
iter: 5103, Minibatch log likelihood (pre-update): -54.284, error rate (pre-update): 0.074284

size_minibatch = 20000
Precon grad coeff: 0.012482, velocity coeff: 0.94176
norm(ch) = 0.21617
iter: 5104, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.07428

size_minibatch = 20000
Precon grad coeff: 0.016572, velocity coeff: 1.2104
norm(ch) = 0.26208
rho = 1.0377
New lambda: 1.0338e-110
iter: 5105, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074278
iter: 5105, Minibatch log likelihood (post-update): -54.2839, error rate (post-update): 0.074279

size_minibatch = 20000
Precon grad coeff: 0.016645, velocity coeff: 0.94594
norm(ch) = 0.24825
iter: 5106, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074279

size_minibatch = 20000
Precon grad coeff: 0.01606, velocity coeff: 0.97692
norm(ch) = 0.24285
iter: 5107, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074276

size_minibatch = 20000
Precon grad coeff: 0.016682, velocity coeff: 1.0063
norm(ch) = 0.24485
iter: 5108, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074272

size_minibatch = 20000
Precon grad coeff: 0.015189, velocity coeff: 0.92169
norm(ch) = 0.22607
iter: 5109, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074274

size_minibatch = 20000
Precon grad coeff: 0.012889, velocity coeff: 0.94442
norm(ch) = 0.2138
rho = 0.79381
New lambda: 7.9995e-111
iter: 5110, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074272
iter: 5110, Minibatch log likelihood (post-update): -54.2839, error rate (post-update): 0.074266

size_minibatch = 20000
Precon grad coeff: 0.01387, velocity coeff: 1.061
norm(ch) = 0.22716
iter: 5111, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074266

size_minibatch = 20000
Precon grad coeff: 0.015454, velocity coeff: 1.0328
norm(ch) = 0.23504
iter: 5112, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074266

size_minibatch = 20000
Precon grad coeff: 0.017335, velocity coeff: 1.1148
norm(ch) = 0.26252
iter: 5113, Minibatch log likelihood (pre-update): -54.2839, error rate (pre-update): 0.074268

size_minibatch = 20000
Precon grad coeff: 0.01642, velocity coeff: 0.89351
norm(ch) = 0.23494
iter: 5114, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074266

size_minibatch = 20000
Precon grad coeff: 0.016536, velocity coeff: 1.0292
norm(ch) = 0.24226
rho = 0.92563
New lambda: 6.1898e-111
iter: 5115, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074265
iter: 5115, Minibatch log likelihood (post-update): -54.2838, error rate (post-update): 0.074261

size_minibatch = 20000
Precon grad coeff: 0.015005, velocity coeff: 0.96607
norm(ch) = 0.23458
iter: 5116, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074261

size_minibatch = 20000
Precon grad coeff: 0.012926, velocity coeff: 0.85756
norm(ch) = 0.20155
iter: 5117, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074261

size_minibatch = 20000
Precon grad coeff: 0.01408, velocity coeff: 1.2079
norm(ch) = 0.24384
iter: 5118, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.07426

size_minibatch = 20000
Precon grad coeff: 0.016633, velocity coeff: 0.95573
norm(ch) = 0.23344
iter: 5119, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074258

size_minibatch = 20000
Precon grad coeff: 0.01686, velocity coeff: 1.0441
New gamma: 0.0031623
norm(ch) = 0.2443
rho = 1.216
New lambda: 4.7896e-111
iter: 5120, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074253
iter: 5120, Minibatch log likelihood (post-update): -54.2838, error rate (post-update): 0.074256

size_minibatch = 20000
Precon grad coeff: 0.019494, velocity coeff: 1.0624
norm(ch) = 0.26011
iter: 5121, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074256

size_minibatch = 20000
Precon grad coeff: 0.01626, velocity coeff: 0.86842
norm(ch) = 0.22637
iter: 5122, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074256

size_minibatch = 20000
Precon grad coeff: 0.015034, velocity coeff: 1.0352
norm(ch) = 0.23483
iter: 5123, Minibatch log likelihood (pre-update): -54.2838, error rate (pre-update): 0.074252

size_minibatch = 20000
Precon grad coeff: 0.016128, velocity coeff: 1.0028
norm(ch) = 0.23605
iter: 5124, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074252

size_minibatch = 20000
Precon grad coeff: 0.017775, velocity coeff: 1.0686
norm(ch) = 0.25274
rho = 0.89649
New lambda: 3.7061e-111
iter: 5125, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074251
iter: 5125, Minibatch log likelihood (post-update): -54.2837, error rate (post-update): 0.074247

size_minibatch = 20000
Precon grad coeff: 0.017837, velocity coeff: 0.96932
norm(ch) = 0.24544
iter: 5126, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074247

size_minibatch = 20000
Precon grad coeff: 0.016263, velocity coeff: 0.95823
norm(ch) = 0.23572
iter: 5127, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074245

size_minibatch = 20000
Precon grad coeff: 0.01628, velocity coeff: 0.99842
norm(ch) = 0.23579
iter: 5128, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074243

size_minibatch = 20000
Precon grad coeff: 0.01479, velocity coeff: 0.96236
norm(ch) = 0.22725
iter: 5129, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074243

size_minibatch = 20000
Precon grad coeff: 0.017274, velocity coeff: 1.1148
norm(ch) = 0.25377
rho = 0.87055
New lambda: 2.8677e-111
iter: 5130, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074241
iter: 5130, Minibatch log likelihood (post-update): -54.2837, error rate (post-update): 0.074238

size_minibatch = 20000
Precon grad coeff: 0.019076, velocity coeff: 1.0309
norm(ch) = 0.26207
iter: 5131, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074238

size_minibatch = 20000
Precon grad coeff: 0.016969, velocity coeff: 0.89905
norm(ch) = 0.23605
iter: 5132, Minibatch log likelihood (pre-update): -54.2837, error rate (pre-update): 0.074239

size_minibatch = 20000
Precon grad coeff: 0.015753, velocity coeff: 0.99348
norm(ch) = 0.23491
iter: 5133, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074239

size_minibatch = 20000
Precon grad coeff: 0.015766, velocity coeff: 1.0047
norm(ch) = 0.23638
iter: 5134, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074234

size_minibatch = 20000
Precon grad coeff: 0.016256, velocity coeff: 1.019
norm(ch) = 0.24119
rho = 1.244
New lambda: 2.219e-111
iter: 5135, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074229
iter: 5135, Minibatch log likelihood (post-update): -54.2836, error rate (post-update): 0.074234

size_minibatch = 20000
Precon grad coeff: 0.016629, velocity coeff: 1.0042
norm(ch) = 0.24256
iter: 5136, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074234

size_minibatch = 20000
Precon grad coeff: 0.01963, velocity coeff: 1.086
norm(ch) = 0.26383
iter: 5137, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074233

size_minibatch = 20000
Precon grad coeff: 0.016073, velocity coeff: 0.85783
norm(ch) = 0.22669
iter: 5138, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074226

size_minibatch = 20000
Precon grad coeff: 0.016125, velocity coeff: 1.0669
norm(ch) = 0.24226
iter: 5139, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074226

size_minibatch = 20000
Precon grad coeff: 0.013397, velocity coeff: 0.85505
New gamma: 0.0031623
norm(ch) = 0.20742
rho = 0.99641
New lambda: 1.717e-111
iter: 5140, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074224
iter: 5140, Minibatch log likelihood (post-update): -54.2836, error rate (post-update): 0.074223

size_minibatch = 20000
Precon grad coeff: 0.016056, velocity coeff: 1.216
norm(ch) = 0.2525
iter: 5141, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074223

size_minibatch = 20000
Precon grad coeff: 0.015266, velocity coeff: 0.90304
norm(ch) = 0.22833
iter: 5142, Minibatch log likelihood (pre-update): -54.2836, error rate (pre-update): 0.074223

size_minibatch = 20000
Precon grad coeff: 0.017074, velocity coeff: 1.1086
norm(ch) = 0.25353
iter: 5143, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074221

size_minibatch = 20000
Precon grad coeff: 0.016238, velocity coeff: 0.93087
norm(ch) = 0.23637
iter: 5144, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074217

size_minibatch = 20000
Precon grad coeff: 0.014833, velocity coeff: 0.97197
norm(ch) = 0.23009
rho = 0.93909
New lambda: 1.3286e-111
iter: 5145, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074217
iter: 5145, Minibatch log likelihood (post-update): -54.2835, error rate (post-update): 0.074215

size_minibatch = 20000
Precon grad coeff: 0.013858, velocity coeff: 0.96209
norm(ch) = 0.22168
iter: 5146, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074215

size_minibatch = 20000
Precon grad coeff: 0.015292, velocity coeff: 1.0185
norm(ch) = 0.22617
iter: 5147, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074215

size_minibatch = 20000
Precon grad coeff: 0.013699, velocity coeff: 0.98632
norm(ch) = 0.22331
iter: 5148, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074214

size_minibatch = 20000
Precon grad coeff: 0.018412, velocity coeff: 1.1361
norm(ch) = 0.2541
iter: 5149, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074212

size_minibatch = 20000
Precon grad coeff: 0.017219, velocity coeff: 0.91329
norm(ch) = 0.23243
rho = 1.4221
New lambda: 1.028e-111
iter: 5150, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074209
iter: 5150, Minibatch log likelihood (post-update): -54.2835, error rate (post-update): 0.074209
---
Full log-likelihood: -54.2835, error rate: 0.074209
TEST log-likelihood: -55.5914, error rate: 0.46964
Error difference (test - train): 0.39543
---
Full log-likelihood (averaged params): -54.2851, error rate (averaged params): 0.074939
TEST log-likelihood (averaged params): -55.5591, error rate (averaged params): 0.46186
Error difference (test - train) (averaged params): 0.38692

size_minibatch = 20000
Precon grad coeff: 0.013832, velocity coeff: 0.94256
norm(ch) = 0.21944
iter: 5151, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074209

size_minibatch = 20000
Precon grad coeff: 0.018776, velocity coeff: 1.1644
norm(ch) = 0.25603
iter: 5152, Minibatch log likelihood (pre-update): -54.2835, error rate (pre-update): 0.074207

size_minibatch = 20000
Precon grad coeff: 0.012548, velocity coeff: 0.80005
norm(ch) = 0.2052
iter: 5153, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074206

size_minibatch = 20000
Precon grad coeff: 0.014082, velocity coeff: 1.0878
norm(ch) = 0.22344
iter: 5154, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074203

size_minibatch = 20000
Precon grad coeff: 0.01681, velocity coeff: 1.1097
norm(ch) = 0.24836
rho = 0.75463
New lambda: 7.9547e-112
iter: 5155, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074201
iter: 5155, Minibatch log likelihood (post-update): -54.2834, error rate (post-update): 0.074201

size_minibatch = 20000
Precon grad coeff: 0.015613, velocity coeff: 0.87853
norm(ch) = 0.21856
iter: 5156, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074201

size_minibatch = 20000
Precon grad coeff: 0.016058, velocity coeff: 1.1369
norm(ch) = 0.24887
iter: 5157, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074202

size_minibatch = 20000
Precon grad coeff: 0.019129, velocity coeff: 0.97537
norm(ch) = 0.2432
iter: 5158, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074196

size_minibatch = 20000
Precon grad coeff: 0.014695, velocity coeff: 0.9263
norm(ch) = 0.22567
iter: 5159, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074196

size_minibatch = 20000
Precon grad coeff: 0.015735, velocity coeff: 0.95437
New gamma: 0.0031623
norm(ch) = 0.21581
rho = 0.95229
New lambda: 6.1552e-112
iter: 5160, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074198
iter: 5160, Minibatch log likelihood (post-update): -54.2834, error rate (post-update): 0.074195

size_minibatch = 20000
Precon grad coeff: 0.011644, velocity coeff: 0.91378
norm(ch) = 0.19755
iter: 5161, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074195

size_minibatch = 20000
Precon grad coeff: 0.01354, velocity coeff: 1.0931
norm(ch) = 0.21619
iter: 5162, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074191

size_minibatch = 20000
Precon grad coeff: 0.014598, velocity coeff: 1.0326
norm(ch) = 0.22362
iter: 5163, Minibatch log likelihood (pre-update): -54.2834, error rate (pre-update): 0.074191

size_minibatch = 20000
Precon grad coeff: 0.015598, velocity coeff: 1.0117
norm(ch) = 0.22658
iter: 5164, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074189

size_minibatch = 20000
Precon grad coeff: 0.019751, velocity coeff: 1.1477
norm(ch) = 0.26062
rho = 0.99599
New lambda: 4.7628e-112
iter: 5165, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074186
iter: 5165, Minibatch log likelihood (post-update): -54.2833, error rate (post-update): 0.074184

size_minibatch = 20000
Precon grad coeff: 0.01269, velocity coeff: 0.72375
norm(ch) = 0.18891
iter: 5166, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074184

size_minibatch = 20000
Precon grad coeff: 0.013648, velocity coeff: 1.1674
norm(ch) = 0.22093
iter: 5167, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074183

size_minibatch = 20000
Precon grad coeff: 0.012454, velocity coeff: 0.91451
norm(ch) = 0.20232
iter: 5168, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074181

size_minibatch = 20000
Precon grad coeff: 0.014684, velocity coeff: 1.1585
norm(ch) = 0.23471
iter: 5169, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.07418

size_minibatch = 20000
Precon grad coeff: 0.019107, velocity coeff: 1.127
norm(ch) = 0.26495
rho = 1.1522
New lambda: 3.6853e-112
iter: 5170, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074177
iter: 5170, Minibatch log likelihood (post-update): -54.2833, error rate (post-update): 0.074178

size_minibatch = 20000
Precon grad coeff: 0.015773, velocity coeff: 0.78877
norm(ch) = 0.20935
iter: 5171, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074178

size_minibatch = 20000
Precon grad coeff: 0.014311, velocity coeff: 1.1619
norm(ch) = 0.24363
iter: 5172, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074177

size_minibatch = 20000
Precon grad coeff: 0.013081, velocity coeff: 0.79183
norm(ch) = 0.19326
iter: 5173, Minibatch log likelihood (pre-update): -54.2833, error rate (pre-update): 0.074175

size_minibatch = 20000
Precon grad coeff: 0.012773, velocity coeff: 1.1876
norm(ch) = 0.22978
iter: 5174, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074173

size_minibatch = 20000
Precon grad coeff: 0.01654, velocity coeff: 1.0324
norm(ch) = 0.23751
rho = 1.3802
New lambda: 2.8517e-112
iter: 5175, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074172
iter: 5175, Minibatch log likelihood (post-update): -54.2832, error rate (post-update): 0.074168

size_minibatch = 20000
Precon grad coeff: 0.015707, velocity coeff: 0.99069
norm(ch) = 0.23558
iter: 5176, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074168

size_minibatch = 20000
Precon grad coeff: 0.01685, velocity coeff: 1.0267
norm(ch) = 0.24224
iter: 5177, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074169

size_minibatch = 20000
Precon grad coeff: 0.013869, velocity coeff: 0.88509
norm(ch) = 0.2147
iter: 5178, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074169

size_minibatch = 20000
Precon grad coeff: 0.011432, velocity coeff: 0.95333
norm(ch) = 0.20502
iter: 5179, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074165

size_minibatch = 20000
Precon grad coeff: 0.015715, velocity coeff: 0.99418
New gamma: 0.0031623
norm(ch) = 0.20409
rho = 0.8928
New lambda: 2.2066e-112
iter: 5180, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074161
iter: 5180, Minibatch log likelihood (post-update): -54.2832, error rate (post-update): 0.074162

size_minibatch = 20000
Precon grad coeff: 0.015179, velocity coeff: 0.91779
norm(ch) = 0.18782
iter: 5181, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074162

size_minibatch = 20000
Precon grad coeff: 0.015795, velocity coeff: 0.96853
norm(ch) = 0.18233
iter: 5182, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074161

size_minibatch = 20000
Precon grad coeff: 0.013834, velocity coeff: 0.95153
norm(ch) = 0.17393
iter: 5183, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074159

size_minibatch = 20000
Precon grad coeff: 0.017727, velocity coeff: 1.1879
norm(ch) = 0.20729
iter: 5184, Minibatch log likelihood (pre-update): -54.2832, error rate (pre-update): 0.074159

size_minibatch = 20000
Precon grad coeff: 0.016812, velocity coeff: 0.98689
norm(ch) = 0.20528
rho = 1.2963
New lambda: 1.7074e-112
iter: 5185, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074156
iter: 5185, Minibatch log likelihood (post-update): -54.2831, error rate (post-update): 0.074153

size_minibatch = 20000
Precon grad coeff: 0.013986, velocity coeff: 1.0158
norm(ch) = 0.20916
iter: 5186, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074153

size_minibatch = 20000
Precon grad coeff: 0.01752, velocity coeff: 1.1579
norm(ch) = 0.24279
iter: 5187, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074153

size_minibatch = 20000
Precon grad coeff: 0.016958, velocity coeff: 1.0647
norm(ch) = 0.25913
iter: 5188, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074151

size_minibatch = 20000
Precon grad coeff: 0.015743, velocity coeff: 0.92403
norm(ch) = 0.24011
iter: 5189, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.07415

size_minibatch = 20000
Precon grad coeff: 0.014619, velocity coeff: 1.1085
norm(ch) = 0.26645
rho = 0.98417
New lambda: 1.3211e-112
iter: 5190, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074148
iter: 5190, Minibatch log likelihood (post-update): -54.2831, error rate (post-update): 0.074145

size_minibatch = 20000
Precon grad coeff: 0.019771, velocity coeff: 1.0754
norm(ch) = 0.28708
iter: 5191, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074145

size_minibatch = 20000
Precon grad coeff: 0.013888, velocity coeff: 0.80532
norm(ch) = 0.23159
iter: 5192, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074146

size_minibatch = 20000
Precon grad coeff: 0.016481, velocity coeff: 1.1193
norm(ch) = 0.25956
iter: 5193, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074143

size_minibatch = 20000
Precon grad coeff: 0.015024, velocity coeff: 0.86889
norm(ch) = 0.22584
iter: 5194, Minibatch log likelihood (pre-update): -54.2831, error rate (pre-update): 0.074137

size_minibatch = 20000
Precon grad coeff: 0.016456, velocity coeff: 1.076
norm(ch) = 0.2433
rho = 1.0082
New lambda: 1.0223e-112
iter: 5195, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074139
iter: 5195, Minibatch log likelihood (post-update): -54.283, error rate (post-update): 0.074139

size_minibatch = 20000
Precon grad coeff: 0.016771, velocity coeff: 0.89878
norm(ch) = 0.21905
iter: 5196, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074139

size_minibatch = 20000
Precon grad coeff: 0.013874, velocity coeff: 0.95683
norm(ch) = 0.2099
iter: 5197, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074135

size_minibatch = 20000
Precon grad coeff: 0.018759, velocity coeff: 1.1255
norm(ch) = 0.23661
iter: 5198, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074132

size_minibatch = 20000
Precon grad coeff: 0.015806, velocity coeff: 0.88127
norm(ch) = 0.20884
iter: 5199, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074129

size_minibatch = 20000
Precon grad coeff: 0.014534, velocity coeff: 1.0091
New gamma: 0.0031623
norm(ch) = 0.21112
rho = 1.1065
New lambda: 7.9102e-113
iter: 5200, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.07413
iter: 5200, Minibatch log likelihood (post-update): -54.283, error rate (post-update): 0.07413
---
Full log-likelihood: -54.283, error rate: 0.07413
TEST log-likelihood: -55.6019, error rate: 0.47207
Error difference (test - train): 0.39794
---
Full log-likelihood (averaged params): -54.2846, error rate (averaged params): 0.074829
TEST log-likelihood (averaged params): -55.5704, error rate (averaged params): 0.46449
Error difference (test - train) (averaged params): 0.38966

size_minibatch = 20000
Precon grad coeff: 0.013767, velocity coeff: 0.92783
norm(ch) = 0.19622
iter: 5201, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.07413

size_minibatch = 20000
Precon grad coeff: 0.014573, velocity coeff: 1.0943
norm(ch) = 0.21507
iter: 5202, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074126

size_minibatch = 20000
Precon grad coeff: 0.019491, velocity coeff: 1.1641
norm(ch) = 0.25084
iter: 5203, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074126

size_minibatch = 20000
Precon grad coeff: 0.014998, velocity coeff: 0.81298
norm(ch) = 0.20431
iter: 5204, Minibatch log likelihood (pre-update): -54.283, error rate (pre-update): 0.074128

size_minibatch = 20000
Precon grad coeff: 0.01428, velocity coeff: 1.1016
norm(ch) = 0.22544
rho = 0.87827
New lambda: 6.1207e-113
iter: 5205, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074123
iter: 5205, Minibatch log likelihood (post-update): -54.2829, error rate (post-update): 0.074121

size_minibatch = 20000
Precon grad coeff: 0.014754, velocity coeff: 0.95942
norm(ch) = 0.2167
iter: 5206, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074121

size_minibatch = 20000
Precon grad coeff: 0.014284, velocity coeff: 1.0671
norm(ch) = 0.23164
iter: 5207, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.07412

size_minibatch = 20000
Precon grad coeff: 0.019311, velocity coeff: 1.0926
norm(ch) = 0.25351
iter: 5208, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074117

size_minibatch = 20000
Precon grad coeff: 0.013168, velocity coeff: 0.78523
norm(ch) = 0.19955
iter: 5209, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074115

size_minibatch = 20000
Precon grad coeff: 0.013512, velocity coeff: 1.0045
norm(ch) = 0.20072
rho = 1.4505
New lambda: 4.7361e-113
iter: 5210, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074115
iter: 5210, Minibatch log likelihood (post-update): -54.2829, error rate (post-update): 0.074114

size_minibatch = 20000
Precon grad coeff: 0.015721, velocity coeff: 1.0809
norm(ch) = 0.21735
iter: 5211, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074114

size_minibatch = 20000
Precon grad coeff: 0.016797, velocity coeff: 1.0062
norm(ch) = 0.21924
iter: 5212, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.07411

size_minibatch = 20000
Precon grad coeff: 0.013525, velocity coeff: 0.82101
norm(ch) = 0.18035
iter: 5213, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.07411

size_minibatch = 20000
Precon grad coeff: 0.013873, velocity coeff: 1.2115
norm(ch) = 0.21888
iter: 5214, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074109

size_minibatch = 20000
Precon grad coeff: 0.016384, velocity coeff: 0.97384
norm(ch) = 0.21359
rho = 0.89938
New lambda: 3.6647e-113
iter: 5215, Minibatch log likelihood (pre-update): -54.2829, error rate (pre-update): 0.074106
iter: 5215, Minibatch log likelihood (post-update): -54.2828, error rate (post-update): 0.074108

size_minibatch = 20000
Precon grad coeff: 0.014496, velocity coeff: 1.0174
norm(ch) = 0.21775
iter: 5216, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074108

size_minibatch = 20000
Precon grad coeff: 0.016316, velocity coeff: 1.0186
norm(ch) = 0.22232
iter: 5217, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074105

size_minibatch = 20000
Precon grad coeff: 0.012956, velocity coeff: 0.89195
norm(ch) = 0.19878
iter: 5218, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074101

size_minibatch = 20000
Precon grad coeff: 0.015957, velocity coeff: 1.2569
norm(ch) = 0.25009
iter: 5219, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074102

size_minibatch = 20000
Precon grad coeff: 0.019881, velocity coeff: 1.0194
New gamma: 0.0031623
norm(ch) = 0.25546
rho = 0.95889
New lambda: 2.8357e-113
iter: 5220, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074102
iter: 5220, Minibatch log likelihood (post-update): -54.2828, error rate (post-update): 0.074095

size_minibatch = 20000
Precon grad coeff: 0.014624, velocity coeff: 0.84903
norm(ch) = 0.21725
iter: 5221, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074095

size_minibatch = 20000
Precon grad coeff: 0.012968, velocity coeff: 1.0134
norm(ch) = 0.22045
iter: 5222, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074093

size_minibatch = 20000
Precon grad coeff: 0.01443, velocity coeff: 1.0179
norm(ch) = 0.2247
iter: 5223, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074093

size_minibatch = 20000
Precon grad coeff: 0.015885, velocity coeff: 1.0937
norm(ch) = 0.24602
iter: 5224, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074093

size_minibatch = 20000
Precon grad coeff: 0.018236, velocity coeff: 0.97179
norm(ch) = 0.23943
rho = 0.51783
New lambda: 2.8357e-113
iter: 5225, Minibatch log likelihood (pre-update): -54.2828, error rate (pre-update): 0.074092
iter: 5225, Minibatch log likelihood (post-update): -54.2827, error rate (post-update): 0.07409

size_minibatch = 20000
Precon grad coeff: 0.014244, velocity coeff: 0.88593
norm(ch) = 0.21246
iter: 5226, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.07409

size_minibatch = 20000
Precon grad coeff: 0.012744, velocity coeff: 0.98183
norm(ch) = 0.20879
iter: 5227, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074089

size_minibatch = 20000
Precon grad coeff: 0.015009, velocity coeff: 1.0912
norm(ch) = 0.22809
iter: 5228, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074086

size_minibatch = 20000
Precon grad coeff: 0.016585, velocity coeff: 1.0396
norm(ch) = 0.23743
iter: 5229, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074084

size_minibatch = 20000
Precon grad coeff: 0.018324, velocity coeff: 0.99344
norm(ch) = 0.23621
rho = 1.162
New lambda: 2.1942e-113
iter: 5230, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074084
iter: 5230, Minibatch log likelihood (post-update): -54.2827, error rate (post-update): 0.074084

size_minibatch = 20000
Precon grad coeff: 0.012282, velocity coeff: 0.81643
norm(ch) = 0.19311
iter: 5231, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074084

size_minibatch = 20000
Precon grad coeff: 0.014135, velocity coeff: 1.1174
norm(ch) = 0.21613
iter: 5232, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074082

size_minibatch = 20000
Precon grad coeff: 0.014577, velocity coeff: 0.99482
norm(ch) = 0.21525
iter: 5233, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074078

size_minibatch = 20000
Precon grad coeff: 0.016611, velocity coeff: 1.0267
norm(ch) = 0.22135
iter: 5234, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074078

size_minibatch = 20000
Precon grad coeff: 0.016185, velocity coeff: 0.95253
norm(ch) = 0.21132
rho = 0.71224
New lambda: 2.1942e-113
iter: 5235, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074077
iter: 5235, Minibatch log likelihood (post-update): -54.2827, error rate (post-update): 0.074075

size_minibatch = 20000
Precon grad coeff: 0.011111, velocity coeff: 0.84008
norm(ch) = 0.17775
iter: 5236, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074075

size_minibatch = 20000
Precon grad coeff: 0.018354, velocity coeff: 1.3313
norm(ch) = 0.23706
iter: 5237, Minibatch log likelihood (pre-update): -54.2827, error rate (pre-update): 0.074075

size_minibatch = 20000
Precon grad coeff: 0.016328, velocity coeff: 0.87593
norm(ch) = 0.20813
iter: 5238, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.07407

size_minibatch = 20000
Precon grad coeff: 0.014139, velocity coeff: 1.0208
norm(ch) = 0.21285
iter: 5239, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074068

size_minibatch = 20000
Precon grad coeff: 0.013192, velocity coeff: 0.87015
New gamma: 0.0031623
norm(ch) = 0.18558
rho = 0.95527
New lambda: 1.6978e-113
iter: 5240, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074068
iter: 5240, Minibatch log likelihood (post-update): -54.2826, error rate (post-update): 0.074066

size_minibatch = 20000
Precon grad coeff: 0.015484, velocity coeff: 1.2833
norm(ch) = 0.23862
iter: 5241, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074066

size_minibatch = 20000
Precon grad coeff: 0.020978, velocity coeff: 1.0564
norm(ch) = 0.25267
iter: 5242, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074066

size_minibatch = 20000
Precon grad coeff: 0.012747, velocity coeff: 0.79219
norm(ch) = 0.20057
iter: 5243, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074064

size_minibatch = 20000
Precon grad coeff: 0.014145, velocity coeff: 1.1248
norm(ch) = 0.22602
iter: 5244, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.07406

size_minibatch = 20000
Precon grad coeff: 0.01719, velocity coeff: 1.0858
norm(ch) = 0.24594
rho = 1.2768
New lambda: 1.3137e-113
iter: 5245, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074061
iter: 5245, Minibatch log likelihood (post-update): -54.2826, error rate (post-update): 0.07406

size_minibatch = 20000
Precon grad coeff: 0.015191, velocity coeff: 0.98935
norm(ch) = 0.24368
iter: 5246, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.07406

size_minibatch = 20000
Precon grad coeff: 0.016057, velocity coeff: 0.88633
norm(ch) = 0.21648
iter: 5247, Minibatch log likelihood (pre-update): -54.2826, error rate (pre-update): 0.074054

size_minibatch = 20000
Precon grad coeff: 0.010859, velocity coeff: 0.94684
norm(ch) = 0.20526
iter: 5248, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074055

size_minibatch = 20000
Precon grad coeff: 0.018315, velocity coeff: 1.148
norm(ch) = 0.2359
iter: 5249, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074056

size_minibatch = 20000
Precon grad coeff: 0.015743, velocity coeff: 0.82358
norm(ch) = 0.19476
rho = 1.0773
New lambda: 1.0166e-113
iter: 5250, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.07405
iter: 5250, Minibatch log likelihood (post-update): -54.2825, error rate (post-update): 0.074048
---
Full log-likelihood: -54.2825, error rate: 0.074048
TEST log-likelihood: -55.6125, error rate: 0.47456
Error difference (test - train): 0.40051
---
Full log-likelihood (averaged params): -54.2841, error rate (averaged params): 0.074725
TEST log-likelihood (averaged params): -55.5815, error rate (averaged params): 0.46707
Error difference (test - train) (averaged params): 0.39235

size_minibatch = 20000
Precon grad coeff: 0.010983, velocity coeff: 0.89864
norm(ch) = 0.17534
iter: 5251, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074048

size_minibatch = 20000
Precon grad coeff: 0.016467, velocity coeff: 1.1815
norm(ch) = 0.20749
iter: 5252, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074047

size_minibatch = 20000
Precon grad coeff: 0.015858, velocity coeff: 0.94374
norm(ch) = 0.19641
iter: 5253, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074048

size_minibatch = 20000
Precon grad coeff: 0.012831, velocity coeff: 0.93686
norm(ch) = 0.18436
iter: 5254, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074045

size_minibatch = 20000
Precon grad coeff: 0.013174, velocity coeff: 1.0157
norm(ch) = 0.18758
rho = 0.93574
New lambda: 7.8659e-114
iter: 5255, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074043
iter: 5255, Minibatch log likelihood (post-update): -54.2825, error rate (post-update): 0.074046

size_minibatch = 20000
Precon grad coeff: 0.017048, velocity coeff: 1.2244
norm(ch) = 0.23034
iter: 5256, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074046

size_minibatch = 20000
Precon grad coeff: 0.013609, velocity coeff: 0.77322
norm(ch) = 0.17857
iter: 5257, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074041

size_minibatch = 20000
Precon grad coeff: 0.013348, velocity coeff: 1.1701
norm(ch) = 0.20927
iter: 5258, Minibatch log likelihood (pre-update): -54.2825, error rate (pre-update): 0.074039

size_minibatch = 20000
Precon grad coeff: 0.01465, velocity coeff: 1.0101
norm(ch) = 0.21185
iter: 5259, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074041

size_minibatch = 20000
Precon grad coeff: 0.016356, velocity coeff: 1.0586
New gamma: 0.0031623
norm(ch) = 0.22479
rho = 0.82241
New lambda: 6.0865e-114
iter: 5260, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074038
iter: 5260, Minibatch log likelihood (post-update): -54.2824, error rate (post-update): 0.074034

size_minibatch = 20000
Precon grad coeff: 0.013143, velocity coeff: 0.88731
norm(ch) = 0.19985
iter: 5261, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074034

size_minibatch = 20000
Precon grad coeff: 0.016223, velocity coeff: 1.1972
norm(ch) = 0.23974
iter: 5262, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074034

size_minibatch = 20000
Precon grad coeff: 0.015417, velocity coeff: 0.90518
norm(ch) = 0.21744
iter: 5263, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.07403

size_minibatch = 20000
Precon grad coeff: 0.014517, velocity coeff: 1.0699
norm(ch) = 0.23304
iter: 5264, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074028

size_minibatch = 20000
Precon grad coeff: 0.01375, velocity coeff: 0.89893
norm(ch) = 0.20988
rho = 0.83817
New lambda: 4.7096e-114
iter: 5265, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.07403
iter: 5265, Minibatch log likelihood (post-update): -54.2824, error rate (post-update): 0.074028

size_minibatch = 20000
Precon grad coeff: 0.016524, velocity coeff: 1.1265
norm(ch) = 0.23685
iter: 5266, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074028

size_minibatch = 20000
Precon grad coeff: 0.014534, velocity coeff: 0.89295
norm(ch) = 0.21192
iter: 5267, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074023

size_minibatch = 20000
Precon grad coeff: 0.01268, velocity coeff: 0.97591
norm(ch) = 0.20716
iter: 5268, Minibatch log likelihood (pre-update): -54.2824, error rate (pre-update): 0.074023

size_minibatch = 20000
Precon grad coeff: 0.017269, velocity coeff: 1.112
norm(ch) = 0.23064
iter: 5269, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074021

size_minibatch = 20000
Precon grad coeff: 0.013881, velocity coeff: 0.82234
norm(ch) = 0.1901
rho = 0.68958
New lambda: 4.7096e-114
iter: 5270, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.07402
iter: 5270, Minibatch log likelihood (post-update): -54.2823, error rate (post-update): 0.074019

size_minibatch = 20000
Precon grad coeff: 0.013674, velocity coeff: 1.1414
norm(ch) = 0.21727
iter: 5271, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074019

size_minibatch = 20000
Precon grad coeff: 0.016443, velocity coeff: 0.94657
norm(ch) = 0.20606
iter: 5272, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074016

size_minibatch = 20000
Precon grad coeff: 0.013572, velocity coeff: 0.94981
norm(ch) = 0.19612
iter: 5273, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074014

size_minibatch = 20000
Precon grad coeff: 0.014552, velocity coeff: 1.0435
norm(ch) = 0.20509
iter: 5274, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074012

size_minibatch = 20000
Precon grad coeff: 0.014957, velocity coeff: 0.99211
norm(ch) = 0.20382
rho = 1.0097
New lambda: 3.6442e-114
iter: 5275, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.07401
iter: 5275, Minibatch log likelihood (post-update): -54.2823, error rate (post-update): 0.074009

size_minibatch = 20000
Precon grad coeff: 0.013661, velocity coeff: 0.92116
norm(ch) = 0.1882
iter: 5276, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074009

size_minibatch = 20000
Precon grad coeff: 0.014212, velocity coeff: 1.0608
norm(ch) = 0.20021
iter: 5277, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074008

size_minibatch = 20000
Precon grad coeff: 0.013233, velocity coeff: 0.93671
norm(ch) = 0.18774
iter: 5278, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074005

size_minibatch = 20000
Precon grad coeff: 0.015611, velocity coeff: 1.0954
norm(ch) = 0.20641
iter: 5279, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074005

size_minibatch = 20000
Precon grad coeff: 0.014372, velocity coeff: 0.87329
New gamma: 0.0052816
norm(ch) = 0.18039
rho = 1.0709
New lambda: 2.8198e-114
iter: 5280, Minibatch log likelihood (pre-update): -54.2823, error rate (pre-update): 0.074003
iter: 5280, Minibatch log likelihood (post-update): -54.2822, error rate (post-update): 0.074001

size_minibatch = 20000
Precon grad coeff: 0.016654, velocity coeff: 1.1278
norm(ch) = 0.20367
iter: 5281, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.074001

size_minibatch = 20000
Precon grad coeff: 0.0175, velocity coeff: 0.93788
norm(ch) = 0.19142
iter: 5282, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.074001

size_minibatch = 20000
Precon grad coeff: 0.016145, velocity coeff: 1.0365
norm(ch) = 0.19859
iter: 5283, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073997

size_minibatch = 20000
Precon grad coeff: 0.017098, velocity coeff: 0.99376
norm(ch) = 0.19764
iter: 5284, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073995

size_minibatch = 20000
Precon grad coeff: 0.016735, velocity coeff: 1.0408
norm(ch) = 0.20596
rho = 1.3248
New lambda: 2.1819e-114
iter: 5285, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.074
iter: 5285, Minibatch log likelihood (post-update): -54.2822, error rate (post-update): 0.073996

size_minibatch = 20000
Precon grad coeff: 0.016248, velocity coeff: 0.90258
norm(ch) = 0.18614
iter: 5286, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073996

size_minibatch = 20000
Precon grad coeff: 0.017233, velocity coeff: 1.1204
norm(ch) = 0.2088
iter: 5287, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.07399

size_minibatch = 20000
Precon grad coeff: 0.015523, velocity coeff: 0.86479
norm(ch) = 0.18075
iter: 5288, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073991

size_minibatch = 20000
Precon grad coeff: 0.018127, velocity coeff: 1.1508
norm(ch) = 0.20824
iter: 5289, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.07399

size_minibatch = 20000
Precon grad coeff: 0.015681, velocity coeff: 0.83957
norm(ch) = 0.17508
rho = 0.28906
New lambda: 2.1819e-114
iter: 5290, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073986
iter: 5290, Minibatch log likelihood (post-update): -54.2822, error rate (post-update): 0.073988

size_minibatch = 20000
Precon grad coeff: 0.016886, velocity coeff: 1.178
norm(ch) = 0.2064
iter: 5291, Minibatch log likelihood (pre-update): -54.2822, error rate (pre-update): 0.073988

size_minibatch = 20000
Precon grad coeff: 0.018241, velocity coeff: 0.93023
norm(ch) = 0.1922
iter: 5292, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073988

size_minibatch = 20000
Precon grad coeff: 0.015422, velocity coeff: 0.95285
norm(ch) = 0.18339
iter: 5293, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073983

size_minibatch = 20000
Precon grad coeff: 0.018296, velocity coeff: 1.1797
norm(ch) = 0.21648
iter: 5294, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073982

size_minibatch = 20000
Precon grad coeff: 0.017668, velocity coeff: 0.90425
norm(ch) = 0.19594
rho = 0.83746
New lambda: 1.6883e-114
iter: 5295, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073981
iter: 5295, Minibatch log likelihood (post-update): -54.2821, error rate (post-update): 0.073979

size_minibatch = 20000
Precon grad coeff: 0.015969, velocity coeff: 1.0484
norm(ch) = 0.20566
iter: 5296, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073979

size_minibatch = 20000
Precon grad coeff: 0.018651, velocity coeff: 1.0281
norm(ch) = 0.21158
iter: 5297, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073976

size_minibatch = 20000
Precon grad coeff: 0.01618, velocity coeff: 0.94499
norm(ch) = 0.20009
iter: 5298, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073976

size_minibatch = 20000
Precon grad coeff: 0.018064, velocity coeff: 1.0856
norm(ch) = 0.21745
iter: 5299, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073977

size_minibatch = 20000
Precon grad coeff: 0.014969, velocity coeff: 0.95671
New gamma: 0.0031623
norm(ch) = 0.20827
rho = 1.0093
New lambda: 1.3064e-114
iter: 5300, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.073974
iter: 5300, Minibatch log likelihood (post-update): -54.2821, error rate (post-update): 0.07397
---
Full log-likelihood: -54.2821, error rate: 0.07397
TEST log-likelihood: -55.6228, error rate: 0.47702
Error difference (test - train): 0.40305
---
Full log-likelihood (averaged params): -54.2835, error rate (averaged params): 0.074619
TEST log-likelihood (averaged params): -55.5925, error rate (averaged params): 0.46966
Error difference (test - train) (averaged params): 0.39504

size_minibatch = 20000
Precon grad coeff: 0.016283, velocity coeff: 1.1054
norm(ch) = 0.23051
iter: 5301, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.07397

size_minibatch = 20000
Precon grad coeff: 0.018148, velocity coeff: 1.152
norm(ch) = 0.26591
iter: 5302, Minibatch log likelihood (pre-update): -54.2821, error rate (pre-update): 0.07397

size_minibatch = 20000
Precon grad coeff: 0.01724, velocity coeff: 0.9102
norm(ch) = 0.24236
iter: 5303, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073968

size_minibatch = 20000
Precon grad coeff: 0.014832, velocity coeff: 0.99768
norm(ch) = 0.24213
iter: 5304, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073966

size_minibatch = 20000
Precon grad coeff: 0.015921, velocity coeff: 0.98927
norm(ch) = 0.23979
rho = 1.0574
New lambda: 1.0109e-114
iter: 5305, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073966
iter: 5305, Minibatch log likelihood (post-update): -54.282, error rate (post-update): 0.073966

size_minibatch = 20000
Precon grad coeff: 0.012883, velocity coeff: 0.87584
norm(ch) = 0.21034
iter: 5306, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073966

size_minibatch = 20000
Precon grad coeff: 0.017846, velocity coeff: 1.1745
norm(ch) = 0.24755
iter: 5307, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073961

size_minibatch = 20000
Precon grad coeff: 0.015171, velocity coeff: 0.85917
norm(ch) = 0.21314
iter: 5308, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.07396

size_minibatch = 20000
Precon grad coeff: 0.017553, velocity coeff: 1.1453
norm(ch) = 0.24456
iter: 5309, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073959

size_minibatch = 20000
Precon grad coeff: 0.017969, velocity coeff: 0.91252
norm(ch) = 0.22369
rho = 1.1254
New lambda: 7.8219e-115
iter: 5310, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073956
iter: 5310, Minibatch log likelihood (post-update): -54.282, error rate (post-update): 0.073956

size_minibatch = 20000
Precon grad coeff: 0.014614, velocity coeff: 0.94375
norm(ch) = 0.21154
iter: 5311, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073956

size_minibatch = 20000
Precon grad coeff: 0.015813, velocity coeff: 1.0542
norm(ch) = 0.22355
iter: 5312, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073956

size_minibatch = 20000
Precon grad coeff: 0.014706, velocity coeff: 0.95621
norm(ch) = 0.21424
iter: 5313, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073952

size_minibatch = 20000
Precon grad coeff: 0.015011, velocity coeff: 1.0477
norm(ch) = 0.22491
iter: 5314, Minibatch log likelihood (pre-update): -54.282, error rate (pre-update): 0.073952

size_minibatch = 20000
Precon grad coeff: 0.018019, velocity coeff: 1.0956
norm(ch) = 0.24689
rho = 1.0267
New lambda: 6.0524e-115
iter: 5315, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073951
iter: 5315, Minibatch log likelihood (post-update): -54.2819, error rate (post-update): 0.073948

size_minibatch = 20000
Precon grad coeff: 0.015707, velocity coeff: 0.89851
norm(ch) = 0.22229
iter: 5316, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073948

size_minibatch = 20000
Precon grad coeff: 0.01736, velocity coeff: 1.112
norm(ch) = 0.24768
iter: 5317, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073944

size_minibatch = 20000
Precon grad coeff: 0.01515, velocity coeff: 0.86638
norm(ch) = 0.21499
iter: 5318, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073946

size_minibatch = 20000
Precon grad coeff: 0.014825, velocity coeff: 1.048
norm(ch) = 0.22568
iter: 5319, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073944

size_minibatch = 20000
Precon grad coeff: 0.018368, velocity coeff: 1.0244
New gamma: 0.0052816
norm(ch) = 0.23143
rho = 1.2503
New lambda: 4.6832e-115
iter: 5320, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.07394
iter: 5320, Minibatch log likelihood (post-update): -54.2819, error rate (post-update): 0.073939

size_minibatch = 20000
Precon grad coeff: 0.015629, velocity coeff: 0.89808
norm(ch) = 0.20798
iter: 5321, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073939

size_minibatch = 20000
Precon grad coeff: 0.021254, velocity coeff: 1.1389
norm(ch) = 0.23712
iter: 5322, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073941

size_minibatch = 20000
Precon grad coeff: 0.020277, velocity coeff: 0.89621
norm(ch) = 0.21278
iter: 5323, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073936

size_minibatch = 20000
Precon grad coeff: 0.016659, velocity coeff: 0.93607
norm(ch) = 0.19931
iter: 5324, Minibatch log likelihood (pre-update): -54.2819, error rate (pre-update): 0.073934

size_minibatch = 20000
Precon grad coeff: 0.016906, velocity coeff: 0.95674
norm(ch) = 0.19084
rho = 0.61742
New lambda: 4.6832e-115
iter: 5325, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073936
iter: 5325, Minibatch log likelihood (post-update): -54.2818, error rate (post-update): 0.073933

size_minibatch = 20000
Precon grad coeff: 0.018292, velocity coeff: 1.0833
norm(ch) = 0.2069
iter: 5326, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073933

size_minibatch = 20000
Precon grad coeff: 0.016535, velocity coeff: 0.94207
norm(ch) = 0.19509
iter: 5327, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.07393

size_minibatch = 20000
Precon grad coeff: 0.021617, velocity coeff: 1.1148
norm(ch) = 0.21769
iter: 5328, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073931

size_minibatch = 20000
Precon grad coeff: 0.017998, velocity coeff: 0.91923
norm(ch) = 0.20022
iter: 5329, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073929

size_minibatch = 20000
Precon grad coeff: 0.018498, velocity coeff: 1.0147
norm(ch) = 0.20336
rho = 0.79325
New lambda: 3.6238e-115
iter: 5330, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073926
iter: 5330, Minibatch log likelihood (post-update): -54.2818, error rate (post-update): 0.073924

size_minibatch = 20000
Precon grad coeff: 0.016986, velocity coeff: 0.93473
norm(ch) = 0.19023
iter: 5331, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073924

size_minibatch = 20000
Precon grad coeff: 0.016771, velocity coeff: 1.0594
norm(ch) = 0.2016
iter: 5332, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073924

size_minibatch = 20000
Precon grad coeff: 0.020014, velocity coeff: 1.0646
norm(ch) = 0.21484
iter: 5333, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073922

size_minibatch = 20000
Precon grad coeff: 0.01942, velocity coeff: 0.99217
norm(ch) = 0.21333
iter: 5334, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073921

size_minibatch = 20000
Precon grad coeff: 0.018303, velocity coeff: 0.99021
norm(ch) = 0.21139
rho = 1.3385
New lambda: 2.804e-115
iter: 5335, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073918
iter: 5335, Minibatch log likelihood (post-update): -54.2818, error rate (post-update): 0.073916

size_minibatch = 20000
Precon grad coeff: 0.018841, velocity coeff: 1.0298
norm(ch) = 0.21788
iter: 5336, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073916

size_minibatch = 20000
Precon grad coeff: 0.017762, velocity coeff: 0.93499
norm(ch) = 0.20389
iter: 5337, Minibatch log likelihood (pre-update): -54.2818, error rate (pre-update): 0.073917

size_minibatch = 20000
Precon grad coeff: 0.016159, velocity coeff: 0.98054
norm(ch) = 0.20013
iter: 5338, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073914

size_minibatch = 20000
Precon grad coeff: 0.01875, velocity coeff: 1.1392
norm(ch) = 0.22818
iter: 5339, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073913

size_minibatch = 20000
Precon grad coeff: 0.017832, velocity coeff: 0.99012
New gamma: 0.0031623
norm(ch) = 0.2262
rho = 1.2804
New lambda: 2.1697e-115
iter: 5340, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073912
iter: 5340, Minibatch log likelihood (post-update): -54.2817, error rate (post-update): 0.07391

size_minibatch = 20000
Precon grad coeff: 0.016284, velocity coeff: 1.0051
norm(ch) = 0.22777
iter: 5341, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.07391

size_minibatch = 20000
Precon grad coeff: 0.018493, velocity coeff: 1.0972
norm(ch) = 0.25039
iter: 5342, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073906

size_minibatch = 20000
Precon grad coeff: 0.016759, velocity coeff: 0.91188
norm(ch) = 0.22882
iter: 5343, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073905

size_minibatch = 20000
Precon grad coeff: 0.01547, velocity coeff: 1.0593
norm(ch) = 0.24289
iter: 5344, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073905

size_minibatch = 20000
Precon grad coeff: 0.014913, velocity coeff: 0.93179
norm(ch) = 0.22689
rho = 0.93145
New lambda: 1.6789e-115
iter: 5345, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073902
iter: 5345, Minibatch log likelihood (post-update): -54.2817, error rate (post-update): 0.073902

size_minibatch = 20000
Precon grad coeff: 0.013836, velocity coeff: 1.0029
norm(ch) = 0.22805
iter: 5346, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073902

size_minibatch = 20000
Precon grad coeff: 0.017808, velocity coeff: 1.1671
norm(ch) = 0.26679
iter: 5347, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073902

size_minibatch = 20000
Precon grad coeff: 0.017668, velocity coeff: 0.87693
norm(ch) = 0.23453
iter: 5348, Minibatch log likelihood (pre-update): -54.2817, error rate (pre-update): 0.073899

size_minibatch = 20000
Precon grad coeff: 0.015325, velocity coeff: 0.99921
norm(ch) = 0.2349
iter: 5349, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073895

size_minibatch = 20000
Precon grad coeff: 0.018227, velocity coeff: 1.033
norm(ch) = 0.2434
rho = 1.373
New lambda: 1.2991e-115
iter: 5350, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073895
iter: 5350, Minibatch log likelihood (post-update): -54.2816, error rate (post-update): 0.073893
---
Full log-likelihood: -54.2816, error rate: 0.073893
TEST log-likelihood: -55.6347, error rate: 0.47989
Error difference (test - train): 0.406
---
Full log-likelihood (averaged params): -54.2831, error rate (averaged params): 0.07453
TEST log-likelihood (averaged params): -55.6037, error rate (averaged params): 0.47227
Error difference (test - train) (averaged params): 0.39774

size_minibatch = 20000
Precon grad coeff: 0.014178, velocity coeff: 0.87994
norm(ch) = 0.21466
iter: 5351, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073893

size_minibatch = 20000
Precon grad coeff: 0.014604, velocity coeff: 1.0166
norm(ch) = 0.21871
iter: 5352, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073892

size_minibatch = 20000
Precon grad coeff: 0.015002, velocity coeff: 1.0131
norm(ch) = 0.22202
iter: 5353, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073893

size_minibatch = 20000
Precon grad coeff: 0.017568, velocity coeff: 1.1084
norm(ch) = 0.24663
iter: 5354, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073888

size_minibatch = 20000
Precon grad coeff: 0.017431, velocity coeff: 0.95299
norm(ch) = 0.23555
rho = 0.73082
New lambda: 1.2991e-115
iter: 5355, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073884
iter: 5355, Minibatch log likelihood (post-update): -54.2816, error rate (post-update): 0.073886

size_minibatch = 20000
Precon grad coeff: 0.016323, velocity coeff: 0.99372
norm(ch) = 0.23451
iter: 5356, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073886

size_minibatch = 20000
Precon grad coeff: 0.015924, velocity coeff: 0.9528
norm(ch) = 0.2239
iter: 5357, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073882

size_minibatch = 20000
Precon grad coeff: 0.013162, velocity coeff: 0.94923
norm(ch) = 0.21294
iter: 5358, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073881

size_minibatch = 20000
Precon grad coeff: 0.015634, velocity coeff: 1.0472
norm(ch) = 0.22325
iter: 5359, Minibatch log likelihood (pre-update): -54.2816, error rate (pre-update): 0.073881

size_minibatch = 20000
Precon grad coeff: 0.015064, velocity coeff: 0.91141
New gamma: 0.0031623
norm(ch) = 0.20376
rho = 1.3696
New lambda: 1.0052e-115
iter: 5360, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073879
iter: 5360, Minibatch log likelihood (post-update): -54.2815, error rate (post-update): 0.073875

size_minibatch = 20000
Precon grad coeff: 0.01645, velocity coeff: 1.077
norm(ch) = 0.21982
iter: 5361, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073875

size_minibatch = 20000
Precon grad coeff: 0.017441, velocity coeff: 0.99394
norm(ch) = 0.21889
iter: 5362, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073874

size_minibatch = 20000
Precon grad coeff: 0.014937, velocity coeff: 0.93058
norm(ch) = 0.20398
iter: 5363, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073874

size_minibatch = 20000
Precon grad coeff: 0.014807, velocity coeff: 1.0384
norm(ch) = 0.21217
iter: 5364, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073872

size_minibatch = 20000
Precon grad coeff: 0.015612, velocity coeff: 1.0688
norm(ch) = 0.2271
rho = 1.3086
New lambda: 7.7781e-116
iter: 5365, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073872
iter: 5365, Minibatch log likelihood (post-update): -54.2815, error rate (post-update): 0.073869

size_minibatch = 20000
Precon grad coeff: 0.015943, velocity coeff: 1.015
norm(ch) = 0.23087
iter: 5366, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073869

size_minibatch = 20000
Precon grad coeff: 0.016415, velocity coeff: 1.0399
norm(ch) = 0.24047
iter: 5367, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073867

size_minibatch = 20000
Precon grad coeff: 0.017204, velocity coeff: 1.0239
norm(ch) = 0.24656
iter: 5368, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073864

size_minibatch = 20000
Precon grad coeff: 0.01499, velocity coeff: 0.89992
norm(ch) = 0.22225
iter: 5369, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073862

size_minibatch = 20000
Precon grad coeff: 0.014704, velocity coeff: 1.0076
norm(ch) = 0.22431
rho = 0.98454
New lambda: 6.0185e-116
iter: 5370, Minibatch log likelihood (pre-update): -54.2815, error rate (pre-update): 0.073863
iter: 5370, Minibatch log likelihood (post-update): -54.2814, error rate (post-update): 0.073861

size_minibatch = 20000
Precon grad coeff: 0.015515, velocity coeff: 1.0285
norm(ch) = 0.2311
iter: 5371, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073861

size_minibatch = 20000
Precon grad coeff: 0.014698, velocity coeff: 0.95532
norm(ch) = 0.22105
iter: 5372, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073858

size_minibatch = 20000
Precon grad coeff: 0.018193, velocity coeff: 1.089
norm(ch) = 0.24121
iter: 5373, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073855

size_minibatch = 20000
Precon grad coeff: 0.015428, velocity coeff: 0.89527
norm(ch) = 0.21635
iter: 5374, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073854

size_minibatch = 20000
Precon grad coeff: 0.015712, velocity coeff: 1.0569
norm(ch) = 0.22903
rho = 0.79885
New lambda: 4.657e-116
iter: 5375, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073852
iter: 5375, Minibatch log likelihood (post-update): -54.2814, error rate (post-update): 0.073851

size_minibatch = 20000
Precon grad coeff: 0.014951, velocity coeff: 0.95219
norm(ch) = 0.21848
iter: 5376, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073851

size_minibatch = 20000
Precon grad coeff: 0.015069, velocity coeff: 1.0366
norm(ch) = 0.22683
iter: 5377, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073853

size_minibatch = 20000
Precon grad coeff: 0.015452, velocity coeff: 0.98512
norm(ch) = 0.22387
iter: 5378, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073849

size_minibatch = 20000
Precon grad coeff: 0.017228, velocity coeff: 1.1093
norm(ch) = 0.24883
iter: 5379, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073846

size_minibatch = 20000
Precon grad coeff: 0.016202, velocity coeff: 0.86868
New gamma: 0.0031623
norm(ch) = 0.21659
rho = 1.1812
New lambda: 3.6035e-116
iter: 5380, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073848
iter: 5380, Minibatch log likelihood (post-update): -54.2814, error rate (post-update): 0.073844

size_minibatch = 20000
Precon grad coeff: 0.016073, velocity coeff: 1.0852
norm(ch) = 0.23548
iter: 5381, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073844

size_minibatch = 20000
Precon grad coeff: 0.015269, velocity coeff: 0.88251
norm(ch) = 0.20831
iter: 5382, Minibatch log likelihood (pre-update): -54.2814, error rate (pre-update): 0.073841

size_minibatch = 20000
Precon grad coeff: 0.012626, velocity coeff: 0.98873
norm(ch) = 0.20636
iter: 5383, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.07384

size_minibatch = 20000
Precon grad coeff: 0.017953, velocity coeff: 1.211
norm(ch) = 0.25017
iter: 5384, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.07384

size_minibatch = 20000
Precon grad coeff: 0.014333, velocity coeff: 0.91559
norm(ch) = 0.22937
rho = 1.5388
New lambda: 2.7883e-116
iter: 5385, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073836
iter: 5385, Minibatch log likelihood (post-update): -54.2813, error rate (post-update): 0.073837

size_minibatch = 20000
Precon grad coeff: 0.017796, velocity coeff: 1.1437
norm(ch) = 0.26274
iter: 5386, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073837

size_minibatch = 20000
Precon grad coeff: 0.017007, velocity coeff: 0.95272
norm(ch) = 0.25067
iter: 5387, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073835

size_minibatch = 20000
Precon grad coeff: 0.014215, velocity coeff: 0.83343
norm(ch) = 0.20925
iter: 5388, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073831

size_minibatch = 20000
Precon grad coeff: 0.014149, velocity coeff: 1.1002
norm(ch) = 0.23045
iter: 5389, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073829

size_minibatch = 20000
Precon grad coeff: 0.015522, velocity coeff: 0.95251
norm(ch) = 0.21973
rho = 0.42902
New lambda: 2.7883e-116
iter: 5390, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.07383
iter: 5390, Minibatch log likelihood (post-update): -54.2813, error rate (post-update): 0.073828

size_minibatch = 20000
Precon grad coeff: 0.013733, velocity coeff: 0.99563
norm(ch) = 0.21904
iter: 5391, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073828

size_minibatch = 20000
Precon grad coeff: 0.017425, velocity coeff: 1.1224
norm(ch) = 0.24611
iter: 5392, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073826

size_minibatch = 20000
Precon grad coeff: 0.017937, velocity coeff: 0.9414
norm(ch) = 0.23201
iter: 5393, Minibatch log likelihood (pre-update): -54.2813, error rate (pre-update): 0.073824

size_minibatch = 20000
Precon grad coeff: 0.01213, velocity coeff: 0.9018
norm(ch) = 0.20946
iter: 5394, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073825

size_minibatch = 20000
Precon grad coeff: 0.015541, velocity coeff: 1.022
norm(ch) = 0.21427
rho = 1.1953
New lambda: 2.1576e-116
iter: 5395, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073823
iter: 5395, Minibatch log likelihood (post-update): -54.2812, error rate (post-update): 0.07382

size_minibatch = 20000
Precon grad coeff: 0.014267, velocity coeff: 1.0172
norm(ch) = 0.21814
iter: 5396, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.07382

size_minibatch = 20000
Precon grad coeff: 0.014125, velocity coeff: 0.94726
norm(ch) = 0.20689
iter: 5397, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073816

size_minibatch = 20000
Precon grad coeff: 0.01973, velocity coeff: 1.2276
norm(ch) = 0.25434
iter: 5398, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073817

size_minibatch = 20000
Precon grad coeff: 0.015022, velocity coeff: 0.774
norm(ch) = 0.19717
iter: 5399, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073816

size_minibatch = 20000
Precon grad coeff: 0.017506, velocity coeff: 1.1662
New gamma: 0.0052816
norm(ch) = 0.23001
rho = 1.1727
New lambda: 1.6695e-116
iter: 5400, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073813
iter: 5400, Minibatch log likelihood (post-update): -54.2812, error rate (post-update): 0.073811
---
Full log-likelihood: -54.2812, error rate: 0.073811
TEST log-likelihood: -55.6458, error rate: 0.48269
Error difference (test - train): 0.40888
---
Full log-likelihood (averaged params): -54.2827, error rate (averaged params): 0.074471
TEST log-likelihood (averaged params): -55.6148, error rate (averaged params): 0.47495
Error difference (test - train) (averaged params): 0.40048

size_minibatch = 20000
Precon grad coeff: 0.016523, velocity coeff: 0.84479
norm(ch) = 0.19445
iter: 5401, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073811

size_minibatch = 20000
Precon grad coeff: 0.016351, velocity coeff: 1.1182
norm(ch) = 0.21761
iter: 5402, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073812

size_minibatch = 20000
Precon grad coeff: 0.017816, velocity coeff: 0.93289
norm(ch) = 0.2032
iter: 5403, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073808

size_minibatch = 20000
Precon grad coeff: 0.018127, velocity coeff: 1.0565
norm(ch) = 0.21481
iter: 5404, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073807

size_minibatch = 20000
Precon grad coeff: 0.018503, velocity coeff: 0.95365
norm(ch) = 0.205
rho = 1.2561
New lambda: 1.2918e-116
iter: 5405, Minibatch log likelihood (pre-update): -54.2812, error rate (pre-update): 0.073808
iter: 5405, Minibatch log likelihood (post-update): -54.2811, error rate (post-update): 0.073804

size_minibatch = 20000
Precon grad coeff: 0.019419, velocity coeff: 1.0321
norm(ch) = 0.21175
iter: 5406, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073804

size_minibatch = 20000
Precon grad coeff: 0.015995, velocity coeff: 0.88492
norm(ch) = 0.18755
iter: 5407, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073802

size_minibatch = 20000
Precon grad coeff: 0.017642, velocity coeff: 1.0674
norm(ch) = 0.20029
iter: 5408, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073804

size_minibatch = 20000
Precon grad coeff: 0.016463, velocity coeff: 0.98546
norm(ch) = 0.1975
iter: 5409, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073801

size_minibatch = 20000
Precon grad coeff: 0.016855, velocity coeff: 1.0057
norm(ch) = 0.19876
rho = 1.0992
New lambda: 9.9958e-117
iter: 5410, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073798
iter: 5410, Minibatch log likelihood (post-update): -54.2811, error rate (post-update): 0.073798

size_minibatch = 20000
Precon grad coeff: 0.019614, velocity coeff: 1.1087
norm(ch) = 0.22057
iter: 5411, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073798

size_minibatch = 20000
Precon grad coeff: 0.018681, velocity coeff: 0.94076
norm(ch) = 0.20761
iter: 5412, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073796

size_minibatch = 20000
Precon grad coeff: 0.018898, velocity coeff: 1.0188
norm(ch) = 0.21161
iter: 5413, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073792

size_minibatch = 20000
Precon grad coeff: 0.016366, velocity coeff: 0.94533
norm(ch) = 0.20018
iter: 5414, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073792

size_minibatch = 20000
Precon grad coeff: 0.018855, velocity coeff: 1.047
norm(ch) = 0.20975
rho = 1.2581
New lambda: 7.7346e-117
iter: 5415, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073789
iter: 5415, Minibatch log likelihood (post-update): -54.2811, error rate (post-update): 0.07379

size_minibatch = 20000
Precon grad coeff: 0.013871, velocity coeff: 0.88279
norm(ch) = 0.18538
iter: 5416, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.07379

size_minibatch = 20000
Precon grad coeff: 0.019285, velocity coeff: 1.1183
norm(ch) = 0.20741
iter: 5417, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.07379

size_minibatch = 20000
Precon grad coeff: 0.017622, velocity coeff: 0.92397
norm(ch) = 0.19175
iter: 5418, Minibatch log likelihood (pre-update): -54.2811, error rate (pre-update): 0.073788

size_minibatch = 20000
Precon grad coeff: 0.020214, velocity coeff: 1.1147
norm(ch) = 0.21398
iter: 5419, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073784

size_minibatch = 20000
Precon grad coeff: 0.016654, velocity coeff: 0.88136
New gamma: 0.0031623
norm(ch) = 0.18895
rho = 1.1039
New lambda: 5.9849e-117
iter: 5420, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073784
iter: 5420, Minibatch log likelihood (post-update): -54.281, error rate (post-update): 0.073781

size_minibatch = 20000
Precon grad coeff: 0.017994, velocity coeff: 1.1802
norm(ch) = 0.22352
iter: 5421, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073781

size_minibatch = 20000
Precon grad coeff: 0.018638, velocity coeff: 0.96672
norm(ch) = 0.21662
iter: 5422, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073781

size_minibatch = 20000
Precon grad coeff: 0.012471, velocity coeff: 0.92074
norm(ch) = 0.19989
iter: 5423, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073782

size_minibatch = 20000
Precon grad coeff: 0.015132, velocity coeff: 1.1326
norm(ch) = 0.22698
iter: 5424, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073777

size_minibatch = 20000
Precon grad coeff: 0.013594, velocity coeff: 1.0222
norm(ch) = 0.23247
rho = 1.1896
New lambda: 4.631e-117
iter: 5425, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073773
iter: 5425, Minibatch log likelihood (post-update): -54.281, error rate (post-update): 0.073775

size_minibatch = 20000
Precon grad coeff: 0.018636, velocity coeff: 1.1528
norm(ch) = 0.2686
iter: 5426, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073775

size_minibatch = 20000
Precon grad coeff: 0.016373, velocity coeff: 0.91704
norm(ch) = 0.24686
iter: 5427, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073776

size_minibatch = 20000
Precon grad coeff: 0.016896, velocity coeff: 0.97599
norm(ch) = 0.24153
iter: 5428, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073773

size_minibatch = 20000
Precon grad coeff: 0.016682, velocity coeff: 1.0243
norm(ch) = 0.24798
iter: 5429, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073775

size_minibatch = 20000
Precon grad coeff: 0.015188, velocity coeff: 0.85866
norm(ch) = 0.21347
rho = 1.0394
New lambda: 3.5834e-117
iter: 5430, Minibatch log likelihood (pre-update): -54.281, error rate (pre-update): 0.073771
iter: 5430, Minibatch log likelihood (post-update): -54.2809, error rate (post-update): 0.073768

size_minibatch = 20000
Precon grad coeff: 0.01186, velocity coeff: 0.97986
norm(ch) = 0.20964
iter: 5431, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073768

size_minibatch = 20000
Precon grad coeff: 0.014828, velocity coeff: 1.0058
norm(ch) = 0.21119
iter: 5432, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073767

size_minibatch = 20000
Precon grad coeff: 0.015023, velocity coeff: 1.0311
norm(ch) = 0.21821
iter: 5433, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073767

size_minibatch = 20000
Precon grad coeff: 0.018371, velocity coeff: 1.0373
norm(ch) = 0.22691
iter: 5434, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073763

size_minibatch = 20000
Precon grad coeff: 0.015492, velocity coeff: 0.87908
norm(ch) = 0.19994
rho = 0.90545
New lambda: 2.7727e-117
iter: 5435, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073762
iter: 5435, Minibatch log likelihood (post-update): -54.2809, error rate (post-update): 0.073762

size_minibatch = 20000
Precon grad coeff: 0.012986, velocity coeff: 0.94317
norm(ch) = 0.18897
iter: 5436, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073762

size_minibatch = 20000
Precon grad coeff: 0.013451, velocity coeff: 1.072
norm(ch) = 0.20296
iter: 5437, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.07376

size_minibatch = 20000
Precon grad coeff: 0.016663, velocity coeff: 1.1186
norm(ch) = 0.22749
iter: 5438, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073759

size_minibatch = 20000
Precon grad coeff: 0.016134, velocity coeff: 1.0296
norm(ch) = 0.23461
iter: 5439, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073758

size_minibatch = 20000
Precon grad coeff: 0.017188, velocity coeff: 0.99641
New gamma: 0.0031623
norm(ch) = 0.23415
rho = 0.83712
New lambda: 2.1455e-117
iter: 5440, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073756
iter: 5440, Minibatch log likelihood (post-update): -54.2809, error rate (post-update): 0.073755

size_minibatch = 20000
Precon grad coeff: 0.011773, velocity coeff: 0.79994
norm(ch) = 0.18762
iter: 5441, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073755

size_minibatch = 20000
Precon grad coeff: 0.011128, velocity coeff: 1.097
norm(ch) = 0.20608
iter: 5442, Minibatch log likelihood (pre-update): -54.2809, error rate (pre-update): 0.073752

size_minibatch = 20000
Precon grad coeff: 0.014273, velocity coeff: 1.1224
norm(ch) = 0.23149
iter: 5443, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073751

size_minibatch = 20000
Precon grad coeff: 0.017094, velocity coeff: 1.0846
norm(ch) = 0.25135
iter: 5444, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073749

size_minibatch = 20000
Precon grad coeff: 0.016271, velocity coeff: 0.96742
norm(ch) = 0.24342
rho = 0.98347
New lambda: 1.6601e-117
iter: 5445, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073747
iter: 5445, Minibatch log likelihood (post-update): -54.2808, error rate (post-update): 0.073744

size_minibatch = 20000
Precon grad coeff: 0.015239, velocity coeff: 0.908
norm(ch) = 0.22124
iter: 5446, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073744

size_minibatch = 20000
Precon grad coeff: 0.012188, velocity coeff: 0.90271
norm(ch) = 0.19994
iter: 5447, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073744

size_minibatch = 20000
Precon grad coeff: 0.011063, velocity coeff: 1.007
norm(ch) = 0.20156
iter: 5448, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073742

size_minibatch = 20000
Precon grad coeff: 0.015382, velocity coeff: 1.1769
norm(ch) = 0.23734
iter: 5449, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073742

size_minibatch = 20000
Precon grad coeff: 0.015145, velocity coeff: 1.007
norm(ch) = 0.23915
rho = 0.82805
New lambda: 1.2846e-117
iter: 5450, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073742
iter: 5450, Minibatch log likelihood (post-update): -54.2808, error rate (post-update): 0.07374
---
Full log-likelihood: -54.2808, error rate: 0.07374
TEST log-likelihood: -55.6572, error rate: 0.48558
Error difference (test - train): 0.41184
---
Full log-likelihood (averaged params): -54.2823, error rate (averaged params): 0.074408
TEST log-likelihood (averaged params): -55.6259, error rate (averaged params): 0.47772
Error difference (test - train) (averaged params): 0.40331

size_minibatch = 20000
Precon grad coeff: 0.013968, velocity coeff: 0.90059
norm(ch) = 0.21559
iter: 5451, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.07374

size_minibatch = 20000
Precon grad coeff: 0.012291, velocity coeff: 0.92805
norm(ch) = 0.20029
iter: 5452, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073736

size_minibatch = 20000
Precon grad coeff: 0.01081, velocity coeff: 1.0955
norm(ch) = 0.21967
iter: 5453, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073736

size_minibatch = 20000
Precon grad coeff: 0.01494, velocity coeff: 0.93635
norm(ch) = 0.20586
iter: 5454, Minibatch log likelihood (pre-update): -54.2808, error rate (pre-update): 0.073733

size_minibatch = 20000
Precon grad coeff: 0.014776, velocity coeff: 1.079
norm(ch) = 0.22239
rho = 0.86607
New lambda: 9.9398e-118
iter: 5455, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073732
iter: 5455, Minibatch log likelihood (post-update): -54.2807, error rate (post-update): 0.073733

size_minibatch = 20000
Precon grad coeff: 0.015529, velocity coeff: 0.91212
norm(ch) = 0.20319
iter: 5456, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073733

size_minibatch = 20000
Precon grad coeff: 0.01153, velocity coeff: 0.87687
norm(ch) = 0.17851
iter: 5457, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073731

size_minibatch = 20000
Precon grad coeff: 0.011456, velocity coeff: 1.0412
norm(ch) = 0.18611
iter: 5458, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073727

size_minibatch = 20000
Precon grad coeff: 0.016591, velocity coeff: 1.2553
norm(ch) = 0.23402
iter: 5459, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073727

size_minibatch = 20000
Precon grad coeff: 0.014994, velocity coeff: 0.83038
New gamma: 0.0052816
norm(ch) = 0.19452
rho = 1.17
New lambda: 7.6913e-118
iter: 5460, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073728
iter: 5460, Minibatch log likelihood (post-update): -54.2807, error rate (post-update): 0.073726

size_minibatch = 20000
Precon grad coeff: 0.018193, velocity coeff: 1.1448
norm(ch) = 0.22292
iter: 5461, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073726

size_minibatch = 20000
Precon grad coeff: 0.019154, velocity coeff: 0.97959
norm(ch) = 0.21858
iter: 5462, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073725

size_minibatch = 20000
Precon grad coeff: 0.015338, velocity coeff: 0.86836
norm(ch) = 0.19001
iter: 5463, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073724

size_minibatch = 20000
Precon grad coeff: 0.014357, velocity coeff: 0.99712
norm(ch) = 0.18964
iter: 5464, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073719

size_minibatch = 20000
Precon grad coeff: 0.014644, velocity coeff: 0.96939
norm(ch) = 0.1841
rho = 1.2334
New lambda: 5.9514e-118
iter: 5465, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.073719
iter: 5465, Minibatch log likelihood (post-update): -54.2807, error rate (post-update): 0.07372

size_minibatch = 20000
Precon grad coeff: 0.015939, velocity coeff: 1.0821
norm(ch) = 0.19925
iter: 5466, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.07372

size_minibatch = 20000
Precon grad coeff: 0.017168, velocity coeff: 0.92719
norm(ch) = 0.18491
iter: 5467, Minibatch log likelihood (pre-update): -54.2807, error rate (pre-update): 0.07372

size_minibatch = 20000
Precon grad coeff: 0.018263, velocity coeff: 1.1209
norm(ch) = 0.20751
iter: 5468, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073716

size_minibatch = 20000
Precon grad coeff: 0.019225, velocity coeff: 0.9466
norm(ch) = 0.19656
iter: 5469, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073715

size_minibatch = 20000
Precon grad coeff: 0.016343, velocity coeff: 0.91587
norm(ch) = 0.18019
rho = 0.5339
New lambda: 5.9514e-118
iter: 5470, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073714
iter: 5470, Minibatch log likelihood (post-update): -54.2806, error rate (post-update): 0.073713

size_minibatch = 20000
Precon grad coeff: 0.014318, velocity coeff: 1.0277
norm(ch) = 0.18533
iter: 5471, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073713

size_minibatch = 20000
Precon grad coeff: 0.014747, velocity coeff: 0.9012
norm(ch) = 0.16727
iter: 5472, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073713

size_minibatch = 20000
Precon grad coeff: 0.015091, velocity coeff: 1.2104
norm(ch) = 0.20246
iter: 5473, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.07371

size_minibatch = 20000
Precon grad coeff: 0.020858, velocity coeff: 1.0411
norm(ch) = 0.21096
iter: 5474, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073709

size_minibatch = 20000
Precon grad coeff: 0.015865, velocity coeff: 0.86308
norm(ch) = 0.1823
rho = 1.9456
New lambda: 4.605e-118
iter: 5475, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073707
iter: 5475, Minibatch log likelihood (post-update): -54.2806, error rate (post-update): 0.073707

size_minibatch = 20000
Precon grad coeff: 0.015367, velocity coeff: 1.015
norm(ch) = 0.1851
iter: 5476, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073707

size_minibatch = 20000
Precon grad coeff: 0.012604, velocity coeff: 0.88997
norm(ch) = 0.16486
iter: 5477, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073706

size_minibatch = 20000
Precon grad coeff: 0.017708, velocity coeff: 1.2652
norm(ch) = 0.20872
iter: 5478, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073704

size_minibatch = 20000
Precon grad coeff: 0.017121, velocity coeff: 0.95217
norm(ch) = 0.19891
iter: 5479, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073704

size_minibatch = 20000
Precon grad coeff: 0.016231, velocity coeff: 0.97549
New gamma: 0.0031623
norm(ch) = 0.19431
rho = 0.72551
New lambda: 4.605e-118
iter: 5480, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073704
iter: 5480, Minibatch log likelihood (post-update): -54.2806, error rate (post-update): 0.073699

size_minibatch = 20000
Precon grad coeff: 0.0157, velocity coeff: 1.0197
norm(ch) = 0.19853
iter: 5481, Minibatch log likelihood (pre-update): -54.2806, error rate (pre-update): 0.073699

size_minibatch = 20000
Precon grad coeff: 0.011563, velocity coeff: 0.83586
norm(ch) = 0.16631
iter: 5482, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073699

size_minibatch = 20000
Precon grad coeff: 0.014788, velocity coeff: 1.2808
norm(ch) = 0.21328
iter: 5483, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073698

size_minibatch = 20000
Precon grad coeff: 0.019126, velocity coeff: 1.0649
norm(ch) = 0.22766
iter: 5484, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073696

size_minibatch = 20000
Precon grad coeff: 0.015143, velocity coeff: 0.90763
norm(ch) = 0.20719
rho = 1.585
New lambda: 3.5633e-118
iter: 5485, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073694
iter: 5485, Minibatch log likelihood (post-update): -54.2805, error rate (post-update): 0.073695

size_minibatch = 20000
Precon grad coeff: 0.013749, velocity coeff: 1.0038
norm(ch) = 0.20845
iter: 5486, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073695

size_minibatch = 20000
Precon grad coeff: 0.012093, velocity coeff: 0.98062
norm(ch) = 0.20482
iter: 5487, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073695

size_minibatch = 20000
Precon grad coeff: 0.016761, velocity coeff: 1.2332
norm(ch) = 0.25311
iter: 5488, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073693

size_minibatch = 20000
Precon grad coeff: 0.015992, velocity coeff: 0.94873
norm(ch) = 0.24067
iter: 5489, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073693

size_minibatch = 20000
Precon grad coeff: 0.017514, velocity coeff: 1.0224
norm(ch) = 0.24668
rho = 0.87627
New lambda: 2.7572e-118
iter: 5490, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073691
iter: 5490, Minibatch log likelihood (post-update): -54.2805, error rate (post-update): 0.073688

size_minibatch = 20000
Precon grad coeff: 0.012142, velocity coeff: 0.81765
norm(ch) = 0.20208
iter: 5491, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073688

size_minibatch = 20000
Precon grad coeff: 0.012944, velocity coeff: 1.0803
norm(ch) = 0.21866
iter: 5492, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073688

size_minibatch = 20000
Precon grad coeff: 0.015325, velocity coeff: 1.0505
norm(ch) = 0.23014
iter: 5493, Minibatch log likelihood (pre-update): -54.2805, error rate (pre-update): 0.073687

size_minibatch = 20000
Precon grad coeff: 0.017804, velocity coeff: 1.0567
norm(ch) = 0.24368
iter: 5494, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073686

size_minibatch = 20000
Precon grad coeff: 0.015245, velocity coeff: 0.88635
norm(ch) = 0.21638
rho = 1.3345
New lambda: 2.1335e-118
iter: 5495, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073686
iter: 5495, Minibatch log likelihood (post-update): -54.2804, error rate (post-update): 0.073683

size_minibatch = 20000
Precon grad coeff: 0.014296, velocity coeff: 0.96597
norm(ch) = 0.20943
iter: 5496, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073683

size_minibatch = 20000
Precon grad coeff: 0.01139, velocity coeff: 0.90736
norm(ch) = 0.19035
iter: 5497, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073683

size_minibatch = 20000
Precon grad coeff: 0.015421, velocity coeff: 1.1751
norm(ch) = 0.22388
iter: 5498, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073681

size_minibatch = 20000
Precon grad coeff: 0.016721, velocity coeff: 0.98502
norm(ch) = 0.22089
iter: 5499, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073678

size_minibatch = 20000
Precon grad coeff: 0.019432, velocity coeff: 1.0153
New gamma: 0.0052816
norm(ch) = 0.22452
rho = 0.56297
New lambda: 2.1335e-118
iter: 5500, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073677
iter: 5500, Minibatch log likelihood (post-update): -54.2804, error rate (post-update): 0.073678
---
Full log-likelihood: -54.2804, error rate: 0.073678
TEST log-likelihood: -55.6698, error rate: 0.48854
Error difference (test - train): 0.41486
---
Full log-likelihood (averaged params): -54.2819, error rate (averaged params): 0.074329
TEST log-likelihood (averaged params): -55.6375, error rate (averaged params): 0.48059
Error difference (test - train) (averaged params): 0.40626

size_minibatch = 20000
Precon grad coeff: 0.013327, velocity coeff: 0.72101
norm(ch) = 0.16201
iter: 5501, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073678

size_minibatch = 20000
Precon grad coeff: 0.015111, velocity coeff: 1.2462
norm(ch) = 0.20204
iter: 5502, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073677

size_minibatch = 20000
Precon grad coeff: 0.017091, velocity coeff: 0.97207
norm(ch) = 0.19659
iter: 5503, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073673

size_minibatch = 20000
Precon grad coeff: 0.016743, velocity coeff: 1.0224
norm(ch) = 0.20114
iter: 5504, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073674

size_minibatch = 20000
Precon grad coeff: 0.020316, velocity coeff: 1.028
norm(ch) = 0.20695
rho = 1.1771
New lambda: 1.6508e-118
iter: 5505, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073672
iter: 5505, Minibatch log likelihood (post-update): -54.2804, error rate (post-update): 0.073669

size_minibatch = 20000
Precon grad coeff: 0.014249, velocity coeff: 0.83144
norm(ch) = 0.17224
iter: 5506, Minibatch log likelihood (pre-update): -54.2804, error rate (pre-update): 0.073669

size_minibatch = 20000
Precon grad coeff: 0.013855, velocity coeff: 1.0877
norm(ch) = 0.18739
iter: 5507, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073671

size_minibatch = 20000
Precon grad coeff: 0.018775, velocity coeff: 1.1397
norm(ch) = 0.21368
iter: 5508, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073671

size_minibatch = 20000
Precon grad coeff: 0.017608, velocity coeff: 0.92268
norm(ch) = 0.19729
iter: 5509, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073669

size_minibatch = 20000
Precon grad coeff: 0.018086, velocity coeff: 1.0983
norm(ch) = 0.21682
rho = 1.1409
New lambda: 1.2774e-118
iter: 5510, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073667
iter: 5510, Minibatch log likelihood (post-update): -54.2803, error rate (post-update): 0.073666

size_minibatch = 20000
Precon grad coeff: 0.017566, velocity coeff: 0.85727
norm(ch) = 0.18599
iter: 5511, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073666

size_minibatch = 20000
Precon grad coeff: 0.012943, velocity coeff: 1.006
norm(ch) = 0.18725
iter: 5512, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073665

size_minibatch = 20000
Precon grad coeff: 0.016263, velocity coeff: 1.0479
norm(ch) = 0.19629
iter: 5513, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073663

size_minibatch = 20000
Precon grad coeff: 0.017993, velocity coeff: 1.0204
norm(ch) = 0.2004
iter: 5514, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073662

size_minibatch = 20000
Precon grad coeff: 0.018683, velocity coeff: 1.028
norm(ch) = 0.20618
rho = 1.1814
New lambda: 9.8842e-119
iter: 5515, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073661
iter: 5515, Minibatch log likelihood (post-update): -54.2803, error rate (post-update): 0.07366

size_minibatch = 20000
Precon grad coeff: 0.015608, velocity coeff: 0.84628
norm(ch) = 0.17462
iter: 5516, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.07366

size_minibatch = 20000
Precon grad coeff: 0.013419, velocity coeff: 1.0513
norm(ch) = 0.18366
iter: 5517, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073659

size_minibatch = 20000
Precon grad coeff: 0.017008, velocity coeff: 1.0714
norm(ch) = 0.19692
iter: 5518, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073658

size_minibatch = 20000
Precon grad coeff: 0.017581, velocity coeff: 1.0443
norm(ch) = 0.2058
iter: 5519, Minibatch log likelihood (pre-update): -54.2803, error rate (pre-update): 0.073659

size_minibatch = 20000
Precon grad coeff: 0.017946, velocity coeff: 1.0447
New gamma: 0.0031623
norm(ch) = 0.21538
rho = 0.74919
New lambda: 9.8842e-119
iter: 5520, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073657
iter: 5520, Minibatch log likelihood (post-update): -54.2802, error rate (post-update): 0.073656

size_minibatch = 20000
Precon grad coeff: 0.016481, velocity coeff: 0.94854
norm(ch) = 0.20474
iter: 5521, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073656

size_minibatch = 20000
Precon grad coeff: 0.013003, velocity coeff: 0.92847
norm(ch) = 0.19053
iter: 5522, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073657

size_minibatch = 20000
Precon grad coeff: 0.015388, velocity coeff: 1.1614
norm(ch) = 0.22166
iter: 5523, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073654

size_minibatch = 20000
Precon grad coeff: 0.017236, velocity coeff: 1.0287
norm(ch) = 0.22866
iter: 5524, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.07365

size_minibatch = 20000
Precon grad coeff: 0.016987, velocity coeff: 0.99982
norm(ch) = 0.22925
rho = 0.74454
New lambda: 9.8842e-119
iter: 5525, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.07365
iter: 5525, Minibatch log likelihood (post-update): -54.2802, error rate (post-update): 0.073651

size_minibatch = 20000
Precon grad coeff: 0.014335, velocity coeff: 0.93181
norm(ch) = 0.21416
iter: 5526, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073651

size_minibatch = 20000
Precon grad coeff: 0.014552, velocity coeff: 1.0423
norm(ch) = 0.2238
iter: 5527, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073651

size_minibatch = 20000
Precon grad coeff: 0.014465, velocity coeff: 0.98134
norm(ch) = 0.22023
iter: 5528, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073647

size_minibatch = 20000
Precon grad coeff: 0.014965, velocity coeff: 1.0428
norm(ch) = 0.23017
iter: 5529, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073646

size_minibatch = 20000
Precon grad coeff: 0.019639, velocity coeff: 1.1488
norm(ch) = 0.26515
rho = 0.99312
New lambda: 7.6482e-119
iter: 5530, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073646
iter: 5530, Minibatch log likelihood (post-update): -54.2802, error rate (post-update): 0.073642

size_minibatch = 20000
Precon grad coeff: 0.015707, velocity coeff: 0.82352
norm(ch) = 0.21891
iter: 5531, Minibatch log likelihood (pre-update): -54.2802, error rate (pre-update): 0.073642

size_minibatch = 20000
Precon grad coeff: 0.012561, velocity coeff: 0.9473
norm(ch) = 0.20774
iter: 5532, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073643

size_minibatch = 20000
Precon grad coeff: 0.015478, velocity coeff: 1.138
norm(ch) = 0.23679
iter: 5533, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073642

size_minibatch = 20000
Precon grad coeff: 0.01699, velocity coeff: 0.98336
norm(ch) = 0.23325
iter: 5534, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.07364

size_minibatch = 20000
Precon grad coeff: 0.01509, velocity coeff: 0.93102
norm(ch) = 0.21751
rho = 1.543
New lambda: 5.918e-119
iter: 5535, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073639
iter: 5535, Minibatch log likelihood (post-update): -54.2801, error rate (post-update): 0.07364

size_minibatch = 20000
Precon grad coeff: 0.017155, velocity coeff: 1.0533
norm(ch) = 0.22947
iter: 5536, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.07364

size_minibatch = 20000
Precon grad coeff: 0.011796, velocity coeff: 0.81094
norm(ch) = 0.18634
iter: 5537, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073638

size_minibatch = 20000
Precon grad coeff: 0.01624, velocity coeff: 1.2004
norm(ch) = 0.22381
iter: 5538, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073635

size_minibatch = 20000
Precon grad coeff: 0.014874, velocity coeff: 0.89901
norm(ch) = 0.20148
iter: 5539, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073634

size_minibatch = 20000
Precon grad coeff: 0.017078, velocity coeff: 1.029
New gamma: 0.0031623
norm(ch) = 0.20759
rho = 1.3172
New lambda: 4.5793e-119
iter: 5540, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073632
iter: 5540, Minibatch log likelihood (post-update): -54.2801, error rate (post-update): 0.073632

size_minibatch = 20000
Precon grad coeff: 0.014482, velocity coeff: 0.83216
norm(ch) = 0.17297
iter: 5541, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073632

size_minibatch = 20000
Precon grad coeff: 0.012151, velocity coeff: 0.97403
norm(ch) = 0.1687
iter: 5542, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073633

size_minibatch = 20000
Precon grad coeff: 0.01803, velocity coeff: 1.2522
norm(ch) = 0.21163
iter: 5543, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.07363

size_minibatch = 20000
Precon grad coeff: 0.01478, velocity coeff: 0.87211
norm(ch) = 0.18491
iter: 5544, Minibatch log likelihood (pre-update): -54.2801, error rate (pre-update): 0.073629

size_minibatch = 20000
Precon grad coeff: 0.016368, velocity coeff: 1.2071
norm(ch) = 0.22354
rho = 0.77505
New lambda: 3.5433e-119
iter: 5545, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.07363
iter: 5545, Minibatch log likelihood (post-update): -54.28, error rate (post-update): 0.073627

size_minibatch = 20000
Precon grad coeff: 0.015751, velocity coeff: 0.93565
norm(ch) = 0.20962
iter: 5546, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073627

size_minibatch = 20000
Precon grad coeff: 0.013982, velocity coeff: 1.0023
norm(ch) = 0.21044
iter: 5547, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073626

size_minibatch = 20000
Precon grad coeff: 0.013485, velocity coeff: 0.97758
norm(ch) = 0.20599
iter: 5548, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073624

size_minibatch = 20000
Precon grad coeff: 0.015124, velocity coeff: 1.1114
norm(ch) = 0.22933
iter: 5549, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073622

size_minibatch = 20000
Precon grad coeff: 0.018014, velocity coeff: 1.0367
norm(ch) = 0.23817
rho = 1.0944
New lambda: 2.7418e-119
iter: 5550, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073621
iter: 5550, Minibatch log likelihood (post-update): -54.28, error rate (post-update): 0.073624
---
Full log-likelihood: -54.28, error rate: 0.073624
TEST log-likelihood: -55.6835, error rate: 0.49149
Error difference (test - train): 0.41787
---
Full log-likelihood (averaged params): -54.2814, error rate (averaged params): 0.074245
TEST log-likelihood (averaged params): -55.6497, error rate (averaged params): 0.48351
Error difference (test - train) (averaged params): 0.40927

size_minibatch = 20000
Precon grad coeff: 0.015502, velocity coeff: 0.89255
norm(ch) = 0.21299
iter: 5551, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073624

size_minibatch = 20000
Precon grad coeff: 0.011847, velocity coeff: 0.87559
norm(ch) = 0.18686
iter: 5552, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073623

size_minibatch = 20000
Precon grad coeff: 0.015596, velocity coeff: 1.2435
norm(ch) = 0.23267
iter: 5553, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073618

size_minibatch = 20000
Precon grad coeff: 0.016541, velocity coeff: 0.89938
norm(ch) = 0.20971
iter: 5554, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073617

size_minibatch = 20000
Precon grad coeff: 0.016317, velocity coeff: 1.0405
norm(ch) = 0.21869
rho = 1.1139
New lambda: 2.1215e-119
iter: 5555, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073618
iter: 5555, Minibatch log likelihood (post-update): -54.28, error rate (post-update): 0.073614

size_minibatch = 20000
Precon grad coeff: 0.011786, velocity coeff: 0.77382
norm(ch) = 0.16957
iter: 5556, Minibatch log likelihood (pre-update): -54.28, error rate (pre-update): 0.073614

size_minibatch = 20000
Precon grad coeff: 0.015277, velocity coeff: 1.3294
norm(ch) = 0.22582
iter: 5557, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073614

size_minibatch = 20000
Precon grad coeff: 0.018002, velocity coeff: 0.96782
norm(ch) = 0.2191
iter: 5558, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073614

size_minibatch = 20000
Precon grad coeff: 0.014791, velocity coeff: 0.92815
norm(ch) = 0.20377
iter: 5559, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073613

size_minibatch = 20000
Precon grad coeff: 0.013379, velocity coeff: 0.85154
New gamma: 0.0052816
norm(ch) = 0.17384
rho = 1.1169
New lambda: 1.6416e-119
iter: 5560, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073613
iter: 5560, Minibatch log likelihood (post-update): -54.2799, error rate (post-update): 0.073611

size_minibatch = 20000
Precon grad coeff: 0.013721, velocity coeff: 1.0743
norm(ch) = 0.18688
iter: 5561, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073611

size_minibatch = 20000
Precon grad coeff: 0.017348, velocity coeff: 1.0797
norm(ch) = 0.20192
iter: 5562, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073609

size_minibatch = 20000
Precon grad coeff: 0.018519, velocity coeff: 0.9742
norm(ch) = 0.19703
iter: 5563, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073607

size_minibatch = 20000
Precon grad coeff: 0.013756, velocity coeff: 0.8103
norm(ch) = 0.15985
iter: 5564, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073607

size_minibatch = 20000
Precon grad coeff: 0.012898, velocity coeff: 1.0751
norm(ch) = 0.17191
rho = 1.5658
New lambda: 1.2702e-119
iter: 5565, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073607
iter: 5565, Minibatch log likelihood (post-update): -54.2799, error rate (post-update): 0.073605

size_minibatch = 20000
Precon grad coeff: 0.016919, velocity coeff: 1.137
norm(ch) = 0.19565
iter: 5566, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073605

size_minibatch = 20000
Precon grad coeff: 0.017587, velocity coeff: 0.98733
norm(ch) = 0.19334
iter: 5567, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073604

size_minibatch = 20000
Precon grad coeff: 0.017169, velocity coeff: 0.94193
norm(ch) = 0.1823
iter: 5568, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.073604

size_minibatch = 20000
Precon grad coeff: 0.01205, velocity coeff: 0.85864
norm(ch) = 0.15673
iter: 5569, Minibatch log likelihood (pre-update): -54.2799, error rate (pre-update): 0.0736

size_minibatch = 20000
Precon grad coeff: 0.015183, velocity coeff: 1.232
norm(ch) = 0.19314
rho = 1.2549
New lambda: 9.8289e-120
iter: 5570, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.0736
iter: 5570, Minibatch log likelihood (post-update): -54.2798, error rate (post-update): 0.073599

size_minibatch = 20000
Precon grad coeff: 0.018804, velocity coeff: 1.0717
norm(ch) = 0.20707
iter: 5571, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073599

size_minibatch = 20000
Precon grad coeff: 0.018037, velocity coeff: 0.94847
norm(ch) = 0.19657
iter: 5572, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073597

size_minibatch = 20000
Precon grad coeff: 0.014913, velocity coeff: 0.86578
norm(ch) = 0.17035
iter: 5573, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073596

size_minibatch = 20000
Precon grad coeff: 0.013129, velocity coeff: 0.99878
norm(ch) = 0.17024
iter: 5574, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073596

size_minibatch = 20000
Precon grad coeff: 0.015232, velocity coeff: 1.0552
norm(ch) = 0.17964
rho = 1.2853
New lambda: 7.6054e-120
iter: 5575, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073596
iter: 5575, Minibatch log likelihood (post-update): -54.2798, error rate (post-update): 0.073592

size_minibatch = 20000
Precon grad coeff: 0.018832, velocity coeff: 1.1208
norm(ch) = 0.20149
iter: 5576, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073592

size_minibatch = 20000
Precon grad coeff: 0.018254, velocity coeff: 0.95963
norm(ch) = 0.19347
iter: 5577, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073592

size_minibatch = 20000
Precon grad coeff: 0.016205, velocity coeff: 0.93307
norm(ch) = 0.18065
iter: 5578, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073591

size_minibatch = 20000
Precon grad coeff: 0.012941, velocity coeff: 0.92218
norm(ch) = 0.16676
iter: 5579, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073588

size_minibatch = 20000
Precon grad coeff: 0.015711, velocity coeff: 1.0945
New gamma: 0.0052816
norm(ch) = 0.18264
rho = 1.0293
New lambda: 5.8849e-120
iter: 5580, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073589
iter: 5580, Minibatch log likelihood (post-update): -54.2798, error rate (post-update): 0.073588

size_minibatch = 20000
Precon grad coeff: 0.018131, velocity coeff: 0.98454
norm(ch) = 0.17994
iter: 5581, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073588

size_minibatch = 20000
Precon grad coeff: 0.015548, velocity coeff: 0.91663
norm(ch) = 0.1652
iter: 5582, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073586

size_minibatch = 20000
Precon grad coeff: 0.015117, velocity coeff: 1.0403
norm(ch) = 0.17196
iter: 5583, Minibatch log likelihood (pre-update): -54.2798, error rate (pre-update): 0.073585

size_minibatch = 20000
Precon grad coeff: 0.017822, velocity coeff: 1.108
norm(ch) = 0.1907
iter: 5584, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073585

size_minibatch = 20000
Precon grad coeff: 0.017139, velocity coeff: 0.92533
norm(ch) = 0.17674
rho = 1.3067
New lambda: 4.5536e-120
iter: 5585, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073586
iter: 5585, Minibatch log likelihood (post-update): -54.2797, error rate (post-update): 0.073582

size_minibatch = 20000
Precon grad coeff: 0.015329, velocity coeff: 1.0358
norm(ch) = 0.18323
iter: 5586, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073582

size_minibatch = 20000
Precon grad coeff: 0.015456, velocity coeff: 0.98197
norm(ch) = 0.18008
iter: 5587, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.07358

size_minibatch = 20000
Precon grad coeff: 0.018483, velocity coeff: 1.1516
norm(ch) = 0.20764
iter: 5588, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073582

size_minibatch = 20000
Precon grad coeff: 0.0157, velocity coeff: 0.79647
norm(ch) = 0.16562
iter: 5589, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073581

size_minibatch = 20000
Precon grad coeff: 0.015093, velocity coeff: 1.1828
norm(ch) = 0.19612
rho = 0.83862
New lambda: 3.5235e-120
iter: 5590, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073578
iter: 5590, Minibatch log likelihood (post-update): -54.2797, error rate (post-update): 0.073579

size_minibatch = 20000
Precon grad coeff: 0.02068, velocity coeff: 1.0534
norm(ch) = 0.20686
iter: 5591, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073579

size_minibatch = 20000
Precon grad coeff: 0.013336, velocity coeff: 0.78463
norm(ch) = 0.16252
iter: 5592, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073579

size_minibatch = 20000
Precon grad coeff: 0.018937, velocity coeff: 1.3253
norm(ch) = 0.21569
iter: 5593, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073577

size_minibatch = 20000
Precon grad coeff: 0.015676, velocity coeff: 0.82658
norm(ch) = 0.17853
iter: 5594, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073574

size_minibatch = 20000
Precon grad coeff: 0.015874, velocity coeff: 1.1161
norm(ch) = 0.19947
rho = 1.0285
New lambda: 2.7264e-120
iter: 5595, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073574
iter: 5595, Minibatch log likelihood (post-update): -54.2797, error rate (post-update): 0.073576

size_minibatch = 20000
Precon grad coeff: 0.018241, velocity coeff: 0.99445
norm(ch) = 0.19865
iter: 5596, Minibatch log likelihood (pre-update): -54.2797, error rate (pre-update): 0.073576

size_minibatch = 20000
Precon grad coeff: 0.014682, velocity coeff: 0.95757
norm(ch) = 0.19042
iter: 5597, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073571

size_minibatch = 20000
Precon grad coeff: 0.017482, velocity coeff: 1.0284
norm(ch) = 0.19607
iter: 5598, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073567

size_minibatch = 20000
Precon grad coeff: 0.014987, velocity coeff: 0.96602
norm(ch) = 0.18961
iter: 5599, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.07357

size_minibatch = 20000
Precon grad coeff: 0.016276, velocity coeff: 1.0224
New gamma: 0.0031623
norm(ch) = 0.19432
rho = 1.0487
New lambda: 2.1097e-120
iter: 5600, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073568
iter: 5600, Minibatch log likelihood (post-update): -54.2796, error rate (post-update): 0.073567
---
Full log-likelihood: -54.2796, error rate: 0.073567
TEST log-likelihood: -55.6958, error rate: 0.49408
Error difference (test - train): 0.42052
---
Full log-likelihood (averaged params): -54.281, error rate (averaged params): 0.074157
TEST log-likelihood (averaged params): -55.6626, error rate (averaged params): 0.48641
Error difference (test - train) (averaged params): 0.41225

size_minibatch = 20000
Precon grad coeff: 0.01341, velocity coeff: 0.93102
norm(ch) = 0.18132
iter: 5601, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073567

size_minibatch = 20000
Precon grad coeff: 0.013946, velocity coeff: 1.0511
norm(ch) = 0.19099
iter: 5602, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073569

size_minibatch = 20000
Precon grad coeff: 0.016074, velocity coeff: 1.1566
norm(ch) = 0.22142
iter: 5603, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073567

size_minibatch = 20000
Precon grad coeff: 0.015288, velocity coeff: 0.91461
norm(ch) = 0.20301
iter: 5604, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073564

size_minibatch = 20000
Precon grad coeff: 0.012588, velocity coeff: 0.96603
norm(ch) = 0.19658
rho = 0.64957
New lambda: 2.1097e-120
iter: 5605, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073564
iter: 5605, Minibatch log likelihood (post-update): -54.2796, error rate (post-update): 0.073563

size_minibatch = 20000
Precon grad coeff: 0.014976, velocity coeff: 1.1126
norm(ch) = 0.21915
iter: 5606, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073563

size_minibatch = 20000
Precon grad coeff: 0.016647, velocity coeff: 0.99922
norm(ch) = 0.2195
iter: 5607, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073562

size_minibatch = 20000
Precon grad coeff: 0.012248, velocity coeff: 0.88203
norm(ch) = 0.19409
iter: 5608, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.07356

size_minibatch = 20000
Precon grad coeff: 0.013741, velocity coeff: 1.0203
norm(ch) = 0.19836
iter: 5609, Minibatch log likelihood (pre-update): -54.2796, error rate (pre-update): 0.073558

size_minibatch = 20000
Precon grad coeff: 0.015965, velocity coeff: 1.0737
norm(ch) = 0.21339
rho = 0.80561
New lambda: 1.6324e-120
iter: 5610, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073557
iter: 5610, Minibatch log likelihood (post-update): -54.2795, error rate (post-update): 0.073556

size_minibatch = 20000
Precon grad coeff: 0.013673, velocity coeff: 0.88821
norm(ch) = 0.19008
iter: 5611, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073556

size_minibatch = 20000
Precon grad coeff: 0.012468, velocity coeff: 0.98202
norm(ch) = 0.18694
iter: 5612, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073555

size_minibatch = 20000
Precon grad coeff: 0.016942, velocity coeff: 1.176
norm(ch) = 0.22029
iter: 5613, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073554

size_minibatch = 20000
Precon grad coeff: 0.012896, velocity coeff: 0.81021
norm(ch) = 0.17895
iter: 5614, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.07355

size_minibatch = 20000
Precon grad coeff: 0.013584, velocity coeff: 1.1156
norm(ch) = 0.1999
rho = 1.0664
New lambda: 1.2631e-120
iter: 5615, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073551
iter: 5615, Minibatch log likelihood (post-update): -54.2795, error rate (post-update): 0.073554

size_minibatch = 20000
Precon grad coeff: 0.014501, velocity coeff: 0.99875
norm(ch) = 0.20006
iter: 5616, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073554

size_minibatch = 20000
Precon grad coeff: 0.01443, velocity coeff: 0.99449
norm(ch) = 0.19932
iter: 5617, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073549

size_minibatch = 20000
Precon grad coeff: 0.012513, velocity coeff: 0.95537
norm(ch) = 0.19073
iter: 5618, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073547

size_minibatch = 20000
Precon grad coeff: 0.015047, velocity coeff: 1.1339
norm(ch) = 0.21663
iter: 5619, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073547

size_minibatch = 20000
Precon grad coeff: 0.016514, velocity coeff: 0.92946
New gamma: 0.0031623
norm(ch) = 0.2018
rho = 1.2388
New lambda: 9.7739e-121
iter: 5620, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073546
iter: 5620, Minibatch log likelihood (post-update): -54.2795, error rate (post-update): 0.073546

size_minibatch = 20000
Precon grad coeff: 0.01506, velocity coeff: 1.0911
norm(ch) = 0.22052
iter: 5621, Minibatch log likelihood (pre-update): -54.2795, error rate (pre-update): 0.073546

size_minibatch = 20000
Precon grad coeff: 0.018377, velocity coeff: 0.99253
norm(ch) = 0.2193
iter: 5622, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073545

size_minibatch = 20000
Precon grad coeff: 0.013725, velocity coeff: 0.91006
norm(ch) = 0.19994
iter: 5623, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073545

size_minibatch = 20000
Precon grad coeff: 0.015594, velocity coeff: 1.0624
norm(ch) = 0.21279
iter: 5624, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073543

size_minibatch = 20000
Precon grad coeff: 0.01466, velocity coeff: 0.99367
norm(ch) = 0.21172
rho = 1.0499
New lambda: 7.5628e-121
iter: 5625, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.07354
iter: 5625, Minibatch log likelihood (post-update): -54.2794, error rate (post-update): 0.073541

size_minibatch = 20000
Precon grad coeff: 0.016668, velocity coeff: 1.0527
norm(ch) = 0.22324
iter: 5626, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073541

size_minibatch = 20000
Precon grad coeff: 0.015973, velocity coeff: 0.95728
norm(ch) = 0.21401
iter: 5627, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073541

size_minibatch = 20000
Precon grad coeff: 0.015491, velocity coeff: 0.99065
norm(ch) = 0.21233
iter: 5628, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073538

size_minibatch = 20000
Precon grad coeff: 0.014408, velocity coeff: 0.94543
norm(ch) = 0.20109
iter: 5629, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073537

size_minibatch = 20000
Precon grad coeff: 0.014467, velocity coeff: 1.0028
norm(ch) = 0.20199
rho = 0.65848
New lambda: 7.5628e-121
iter: 5630, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073537
iter: 5630, Minibatch log likelihood (post-update): -54.2794, error rate (post-update): 0.073537

size_minibatch = 20000
Precon grad coeff: 0.015989, velocity coeff: 1.069
norm(ch) = 0.21632
iter: 5631, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073537

size_minibatch = 20000
Precon grad coeff: 0.015905, velocity coeff: 0.97087
norm(ch) = 0.21031
iter: 5632, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073536

size_minibatch = 20000
Precon grad coeff: 0.01551, velocity coeff: 0.98142
norm(ch) = 0.20678
iter: 5633, Minibatch log likelihood (pre-update): -54.2794, error rate (pre-update): 0.073534

size_minibatch = 20000
Precon grad coeff: 0.015835, velocity coeff: 1.0378
norm(ch) = 0.21502
iter: 5634, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073531

size_minibatch = 20000
Precon grad coeff: 0.014056, velocity coeff: 0.86618
norm(ch) = 0.18656
rho = 1.1061
New lambda: 5.852e-121
iter: 5635, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.07353
iter: 5635, Minibatch log likelihood (post-update): -54.2793, error rate (post-update): 0.073531

size_minibatch = 20000
Precon grad coeff: 0.014181, velocity coeff: 1.1262
norm(ch) = 0.21043
iter: 5636, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073531

size_minibatch = 20000
Precon grad coeff: 0.019487, velocity coeff: 1.0669
norm(ch) = 0.22501
iter: 5637, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073529

size_minibatch = 20000
Precon grad coeff: 0.013591, velocity coeff: 0.87255
norm(ch) = 0.19668
iter: 5638, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073528

size_minibatch = 20000
Precon grad coeff: 0.016391, velocity coeff: 1.0647
norm(ch) = 0.20982
iter: 5639, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073527

size_minibatch = 20000
Precon grad coeff: 0.014276, velocity coeff: 0.95362
New gamma: 0.0031623
norm(ch) = 0.20047
rho = 0.8645
New lambda: 4.5281e-121
iter: 5640, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073526
iter: 5640, Minibatch log likelihood (post-update): -54.2793, error rate (post-update): 0.073526

size_minibatch = 20000
Precon grad coeff: 0.014347, velocity coeff: 1.0175
norm(ch) = 0.20441
iter: 5641, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073526

size_minibatch = 20000
Precon grad coeff: 0.015999, velocity coeff: 1.0577
norm(ch) = 0.21657
iter: 5642, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073525

size_minibatch = 20000
Precon grad coeff: 0.01578, velocity coeff: 0.97251
norm(ch) = 0.21096
iter: 5643, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073523

size_minibatch = 20000
Precon grad coeff: 0.015757, velocity coeff: 0.99616
norm(ch) = 0.21058
iter: 5644, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.073521

size_minibatch = 20000
Precon grad coeff: 0.014437, velocity coeff: 0.9314
norm(ch) = 0.19646
rho = 0.87138
New lambda: 3.5038e-121
iter: 5645, Minibatch log likelihood (pre-update): -54.2793, error rate (pre-update): 0.07352
iter: 5645, Minibatch log likelihood (post-update): -54.2793, error rate (post-update): 0.073519

size_minibatch = 20000
Precon grad coeff: 0.014169, velocity coeff: 1.0388
norm(ch) = 0.20443
iter: 5646, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073519

size_minibatch = 20000
Precon grad coeff: 0.015161, velocity coeff: 0.97794
norm(ch) = 0.20025
iter: 5647, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073518

size_minibatch = 20000
Precon grad coeff: 0.016082, velocity coeff: 1.09
norm(ch) = 0.21865
iter: 5648, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073519

size_minibatch = 20000
Precon grad coeff: 0.016213, velocity coeff: 0.95403
norm(ch) = 0.20898
iter: 5649, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073518

size_minibatch = 20000
Precon grad coeff: 0.014597, velocity coeff: 0.94492
norm(ch) = 0.19776
rho = 0.68229
New lambda: 3.5038e-121
iter: 5650, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073516
iter: 5650, Minibatch log likelihood (post-update): -54.2792, error rate (post-update): 0.073518
---
Full log-likelihood: -54.2792, error rate: 0.073518
TEST log-likelihood: -55.7101, error rate: 0.49714
Error difference (test - train): 0.42362
---
Full log-likelihood (averaged params): -54.2806, error rate (averaged params): 0.074078
TEST log-likelihood (averaged params): -55.6757, error rate (averaged params): 0.48927
Error difference (test - train) (averaged params): 0.4152

size_minibatch = 20000
Precon grad coeff: 0.014081, velocity coeff: 1.0098
norm(ch) = 0.19996
iter: 5651, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073518

size_minibatch = 20000
Precon grad coeff: 0.01505, velocity coeff: 0.9935
norm(ch) = 0.19897
iter: 5652, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073515

size_minibatch = 20000
Precon grad coeff: 0.015753, velocity coeff: 1.0755
norm(ch) = 0.21431
iter: 5653, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073512

size_minibatch = 20000
Precon grad coeff: 0.015474, velocity coeff: 0.97387
norm(ch) = 0.20896
iter: 5654, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073513

size_minibatch = 20000
Precon grad coeff: 0.016358, velocity coeff: 0.96498
norm(ch) = 0.20203
rho = 0.84802
New lambda: 2.7112e-121
iter: 5655, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073513
iter: 5655, Minibatch log likelihood (post-update): -54.2792, error rate (post-update): 0.073511

size_minibatch = 20000
Precon grad coeff: 0.013675, velocity coeff: 0.96729
norm(ch) = 0.19568
iter: 5656, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.073511

size_minibatch = 20000
Precon grad coeff: 0.015098, velocity coeff: 1.0653
norm(ch) = 0.20867
iter: 5657, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.07351

size_minibatch = 20000
Precon grad coeff: 0.014089, velocity coeff: 0.91928
norm(ch) = 0.19208
iter: 5658, Minibatch log likelihood (pre-update): -54.2792, error rate (pre-update): 0.07351

size_minibatch = 20000
Precon grad coeff: 0.016902, velocity coeff: 1.1534
norm(ch) = 0.22185
iter: 5659, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073506

size_minibatch = 20000
Precon grad coeff: 0.015468, velocity coeff: 0.8732
New gamma: 0.0031623
norm(ch) = 0.19403
rho = 0.47419
New lambda: 2.7112e-121
iter: 5660, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073506
iter: 5660, Minibatch log likelihood (post-update): -54.2791, error rate (post-update): 0.073508

size_minibatch = 20000
Precon grad coeff: 0.0151, velocity coeff: 1.0623
norm(ch) = 0.20641
iter: 5661, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073508

size_minibatch = 20000
Precon grad coeff: 0.015661, velocity coeff: 1.0068
norm(ch) = 0.20811
iter: 5662, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073504

size_minibatch = 20000
Precon grad coeff: 0.01765, velocity coeff: 1.0928
norm(ch) = 0.22777
iter: 5663, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073501

size_minibatch = 20000
Precon grad coeff: 0.014227, velocity coeff: 0.83031
norm(ch) = 0.18939
iter: 5664, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073504

size_minibatch = 20000
Precon grad coeff: 0.01575, velocity coeff: 1.16
norm(ch) = 0.22003
rho = 1.2011
New lambda: 2.0978e-121
iter: 5665, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073503
iter: 5665, Minibatch log likelihood (post-update): -54.2791, error rate (post-update): 0.073501

size_minibatch = 20000
Precon grad coeff: 0.017104, velocity coeff: 1.033
norm(ch) = 0.22761
iter: 5666, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073501

size_minibatch = 20000
Precon grad coeff: 0.015092, velocity coeff: 0.84861
norm(ch) = 0.19345
iter: 5667, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073501

size_minibatch = 20000
Precon grad coeff: 0.015854, velocity coeff: 1.1623
norm(ch) = 0.22521
iter: 5668, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073498

size_minibatch = 20000
Precon grad coeff: 0.015827, velocity coeff: 0.89484
norm(ch) = 0.20181
iter: 5669, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073496

size_minibatch = 20000
Precon grad coeff: 0.015406, velocity coeff: 1.0975
norm(ch) = 0.22184
rho = 1.2152
New lambda: 1.6233e-121
iter: 5670, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073498
iter: 5670, Minibatch log likelihood (post-update): -54.279, error rate (post-update): 0.073497

size_minibatch = 20000
Precon grad coeff: 0.017881, velocity coeff: 0.98127
norm(ch) = 0.21806
iter: 5671, Minibatch log likelihood (pre-update): -54.2791, error rate (pre-update): 0.073497

size_minibatch = 20000
Precon grad coeff: 0.013861, velocity coeff: 0.91259
norm(ch) = 0.19926
iter: 5672, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073494

size_minibatch = 20000
Precon grad coeff: 0.016435, velocity coeff: 1.11
norm(ch) = 0.22148
iter: 5673, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073493

size_minibatch = 20000
Precon grad coeff: 0.016556, velocity coeff: 0.91561
norm(ch) = 0.20313
iter: 5674, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073492

size_minibatch = 20000
Precon grad coeff: 0.014783, velocity coeff: 1.0185
norm(ch) = 0.20722
rho = 0.84447
New lambda: 1.2561e-121
iter: 5675, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073491
iter: 5675, Minibatch log likelihood (post-update): -54.279, error rate (post-update): 0.073489

size_minibatch = 20000
Precon grad coeff: 0.01664, velocity coeff: 1.0204
norm(ch) = 0.21181
iter: 5676, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073489

size_minibatch = 20000
Precon grad coeff: 0.014652, velocity coeff: 0.93313
norm(ch) = 0.1979
iter: 5677, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.07349

size_minibatch = 20000
Precon grad coeff: 0.01754, velocity coeff: 1.112
norm(ch) = 0.2205
iter: 5678, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073489

size_minibatch = 20000
Precon grad coeff: 0.014253, velocity coeff: 0.8635
norm(ch) = 0.19065
iter: 5679, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073486

size_minibatch = 20000
Precon grad coeff: 0.017935, velocity coeff: 1.1559
New gamma: 0.0031623
norm(ch) = 0.22077
rho = 1.0032
New lambda: 9.7192e-122
iter: 5680, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073486
iter: 5680, Minibatch log likelihood (post-update): -54.279, error rate (post-update): 0.073485

size_minibatch = 20000
Precon grad coeff: 0.015012, velocity coeff: 0.86982
norm(ch) = 0.19233
iter: 5681, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073485

size_minibatch = 20000
Precon grad coeff: 0.016765, velocity coeff: 1.0851
norm(ch) = 0.20903
iter: 5682, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073483

size_minibatch = 20000
Precon grad coeff: 0.015643, velocity coeff: 0.96047
norm(ch) = 0.20108
iter: 5683, Minibatch log likelihood (pre-update): -54.279, error rate (pre-update): 0.073483

size_minibatch = 20000
Precon grad coeff: 0.016402, velocity coeff: 1.0523
norm(ch) = 0.21192
iter: 5684, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073481

size_minibatch = 20000
Precon grad coeff: 0.017478, velocity coeff: 1.0273
norm(ch) = 0.21811
rho = 0.44134
New lambda: 9.7192e-122
iter: 5685, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073481
iter: 5685, Minibatch log likelihood (post-update): -54.2789, error rate (post-update): 0.073482

size_minibatch = 20000
Precon grad coeff: 0.013933, velocity coeff: 0.89009
norm(ch) = 0.19444
iter: 5686, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073482

size_minibatch = 20000
Precon grad coeff: 0.018437, velocity coeff: 1.1918
norm(ch) = 0.232
iter: 5687, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.07348

size_minibatch = 20000
Precon grad coeff: 0.015204, velocity coeff: 0.86822
norm(ch) = 0.20176
iter: 5688, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073478

size_minibatch = 20000
Precon grad coeff: 0.015913, velocity coeff: 1.078
norm(ch) = 0.21776
iter: 5689, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073477

size_minibatch = 20000
Precon grad coeff: 0.017595, velocity coeff: 1.0022
norm(ch) = 0.21853
rho = 1.6271
New lambda: 7.5205e-122
iter: 5690, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073476
iter: 5690, Minibatch log likelihood (post-update): -54.2789, error rate (post-update): 0.073475

size_minibatch = 20000
Precon grad coeff: 0.014824, velocity coeff: 0.97551
norm(ch) = 0.21343
iter: 5691, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073475

size_minibatch = 20000
Precon grad coeff: 0.017229, velocity coeff: 1.0151
norm(ch) = 0.21693
iter: 5692, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073473

size_minibatch = 20000
Precon grad coeff: 0.015053, velocity coeff: 0.96877
norm(ch) = 0.21036
iter: 5693, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073473

size_minibatch = 20000
Precon grad coeff: 0.017434, velocity coeff: 1.0643
norm(ch) = 0.22417
iter: 5694, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073474

size_minibatch = 20000
Precon grad coeff: 0.016053, velocity coeff: 0.9276
norm(ch) = 0.20823
rho = 1.0441
New lambda: 5.8192e-122
iter: 5695, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073469
iter: 5695, Minibatch log likelihood (post-update): -54.2789, error rate (post-update): 0.073468

size_minibatch = 20000
Precon grad coeff: 0.015037, velocity coeff: 0.98561
norm(ch) = 0.20553
iter: 5696, Minibatch log likelihood (pre-update): -54.2789, error rate (pre-update): 0.073468

size_minibatch = 20000
Precon grad coeff: 0.017873, velocity coeff: 1.0906
norm(ch) = 0.22445
iter: 5697, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073471

size_minibatch = 20000
Precon grad coeff: 0.015013, velocity coeff: 0.88358
norm(ch) = 0.19857
iter: 5698, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073469

size_minibatch = 20000
Precon grad coeff: 0.016598, velocity coeff: 1.1172
norm(ch) = 0.22215
iter: 5699, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073465

size_minibatch = 20000
Precon grad coeff: 0.016431, velocity coeff: 0.95377
New gamma: 0.0031623
norm(ch) = 0.21216
rho = 1.0473
New lambda: 4.5028e-122
iter: 5700, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073465
iter: 5700, Minibatch log likelihood (post-update): -54.2788, error rate (post-update): 0.073464
---
Full log-likelihood: -54.2788, error rate: 0.073464
TEST log-likelihood: -55.7265, error rate: 0.50072
Error difference (test - train): 0.42726
---
Full log-likelihood (averaged params): -54.2802, error rate (averaged params): 0.074026
TEST log-likelihood (averaged params): -55.6897, error rate (averaged params): 0.4923
Error difference (test - train) (averaged params): 0.41827

size_minibatch = 20000
Precon grad coeff: 0.015302, velocity coeff: 1.0208
norm(ch) = 0.21686
iter: 5701, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073464

size_minibatch = 20000
Precon grad coeff: 0.016058, velocity coeff: 0.95937
norm(ch) = 0.20835
iter: 5702, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073462

size_minibatch = 20000
Precon grad coeff: 0.013754, velocity coeff: 0.99915
norm(ch) = 0.20844
iter: 5703, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073463

size_minibatch = 20000
Precon grad coeff: 0.01631, velocity coeff: 1.0534
norm(ch) = 0.21984
iter: 5704, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073463

size_minibatch = 20000
Precon grad coeff: 0.016147, velocity coeff: 0.94364
norm(ch) = 0.20775
rho = 1.0378
New lambda: 3.4842e-122
iter: 5705, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073461
iter: 5705, Minibatch log likelihood (post-update): -54.2788, error rate (post-update): 0.073459

size_minibatch = 20000
Precon grad coeff: 0.015031, velocity coeff: 1.0543
norm(ch) = 0.21932
iter: 5706, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073459

size_minibatch = 20000
Precon grad coeff: 0.014829, velocity coeff: 0.87112
norm(ch) = 0.19129
iter: 5707, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073457

size_minibatch = 20000
Precon grad coeff: 0.015174, velocity coeff: 1.1045
norm(ch) = 0.21161
iter: 5708, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073458

size_minibatch = 20000
Precon grad coeff: 0.015743, velocity coeff: 0.97853
norm(ch) = 0.20739
iter: 5709, Minibatch log likelihood (pre-update): -54.2788, error rate (pre-update): 0.073455

size_minibatch = 20000
Precon grad coeff: 0.016315, velocity coeff: 1.0365
norm(ch) = 0.21521
rho = 1.2093
New lambda: 2.696e-122
iter: 5710, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073453
iter: 5710, Minibatch log likelihood (post-update): -54.2787, error rate (post-update): 0.073455

size_minibatch = 20000
Precon grad coeff: 0.01433, velocity coeff: 0.92986
norm(ch) = 0.20038
iter: 5711, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073455

size_minibatch = 20000
Precon grad coeff: 0.016068, velocity coeff: 1.0418
norm(ch) = 0.20903
iter: 5712, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073453

size_minibatch = 20000
Precon grad coeff: 0.014932, velocity coeff: 0.99475
norm(ch) = 0.2082
iter: 5713, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073451

size_minibatch = 20000
Precon grad coeff: 0.015823, velocity coeff: 1.0264
norm(ch) = 0.21395
iter: 5714, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073451

size_minibatch = 20000
Precon grad coeff: 0.015253, velocity coeff: 0.93728
norm(ch) = 0.20079
rho = 1.2522
New lambda: 2.0861e-122
iter: 5715, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073449
iter: 5715, Minibatch log likelihood (post-update): -54.2787, error rate (post-update): 0.073446

size_minibatch = 20000
Precon grad coeff: 0.014889, velocity coeff: 1.0078
norm(ch) = 0.20261
iter: 5716, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073446

size_minibatch = 20000
Precon grad coeff: 0.015695, velocity coeff: 1.0419
norm(ch) = 0.21136
iter: 5717, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073447

size_minibatch = 20000
Precon grad coeff: 0.015504, velocity coeff: 0.93806
norm(ch) = 0.19852
iter: 5718, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073449

size_minibatch = 20000
Precon grad coeff: 0.014991, velocity coeff: 1.0802
norm(ch) = 0.2147
iter: 5719, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073444

size_minibatch = 20000
Precon grad coeff: 0.017229, velocity coeff: 0.912
New gamma: 0.0052816
norm(ch) = 0.196
rho = 0.82337
New lambda: 1.6142e-122
iter: 5720, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073441
iter: 5720, Minibatch log likelihood (post-update): -54.2787, error rate (post-update): 0.073443

size_minibatch = 20000
Precon grad coeff: 0.018429, velocity coeff: 1.1061
norm(ch) = 0.21692
iter: 5721, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073443

size_minibatch = 20000
Precon grad coeff: 0.017509, velocity coeff: 0.88755
norm(ch) = 0.1927
iter: 5722, Minibatch log likelihood (pre-update): -54.2787, error rate (pre-update): 0.073441

size_minibatch = 20000
Precon grad coeff: 0.017508, velocity coeff: 0.9995
norm(ch) = 0.19275
iter: 5723, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.07344

size_minibatch = 20000
Precon grad coeff: 0.015678, velocity coeff: 0.9319
norm(ch) = 0.17973
iter: 5724, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.07344

size_minibatch = 20000
Precon grad coeff: 0.016232, velocity coeff: 1.0522
norm(ch) = 0.18921
rho = 1.029
New lambda: 1.249e-122
iter: 5725, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073438
iter: 5725, Minibatch log likelihood (post-update): -54.2786, error rate (post-update): 0.073435

size_minibatch = 20000
Precon grad coeff: 0.019095, velocity coeff: 1.0094
norm(ch) = 0.19112
iter: 5726, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073435

size_minibatch = 20000
Precon grad coeff: 0.017405, velocity coeff: 0.97719
norm(ch) = 0.18687
iter: 5727, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073435

size_minibatch = 20000
Precon grad coeff: 0.018639, velocity coeff: 1.0065
norm(ch) = 0.1882
iter: 5728, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073433

size_minibatch = 20000
Precon grad coeff: 0.016782, velocity coeff: 0.99455
norm(ch) = 0.18731
iter: 5729, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073431

size_minibatch = 20000
Precon grad coeff: 0.016634, velocity coeff: 0.95272
norm(ch) = 0.17854
rho = 1.0853
New lambda: 9.6648e-123
iter: 5730, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073431
iter: 5730, Minibatch log likelihood (post-update): -54.2786, error rate (post-update): 0.07343

size_minibatch = 20000
Precon grad coeff: 0.017484, velocity coeff: 1.0597
norm(ch) = 0.18933
iter: 5731, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.07343

size_minibatch = 20000
Precon grad coeff: 0.01556, velocity coeff: 0.93811
norm(ch) = 0.17772
iter: 5732, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073431

size_minibatch = 20000
Precon grad coeff: 0.019908, velocity coeff: 1.1794
norm(ch) = 0.20972
iter: 5733, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073429

size_minibatch = 20000
Precon grad coeff: 0.018305, velocity coeff: 0.90738
norm(ch) = 0.19044
iter: 5734, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073427

size_minibatch = 20000
Precon grad coeff: 0.017742, velocity coeff: 1.0296
norm(ch) = 0.1962
rho = 1.2291
New lambda: 7.4784e-123
iter: 5735, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073426
iter: 5735, Minibatch log likelihood (post-update): -54.2786, error rate (post-update): 0.073425

size_minibatch = 20000
Precon grad coeff: 0.016726, velocity coeff: 0.93794
norm(ch) = 0.18415
iter: 5736, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073425

size_minibatch = 20000
Precon grad coeff: 0.016222, velocity coeff: 1.0162
norm(ch) = 0.18725
iter: 5737, Minibatch log likelihood (pre-update): -54.2786, error rate (pre-update): 0.073425

size_minibatch = 20000
Precon grad coeff: 0.017098, velocity coeff: 1.0453
norm(ch) = 0.19588
iter: 5738, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073423

size_minibatch = 20000
Precon grad coeff: 0.018247, velocity coeff: 0.99891
norm(ch) = 0.19579
iter: 5739, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073423

size_minibatch = 20000
Precon grad coeff: 0.014284, velocity coeff: 0.95201
New gamma: 0.0031623
norm(ch) = 0.18661
rho = 0.78595
New lambda: 5.7866e-123
iter: 5740, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073421
iter: 5740, Minibatch log likelihood (post-update): -54.2785, error rate (post-update): 0.073419

size_minibatch = 20000
Precon grad coeff: 0.01716, velocity coeff: 1.1485
norm(ch) = 0.21469
iter: 5741, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073419

size_minibatch = 20000
Precon grad coeff: 0.015418, velocity coeff: 0.93292
norm(ch) = 0.20061
iter: 5742, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073419

size_minibatch = 20000
Precon grad coeff: 0.014021, velocity coeff: 1.034
norm(ch) = 0.20783
iter: 5743, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073416

size_minibatch = 20000
Precon grad coeff: 0.013816, velocity coeff: 0.98415
norm(ch) = 0.20489
iter: 5744, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073416

size_minibatch = 20000
Precon grad coeff: 0.014042, velocity coeff: 1.0844
norm(ch) = 0.22259
rho = 1.3269
New lambda: 4.4776e-123
iter: 5745, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073416
iter: 5745, Minibatch log likelihood (post-update): -54.2785, error rate (post-update): 0.073414

size_minibatch = 20000
Precon grad coeff: 0.017011, velocity coeff: 1.0138
norm(ch) = 0.22606
iter: 5746, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073414

size_minibatch = 20000
Precon grad coeff: 0.015618, velocity coeff: 1.0158
norm(ch) = 0.2301
iter: 5747, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073412

size_minibatch = 20000
Precon grad coeff: 0.016316, velocity coeff: 0.97497
norm(ch) = 0.22483
iter: 5748, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073412

size_minibatch = 20000
Precon grad coeff: 0.012889, velocity coeff: 0.87422
norm(ch) = 0.19695
iter: 5749, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073412

size_minibatch = 20000
Precon grad coeff: 0.013488, velocity coeff: 1.0086
norm(ch) = 0.19895
rho = 1.2062
New lambda: 3.4647e-123
iter: 5750, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.07341
iter: 5750, Minibatch log likelihood (post-update): -54.2785, error rate (post-update): 0.073407
---
Full log-likelihood: -54.2785, error rate: 0.073407
TEST log-likelihood: -55.7439, error rate: 0.50459
Error difference (test - train): 0.43118
---
Full log-likelihood (averaged params): -54.2798, error rate (averaged params): 0.073991
TEST log-likelihood (averaged params): -55.705, error rate (averaged params): 0.49561
Error difference (test - train) (averaged params): 0.42162

size_minibatch = 20000
Precon grad coeff: 0.014943, velocity coeff: 1.116
norm(ch) = 0.22237
iter: 5751, Minibatch log likelihood (pre-update): -54.2785, error rate (pre-update): 0.073407

size_minibatch = 20000
Precon grad coeff: 0.016437, velocity coeff: 0.93545
norm(ch) = 0.20843
iter: 5752, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073404

size_minibatch = 20000
Precon grad coeff: 0.015675, velocity coeff: 1.0465
norm(ch) = 0.21852
iter: 5753, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073405

size_minibatch = 20000
Precon grad coeff: 0.015274, velocity coeff: 0.94616
norm(ch) = 0.20714
iter: 5754, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073404

size_minibatch = 20000
Precon grad coeff: 0.013109, velocity coeff: 0.9401
norm(ch) = 0.19509
rho = 1.0143
New lambda: 2.6809e-123
iter: 5755, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073399
iter: 5755, Minibatch log likelihood (post-update): -54.2784, error rate (post-update): 0.073399

size_minibatch = 20000
Precon grad coeff: 0.013901, velocity coeff: 1.091
norm(ch) = 0.21307
iter: 5756, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073399

size_minibatch = 20000
Precon grad coeff: 0.016312, velocity coeff: 1.0647
norm(ch) = 0.22708
iter: 5757, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073402

size_minibatch = 20000
Precon grad coeff: 0.01507, velocity coeff: 0.95381
norm(ch) = 0.21684
iter: 5758, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073401

size_minibatch = 20000
Precon grad coeff: 0.017005, velocity coeff: 1.052
norm(ch) = 0.22836
iter: 5759, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073398

size_minibatch = 20000
Precon grad coeff: 0.015079, velocity coeff: 0.8993
New gamma: 0.0031623
norm(ch) = 0.20561
rho = 0.48038
New lambda: 2.6809e-123
iter: 5760, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073396
iter: 5760, Minibatch log likelihood (post-update): -54.2784, error rate (post-update): 0.073393

size_minibatch = 20000
Precon grad coeff: 0.01441, velocity coeff: 0.98107
norm(ch) = 0.20193
iter: 5761, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073393

size_minibatch = 20000
Precon grad coeff: 0.012792, velocity coeff: 0.93133
norm(ch) = 0.18822
iter: 5762, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.07339

size_minibatch = 20000
Precon grad coeff: 0.015971, velocity coeff: 1.1984
norm(ch) = 0.22575
iter: 5763, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073392

size_minibatch = 20000
Precon grad coeff: 0.015213, velocity coeff: 0.89027
norm(ch) = 0.20116
iter: 5764, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.073393

size_minibatch = 20000
Precon grad coeff: 0.016365, velocity coeff: 1.1392
norm(ch) = 0.22936
rho = 1.256
New lambda: 2.0744e-123
iter: 5765, Minibatch log likelihood (pre-update): -54.2784, error rate (pre-update): 0.07339
iter: 5765, Minibatch log likelihood (post-update): -54.2783, error rate (post-update): 0.073386

size_minibatch = 20000
Precon grad coeff: 0.018344, velocity coeff: 1.0216
norm(ch) = 0.23457
iter: 5766, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073386

size_minibatch = 20000
Precon grad coeff: 0.015215, velocity coeff: 0.87781
norm(ch) = 0.20615
iter: 5767, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073386

size_minibatch = 20000
Precon grad coeff: 0.012114, velocity coeff: 0.9253
norm(ch) = 0.191
iter: 5768, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073388

size_minibatch = 20000
Precon grad coeff: 0.016272, velocity coeff: 1.1912
norm(ch) = 0.22774
iter: 5769, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073386

size_minibatch = 20000
Precon grad coeff: 0.013937, velocity coeff: 0.89237
norm(ch) = 0.20344
rho = 1.4092
New lambda: 1.6052e-123
iter: 5770, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073383
iter: 5770, Minibatch log likelihood (post-update): -54.2783, error rate (post-update): 0.073383

size_minibatch = 20000
Precon grad coeff: 0.015852, velocity coeff: 1.0933
norm(ch) = 0.22268
iter: 5771, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073383

size_minibatch = 20000
Precon grad coeff: 0.017853, velocity coeff: 1.0041
norm(ch) = 0.22393
iter: 5772, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073383

size_minibatch = 20000
Precon grad coeff: 0.015042, velocity coeff: 0.92967
norm(ch) = 0.20848
iter: 5773, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073381

size_minibatch = 20000
Precon grad coeff: 0.013191, velocity coeff: 0.97492
norm(ch) = 0.20352
iter: 5774, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073378

size_minibatch = 20000
Precon grad coeff: 0.014489, velocity coeff: 0.98001
norm(ch) = 0.19976
rho = 1.6751
New lambda: 1.242e-123
iter: 5775, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073378
iter: 5775, Minibatch log likelihood (post-update): -54.2783, error rate (post-update): 0.073376

size_minibatch = 20000
Precon grad coeff: 0.013868, velocity coeff: 1.0526
norm(ch) = 0.21055
iter: 5776, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073376

size_minibatch = 20000
Precon grad coeff: 0.016324, velocity coeff: 1.0511
norm(ch) = 0.22165
iter: 5777, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073375

size_minibatch = 20000
Precon grad coeff: 0.016648, velocity coeff: 1.0311
norm(ch) = 0.22892
iter: 5778, Minibatch log likelihood (pre-update): -54.2783, error rate (pre-update): 0.073373

size_minibatch = 20000
Precon grad coeff: 0.01617, velocity coeff: 0.89373
norm(ch) = 0.20496
iter: 5779, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073372

size_minibatch = 20000
Precon grad coeff: 0.01309, velocity coeff: 0.93485
New gamma: 0.0031623
norm(ch) = 0.1919
rho = 1.2013
New lambda: 9.6107e-124
iter: 5780, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073372
iter: 5780, Minibatch log likelihood (post-update): -54.2782, error rate (post-update): 0.073371

size_minibatch = 20000
Precon grad coeff: 0.015945, velocity coeff: 1.1807
norm(ch) = 0.22692
iter: 5781, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073371

size_minibatch = 20000
Precon grad coeff: 0.018776, velocity coeff: 0.99328
norm(ch) = 0.22576
iter: 5782, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.07337

size_minibatch = 20000
Precon grad coeff: 0.014906, velocity coeff: 0.90022
norm(ch) = 0.20356
iter: 5783, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073365

size_minibatch = 20000
Precon grad coeff: 0.014756, velocity coeff: 1.0172
norm(ch) = 0.20736
iter: 5784, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073364

size_minibatch = 20000
Precon grad coeff: 0.015538, velocity coeff: 1.0423
norm(ch) = 0.21644
rho = 1.5584
New lambda: 7.4365e-124
iter: 5785, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073366
iter: 5785, Minibatch log likelihood (post-update): -54.2782, error rate (post-update): 0.073365

size_minibatch = 20000
Precon grad coeff: 0.015948, velocity coeff: 1.0077
norm(ch) = 0.21841
iter: 5786, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073365

size_minibatch = 20000
Precon grad coeff: 0.015981, velocity coeff: 0.99976
norm(ch) = 0.21864
iter: 5787, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073363

size_minibatch = 20000
Precon grad coeff: 0.015507, velocity coeff: 0.98715
norm(ch) = 0.21614
iter: 5788, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073362

size_minibatch = 20000
Precon grad coeff: 0.015401, velocity coeff: 0.98422
norm(ch) = 0.21297
iter: 5789, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073359

size_minibatch = 20000
Precon grad coeff: 0.014759, velocity coeff: 0.97749
norm(ch) = 0.20847
rho = 1.3812
New lambda: 5.7543e-124
iter: 5790, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073358
iter: 5790, Minibatch log likelihood (post-update): -54.2782, error rate (post-update): 0.073358

size_minibatch = 20000
Precon grad coeff: 0.015691, velocity coeff: 1.0792
norm(ch) = 0.22522
iter: 5791, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073358

size_minibatch = 20000
Precon grad coeff: 0.017434, velocity coeff: 0.97604
norm(ch) = 0.22008
iter: 5792, Minibatch log likelihood (pre-update): -54.2782, error rate (pre-update): 0.073357

size_minibatch = 20000
Precon grad coeff: 0.015986, velocity coeff: 0.97826
norm(ch) = 0.21557
iter: 5793, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073356

size_minibatch = 20000
Precon grad coeff: 0.012599, velocity coeff: 0.89138
norm(ch) = 0.19233
iter: 5794, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073354

size_minibatch = 20000
Precon grad coeff: 0.018635, velocity coeff: 1.2453
norm(ch) = 0.23982
rho = 1.2502
New lambda: 4.4525e-124
iter: 5795, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.07335
iter: 5795, Minibatch log likelihood (post-update): -54.2781, error rate (post-update): 0.073351

size_minibatch = 20000
Precon grad coeff: 0.018408, velocity coeff: 0.95135
norm(ch) = 0.22847
iter: 5796, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073351

size_minibatch = 20000
Precon grad coeff: 0.014205, velocity coeff: 0.86385
norm(ch) = 0.19761
iter: 5797, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.07335

size_minibatch = 20000
Precon grad coeff: 0.013819, velocity coeff: 1.0739
norm(ch) = 0.21244
iter: 5798, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073346

size_minibatch = 20000
Precon grad coeff: 0.018579, velocity coeff: 1.1135
norm(ch) = 0.23685
iter: 5799, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073347

size_minibatch = 20000
Precon grad coeff: 0.017748, velocity coeff: 0.9162
New gamma: 0.0031623
norm(ch) = 0.21731
rho = 1.1125
New lambda: 3.4453e-124
iter: 5800, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073349
iter: 5800, Minibatch log likelihood (post-update): -54.2781, error rate (post-update): 0.073344
---
Full log-likelihood: -54.2781, error rate: 0.073344
TEST log-likelihood: -55.7619, error rate: 0.50864
Error difference (test - train): 0.4353
---
Full log-likelihood (averaged params): -54.2795, error rate (averaged params): 0.073965
TEST log-likelihood (averaged params): -55.7213, error rate (averaged params): 0.49916
Error difference (test - train) (averaged params): 0.4252

size_minibatch = 20000
Precon grad coeff: 0.014833, velocity coeff: 0.92209
norm(ch) = 0.20065
iter: 5801, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073344

size_minibatch = 20000
Precon grad coeff: 0.016297, velocity coeff: 1.0715
norm(ch) = 0.21535
iter: 5802, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073343

size_minibatch = 20000
Precon grad coeff: 0.016606, velocity coeff: 1.0004
norm(ch) = 0.21575
iter: 5803, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073342

size_minibatch = 20000
Precon grad coeff: 0.016206, velocity coeff: 0.95644
norm(ch) = 0.20661
iter: 5804, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073339

size_minibatch = 20000
Precon grad coeff: 0.016103, velocity coeff: 1.0437
norm(ch) = 0.21595
rho = 0.93773
New lambda: 2.6659e-124
iter: 5805, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073338
iter: 5805, Minibatch log likelihood (post-update): -54.278, error rate (post-update): 0.073338

size_minibatch = 20000
Precon grad coeff: 0.017786, velocity coeff: 1.0705
norm(ch) = 0.23154
iter: 5806, Minibatch log likelihood (pre-update): -54.2781, error rate (pre-update): 0.073338

size_minibatch = 20000
Precon grad coeff: 0.016726, velocity coeff: 0.90209
norm(ch) = 0.20921
iter: 5807, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073337

size_minibatch = 20000
Precon grad coeff: 0.014506, velocity coeff: 1.0112
norm(ch) = 0.21185
iter: 5808, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073335

size_minibatch = 20000
Precon grad coeff: 0.017676, velocity coeff: 1.0961
norm(ch) = 0.23256
iter: 5809, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073335

size_minibatch = 20000
Precon grad coeff: 0.015341, velocity coeff: 0.91366
norm(ch) = 0.21277
rho = 0.73037
New lambda: 2.6659e-124
iter: 5810, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073333
iter: 5810, Minibatch log likelihood (post-update): -54.278, error rate (post-update): 0.073329

size_minibatch = 20000
Precon grad coeff: 0.018819, velocity coeff: 1.1306
norm(ch) = 0.24092
iter: 5811, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073329

size_minibatch = 20000
Precon grad coeff: 0.016066, velocity coeff: 0.85985
norm(ch) = 0.20746
iter: 5812, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073328

size_minibatch = 20000
Precon grad coeff: 0.014342, velocity coeff: 1.023
norm(ch) = 0.21246
iter: 5813, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073328

size_minibatch = 20000
Precon grad coeff: 0.019144, velocity coeff: 1.1299
norm(ch) = 0.24039
iter: 5814, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073328

size_minibatch = 20000
Precon grad coeff: 0.014763, velocity coeff: 0.80529
norm(ch) = 0.19381
rho = 1.0422
New lambda: 2.0628e-124
iter: 5815, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073325
iter: 5815, Minibatch log likelihood (post-update): -54.278, error rate (post-update): 0.073326

size_minibatch = 20000
Precon grad coeff: 0.017313, velocity coeff: 1.2293
norm(ch) = 0.23854
iter: 5816, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073326

size_minibatch = 20000
Precon grad coeff: 0.017421, velocity coeff: 0.90332
norm(ch) = 0.21576
iter: 5817, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073323

size_minibatch = 20000
Precon grad coeff: 0.01533, velocity coeff: 1.0039
norm(ch) = 0.21686
iter: 5818, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.07332

size_minibatch = 20000
Precon grad coeff: 0.016875, velocity coeff: 1.0115
norm(ch) = 0.21967
iter: 5819, Minibatch log likelihood (pre-update): -54.278, error rate (pre-update): 0.073321

size_minibatch = 20000
Precon grad coeff: 0.014354, velocity coeff: 0.93631
New gamma: 0.0031623
norm(ch) = 0.20591
rho = 1.2349
New lambda: 1.5962e-124
iter: 5820, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.07332
iter: 5820, Minibatch log likelihood (post-update): -54.2779, error rate (post-update): 0.073319

size_minibatch = 20000
Precon grad coeff: 0.01728, velocity coeff: 1.1596
norm(ch) = 0.23906
iter: 5821, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073319

size_minibatch = 20000
Precon grad coeff: 0.020151, velocity coeff: 0.99048
norm(ch) = 0.2371
iter: 5822, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073316

size_minibatch = 20000
Precon grad coeff: 0.016639, velocity coeff: 0.92417
norm(ch) = 0.2194
iter: 5823, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073314

size_minibatch = 20000
Precon grad coeff: 0.013873, velocity coeff: 0.95888
norm(ch) = 0.2106
iter: 5824, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073315

size_minibatch = 20000
Precon grad coeff: 0.020511, velocity coeff: 1.2273
norm(ch) = 0.2588
rho = 1.2215
New lambda: 1.2351e-124
iter: 5825, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073313
iter: 5825, Minibatch log likelihood (post-update): -54.2779, error rate (post-update): 0.073311

size_minibatch = 20000
Precon grad coeff: 0.020099, velocity coeff: 0.91133
norm(ch) = 0.23617
iter: 5826, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073311

size_minibatch = 20000
Precon grad coeff: 0.01465, velocity coeff: 0.83674
norm(ch) = 0.19786
iter: 5827, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.07331

size_minibatch = 20000
Precon grad coeff: 0.015449, velocity coeff: 1.1505
norm(ch) = 0.22791
iter: 5828, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073309

size_minibatch = 20000
Precon grad coeff: 0.017696, velocity coeff: 0.9598
norm(ch) = 0.21909
iter: 5829, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073307

size_minibatch = 20000
Precon grad coeff: 0.015599, velocity coeff: 1.0073
norm(ch) = 0.22097
rho = 1.1868
New lambda: 9.5569e-125
iter: 5830, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073305
iter: 5830, Minibatch log likelihood (post-update): -54.2779, error rate (post-update): 0.073305

size_minibatch = 20000
Precon grad coeff: 0.016183, velocity coeff: 0.95856
norm(ch) = 0.21202
iter: 5831, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073305

size_minibatch = 20000
Precon grad coeff: 0.014894, velocity coeff: 1.0177
norm(ch) = 0.21603
iter: 5832, Minibatch log likelihood (pre-update): -54.2779, error rate (pre-update): 0.073306

size_minibatch = 20000
Precon grad coeff: 0.018459, velocity coeff: 1.0695
norm(ch) = 0.23135
iter: 5833, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073302

size_minibatch = 20000
Precon grad coeff: 0.01707, velocity coeff: 0.96785
norm(ch) = 0.22423
iter: 5834, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.0733

size_minibatch = 20000
Precon grad coeff: 0.016823, velocity coeff: 0.98105
norm(ch) = 0.22025
rho = 1.413
New lambda: 7.3949e-125
iter: 5835, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073299
iter: 5835, Minibatch log likelihood (post-update): -54.2778, error rate (post-update): 0.073298

size_minibatch = 20000
Precon grad coeff: 0.017359, velocity coeff: 1.0478
norm(ch) = 0.23103
iter: 5836, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073298

size_minibatch = 20000
Precon grad coeff: 0.014699, velocity coeff: 0.88179
norm(ch) = 0.20394
iter: 5837, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073297

size_minibatch = 20000
Precon grad coeff: 0.017605, velocity coeff: 1.1474
norm(ch) = 0.23428
iter: 5838, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073294

size_minibatch = 20000
Precon grad coeff: 0.017606, velocity coeff: 0.95246
norm(ch) = 0.22347
iter: 5839, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073294

size_minibatch = 20000
Precon grad coeff: 0.015461, velocity coeff: 0.92586
New gamma: 0.0031623
norm(ch) = 0.20716
rho = 1.6864
New lambda: 5.722e-125
iter: 5840, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073294
iter: 5840, Minibatch log likelihood (post-update): -54.2778, error rate (post-update): 0.073292

size_minibatch = 20000
Precon grad coeff: 0.015306, velocity coeff: 0.98726
norm(ch) = 0.20479
iter: 5841, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073292

size_minibatch = 20000
Precon grad coeff: 0.014959, velocity coeff: 1.0169
norm(ch) = 0.20848
iter: 5842, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073289

size_minibatch = 20000
Precon grad coeff: 0.017358, velocity coeff: 1.0936
norm(ch) = 0.22832
iter: 5843, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.07329

size_minibatch = 20000
Precon grad coeff: 0.01587, velocity coeff: 0.90163
norm(ch) = 0.20611
iter: 5844, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.07329

size_minibatch = 20000
Precon grad coeff: 0.016511, velocity coeff: 1.1084
norm(ch) = 0.22875
rho = 0.9349
New lambda: 4.4276e-125
iter: 5845, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073289
iter: 5845, Minibatch log likelihood (post-update): -54.2778, error rate (post-update): 0.073286

size_minibatch = 20000
Precon grad coeff: 0.017441, velocity coeff: 0.986
norm(ch) = 0.22581
iter: 5846, Minibatch log likelihood (pre-update): -54.2778, error rate (pre-update): 0.073286

size_minibatch = 20000
Precon grad coeff: 0.018303, velocity coeff: 1.0421
norm(ch) = 0.23564
iter: 5847, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073286

size_minibatch = 20000
Precon grad coeff: 0.014728, velocity coeff: 0.84349
norm(ch) = 0.19903
iter: 5848, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073284

size_minibatch = 20000
Precon grad coeff: 0.015749, velocity coeff: 1.1495
norm(ch) = 0.22908
iter: 5849, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073283

size_minibatch = 20000
Precon grad coeff: 0.01477, velocity coeff: 0.89075
norm(ch) = 0.20425
rho = 1.0318
New lambda: 3.426e-125
iter: 5850, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073283
iter: 5850, Minibatch log likelihood (post-update): -54.2777, error rate (post-update): 0.073281
---
Full log-likelihood: -54.2777, error rate: 0.073281
TEST log-likelihood: -55.7803, error rate: 0.51276
Error difference (test - train): 0.43948
---
Full log-likelihood (averaged params): -54.2792, error rate (averaged params): 0.073951
TEST log-likelihood (averaged params): -55.7383, error rate (averaged params): 0.50288
Error difference (test - train) (averaged params): 0.42893

size_minibatch = 20000
Precon grad coeff: 0.017458, velocity coeff: 1.1578
norm(ch) = 0.23671
iter: 5851, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073281

size_minibatch = 20000
Precon grad coeff: 0.016469, velocity coeff: 0.90687
norm(ch) = 0.21493
iter: 5852, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073278

size_minibatch = 20000
Precon grad coeff: 0.016455, velocity coeff: 1.032
norm(ch) = 0.22209
iter: 5853, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073279

size_minibatch = 20000
Precon grad coeff: 0.017693, velocity coeff: 1.0523
norm(ch) = 0.23398
iter: 5854, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073277

size_minibatch = 20000
Precon grad coeff: 0.017978, velocity coeff: 0.97807
norm(ch) = 0.22918
rho = 0.75066
New lambda: 2.651e-125
iter: 5855, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073274
iter: 5855, Minibatch log likelihood (post-update): -54.2777, error rate (post-update): 0.073274

size_minibatch = 20000
Precon grad coeff: 0.017469, velocity coeff: 0.96927
norm(ch) = 0.22244
iter: 5856, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073274

size_minibatch = 20000
Precon grad coeff: 0.015275, velocity coeff: 0.94074
norm(ch) = 0.20945
iter: 5857, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073272

size_minibatch = 20000
Precon grad coeff: 0.014291, velocity coeff: 1.0268
norm(ch) = 0.21525
iter: 5858, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073271

size_minibatch = 20000
Precon grad coeff: 0.018457, velocity coeff: 1.0731
norm(ch) = 0.23127
iter: 5859, Minibatch log likelihood (pre-update): -54.2777, error rate (pre-update): 0.073272

size_minibatch = 20000
Precon grad coeff: 0.012804, velocity coeff: 0.83218
New gamma: 0.0031623
norm(ch) = 0.19266
rho = 0.82643
New lambda: 2.0513e-125
iter: 5860, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073269
iter: 5860, Minibatch log likelihood (post-update): -54.2776, error rate (post-update): 0.073268

size_minibatch = 20000
Precon grad coeff: 0.019129, velocity coeff: 1.2965
norm(ch) = 0.25008
iter: 5861, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073268

size_minibatch = 20000
Precon grad coeff: 0.015541, velocity coeff: 0.85536
norm(ch) = 0.21415
iter: 5862, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073266

size_minibatch = 20000
Precon grad coeff: 0.015151, velocity coeff: 1.0309
norm(ch) = 0.22102
iter: 5863, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073266

size_minibatch = 20000
Precon grad coeff: 0.015942, velocity coeff: 0.97624
norm(ch) = 0.21604
iter: 5864, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073264

size_minibatch = 20000
Precon grad coeff: 0.014404, velocity coeff: 0.99503
norm(ch) = 0.21512
rho = 1.6903
New lambda: 1.5872e-125
iter: 5865, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073262
iter: 5865, Minibatch log likelihood (post-update): -54.2776, error rate (post-update): 0.073262

size_minibatch = 20000
Precon grad coeff: 0.01626, velocity coeff: 1.0618
norm(ch) = 0.22864
iter: 5866, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073262

size_minibatch = 20000
Precon grad coeff: 0.017406, velocity coeff: 0.99865
norm(ch) = 0.22863
iter: 5867, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.07326

size_minibatch = 20000
Precon grad coeff: 0.015555, velocity coeff: 0.92926
norm(ch) = 0.21269
iter: 5868, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073261

size_minibatch = 20000
Precon grad coeff: 0.013614, velocity coeff: 0.93702
norm(ch) = 0.1995
iter: 5869, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.07326

size_minibatch = 20000
Precon grad coeff: 0.016787, velocity coeff: 1.1862
norm(ch) = 0.23687
rho = 0.94786
New lambda: 1.2282e-125
iter: 5870, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073256
iter: 5870, Minibatch log likelihood (post-update): -54.2776, error rate (post-update): 0.073256

size_minibatch = 20000
Precon grad coeff: 0.016205, velocity coeff: 0.86745
norm(ch) = 0.20573
iter: 5871, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073256

size_minibatch = 20000
Precon grad coeff: 0.015341, velocity coeff: 1.1294
norm(ch) = 0.23261
iter: 5872, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073255

size_minibatch = 20000
Precon grad coeff: 0.01768, velocity coeff: 0.94723
norm(ch) = 0.22064
iter: 5873, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073253

size_minibatch = 20000
Precon grad coeff: 0.012628, velocity coeff: 0.91995
norm(ch) = 0.20324
iter: 5874, Minibatch log likelihood (pre-update): -54.2776, error rate (pre-update): 0.073252

size_minibatch = 20000
Precon grad coeff: 0.01778, velocity coeff: 1.1464
norm(ch) = 0.23321
rho = 1.3538
New lambda: 9.5034e-126
iter: 5875, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073252
iter: 5875, Minibatch log likelihood (post-update): -54.2775, error rate (post-update): 0.073252

size_minibatch = 20000
Precon grad coeff: 0.015284, velocity coeff: 0.8751
norm(ch) = 0.20431
iter: 5876, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073252

size_minibatch = 20000
Precon grad coeff: 0.01431, velocity coeff: 1.0627
norm(ch) = 0.21736
iter: 5877, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073248

size_minibatch = 20000
Precon grad coeff: 0.019149, velocity coeff: 1.085
norm(ch) = 0.23616
iter: 5878, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073246

size_minibatch = 20000
Precon grad coeff: 0.012932, velocity coeff: 0.82609
norm(ch) = 0.19535
iter: 5879, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073246

size_minibatch = 20000
Precon grad coeff: 0.017724, velocity coeff: 1.1705
New gamma: 0.0052816
norm(ch) = 0.22872
rho = 1.1865
New lambda: 7.3535e-126
iter: 5880, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073245
iter: 5880, Minibatch log likelihood (post-update): -54.2775, error rate (post-update): 0.073245

size_minibatch = 20000
Precon grad coeff: 0.015655, velocity coeff: 0.90387
norm(ch) = 0.20685
iter: 5881, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073245

size_minibatch = 20000
Precon grad coeff: 0.017183, velocity coeff: 1.0781
norm(ch) = 0.22311
iter: 5882, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073242

size_minibatch = 20000
Precon grad coeff: 0.01857, velocity coeff: 0.98876
norm(ch) = 0.22073
iter: 5883, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.07324

size_minibatch = 20000
Precon grad coeff: 0.019081, velocity coeff: 0.96265
norm(ch) = 0.21256
iter: 5884, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.07324

size_minibatch = 20000
Precon grad coeff: 0.017276, velocity coeff: 0.94548
norm(ch) = 0.20107
rho = 1.5317
New lambda: 5.69e-126
iter: 5885, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073239
iter: 5885, Minibatch log likelihood (post-update): -54.2775, error rate (post-update): 0.073238

size_minibatch = 20000
Precon grad coeff: 0.015305, velocity coeff: 0.91922
norm(ch) = 0.18487
iter: 5886, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073238

size_minibatch = 20000
Precon grad coeff: 0.016269, velocity coeff: 1.025
norm(ch) = 0.18959
iter: 5887, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073238

size_minibatch = 20000
Precon grad coeff: 0.016147, velocity coeff: 1.0036
norm(ch) = 0.1903
iter: 5888, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073234

size_minibatch = 20000
Precon grad coeff: 0.017291, velocity coeff: 1.0319
norm(ch) = 0.19645
iter: 5889, Minibatch log likelihood (pre-update): -54.2775, error rate (pre-update): 0.073234

size_minibatch = 20000
Precon grad coeff: 0.018409, velocity coeff: 1.0283
norm(ch) = 0.20204
rho = 1.5085
New lambda: 4.4028e-126
iter: 5890, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073234
iter: 5890, Minibatch log likelihood (post-update): -54.2774, error rate (post-update): 0.073232

size_minibatch = 20000
Precon grad coeff: 0.018739, velocity coeff: 1.0146
norm(ch) = 0.20505
iter: 5891, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073232

size_minibatch = 20000
Precon grad coeff: 0.018256, velocity coeff: 0.96109
norm(ch) = 0.19715
iter: 5892, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.07323

size_minibatch = 20000
Precon grad coeff: 0.015738, velocity coeff: 0.95998
norm(ch) = 0.18942
iter: 5893, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073229

size_minibatch = 20000
Precon grad coeff: 0.016734, velocity coeff: 1.0274
norm(ch) = 0.19462
iter: 5894, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073229

size_minibatch = 20000
Precon grad coeff: 0.015129, velocity coeff: 0.95741
norm(ch) = 0.18639
rho = 1.2984
New lambda: 3.4068e-126
iter: 5895, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073228
iter: 5895, Minibatch log likelihood (post-update): -54.2774, error rate (post-update): 0.073225

size_minibatch = 20000
Precon grad coeff: 0.019201, velocity coeff: 1.1459
norm(ch) = 0.21364
iter: 5896, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073225

size_minibatch = 20000
Precon grad coeff: 0.016827, velocity coeff: 0.92416
norm(ch) = 0.19753
iter: 5897, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073224

size_minibatch = 20000
Precon grad coeff: 0.01834, velocity coeff: 1.0755
norm(ch) = 0.21257
iter: 5898, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073223

size_minibatch = 20000
Precon grad coeff: 0.018022, velocity coeff: 0.94716
norm(ch) = 0.20145
iter: 5899, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073222

size_minibatch = 20000
Precon grad coeff: 0.016221, velocity coeff: 1.0324
New gamma: 0.0031623
norm(ch) = 0.20815
rho = 0.95713
New lambda: 2.6361e-126
iter: 5900, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073223
iter: 5900, Minibatch log likelihood (post-update): -54.2774, error rate (post-update): 0.073222
---
Full log-likelihood: -54.2774, error rate: 0.073222
TEST log-likelihood: -55.7962, error rate: 0.51646
Error difference (test - train): 0.44324
---
Full log-likelihood (averaged params): -54.2789, error rate (averaged params): 0.073932
TEST log-likelihood (averaged params): -55.7552, error rate (averaged params): 0.50663
Error difference (test - train) (averaged params): 0.4327

size_minibatch = 20000
Precon grad coeff: 0.015645, velocity coeff: 0.975
norm(ch) = 0.20325
iter: 5901, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073222

size_minibatch = 20000
Precon grad coeff: 0.015971, velocity coeff: 1.0582
norm(ch) = 0.21541
iter: 5902, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073218

size_minibatch = 20000
Precon grad coeff: 0.015377, velocity coeff: 1.0479
norm(ch) = 0.22608
iter: 5903, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073218

size_minibatch = 20000
Precon grad coeff: 0.017356, velocity coeff: 1.0777
norm(ch) = 0.24404
iter: 5904, Minibatch log likelihood (pre-update): -54.2774, error rate (pre-update): 0.073217

size_minibatch = 20000
Precon grad coeff: 0.019607, velocity coeff: 1.0566
norm(ch) = 0.25836
rho = 1.2539
New lambda: 2.0398e-126
iter: 5905, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073214
iter: 5905, Minibatch log likelihood (post-update): -54.2773, error rate (post-update): 0.073213

size_minibatch = 20000
Precon grad coeff: 0.015421, velocity coeff: 0.8541
norm(ch) = 0.22113
iter: 5906, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073213

size_minibatch = 20000
Precon grad coeff: 0.01517, velocity coeff: 1.0501
norm(ch) = 0.23268
iter: 5907, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073213

size_minibatch = 20000
Precon grad coeff: 0.016132, velocity coeff: 1.0272
norm(ch) = 0.23943
iter: 5908, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.07321

size_minibatch = 20000
Precon grad coeff: 0.014374, velocity coeff: 0.92113
norm(ch) = 0.22094
iter: 5909, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073209

size_minibatch = 20000
Precon grad coeff: 0.019464, velocity coeff: 1.1774
norm(ch) = 0.2607
rho = 0.61019
New lambda: 2.0398e-126
iter: 5910, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073206
iter: 5910, Minibatch log likelihood (post-update): -54.2773, error rate (post-update): 0.073203

size_minibatch = 20000
Precon grad coeff: 0.016696, velocity coeff: 0.85317
norm(ch) = 0.22286
iter: 5911, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073203

size_minibatch = 20000
Precon grad coeff: 0.015073, velocity coeff: 1.023
norm(ch) = 0.22832
iter: 5912, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073204

size_minibatch = 20000
Precon grad coeff: 0.018401, velocity coeff: 1.0827
norm(ch) = 0.24765
iter: 5913, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073206

size_minibatch = 20000
Precon grad coeff: 0.015834, velocity coeff: 0.89815
norm(ch) = 0.2228
iter: 5914, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073201

size_minibatch = 20000
Precon grad coeff: 0.013964, velocity coeff: 0.94583
norm(ch) = 0.21108
rho = 0.97919
New lambda: 1.5784e-126
iter: 5915, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.0732
iter: 5915, Minibatch log likelihood (post-update): -54.2773, error rate (post-update): 0.073199

size_minibatch = 20000
Precon grad coeff: 0.017029, velocity coeff: 1.1507
norm(ch) = 0.24316
iter: 5916, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073199

size_minibatch = 20000
Precon grad coeff: 0.019353, velocity coeff: 1.015
norm(ch) = 0.24705
iter: 5917, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073197

size_minibatch = 20000
Precon grad coeff: 0.017036, velocity coeff: 0.90732
norm(ch) = 0.22436
iter: 5918, Minibatch log likelihood (pre-update): -54.2773, error rate (pre-update): 0.073195

size_minibatch = 20000
Precon grad coeff: 0.016781, velocity coeff: 1.0661
norm(ch) = 0.23941
iter: 5919, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073196

size_minibatch = 20000
Precon grad coeff: 0.017358, velocity coeff: 0.9442
New gamma: 0.0031623
norm(ch) = 0.22627
rho = 1.6332
New lambda: 1.2213e-126
iter: 5920, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073194
iter: 5920, Minibatch log likelihood (post-update): -54.2772, error rate (post-update): 0.073193

size_minibatch = 20000
Precon grad coeff: 0.014053, velocity coeff: 0.93969
norm(ch) = 0.21282
iter: 5921, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073193

size_minibatch = 20000
Precon grad coeff: 0.017594, velocity coeff: 1.1805
norm(ch) = 0.2514
iter: 5922, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073191

size_minibatch = 20000
Precon grad coeff: 0.016794, velocity coeff: 0.90122
norm(ch) = 0.22667
iter: 5923, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.07319

size_minibatch = 20000
Precon grad coeff: 0.016862, velocity coeff: 1.0614
norm(ch) = 0.24072
iter: 5924, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073189

size_minibatch = 20000
Precon grad coeff: 0.016468, velocity coeff: 0.94899
norm(ch) = 0.22859
rho = 1.132
New lambda: 9.4502e-127
iter: 5925, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073187
iter: 5925, Minibatch log likelihood (post-update): -54.2772, error rate (post-update): 0.073184

size_minibatch = 20000
Precon grad coeff: 0.017361, velocity coeff: 1.0973
norm(ch) = 0.25103
iter: 5926, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073184

size_minibatch = 20000
Precon grad coeff: 0.018201, velocity coeff: 0.94973
norm(ch) = 0.23866
iter: 5927, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073183

size_minibatch = 20000
Precon grad coeff: 0.014673, velocity coeff: 0.90266
norm(ch) = 0.21567
iter: 5928, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073183

size_minibatch = 20000
Precon grad coeff: 0.016258, velocity coeff: 1.1048
norm(ch) = 0.23844
iter: 5929, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073181

size_minibatch = 20000
Precon grad coeff: 0.016185, velocity coeff: 0.98893
norm(ch) = 0.23598
rho = 1.1288
New lambda: 7.3124e-127
iter: 5930, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073177
iter: 5930, Minibatch log likelihood (post-update): -54.2772, error rate (post-update): 0.073178

size_minibatch = 20000
Precon grad coeff: 0.018875, velocity coeff: 1.0545
norm(ch) = 0.24914
iter: 5931, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073178

size_minibatch = 20000
Precon grad coeff: 0.019291, velocity coeff: 1.0001
norm(ch) = 0.2495
iter: 5932, Minibatch log likelihood (pre-update): -54.2772, error rate (pre-update): 0.073175

size_minibatch = 20000
Precon grad coeff: 0.014676, velocity coeff: 0.86664
norm(ch) = 0.21651
iter: 5933, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073173

size_minibatch = 20000
Precon grad coeff: 0.015905, velocity coeff: 1.0268
norm(ch) = 0.22267
iter: 5934, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073173

size_minibatch = 20000
Precon grad coeff: 0.01709, velocity coeff: 1.0941
norm(ch) = 0.24392
rho = 0.87589
New lambda: 5.6582e-127
iter: 5935, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073172
iter: 5935, Minibatch log likelihood (post-update): -54.2771, error rate (post-update): 0.073169

size_minibatch = 20000
Precon grad coeff: 0.016741, velocity coeff: 0.94101
norm(ch) = 0.22985
iter: 5936, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073169

size_minibatch = 20000
Precon grad coeff: 0.017416, velocity coeff: 1.0274
norm(ch) = 0.23651
iter: 5937, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.07317

size_minibatch = 20000
Precon grad coeff: 0.016295, velocity coeff: 0.98824
norm(ch) = 0.23412
iter: 5938, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073166

size_minibatch = 20000
Precon grad coeff: 0.015393, velocity coeff: 0.94974
norm(ch) = 0.22269
iter: 5939, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073166

size_minibatch = 20000
Precon grad coeff: 0.022153, velocity coeff: 1.0848
New gamma: 0.0052816
norm(ch) = 0.24175
rho = 1.0603
New lambda: 4.3782e-127
iter: 5940, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073166
iter: 5940, Minibatch log likelihood (post-update): -54.2771, error rate (post-update): 0.073163

size_minibatch = 20000
Precon grad coeff: 0.019215, velocity coeff: 0.88246
norm(ch) = 0.21351
iter: 5941, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073163

size_minibatch = 20000
Precon grad coeff: 0.017286, velocity coeff: 0.91063
norm(ch) = 0.19461
iter: 5942, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073161

size_minibatch = 20000
Precon grad coeff: 0.021244, velocity coeff: 1.1601
norm(ch) = 0.226
iter: 5943, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073161

size_minibatch = 20000
Precon grad coeff: 0.020099, velocity coeff: 0.90507
norm(ch) = 0.20474
iter: 5944, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073159

size_minibatch = 20000
Precon grad coeff: 0.018179, velocity coeff: 0.98634
norm(ch) = 0.20208
rho = 1.0252
New lambda: 3.3878e-127
iter: 5945, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073158
iter: 5945, Minibatch log likelihood (post-update): -54.2771, error rate (post-update): 0.073157

size_minibatch = 20000
Precon grad coeff: 0.020948, velocity coeff: 1.0911
norm(ch) = 0.22065
iter: 5946, Minibatch log likelihood (pre-update): -54.2771, error rate (pre-update): 0.073157

size_minibatch = 20000
Precon grad coeff: 0.022097, velocity coeff: 0.98714
norm(ch) = 0.218
iter: 5947, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073154

size_minibatch = 20000
Precon grad coeff: 0.017781, velocity coeff: 0.97146
norm(ch) = 0.21192
iter: 5948, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073154

size_minibatch = 20000
Precon grad coeff: 0.021776, velocity coeff: 1.0791
norm(ch) = 0.22885
iter: 5949, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073154

size_minibatch = 20000
Precon grad coeff: 0.022392, velocity coeff: 0.99217
norm(ch) = 0.22721
rho = 1.1628
New lambda: 2.6214e-127
iter: 5950, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073151
iter: 5950, Minibatch log likelihood (post-update): -54.277, error rate (post-update): 0.07315
---
Full log-likelihood: -54.277, error rate: 0.07315
TEST log-likelihood: -55.8133, error rate: 0.52067
Error difference (test - train): 0.44752
---
Full log-likelihood (averaged params): -54.2786, error rate (averaged params): 0.07391
TEST log-likelihood (averaged params): -55.7719, error rate (averaged params): 0.51046
Error difference (test - train) (averaged params): 0.43655

size_minibatch = 20000
Precon grad coeff: 0.01835, velocity coeff: 0.92865
norm(ch) = 0.21107
iter: 5951, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.07315

size_minibatch = 20000
Precon grad coeff: 0.019384, velocity coeff: 1.0549
norm(ch) = 0.22277
iter: 5952, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.07315

size_minibatch = 20000
Precon grad coeff: 0.021033, velocity coeff: 1.0069
norm(ch) = 0.22444
iter: 5953, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073146

size_minibatch = 20000
Precon grad coeff: 0.018421, velocity coeff: 0.91333
norm(ch) = 0.20507
iter: 5954, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073147

size_minibatch = 20000
Precon grad coeff: 0.02042, velocity coeff: 1.1342
norm(ch) = 0.2327
rho = 1.3617
New lambda: 2.0284e-127
iter: 5955, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073144
iter: 5955, Minibatch log likelihood (post-update): -54.277, error rate (post-update): 0.073141

size_minibatch = 20000
Precon grad coeff: 0.019223, velocity coeff: 0.91494
norm(ch) = 0.21301
iter: 5956, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073141

size_minibatch = 20000
Precon grad coeff: 0.021022, velocity coeff: 1.0524
norm(ch) = 0.22428
iter: 5957, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073142

size_minibatch = 20000
Precon grad coeff: 0.016669, velocity coeff: 0.92807
norm(ch) = 0.20824
iter: 5958, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073141

size_minibatch = 20000
Precon grad coeff: 0.02258, velocity coeff: 1.1286
norm(ch) = 0.23514
iter: 5959, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073137

size_minibatch = 20000
Precon grad coeff: 0.018516, velocity coeff: 0.91915
New gamma: 0.0031623
norm(ch) = 0.21636
rho = 0.95271
New lambda: 1.5695e-127
iter: 5960, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073138
iter: 5960, Minibatch log likelihood (post-update): -54.277, error rate (post-update): 0.073136

size_minibatch = 20000
Precon grad coeff: 0.019291, velocity coeff: 1.0014
norm(ch) = 0.21705
iter: 5961, Minibatch log likelihood (pre-update): -54.277, error rate (pre-update): 0.073136

size_minibatch = 20000
Precon grad coeff: 0.015539, velocity coeff: 0.9697
norm(ch) = 0.21086
iter: 5962, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073134

size_minibatch = 20000
Precon grad coeff: 0.022037, velocity coeff: 1.2734
norm(ch) = 0.26903
iter: 5963, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073133

size_minibatch = 20000
Precon grad coeff: 0.019039, velocity coeff: 0.87704
norm(ch) = 0.2365
iter: 5964, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.07313

size_minibatch = 20000
Precon grad coeff: 0.015383, velocity coeff: 0.99236
norm(ch) = 0.23519
rho = 0.75069
New lambda: 1.2145e-127
iter: 5965, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.07313
iter: 5965, Minibatch log likelihood (post-update): -54.2769, error rate (post-update): 0.073128

size_minibatch = 20000
Precon grad coeff: 0.016703, velocity coeff: 1.0903
norm(ch) = 0.25694
iter: 5966, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073128

size_minibatch = 20000
Precon grad coeff: 0.01842, velocity coeff: 0.99809
norm(ch) = 0.25703
iter: 5967, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073127

size_minibatch = 20000
Precon grad coeff: 0.018204, velocity coeff: 0.99712
norm(ch) = 0.25682
iter: 5968, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073123

size_minibatch = 20000
Precon grad coeff: 0.017881, velocity coeff: 0.99553
norm(ch) = 0.25623
iter: 5969, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073125

size_minibatch = 20000
Precon grad coeff: 0.019391, velocity coeff: 1.0017
norm(ch) = 0.25728
rho = 1.2975
New lambda: 9.3973e-128
iter: 5970, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073123
iter: 5970, Minibatch log likelihood (post-update): -54.2769, error rate (post-update): 0.073119

size_minibatch = 20000
Precon grad coeff: 0.018244, velocity coeff: 0.95041
norm(ch) = 0.24502
iter: 5971, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073119

size_minibatch = 20000
Precon grad coeff: 0.019094, velocity coeff: 1.0494
norm(ch) = 0.25764
iter: 5972, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073119

size_minibatch = 20000
Precon grad coeff: 0.020294, velocity coeff: 0.95359
norm(ch) = 0.24614
iter: 5973, Minibatch log likelihood (pre-update): -54.2769, error rate (pre-update): 0.073116

size_minibatch = 20000
Precon grad coeff: 0.015197, velocity coeff: 0.90232
norm(ch) = 0.22242
iter: 5974, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073116

size_minibatch = 20000
Precon grad coeff: 0.017444, velocity coeff: 1.0617
norm(ch) = 0.23651
rho = 0.98064
New lambda: 7.2714e-128
iter: 5975, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073115
iter: 5975, Minibatch log likelihood (post-update): -54.2768, error rate (post-update): 0.073113

size_minibatch = 20000
Precon grad coeff: 0.016888, velocity coeff: 0.98205
norm(ch) = 0.23255
iter: 5976, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073113

size_minibatch = 20000
Precon grad coeff: 0.016836, velocity coeff: 1.0321
norm(ch) = 0.24028
iter: 5977, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.07311

size_minibatch = 20000
Precon grad coeff: 0.017255, velocity coeff: 0.98315
norm(ch) = 0.23649
iter: 5978, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.07311

size_minibatch = 20000
Precon grad coeff: 0.018322, velocity coeff: 1.0454
norm(ch) = 0.24748
iter: 5979, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073108

size_minibatch = 20000
Precon grad coeff: 0.019741, velocity coeff: 1.023
New gamma: 0.0031623
norm(ch) = 0.25345
rho = 1.5749
New lambda: 5.6265e-128
iter: 5980, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073107
iter: 5980, Minibatch log likelihood (post-update): -54.2768, error rate (post-update): 0.073105

size_minibatch = 20000
Precon grad coeff: 0.019839, velocity coeff: 0.97776
norm(ch) = 0.24803
iter: 5981, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073105

size_minibatch = 20000
Precon grad coeff: 0.016308, velocity coeff: 0.86663
norm(ch) = 0.21515
iter: 5982, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073104

size_minibatch = 20000
Precon grad coeff: 0.016104, velocity coeff: 1.1509
norm(ch) = 0.24785
iter: 5983, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073102

size_minibatch = 20000
Precon grad coeff: 0.018915, velocity coeff: 0.97651
norm(ch) = 0.24225
iter: 5984, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.0731

size_minibatch = 20000
Precon grad coeff: 0.015281, velocity coeff: 0.93752
norm(ch) = 0.22731
rho = 1.5064
New lambda: 4.3537e-128
iter: 5985, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073099
iter: 5985, Minibatch log likelihood (post-update): -54.2768, error rate (post-update): 0.073098

size_minibatch = 20000
Precon grad coeff: 0.018499, velocity coeff: 1.1292
norm(ch) = 0.25695
iter: 5986, Minibatch log likelihood (pre-update): -54.2768, error rate (pre-update): 0.073098

size_minibatch = 20000
Precon grad coeff: 0.019742, velocity coeff: 0.97621
norm(ch) = 0.25116
iter: 5987, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073096

size_minibatch = 20000
Precon grad coeff: 0.015843, velocity coeff: 0.91999
norm(ch) = 0.23135
iter: 5988, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073096

size_minibatch = 20000
Precon grad coeff: 0.017731, velocity coeff: 1.0728
norm(ch) = 0.24847
iter: 5989, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073096

size_minibatch = 20000
Precon grad coeff: 0.020002, velocity coeff: 1.0319
norm(ch) = 0.25672
rho = 1.175
New lambda: 3.3688e-128
iter: 5990, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073092
iter: 5990, Minibatch log likelihood (post-update): -54.2767, error rate (post-update): 0.073092

size_minibatch = 20000
Precon grad coeff: 0.017568, velocity coeff: 0.92608
norm(ch) = 0.23809
iter: 5991, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073092

size_minibatch = 20000
Precon grad coeff: 0.016169, velocity coeff: 0.96366
norm(ch) = 0.22976
iter: 5992, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.07309

size_minibatch = 20000
Precon grad coeff: 0.017698, velocity coeff: 1.0448
norm(ch) = 0.24041
iter: 5993, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073089

size_minibatch = 20000
Precon grad coeff: 0.0171, velocity coeff: 0.96547
norm(ch) = 0.23246
iter: 5994, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073088

size_minibatch = 20000
Precon grad coeff: 0.015944, velocity coeff: 0.99632
norm(ch) = 0.23196
rho = 0.61723
New lambda: 3.3688e-128
iter: 5995, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073086
iter: 5995, Minibatch log likelihood (post-update): -54.2767, error rate (post-update): 0.073087

size_minibatch = 20000
Precon grad coeff: 0.01706, velocity coeff: 1.022
norm(ch) = 0.23741
iter: 5996, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073087

size_minibatch = 20000
Precon grad coeff: 0.017567, velocity coeff: 1.028
norm(ch) = 0.24442
iter: 5997, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073084

size_minibatch = 20000
Precon grad coeff: 0.019353, velocity coeff: 1.0368
norm(ch) = 0.25381
iter: 5998, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073082

size_minibatch = 20000
Precon grad coeff: 0.019197, velocity coeff: 0.98665
norm(ch) = 0.2508
iter: 5999, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.073082

size_minibatch = 20000
Precon grad coeff: 0.019474, velocity coeff: 0.96275
New gamma: 0.0031623
norm(ch) = 0.24183
rho = 1.2196
New lambda: 2.6067e-128
iter: 6000, Minibatch log likelihood (pre-update): -54.2767, error rate (pre-update): 0.07308
iter: 6000, Minibatch log likelihood (post-update): -54.2766, error rate (post-update): 0.073079
---
Full log-likelihood: -54.2766, error rate: 0.073079
TEST log-likelihood: -55.8296, error rate: 0.52483
Error difference (test - train): 0.45175
---
Full log-likelihood (averaged params): -54.2784, error rate (averaged params): 0.073899
TEST log-likelihood (averaged params): -55.7883, error rate (averaged params): 0.51443
Error difference (test - train) (averaged params): 0.44053

size_minibatch = 20000
Precon grad coeff: 0.01739, velocity coeff: 0.92356
norm(ch) = 0.22371
iter: 6001, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073079

size_minibatch = 20000
Precon grad coeff: 0.017564, velocity coeff: 1.0078
norm(ch) = 0.22581
iter: 6002, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.07308

size_minibatch = 20000
Precon grad coeff: 0.019329, velocity coeff: 1.0559
norm(ch) = 0.23879
iter: 6003, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073075

size_minibatch = 20000
Precon grad coeff: 0.01583, velocity coeff: 0.90186
norm(ch) = 0.21566
iter: 6004, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073075

size_minibatch = 20000
Precon grad coeff: 0.015765, velocity coeff: 1.0826
norm(ch) = 0.23375
rho = 1.0717
New lambda: 2.017e-128
iter: 6005, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073075
iter: 6005, Minibatch log likelihood (post-update): -54.2766, error rate (post-update): 0.073074

size_minibatch = 20000
Precon grad coeff: 0.021394, velocity coeff: 1.1487
norm(ch) = 0.26887
iter: 6006, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073074

size_minibatch = 20000
Precon grad coeff: 0.018314, velocity coeff: 0.86314
norm(ch) = 0.23236
iter: 6007, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073071

size_minibatch = 20000
Precon grad coeff: 0.017342, velocity coeff: 1.0712
norm(ch) = 0.24918
iter: 6008, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073071

size_minibatch = 20000
Precon grad coeff: 0.019007, velocity coeff: 1.0332
norm(ch) = 0.25772
iter: 6009, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073068

size_minibatch = 20000
Precon grad coeff: 0.019289, velocity coeff: 0.93922
norm(ch) = 0.24232
rho = 0.64828
New lambda: 2.017e-128
iter: 6010, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073067
iter: 6010, Minibatch log likelihood (post-update): -54.2766, error rate (post-update): 0.073064

size_minibatch = 20000
Precon grad coeff: 0.016114, velocity coeff: 0.96995
norm(ch) = 0.23525
iter: 6011, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073064

size_minibatch = 20000
Precon grad coeff: 0.015452, velocity coeff: 0.96371
norm(ch) = 0.22691
iter: 6012, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073065

size_minibatch = 20000
Precon grad coeff: 0.020694, velocity coeff: 1.1569
norm(ch) = 0.26282
iter: 6013, Minibatch log likelihood (pre-update): -54.2766, error rate (pre-update): 0.073064

size_minibatch = 20000
Precon grad coeff: 0.01722, velocity coeff: 0.90228
norm(ch) = 0.23734
iter: 6014, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073064

size_minibatch = 20000
Precon grad coeff: 0.017655, velocity coeff: 1.0003
norm(ch) = 0.23763
rho = 1.1068
New lambda: 1.5607e-128
iter: 6015, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073061
iter: 6015, Minibatch log likelihood (post-update): -54.2765, error rate (post-update): 0.07306

size_minibatch = 20000
Precon grad coeff: 0.017771, velocity coeff: 1.0353
norm(ch) = 0.24624
iter: 6016, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.07306

size_minibatch = 20000
Precon grad coeff: 0.019756, velocity coeff: 1.0216
norm(ch) = 0.25184
iter: 6017, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073058

size_minibatch = 20000
Precon grad coeff: 0.014749, velocity coeff: 0.84582
norm(ch) = 0.21321
iter: 6018, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073058

size_minibatch = 20000
Precon grad coeff: 0.017022, velocity coeff: 1.1619
norm(ch) = 0.24792
iter: 6019, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073057

size_minibatch = 20000
Precon grad coeff: 0.019265, velocity coeff: 0.94372
New gamma: 0.0031623
norm(ch) = 0.23423
rho = 0.89663
New lambda: 1.2077e-128
iter: 6020, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073056
iter: 6020, Minibatch log likelihood (post-update): -54.2765, error rate (post-update): 0.073054

size_minibatch = 20000
Precon grad coeff: 0.017638, velocity coeff: 0.97306
norm(ch) = 0.22821
iter: 6021, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073054

size_minibatch = 20000
Precon grad coeff: 0.016869, velocity coeff: 0.94215
norm(ch) = 0.21528
iter: 6022, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073054

size_minibatch = 20000
Precon grad coeff: 0.016553, velocity coeff: 1.0934
norm(ch) = 0.23569
iter: 6023, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073053

size_minibatch = 20000
Precon grad coeff: 0.019875, velocity coeff: 1.0295
norm(ch) = 0.243
iter: 6024, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073049

size_minibatch = 20000
Precon grad coeff: 0.017154, velocity coeff: 0.97069
norm(ch) = 0.23619
rho = 1.1483
New lambda: 9.3447e-129
iter: 6025, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.07305
iter: 6025, Minibatch log likelihood (post-update): -54.2765, error rate (post-update): 0.073051

size_minibatch = 20000
Precon grad coeff: 0.017807, velocity coeff: 0.99019
norm(ch) = 0.23422
iter: 6026, Minibatch log likelihood (pre-update): -54.2765, error rate (pre-update): 0.073051

size_minibatch = 20000
Precon grad coeff: 0.017933, velocity coeff: 1.0631
norm(ch) = 0.24932
iter: 6027, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073048

size_minibatch = 20000
Precon grad coeff: 0.016368, velocity coeff: 0.92456
norm(ch) = 0.23078
iter: 6028, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073046

size_minibatch = 20000
Precon grad coeff: 0.018142, velocity coeff: 1.0755
norm(ch) = 0.2485
iter: 6029, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073045

size_minibatch = 20000
Precon grad coeff: 0.017234, velocity coeff: 0.93351
norm(ch) = 0.23225
rho = 0.74105
New lambda: 9.3447e-129
iter: 6030, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073042
iter: 6030, Minibatch log likelihood (post-update): -54.2764, error rate (post-update): 0.073044

size_minibatch = 20000
Precon grad coeff: 0.016261, velocity coeff: 1.0539
norm(ch) = 0.24506
iter: 6031, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073044

size_minibatch = 20000
Precon grad coeff: 0.022673, velocity coeff: 1.0719
norm(ch) = 0.26306
iter: 6032, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073043

size_minibatch = 20000
Precon grad coeff: 0.014693, velocity coeff: 0.82445
norm(ch) = 0.21712
iter: 6033, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073041

size_minibatch = 20000
Precon grad coeff: 0.017359, velocity coeff: 1.0919
norm(ch) = 0.2373
iter: 6034, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.07304

size_minibatch = 20000
Precon grad coeff: 0.018699, velocity coeff: 1.0219
norm(ch) = 0.24276
rho = 0.33437
New lambda: 9.3447e-129
iter: 6035, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073038
iter: 6035, Minibatch log likelihood (post-update): -54.2764, error rate (post-update): 0.073038

size_minibatch = 20000
Precon grad coeff: 0.016177, velocity coeff: 0.91707
norm(ch) = 0.22288
iter: 6036, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073038

size_minibatch = 20000
Precon grad coeff: 0.018852, velocity coeff: 1.1189
norm(ch) = 0.24967
iter: 6037, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073036

size_minibatch = 20000
Precon grad coeff: 0.016293, velocity coeff: 0.88748
norm(ch) = 0.22181
iter: 6038, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073036

size_minibatch = 20000
Precon grad coeff: 0.018252, velocity coeff: 1.119
norm(ch) = 0.24841
iter: 6039, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073035

size_minibatch = 20000
Precon grad coeff: 0.017167, velocity coeff: 0.89426
New gamma: 0.0031623
norm(ch) = 0.22241
rho = 1.2418
New lambda: 7.2307e-129
iter: 6040, Minibatch log likelihood (pre-update): -54.2764, error rate (pre-update): 0.073032
iter: 6040, Minibatch log likelihood (post-update): -54.2763, error rate (post-update): 0.073032

size_minibatch = 20000
Precon grad coeff: 0.013952, velocity coeff: 0.9478
norm(ch) = 0.21108
iter: 6041, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073032

size_minibatch = 20000
Precon grad coeff: 0.015603, velocity coeff: 1.0472
norm(ch) = 0.22123
iter: 6042, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073031

size_minibatch = 20000
Precon grad coeff: 0.019306, velocity coeff: 1.1605
norm(ch) = 0.25698
iter: 6043, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073032

size_minibatch = 20000
Precon grad coeff: 0.016644, velocity coeff: 0.80738
norm(ch) = 0.20774
iter: 6044, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073031

size_minibatch = 20000
Precon grad coeff: 0.013047, velocity coeff: 1.0829
norm(ch) = 0.22516
rho = 1.4307
New lambda: 5.595e-129
iter: 6045, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073028
iter: 6045, Minibatch log likelihood (post-update): -54.2763, error rate (post-update): 0.073027

size_minibatch = 20000
Precon grad coeff: 0.020806, velocity coeff: 1.1329
norm(ch) = 0.2554
iter: 6046, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073027

size_minibatch = 20000
Precon grad coeff: 0.015843, velocity coeff: 0.83615
norm(ch) = 0.2138
iter: 6047, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073024

size_minibatch = 20000
Precon grad coeff: 0.01448, velocity coeff: 1.061
norm(ch) = 0.22708
iter: 6048, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073025

size_minibatch = 20000
Precon grad coeff: 0.017162, velocity coeff: 1.0393
norm(ch) = 0.23622
iter: 6049, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073025

size_minibatch = 20000
Precon grad coeff: 0.015801, velocity coeff: 0.96128
norm(ch) = 0.2273
rho = 1.0467
New lambda: 4.3293e-129
iter: 6050, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073022
iter: 6050, Minibatch log likelihood (post-update): -54.2763, error rate (post-update): 0.073022
---
Full log-likelihood: -54.2763, error rate: 0.073022
TEST log-likelihood: -55.8453, error rate: 0.52869
Error difference (test - train): 0.45567
---
Full log-likelihood (averaged params): -54.2782, error rate (averaged params): 0.073901
TEST log-likelihood (averaged params): -55.8047, error rate (averaged params): 0.51848
Error difference (test - train) (averaged params): 0.44458

size_minibatch = 20000
Precon grad coeff: 0.014973, velocity coeff: 0.98584
norm(ch) = 0.22434
iter: 6051, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073022

size_minibatch = 20000
Precon grad coeff: 0.016334, velocity coeff: 1.007
norm(ch) = 0.2261
iter: 6052, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073021

size_minibatch = 20000
Precon grad coeff: 0.01621, velocity coeff: 0.99233
norm(ch) = 0.22457
iter: 6053, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073019

size_minibatch = 20000
Precon grad coeff: 0.014044, velocity coeff: 0.92615
norm(ch) = 0.20817
iter: 6054, Minibatch log likelihood (pre-update): -54.2763, error rate (pre-update): 0.073019

size_minibatch = 20000
Precon grad coeff: 0.018411, velocity coeff: 1.2248
norm(ch) = 0.25523
rho = 1.1395
New lambda: 3.3499e-129
iter: 6055, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073019
iter: 6055, Minibatch log likelihood (post-update): -54.2762, error rate (post-update): 0.073016

size_minibatch = 20000
Precon grad coeff: 0.015319, velocity coeff: 0.7888
norm(ch) = 0.20163
iter: 6056, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073016

size_minibatch = 20000
Precon grad coeff: 0.014555, velocity coeff: 1.1313
norm(ch) = 0.22824
iter: 6057, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073015

size_minibatch = 20000
Precon grad coeff: 0.019175, velocity coeff: 1.061
norm(ch) = 0.24239
iter: 6058, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073017

size_minibatch = 20000
Precon grad coeff: 0.015164, velocity coeff: 0.88195
norm(ch) = 0.21403
iter: 6059, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073013

size_minibatch = 20000
Precon grad coeff: 0.013972, velocity coeff: 0.98468
New gamma: 0.0031623
norm(ch) = 0.21096
rho = 1.3068
New lambda: 2.5921e-129
iter: 6060, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073013
iter: 6060, Minibatch log likelihood (post-update): -54.2762, error rate (post-update): 0.073015

size_minibatch = 20000
Precon grad coeff: 0.016744, velocity coeff: 1.1059
norm(ch) = 0.23358
iter: 6061, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073015

size_minibatch = 20000
Precon grad coeff: 0.016681, velocity coeff: 0.99459
norm(ch) = 0.23259
iter: 6062, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073011

size_minibatch = 20000
Precon grad coeff: 0.01436, velocity coeff: 0.89918
norm(ch) = 0.20935
iter: 6063, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073009

size_minibatch = 20000
Precon grad coeff: 0.014835, velocity coeff: 1.0981
norm(ch) = 0.23016
iter: 6064, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.07301

size_minibatch = 20000
Precon grad coeff: 0.017404, velocity coeff: 1.0592
norm(ch) = 0.24407
rho = 1.1772
New lambda: 2.0057e-129
iter: 6065, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073009
iter: 6065, Minibatch log likelihood (post-update): -54.2762, error rate (post-update): 0.073007

size_minibatch = 20000
Precon grad coeff: 0.015546, velocity coeff: 0.89495
norm(ch) = 0.21872
iter: 6066, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073007

size_minibatch = 20000
Precon grad coeff: 0.013635, velocity coeff: 0.95353
norm(ch) = 0.20875
iter: 6067, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073006

size_minibatch = 20000
Precon grad coeff: 0.016896, velocity coeff: 1.1877
norm(ch) = 0.2482
iter: 6068, Minibatch log likelihood (pre-update): -54.2762, error rate (pre-update): 0.073005

size_minibatch = 20000
Precon grad coeff: 0.015937, velocity coeff: 0.84259
norm(ch) = 0.20946
iter: 6069, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.073004

size_minibatch = 20000
Precon grad coeff: 0.013764, velocity coeff: 1.0454
norm(ch) = 0.21916
rho = 0.76453
New lambda: 1.552e-129
iter: 6070, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.073003
iter: 6070, Minibatch log likelihood (post-update): -54.2761, error rate (post-update): 0.073004

size_minibatch = 20000
Precon grad coeff: 0.017463, velocity coeff: 1.0768
norm(ch) = 0.23623
iter: 6071, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.073004

size_minibatch = 20000
Precon grad coeff: 0.016648, velocity coeff: 0.94525
norm(ch) = 0.22355
iter: 6072, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.073002

size_minibatch = 20000
Precon grad coeff: 0.012433, velocity coeff: 0.92926
norm(ch) = 0.20791
iter: 6073, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.073

size_minibatch = 20000
Precon grad coeff: 0.018462, velocity coeff: 1.204
norm(ch) = 0.25062
iter: 6074, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072999

size_minibatch = 20000
Precon grad coeff: 0.016857, velocity coeff: 0.91101
norm(ch) = 0.22858
rho = 0.97653
New lambda: 1.2009e-129
iter: 6075, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072998
iter: 6075, Minibatch log likelihood (post-update): -54.2761, error rate (post-update): 0.072999

size_minibatch = 20000
Precon grad coeff: 0.013019, velocity coeff: 0.92329
norm(ch) = 0.21126
iter: 6076, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072999

size_minibatch = 20000
Precon grad coeff: 0.016341, velocity coeff: 1.1397
norm(ch) = 0.24099
iter: 6077, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072997

size_minibatch = 20000
Precon grad coeff: 0.015742, velocity coeff: 0.91935
norm(ch) = 0.22177
iter: 6078, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072994

size_minibatch = 20000
Precon grad coeff: 0.014336, velocity coeff: 0.95163
norm(ch) = 0.21129
iter: 6079, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072995

size_minibatch = 20000
Precon grad coeff: 0.016907, velocity coeff: 1.062
New gamma: 0.0031623
norm(ch) = 0.2246
rho = 0.96689
New lambda: 9.2924e-130
iter: 6080, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072994
iter: 6080, Minibatch log likelihood (post-update): -54.2761, error rate (post-update): 0.072993

size_minibatch = 20000
Precon grad coeff: 0.016287, velocity coeff: 0.8999
norm(ch) = 0.20235
iter: 6081, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072993

size_minibatch = 20000
Precon grad coeff: 0.015143, velocity coeff: 1.0345
norm(ch) = 0.20965
iter: 6082, Minibatch log likelihood (pre-update): -54.2761, error rate (pre-update): 0.072993

size_minibatch = 20000
Precon grad coeff: 0.017723, velocity coeff: 1.016
norm(ch) = 0.21333
iter: 6083, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072992

size_minibatch = 20000
Precon grad coeff: 0.016445, velocity coeff: 1.0192
norm(ch) = 0.21771
iter: 6084, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072991

size_minibatch = 20000
Precon grad coeff: 0.016547, velocity coeff: 1.0027
norm(ch) = 0.21863
rho = 1.2658
New lambda: 7.1903e-130
iter: 6085, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.07299
iter: 6085, Minibatch log likelihood (post-update): -54.276, error rate (post-update): 0.07299

size_minibatch = 20000
Precon grad coeff: 0.015314, velocity coeff: 1.027
norm(ch) = 0.22485
iter: 6086, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.07299

size_minibatch = 20000
Precon grad coeff: 0.01833, velocity coeff: 1.0762
norm(ch) = 0.24239
iter: 6087, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072991

size_minibatch = 20000
Precon grad coeff: 0.015845, velocity coeff: 0.93317
norm(ch) = 0.22651
iter: 6088, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072985

size_minibatch = 20000
Precon grad coeff: 0.015361, velocity coeff: 1.007
norm(ch) = 0.22834
iter: 6089, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072985

size_minibatch = 20000
Precon grad coeff: 0.017057, velocity coeff: 1.0732
norm(ch) = 0.24543
rho = 1.3289
New lambda: 5.5637e-130
iter: 6090, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072987
iter: 6090, Minibatch log likelihood (post-update): -54.276, error rate (post-update): 0.072984

size_minibatch = 20000
Precon grad coeff: 0.016724, velocity coeff: 0.91894
norm(ch) = 0.22588
iter: 6091, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072984

size_minibatch = 20000
Precon grad coeff: 0.015405, velocity coeff: 1.0507
norm(ch) = 0.23755
iter: 6092, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072984

size_minibatch = 20000
Precon grad coeff: 0.017327, velocity coeff: 0.98588
norm(ch) = 0.2345
iter: 6093, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.072984

size_minibatch = 20000
Precon grad coeff: 0.015088, velocity coeff: 0.95211
norm(ch) = 0.22355
iter: 6094, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.07298

size_minibatch = 20000
Precon grad coeff: 0.017258, velocity coeff: 1.0886
norm(ch) = 0.24367
rho = 0.9458
New lambda: 4.3051e-130
iter: 6095, Minibatch log likelihood (pre-update): -54.276, error rate (pre-update): 0.07298
iter: 6095, Minibatch log likelihood (post-update): -54.2759, error rate (post-update): 0.072981

size_minibatch = 20000
Precon grad coeff: 0.016468, velocity coeff: 0.90086
norm(ch) = 0.21975
iter: 6096, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072981

size_minibatch = 20000
Precon grad coeff: 0.015781, velocity coeff: 1.045
norm(ch) = 0.22987
iter: 6097, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.07298

size_minibatch = 20000
Precon grad coeff: 0.014442, velocity coeff: 0.91423
norm(ch) = 0.21048
iter: 6098, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072979

size_minibatch = 20000
Precon grad coeff: 0.019287, velocity coeff: 1.1472
norm(ch) = 0.2417
iter: 6099, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072978

size_minibatch = 20000
Precon grad coeff: 0.015468, velocity coeff: 0.85605
New gamma: 0.0031623
norm(ch) = 0.20718
rho = 1.2635
New lambda: 3.3312e-130
iter: 6100, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072977
iter: 6100, Minibatch log likelihood (post-update): -54.2759, error rate (post-update): 0.072976
---
Full log-likelihood: -54.2759, error rate: 0.072976
TEST log-likelihood: -55.8584, error rate: 0.53194
Error difference (test - train): 0.45896
---
Full log-likelihood (averaged params): -54.2779, error rate (averaged params): 0.073882
TEST log-likelihood (averaged params): -55.8203, error rate (averaged params): 0.52237
Error difference (test - train) (averaged params): 0.44849

size_minibatch = 20000
Precon grad coeff: 0.016604, velocity coeff: 1.1169
norm(ch) = 0.23172
iter: 6101, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072976

size_minibatch = 20000
Precon grad coeff: 0.016184, velocity coeff: 0.95405
norm(ch) = 0.22136
iter: 6102, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072974

size_minibatch = 20000
Precon grad coeff: 0.01553, velocity coeff: 1.0104
norm(ch) = 0.22395
iter: 6103, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072975

size_minibatch = 20000
Precon grad coeff: 0.017789, velocity coeff: 1.0679
norm(ch) = 0.23947
iter: 6104, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072974

size_minibatch = 20000
Precon grad coeff: 0.015288, velocity coeff: 0.93365
norm(ch) = 0.22385
rho = 0.7912
New lambda: 2.5776e-130
iter: 6105, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072973
iter: 6105, Minibatch log likelihood (post-update): -54.2759, error rate (post-update): 0.072975

size_minibatch = 20000
Precon grad coeff: 0.016227, velocity coeff: 1.0653
norm(ch) = 0.23876
iter: 6106, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072975

size_minibatch = 20000
Precon grad coeff: 0.016618, velocity coeff: 0.92991
norm(ch) = 0.22231
iter: 6107, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072971

size_minibatch = 20000
Precon grad coeff: 0.015623, velocity coeff: 1.0715
norm(ch) = 0.23846
iter: 6108, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.07297

size_minibatch = 20000
Precon grad coeff: 0.018029, velocity coeff: 0.98373
norm(ch) = 0.23489
iter: 6109, Minibatch log likelihood (pre-update): -54.2759, error rate (pre-update): 0.072971

size_minibatch = 20000
Precon grad coeff: 0.013931, velocity coeff: 0.92924
norm(ch) = 0.21853
rho = 0.98225
New lambda: 1.9945e-130
iter: 6110, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072966
iter: 6110, Minibatch log likelihood (post-update): -54.2758, error rate (post-update): 0.072966

size_minibatch = 20000
Precon grad coeff: 0.019085, velocity coeff: 1.1722
norm(ch) = 0.25644
iter: 6111, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072966

size_minibatch = 20000
Precon grad coeff: 0.015781, velocity coeff: 0.8256
norm(ch) = 0.21197
iter: 6112, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072968

size_minibatch = 20000
Precon grad coeff: 0.015282, velocity coeff: 1.1093
norm(ch) = 0.23539
iter: 6113, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072968

size_minibatch = 20000
Precon grad coeff: 0.018243, velocity coeff: 1.0247
norm(ch) = 0.24155
iter: 6114, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072967

size_minibatch = 20000
Precon grad coeff: 0.015323, velocity coeff: 0.88937
norm(ch) = 0.21508
rho = 0.76162
New lambda: 1.5433e-130
iter: 6115, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072963
iter: 6115, Minibatch log likelihood (post-update): -54.2758, error rate (post-update): 0.072963

size_minibatch = 20000
Precon grad coeff: 0.016362, velocity coeff: 1.1278
norm(ch) = 0.24283
iter: 6116, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072963

size_minibatch = 20000
Precon grad coeff: 0.016734, velocity coeff: 0.92633
norm(ch) = 0.22518
iter: 6117, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072961

size_minibatch = 20000
Precon grad coeff: 0.015618, velocity coeff: 1.0182
norm(ch) = 0.22955
iter: 6118, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072961

size_minibatch = 20000
Precon grad coeff: 0.016612, velocity coeff: 1.0072
norm(ch) = 0.23153
iter: 6119, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072964

size_minibatch = 20000
Precon grad coeff: 0.016031, velocity coeff: 0.96109
New gamma: 0.0031623
norm(ch) = 0.22278
rho = 0.72514
New lambda: 1.5433e-130
iter: 6120, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072958
iter: 6120, Minibatch log likelihood (post-update): -54.2758, error rate (post-update): 0.072957

size_minibatch = 20000
Precon grad coeff: 0.015557, velocity coeff: 0.9849
norm(ch) = 0.21968
iter: 6121, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072957

size_minibatch = 20000
Precon grad coeff: 0.014667, velocity coeff: 0.94611
norm(ch) = 0.20815
iter: 6122, Minibatch log likelihood (pre-update): -54.2758, error rate (pre-update): 0.072961

size_minibatch = 20000
Precon grad coeff: 0.016719, velocity coeff: 1.1108
norm(ch) = 0.23154
iter: 6123, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072958

size_minibatch = 20000
Precon grad coeff: 0.016456, velocity coeff: 0.97131
norm(ch) = 0.22519
iter: 6124, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072955

size_minibatch = 20000
Precon grad coeff: 0.016305, velocity coeff: 0.99153
norm(ch) = 0.22365
rho = 0.74706
New lambda: 1.5433e-130
iter: 6125, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072956
iter: 6125, Minibatch log likelihood (post-update): -54.2757, error rate (post-update): 0.072954

size_minibatch = 20000
Precon grad coeff: 0.014277, velocity coeff: 0.95047
norm(ch) = 0.21283
iter: 6126, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072954

size_minibatch = 20000
Precon grad coeff: 0.016675, velocity coeff: 1.0863
norm(ch) = 0.23148
iter: 6127, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072955

size_minibatch = 20000
Precon grad coeff: 0.015719, velocity coeff: 0.98799
norm(ch) = 0.22905
iter: 6128, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072955

size_minibatch = 20000
Precon grad coeff: 0.016515, velocity coeff: 1.0283
norm(ch) = 0.23584
iter: 6129, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072953

size_minibatch = 20000
Precon grad coeff: 0.01622, velocity coeff: 0.93253
norm(ch) = 0.22017
rho = 1.3859
New lambda: 1.1942e-130
iter: 6130, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072953
iter: 6130, Minibatch log likelihood (post-update): -54.2757, error rate (post-update): 0.07295

size_minibatch = 20000
Precon grad coeff: 0.013655, velocity coeff: 1.0046
norm(ch) = 0.22144
iter: 6131, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.07295

size_minibatch = 20000
Precon grad coeff: 0.017772, velocity coeff: 1.0666
norm(ch) = 0.2365
iter: 6132, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072948

size_minibatch = 20000
Precon grad coeff: 0.01565, velocity coeff: 0.95377
norm(ch) = 0.2258
iter: 6133, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072949

size_minibatch = 20000
Precon grad coeff: 0.016259, velocity coeff: 1.0304
norm(ch) = 0.23295
iter: 6134, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.07295

size_minibatch = 20000
Precon grad coeff: 0.014812, velocity coeff: 0.88892
norm(ch) = 0.20729
rho = 1.22
New lambda: 9.2404e-131
iter: 6135, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072947
iter: 6135, Minibatch log likelihood (post-update): -54.2757, error rate (post-update): 0.072946

size_minibatch = 20000
Precon grad coeff: 0.015507, velocity coeff: 1.1606
norm(ch) = 0.24078
iter: 6136, Minibatch log likelihood (pre-update): -54.2757, error rate (pre-update): 0.072946

size_minibatch = 20000
Precon grad coeff: 0.017925, velocity coeff: 0.96198
norm(ch) = 0.23193
iter: 6137, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072947

size_minibatch = 20000
Precon grad coeff: 0.014827, velocity coeff: 0.95552
norm(ch) = 0.22179
iter: 6138, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072943

size_minibatch = 20000
Precon grad coeff: 0.017183, velocity coeff: 1.0593
norm(ch) = 0.23515
iter: 6139, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072943

size_minibatch = 20000
Precon grad coeff: 0.014389, velocity coeff: 0.9328
New gamma: 0.0031623
norm(ch) = 0.21957
rho = 0.93565
New lambda: 7.15e-131
iter: 6140, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072944
iter: 6140, Minibatch log likelihood (post-update): -54.2756, error rate (post-update): 0.072941

size_minibatch = 20000
Precon grad coeff: 0.017849, velocity coeff: 1.166
norm(ch) = 0.25628
iter: 6141, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072941

size_minibatch = 20000
Precon grad coeff: 0.018844, velocity coeff: 0.93021
norm(ch) = 0.23867
iter: 6142, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072942

size_minibatch = 20000
Precon grad coeff: 0.01543, velocity coeff: 0.97937
norm(ch) = 0.23397
iter: 6143, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072941

size_minibatch = 20000
Precon grad coeff: 0.016049, velocity coeff: 0.98658
norm(ch) = 0.23107
iter: 6144, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072938

size_minibatch = 20000
Precon grad coeff: 0.017141, velocity coeff: 1.0432
norm(ch) = 0.24126
rho = 1.0725
New lambda: 5.5325e-131
iter: 6145, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072939
iter: 6145, Minibatch log likelihood (post-update): -54.2756, error rate (post-update): 0.072937

size_minibatch = 20000
Precon grad coeff: 0.014452, velocity coeff: 0.88413
norm(ch) = 0.21352
iter: 6146, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072937

size_minibatch = 20000
Precon grad coeff: 0.017867, velocity coeff: 1.1973
norm(ch) = 0.25591
iter: 6147, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072935

size_minibatch = 20000
Precon grad coeff: 0.017242, velocity coeff: 0.891
norm(ch) = 0.2283
iter: 6148, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072936

size_minibatch = 20000
Precon grad coeff: 0.017407, velocity coeff: 1.0628
norm(ch) = 0.24292
iter: 6149, Minibatch log likelihood (pre-update): -54.2756, error rate (pre-update): 0.072935

size_minibatch = 20000
Precon grad coeff: 0.014657, velocity coeff: 0.8693
norm(ch) = 0.21139
rho = 0.69785
New lambda: 5.5325e-131
iter: 6150, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072932
iter: 6150, Minibatch log likelihood (post-update): -54.2755, error rate (post-update): 0.072932
---
Full log-likelihood: -54.2755, error rate: 0.072932
TEST log-likelihood: -55.87, error rate: 0.53471
Error difference (test - train): 0.46178
---
Full log-likelihood (averaged params): -54.2776, error rate (averaged params): 0.073849
TEST log-likelihood (averaged params): -55.8347, error rate (averaged params): 0.52593
Error difference (test - train) (averaged params): 0.45208

size_minibatch = 20000
Precon grad coeff: 0.016543, velocity coeff: 1.1503
norm(ch) = 0.24347
iter: 6151, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072932

size_minibatch = 20000
Precon grad coeff: 0.016424, velocity coeff: 0.95234
norm(ch) = 0.23215
iter: 6152, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072933

size_minibatch = 20000
Precon grad coeff: 0.017743, velocity coeff: 1.0679
norm(ch) = 0.24821
iter: 6153, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072928

size_minibatch = 20000
Precon grad coeff: 0.016849, velocity coeff: 0.94377
norm(ch) = 0.2345
iter: 6154, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.07293

size_minibatch = 20000
Precon grad coeff: 0.016102, velocity coeff: 0.99944
norm(ch) = 0.23463
rho = 1.2976
New lambda: 4.281e-131
iter: 6155, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.07293
iter: 6155, Minibatch log likelihood (post-update): -54.2755, error rate (post-update): 0.072926

size_minibatch = 20000
Precon grad coeff: 0.015596, velocity coeff: 0.93661
norm(ch) = 0.22003
iter: 6156, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072926

size_minibatch = 20000
Precon grad coeff: 0.015913, velocity coeff: 1.064
norm(ch) = 0.23438
iter: 6157, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072928

size_minibatch = 20000
Precon grad coeff: 0.016732, velocity coeff: 0.99977
norm(ch) = 0.23458
iter: 6158, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072927

size_minibatch = 20000
Precon grad coeff: 0.016168, velocity coeff: 1.0016
norm(ch) = 0.23522
iter: 6159, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072922

size_minibatch = 20000
Precon grad coeff: 0.019946, velocity coeff: 0.99956
New gamma: 0.0052816
norm(ch) = 0.23529
rho = 0.86608
New lambda: 3.3125e-131
iter: 6160, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072922
iter: 6160, Minibatch log likelihood (post-update): -54.2755, error rate (post-update): 0.072921

size_minibatch = 20000
Precon grad coeff: 0.018894, velocity coeff: 1.0132
norm(ch) = 0.23852
iter: 6161, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.072921

size_minibatch = 20000
Precon grad coeff: 0.017986, velocity coeff: 0.94227
norm(ch) = 0.22489
iter: 6162, Minibatch log likelihood (pre-update): -54.2755, error rate (pre-update): 0.07292

size_minibatch = 20000
Precon grad coeff: 0.017109, velocity coeff: 0.95635
norm(ch) = 0.21523
iter: 6163, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.07292

size_minibatch = 20000
Precon grad coeff: 0.020248, velocity coeff: 1.1158
norm(ch) = 0.24025
iter: 6164, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072917

size_minibatch = 20000
Precon grad coeff: 0.020131, velocity coeff: 0.86975
norm(ch) = 0.209
rho = 0.85853
New lambda: 2.5632e-131
iter: 6165, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072913
iter: 6165, Minibatch log likelihood (post-update): -54.2754, error rate (post-update): 0.072915

size_minibatch = 20000
Precon grad coeff: 0.015577, velocity coeff: 0.9402
norm(ch) = 0.19657
iter: 6166, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072915

size_minibatch = 20000
Precon grad coeff: 0.020951, velocity coeff: 1.1596
norm(ch) = 0.22803
iter: 6167, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072916

size_minibatch = 20000
Precon grad coeff: 0.019339, velocity coeff: 0.8775
norm(ch) = 0.20016
iter: 6168, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072914

size_minibatch = 20000
Precon grad coeff: 0.016974, velocity coeff: 1.0192
norm(ch) = 0.20406
iter: 6169, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072913

size_minibatch = 20000
Precon grad coeff: 0.019524, velocity coeff: 1.0877
norm(ch) = 0.22205
rho = 0.80105
New lambda: 1.9833e-131
iter: 6170, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072911
iter: 6170, Minibatch log likelihood (post-update): -54.2754, error rate (post-update): 0.072909

size_minibatch = 20000
Precon grad coeff: 0.020622, velocity coeff: 0.97064
norm(ch) = 0.21561
iter: 6171, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072909

size_minibatch = 20000
Precon grad coeff: 0.017385, velocity coeff: 0.9829
norm(ch) = 0.21199
iter: 6172, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072908

size_minibatch = 20000
Precon grad coeff: 0.018068, velocity coeff: 1.0216
norm(ch) = 0.21664
iter: 6173, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072909

size_minibatch = 20000
Precon grad coeff: 0.019408, velocity coeff: 1.0425
norm(ch) = 0.22594
iter: 6174, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072909

size_minibatch = 20000
Precon grad coeff: 0.019805, velocity coeff: 1.0119
norm(ch) = 0.22872
rho = 0.31927
New lambda: 1.9833e-131
iter: 6175, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072907
iter: 6175, Minibatch log likelihood (post-update): -54.2754, error rate (post-update): 0.072905

size_minibatch = 20000
Precon grad coeff: 0.017932, velocity coeff: 0.92119
norm(ch) = 0.21078
iter: 6176, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072905

size_minibatch = 20000
Precon grad coeff: 0.016827, velocity coeff: 1.0156
norm(ch) = 0.21415
iter: 6177, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072903

size_minibatch = 20000
Precon grad coeff: 0.021664, velocity coeff: 1.0697
norm(ch) = 0.22921
iter: 6178, Minibatch log likelihood (pre-update): -54.2754, error rate (pre-update): 0.072901

size_minibatch = 20000
Precon grad coeff: 0.017007, velocity coeff: 0.92218
norm(ch) = 0.2115
iter: 6179, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072901

size_minibatch = 20000
Precon grad coeff: 0.016468, velocity coeff: 1.0232
New gamma: 0.0031623
norm(ch) = 0.21662
rho = 1.0235
New lambda: 1.5347e-131
iter: 6180, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.0729
iter: 6180, Minibatch log likelihood (post-update): -54.2753, error rate (post-update): 0.0729

size_minibatch = 20000
Precon grad coeff: 0.019886, velocity coeff: 1.0979
norm(ch) = 0.23822
iter: 6181, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.0729

size_minibatch = 20000
Precon grad coeff: 0.014859, velocity coeff: 0.87071
norm(ch) = 0.20777
iter: 6182, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072897

size_minibatch = 20000
Precon grad coeff: 0.016518, velocity coeff: 1.1207
norm(ch) = 0.23331
iter: 6183, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072895

size_minibatch = 20000
Precon grad coeff: 0.01811, velocity coeff: 1.0698
norm(ch) = 0.25003
iter: 6184, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072897

size_minibatch = 20000
Precon grad coeff: 0.017459, velocity coeff: 0.98942
norm(ch) = 0.24796
rho = 0.75038
New lambda: 1.1875e-131
iter: 6185, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072895
iter: 6185, Minibatch log likelihood (post-update): -54.2753, error rate (post-update): 0.072893

size_minibatch = 20000
Precon grad coeff: 0.015287, velocity coeff: 0.96748
norm(ch) = 0.24046
iter: 6186, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072893

size_minibatch = 20000
Precon grad coeff: 0.018445, velocity coeff: 1.1065
norm(ch) = 0.26658
iter: 6187, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072892

size_minibatch = 20000
Precon grad coeff: 0.015127, velocity coeff: 0.91837
norm(ch) = 0.24529
iter: 6188, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072888

size_minibatch = 20000
Precon grad coeff: 0.018408, velocity coeff: 1.0663
norm(ch) = 0.2622
iter: 6189, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072888

size_minibatch = 20000
Precon grad coeff: 0.014384, velocity coeff: 0.8977
norm(ch) = 0.23574
rho = 1.3719
New lambda: 9.1886e-132
iter: 6190, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072887
iter: 6190, Minibatch log likelihood (post-update): -54.2753, error rate (post-update): 0.072885

size_minibatch = 20000
Precon grad coeff: 0.01747, velocity coeff: 1.1229
norm(ch) = 0.26513
iter: 6191, Minibatch log likelihood (pre-update): -54.2753, error rate (pre-update): 0.072885

size_minibatch = 20000
Precon grad coeff: 0.019931, velocity coeff: 0.97251
norm(ch) = 0.25836
iter: 6192, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072885

size_minibatch = 20000
Precon grad coeff: 0.013325, velocity coeff: 0.81853
norm(ch) = 0.21174
iter: 6193, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072882

size_minibatch = 20000
Precon grad coeff: 0.018062, velocity coeff: 1.1949
norm(ch) = 0.25332
iter: 6194, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.07288

size_minibatch = 20000
Precon grad coeff: 0.017014, velocity coeff: 0.9011
norm(ch) = 0.22852
rho = 0.72342
New lambda: 9.1886e-132
iter: 6195, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.07288
iter: 6195, Minibatch log likelihood (post-update): -54.2752, error rate (post-update): 0.072879

size_minibatch = 20000
Precon grad coeff: 0.016158, velocity coeff: 1.0356
norm(ch) = 0.2369
iter: 6196, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072879

size_minibatch = 20000
Precon grad coeff: 0.016797, velocity coeff: 1.0101
norm(ch) = 0.23954
iter: 6197, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072877

size_minibatch = 20000
Precon grad coeff: 0.016628, velocity coeff: 0.98259
norm(ch) = 0.23554
iter: 6198, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072878

size_minibatch = 20000
Precon grad coeff: 0.017516, velocity coeff: 1.0653
norm(ch) = 0.25109
iter: 6199, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072874

size_minibatch = 20000
Precon grad coeff: 0.016219, velocity coeff: 0.89686
New gamma: 0.0031623
norm(ch) = 0.22538
rho = 1.1885
New lambda: 7.11e-132
iter: 6200, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072869
iter: 6200, Minibatch log likelihood (post-update): -54.2752, error rate (post-update): 0.072872
---
Full log-likelihood: -54.2752, error rate: 0.072872
TEST log-likelihood: -55.8815, error rate: 0.53711
Error difference (test - train): 0.46424
---
Full log-likelihood (averaged params): -54.2773, error rate (averaged params): 0.073811
TEST log-likelihood (averaged params): -55.8481, error rate (averaged params): 0.52912
Error difference (test - train) (averaged params): 0.45531

size_minibatch = 20000
Precon grad coeff: 0.015293, velocity coeff: 1.0672
norm(ch) = 0.24068
iter: 6201, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072872

size_minibatch = 20000
Precon grad coeff: 0.019386, velocity coeff: 1.0348
norm(ch) = 0.24923
iter: 6202, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072871

size_minibatch = 20000
Precon grad coeff: 0.015583, velocity coeff: 0.95076
norm(ch) = 0.23715
iter: 6203, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.07287

size_minibatch = 20000
Precon grad coeff: 0.017366, velocity coeff: 1.0433
norm(ch) = 0.24759
iter: 6204, Minibatch log likelihood (pre-update): -54.2752, error rate (pre-update): 0.072869

size_minibatch = 20000
Precon grad coeff: 0.016456, velocity coeff: 0.98013
norm(ch) = 0.24286
rho = 0.89588
New lambda: 5.5016e-132
iter: 6205, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072865
iter: 6205, Minibatch log likelihood (post-update): -54.2751, error rate (post-update): 0.072864

size_minibatch = 20000
Precon grad coeff: 0.016387, velocity coeff: 0.97913
norm(ch) = 0.23804
iter: 6206, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072864

size_minibatch = 20000
Precon grad coeff: 0.015863, velocity coeff: 0.99024
norm(ch) = 0.23595
iter: 6207, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072863

size_minibatch = 20000
Precon grad coeff: 0.017955, velocity coeff: 1.0721
norm(ch) = 0.25327
iter: 6208, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072862

size_minibatch = 20000
Precon grad coeff: 0.016673, velocity coeff: 0.94609
norm(ch) = 0.23992
iter: 6209, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072861

size_minibatch = 20000
Precon grad coeff: 0.016769, velocity coeff: 1.0068
norm(ch) = 0.24186
rho = 1.0875
New lambda: 4.257e-132
iter: 6210, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072858
iter: 6210, Minibatch log likelihood (post-update): -54.2751, error rate (post-update): 0.072857

size_minibatch = 20000
Precon grad coeff: 0.015367, velocity coeff: 0.96548
norm(ch) = 0.2338
iter: 6211, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072857

size_minibatch = 20000
Precon grad coeff: 0.017524, velocity coeff: 1.0892
norm(ch) = 0.25503
iter: 6212, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072857

size_minibatch = 20000
Precon grad coeff: 0.017896, velocity coeff: 0.94929
norm(ch) = 0.24249
iter: 6213, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072854

size_minibatch = 20000
Precon grad coeff: 0.014953, velocity coeff: 0.955
norm(ch) = 0.23192
iter: 6214, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072852

size_minibatch = 20000
Precon grad coeff: 0.018506, velocity coeff: 1.0983
norm(ch) = 0.25514
rho = 1.2554
New lambda: 3.294e-132
iter: 6215, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072852
iter: 6215, Minibatch log likelihood (post-update): -54.2751, error rate (post-update): 0.07285

size_minibatch = 20000
Precon grad coeff: 0.015809, velocity coeff: 0.8963
norm(ch) = 0.22904
iter: 6216, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.07285

size_minibatch = 20000
Precon grad coeff: 0.015661, velocity coeff: 1.0406
norm(ch) = 0.23864
iter: 6217, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072847

size_minibatch = 20000
Precon grad coeff: 0.018372, velocity coeff: 1.0532
norm(ch) = 0.25174
iter: 6218, Minibatch log likelihood (pre-update): -54.2751, error rate (pre-update): 0.072849

size_minibatch = 20000
Precon grad coeff: 0.016691, velocity coeff: 0.95197
norm(ch) = 0.24
iter: 6219, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072846

size_minibatch = 20000
Precon grad coeff: 0.016828, velocity coeff: 0.95245
New gamma: 0.0031623
norm(ch) = 0.22891
rho = 0.9015
New lambda: 2.5488e-132
iter: 6220, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072844
iter: 6220, Minibatch log likelihood (post-update): -54.275, error rate (post-update): 0.072845

size_minibatch = 20000
Precon grad coeff: 0.014653, velocity coeff: 0.89156
norm(ch) = 0.20441
iter: 6221, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072845

size_minibatch = 20000
Precon grad coeff: 0.018148, velocity coeff: 1.1755
norm(ch) = 0.24066
iter: 6222, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072842

size_minibatch = 20000
Precon grad coeff: 0.018937, velocity coeff: 0.98545
norm(ch) = 0.23755
iter: 6223, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072839

size_minibatch = 20000
Precon grad coeff: 0.014969, velocity coeff: 0.89057
norm(ch) = 0.21186
iter: 6224, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.07284

size_minibatch = 20000
Precon grad coeff: 0.017085, velocity coeff: 1.1757
norm(ch) = 0.24941
rho = 0.85141
New lambda: 1.9722e-132
iter: 6225, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072837
iter: 6225, Minibatch log likelihood (post-update): -54.275, error rate (post-update): 0.072834

size_minibatch = 20000
Precon grad coeff: 0.018492, velocity coeff: 1.0207
norm(ch) = 0.25494
iter: 6226, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072834

size_minibatch = 20000
Precon grad coeff: 0.016594, velocity coeff: 0.93135
norm(ch) = 0.23772
iter: 6227, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072834

size_minibatch = 20000
Precon grad coeff: 0.01578, velocity coeff: 0.97357
norm(ch) = 0.23171
iter: 6228, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072833

size_minibatch = 20000
Precon grad coeff: 0.016664, velocity coeff: 1.1253
norm(ch) = 0.26104
iter: 6229, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.072834

size_minibatch = 20000
Precon grad coeff: 0.02028, velocity coeff: 0.9917
norm(ch) = 0.25917
rho = 1.0419
New lambda: 1.5261e-132
iter: 6230, Minibatch log likelihood (pre-update): -54.275, error rate (pre-update): 0.07283
iter: 6230, Minibatch log likelihood (post-update): -54.2749, error rate (post-update): 0.072828

size_minibatch = 20000
Precon grad coeff: 0.014314, velocity coeff: 0.84769
norm(ch) = 0.21988
iter: 6231, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072828

size_minibatch = 20000
Precon grad coeff: 0.016876, velocity coeff: 1.1422
norm(ch) = 0.2514
iter: 6232, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072828

size_minibatch = 20000
Precon grad coeff: 0.019176, velocity coeff: 1.0431
norm(ch) = 0.26251
iter: 6233, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072825

size_minibatch = 20000
Precon grad coeff: 0.016205, velocity coeff: 0.86367
norm(ch) = 0.22694
iter: 6234, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072827

size_minibatch = 20000
Precon grad coeff: 0.015781, velocity coeff: 1.0948
norm(ch) = 0.24869
rho = 0.65812
New lambda: 1.5261e-132
iter: 6235, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072826
iter: 6235, Minibatch log likelihood (post-update): -54.2749, error rate (post-update): 0.072822

size_minibatch = 20000
Precon grad coeff: 0.017003, velocity coeff: 0.9579
norm(ch) = 0.23847
iter: 6236, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072822

size_minibatch = 20000
Precon grad coeff: 0.018742, velocity coeff: 1.0808
norm(ch) = 0.25805
iter: 6237, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072822

size_minibatch = 20000
Precon grad coeff: 0.015472, velocity coeff: 0.85266
norm(ch) = 0.2203
iter: 6238, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.07282

size_minibatch = 20000
Precon grad coeff: 0.016546, velocity coeff: 1.1301
norm(ch) = 0.24924
iter: 6239, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072817

size_minibatch = 20000
Precon grad coeff: 0.016611, velocity coeff: 0.95512
New gamma: 0.0031623
norm(ch) = 0.23835
rho = 0.68681
New lambda: 1.5261e-132
iter: 6240, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072819
iter: 6240, Minibatch log likelihood (post-update): -54.2749, error rate (post-update): 0.072817

size_minibatch = 20000
Precon grad coeff: 0.018148, velocity coeff: 1.0558
norm(ch) = 0.25198
iter: 6241, Minibatch log likelihood (pre-update): -54.2749, error rate (pre-update): 0.072817

size_minibatch = 20000


